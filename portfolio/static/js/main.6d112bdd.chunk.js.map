{"version":3,"sources":["Resources/loading.gif","Utilities/Config.js","Utilities/Display.js","Utilities/Helper.js","HOCs/withMyAlert.js","Components/Displays/MyAlbumCard.js","Components/Displays/MyReaderContextMenu.js","Components/Displays/MyChapterDrawer.js","Components/Displays/MyReaderModal.js","Components/Editors/MyInputTextbox.js","Components/Editors/MyInputStar.js","Components/Editors/MyInputRadio.js","Components/Editors/MyInputCheck.js","Components/Editors/MyInputMulticheck.js","Components/MyEditModal.js","Pages/AlbumList.js","Data/DataSource.js","Components/Editors/MyInputButton.js","Pages/AlbumAddEdit.js","Pages/GenreList.js","Components/MyTagMenuItem.js","Components/Editors/MyQueryEditor.js","MasterPage.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","API_URL","DesktopOnly","children","useMediaQuery","minWidth","MobileOnly","maxWidth","firstLetterLowerCase","string","charAt","toLowerCase","slice","apiErrorHandler","error","undefined","response","alert","JSON","stringify","getPercent100","value","maxValue","fraction","withMyAlert","OriginalComponent","props","popInfo","title","stringContent","objContent","Modal","info","content","onOk","width","popError","popApiError","status","statusText","data","warning","confirm","axios","require","default","ColorFromIndex","tier","i","bot","FlagIcon","flagStyle","height","marginRight","marginBottom","language","GB","style","JP","CN","ID","handler","view","onView","albumCm","edit","onEdit","albumId","delete","fullTitle","icon","ExclamationCircleOutlined","okText","okType","cancelText","then","console","log","onDelete","catch","onCancel","menu","Item","key","onClick","EditOutlined","DeleteOutlined","useInView","threshold","rootMargin","ref","inView","paddingBottom","position","overlay","trigger","disabled","showContextMenu","textAlign","className","isRead","src","coverInfo","uncPathEncoded","alt","top","left","languages","map","item","writingMode","textOrientation","color","Array","e","fontWeight","lastPageIndex","percent","Helper","pageCount","showInfo","strokeWidth","paddingLeft","paddingRight","fontSize","lineHeight","MyReaderContextMenu","useState","jumpValue","setJumpValue","useEffect","initialValue","setNewPageName","pageName","showRenameModal","setShowRenameModal","showConfirmDelete","setShowConfirmDelete","tierDisplay","setTierDisplay","newPageName","visible","footer","closable","centered","span","count","onChange","onTierChange","type","onRecount","FileSyncOutlined","marginTop","Math","min","max","target","padding","WebkitBoxSizing","borderRadius","onJump","ArrowRightOutlined","onUndoJump","ArrowLeftOutlined","bodyStyle","backgroundColor","border","TextArea","event","rows","onRename","chapters","setChapters","get","chapterTitle","encodedChapterTitle","encodeURIComponent","onChapterDeleteSuccess","filter","c","placement","onClose","chapter","index","onJumpToPage","pageIndex","objectFit","maxHeight","pageUncPath","getOverlayStyle","isGrey","button","boxSizing","getGuideLabel","text","margin","textShadow","PageDisplay","styleShow","window","innerHeight","innerWidth","styleHide","extension","IsVideo","pageInfo","autoPlay","loop","id","queue","loadingImg","currentPageIndex","useRef","previousPageIndex","zenpenPageInfo","setZenpenPageInfo","chuhenPageInfo","setChuhenPageInfo","kouhenPageInfo","setKouhenPageInfo","targetPage","pageHandler","jumpTo","document","addEventListener","handleKeyDown2","removeEventListener","keyCode","current","currentTriad","page","number","maxIndex","compose","newTriad","zenpenIndex","chuhenIndex","kouhenIndex","cPageI","rename","newName","post","onPageDeleteSuccess","albumHandler","tierChange","put","recount","setShowContextMenu","showDrawer","setShowDrawer","buttonHandler","rightTop","rightMid","rightBot","midTop","midMid","midBot","leftTop","leftMid","leftBot","swipeHandler","useSwipeable","onSwipedLeft","eventData","onSwipedRight","showGuide","overlayStyle","buttonStyle","side","minHeight","mid","display","isOpen","currentPageInfo","zenpenPage","chuhenPage","kouhenPage","zIndex","name","bottom","newPageCount","MyInputTextbox","gutter","label","placeholder","MyInputStar","MyInputRadio","Group","items","MyInputCheck","checked","MyInputMulticheck","includes","ghost","lodash","useSWR","albumInfo","aiError","path","album","category","orientation","artists","tags","flags","cover","isWip","entryDate","albumVm","setAlbumVm","handlers","albumVmChange","newAlbumVm","cleanedValue","split","pull","push","ok","cancel","join","categories","orientations","albumCms","setAlbumCms","scrollTo","encodedQuery","query","readerModalIsOpen","setReaderModalIsOpen","selectedAlbumId","setSelectedAlbumId","readerHandler","close","aIndex","editModalIsOpen","setEditModalIsOpen","editedAlbumId","setEditedAlbumId","crudHandler","pageDeleteSuccess","chapterDeleteSuccess","editHandler","editedAlbumVm","newAlbumCms","editedAlbumVmIndex","findIndex","a","lg","md","xs","find","aCm","GetTags","FetchAlbumInfo","GetCategories","GetOrientations","GetLanguages","fetch","method","res","json","MyInputButton","AlbumAddEdit","webkit","Files","setFiles","AlbumVm","Tags","setTags","Categories","setCategories","Orientations","setOrientations","Languages","setLanguages","handleAlbumVmChange","DataSource","_tag","_categories","_orientations","_languages","getElementById","onchange","files","justify","align","webkitdirectory","directory","multiple","GenreList","endpoint","albumCGroups","history","acg","paddingTop","MyTagMenuItem","tag","plusBackground","selectStatus","minusBackground","role","onPlus","PlusOutlined","to","onMinus","MinusOutlined","MyQueryEditor","setVisible","setQuery","ConsoleSqlOutlined","SearchOutlined","autoSize","minRows","maxRows","Content","Layout","Header","Footer","Sider","SubMenu","Menu","withRouter","selectedMenu","collapseSider","setCollapseSider","querStr","queryString","parse","location","search","queryHandler","correctedQuery","pattern","forEach","word","goToAlbumList","plus","tagName","targetQueryPlus","targetQueryMinus","newQueries","newQueryString","minus","currentUrlParams","URLSearchParams","set","toString","actionHandler","reload","rescan","menuContent","theme","defaultSelectedKeys","defaultOpenKeys","mode","DesktopOutlined","TeamOutlined","PartitionOutlined","TagsOutlined","TagItemsContainer","DatabaseOutlined","ReloadOutlined","SyncOutlined","revalidateOnFocus","fetcher","collapsible","collapsed","onCollapse","getSelectStatus","queryArr","str","length","App","exact","Boolean","hostname","match","startApp","ReactDOM","render","isCordova","navigator","serviceWorker","ready","registration","unregister","message","cordova"],"mappings":"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","file":"static/js/main.6d112bdd.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/loading.d47e58c7.gif\";","//WARNING can't figure out how to read .env file in production\r\n//require('dotenv').config();\r\n//const API_URL = process.env.REACT_APP_API_URL;\r\n\r\nconst API_URL = \"https://192.255.234.89:80/\";\r\n//const API_URL = \"http://192.168.8.103:5000/\";\r\n//const API_URL = \"http://localhost:57389/\";\r\nconst IS_PUBLIC = true;\r\n\r\n//console.log(\"API URL IS \", API_URL);\r\n\r\nexport { API_URL, IS_PUBLIC }","import { useMediaQuery } from 'react-responsive'\r\n\r\nconst DesktopOnly = ({ children }) => {\r\n  const isDesktop = useMediaQuery({ minWidth: 801 })\r\n  return isDesktop ? children : null\r\n}\r\nconst MobileOnly = ({ children }) => {\r\n  const isMobile = useMediaQuery({ maxWidth: 800 })\r\n  return isMobile ? children : null\r\n}\r\n\r\nexport { DesktopOnly, MobileOnly };","\r\nexport function firstLetterLowerCase(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nexport function apiErrorHandler(error) {\r\n  if (typeof error.response !== undefined) {\r\n    alert(JSON.stringify(error.response, null, \"\\t\"))\r\n  }\r\n  else {\r\n    alert(JSON.stringify(error, null, \"\\t\"));\r\n  }\r\n}\r\n\r\nexport function getPercent100(value, maxValue) {\r\n  let fraction = (value / maxValue) * 100;\r\n  let result = fraction <= 100 ? fraction : 100;\r\n  return result;\r\n}\r\n\r\nexport function contains(target, pattern) {\r\n  var value = 0;\r\n  pattern.forEach(function (word) {\r\n    value = value + target.includes(word);\r\n  });\r\n  return (value === 1);\r\n}\r\n\r\nexport function clamp(number, min, max) {\r\n  return Math.max(min, Math.min(number, max));\r\n}","import React from 'react';\r\nimport { Modal } from 'antd';\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  const width = 500;\r\n\r\n  function popInfo(title, stringContent, objContent) {\r\n    Modal.info({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {JSON.stringify(objContent, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popError(title, stringContent, objContent) {\r\n    Modal.error({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {JSON.stringify(objContent, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popApiError(error) {\r\n    if (error.response == null) {\r\n      Modal.error(JSON.stringify(error));\r\n      return;\r\n    }\r\n    const { status, statusText, data } = error.response;\r\n\r\n    const content = {\r\n      title: `${status} - ${statusText}`,\r\n      content: (\r\n        <span>\r\n          {JSON.stringify(data, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    };\r\n\r\n    if (status >= 400 && status < 500) {\r\n      Modal.warning(content);\r\n    }\r\n    else {\r\n      Modal.error(content);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      popInfo={popInfo}\r\n      popError={popError}\r\n      popApiError={popApiError}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;","import React, { useState, useEffect } from 'react';\r\nimport { useInView } from 'react-intersection-observer';\r\nimport { API_URL } from '../../Utilities/Config';\r\nimport { Dropdown, Menu, Modal, Progress } from 'antd';\r\nimport Flags from 'country-flag-icons/react/3x2';\r\nimport { MoreOutlined, DeleteOutlined, EditOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction MyAlbumCard(props) {\r\n  const handler = {\r\n    view: function () {\r\n      props.onView(props.albumCm)\r\n    },\r\n\r\n    edit: function () {\r\n      props.onEdit(props.albumCm.albumId)\r\n    },\r\n\r\n    delete: function () {\r\n      confirm({\r\n        title: `Delete album ${props.albumCm.fullTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          axios.delete(API_URL + \"Crud/DeleteAlbum/\" + props.albumCm.albumId)\r\n            .then(function (response) {\r\n              console.log(\"del success\", response);\r\n              props.onDelete(props.albumCm.albumId);\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  const menu = (\r\n    <Menu>\r\n      <Menu.Item key=\"1\" onClick={handler.edit}><EditOutlined />Edit</Menu.Item>\r\n      <Menu.Item key=\"2\" onClick={handler.delete}><DeleteOutlined />Delete</Menu.Item>\r\n    </Menu>\r\n  );\r\n\r\n  const [ref, inView, entry] = useInView({\r\n    threshold: 0,\r\n    rootMargin: \"150px 0px 16px 0px\"\r\n  });\r\n\r\n  const absoluteH = \"150px\";\r\n  const flagTopMargin = \"134px\";//absoluteH - (0.5 * height of flags container div)\r\n  const tierTopMargin = \"66px\";//absoluteH / 2 - (0.5 * heights of tier container div)\r\n\r\n  return (\r\n    <div ref={ref} style={{ paddingBottom: '8px', position: \"relative\" }}>\r\n      <Dropdown overlay={menu} trigger={['contextMenu']} disabled={!props.showContextMenu}>\r\n        <div style={{ textAlign: \"center\" }}>\r\n          <div style={{ height: absoluteH, width: \"100%\" }}>\r\n            <img\r\n              onClick={handler.view}\r\n              className={\"img-contain \" + (!props.albumCm.isRead ? \"img-highlight\" : \"\")}\r\n              style={{ height: absoluteH, width: \"100%\", maxWidth: absoluteH }}\r\n              src={inView ? API_URL + \"Media/StreamResizedImage?librelPathBase64=\" + props.albumCm.coverInfo.uncPathEncoded + \"&maxSize=150\" : \"\"}\r\n              alt=\"img\"\r\n            >\r\n            </img>\r\n          </div>\r\n          <div\r\n            style={{ position: \"absolute\", top: flagTopMargin, left: \"50%\", width: \"50%\", maxWidth: \"64px\", textAlign: \"right\" }}\r\n            onClick={handler.view}\r\n          >\r\n            {props.albumCm.languages.map((item, i) => <FlagIcon language={item} key={i} />)}\r\n          </div>\r\n          <div style={{ position: \"absolute\", top: tierTopMargin, left: \"50%\", width: \"50%\", maxWidth: \"72px\", height: \"60px\", textAlign: \"right\", writingMode: \"vertical-rl\", textOrientation: \"upright\", color: \"#52c41a\" }}\r\n            onClick={handler.view}\r\n          >\r\n            <span>{[...Array(props.albumCm.tier)].map((e, i) => <span key={i} style={{ fontWeight: \"bold\", color: ColorFromIndex(props.albumCm.tier, i) }}>l</span>)}</span>\r\n          </div>\r\n          <div style={{ position: \"absolute\", top: absoluteH, textAlign: \"center\", width: \"100%\" }} >\r\n            {props.albumCm.lastPageIndex > 0 ? <Progress percent={Helper.getPercent100(props.albumCm.lastPageIndex + 1, props.albumCm.pageCount)} showInfo={false} strokeWidth={2} style={{ paddingLeft: 3, paddingRight: 3, width: \"70%\" }} /> : <></>}\r\n          </div>\r\n          <span style={{ fontSize: '12px', lineHeight: 1.1 }}>\r\n            {props.albumCm.fullTitle}\r\n          </span>\r\n        </div>\r\n      </Dropdown>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ColorFromIndex(tier, i) {\r\n  const top = \"#22c1c3\";\r\n  const mid = \"#8ebe79\";\r\n  const bot = \"#fdbb2d\";\r\n\r\n  const color =\r\n    tier === 1 ? bot :\r\n      tier === 2 ? i === 0 ? mid : bot :\r\n        tier === 3 ? i === 0 ? top : i === 1 ? mid : bot :\r\n          \"black\";\r\n\r\n  return color;\r\n}\r\n\r\nfunction FlagIcon(props) {\r\n  const flagStyle = { width: \"18px\", height: \"12px\", marginRight: \"2px\", marginBottom: \"2px\" };\r\n\r\n  return (\r\n    <>\r\n      {\r\n        props.language === \"English\" ? <Flags.GB style={flagStyle} /> :\r\n          props.language === \"Japanese\" ? <Flags.JP style={flagStyle} /> :\r\n            props.language === \"Chinese\" ? <Flags.CN style={flagStyle} /> :\r\n              <Flags.ID style={flagStyle} />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyAlbumCard);","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Modal, Button, Menu, Input, Rate } from 'antd';\r\nimport { API_URL } from '../../Utilities/Config';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport { ArrowLeftOutlined, ArrowRightOutlined, DeleteOutlined, EditOutlined, ExclamationCircleOutlined, LineOutlined, FileSyncOutlined } from '@ant-design/icons';\r\n\r\n//import './MyReaderModal.scss';\r\n\r\nfunction MyReaderContextMenu(props) {\r\n  const [jumpValue, setJumpValue] = useState(0);\r\n  useEffect(() => {\r\n    setJumpValue(props.initialValue + 1);\r\n  }, [props.initialValue]);\r\n\r\n  useEffect(() => {\r\n    setNewPageName(props.pageName);\r\n  }, [props.pageName]);\r\n\r\n  const [showRenameModal, setShowRenameModal] = useState(false);\r\n  const [showConfirmDelete, setShowConfirmDelete] = useState(false);\r\n\r\n  const [tierDisplay, setTierDisplay] = useState(0);\r\n  useEffect(() => {\r\n    setTierDisplay(props.albumCm.tier);\r\n  }, [props.albumCm]);\r\n\r\n  const [newPageName, setNewPageName] = useState(\"\");\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={props.visible}\r\n        onCancel={props.onCancel}\r\n        footer={null}\r\n        closable={false}\r\n        centered={true}\r\n        style={{ maxWidth: 300 }}\r\n      //bodyStyle={{ border: \"1px solid black\" }}\r\n      >\r\n        <Row>\r\n          <Col span={24} style={{ marginBottom: 15, textAlign: \"center\" }}>\r\n            <Rate\r\n              count={3}\r\n              value={tierDisplay}\r\n              onChange={(value) => { setTierDisplay(value); props.onTierChange(value); }}\r\n              style={{ fontSize: \"40px\" }}\r\n            />\r\n          </Col>\r\n          <Col span={24}>\r\n            <Button type=\"primary\" onClick={() => props.onRecount()} style={{ width: \"100%\" }}>\r\n              <FileSyncOutlined />Recount Pages\r\n            </Button>\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <input type=\"number\" value={jumpValue} onChange={(e) => setJumpValue(Math.min(Math.max(e.target.value, 1), props.albumCm.pageCount))} style={{ width: \"97%\", padding: \"4px\", WebkitBoxSizing: \"border-box\", borderRadius: \"5px\" }} />\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"right\", marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onJump(jumpValue - 1)} style={{ width: \"97%\", color: \"white\" }}>\r\n              <ArrowRightOutlined />Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onUndoJump()} style={{ width: \"100%\" }}>\r\n              <ArrowLeftOutlined />Undo Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => { props.onCancel(); setShowRenameModal(true); }} style={{ width: \"100%\" }}>\r\n              <EditOutlined />Rename Page\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"danger\" onClick={() => { props.onCancel(); setShowConfirmDelete(true); }} style={{ width: \"100%\" }}>\r\n              <DeleteOutlined />Delete Page\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Modal>\r\n      <Modal\r\n        visible={showRenameModal}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowRenameModal(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <Input.TextArea value={newPageName} onChange={(event) => setNewPageName(event.target.value)} rows={2} />\r\n        <Button type=\"primary\" onClick={() => { setShowRenameModal(false); props.onRename(newPageName); }} style={{ width: \"100%\" }}>\r\n          Rename\r\n        </Button>\r\n      </Modal>\r\n      <Modal\r\n        visible={showConfirmDelete}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowConfirmDelete(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <span style={{ color: \"white\" }}>Are you sure to delete this page?</span>\r\n        <Button type=\"danger\" onClick={() => { setShowConfirmDelete(false); props.onDelete(); }} style={{ width: \"100%\" }}>\r\n          Delete\r\n        </Button>\r\n      </Modal>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MyReaderContextMenu;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Drawer, Modal, Button, Menu, Input, Dropdown } from 'antd';\r\nimport {\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { API_URL } from '../../Utilities/Config';\r\n//import * as Helper from '../../Utilities/Helper';\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction MyChapterDrawer(props) {\r\n  const [chapters, setChapters] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(API_URL + `Crud/GetAlbumChapters?id=${props.albumId}`)\r\n      .then(function (response) {\r\n        setChapters(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handler = {\r\n    rename: (chapterTitle) => {\r\n      console.log(\"rename \", chapterTitle);\r\n    },\r\n    delete: (chapterTitle) => {\r\n      console.log(\"delete \", chapterTitle);\r\n      confirm({\r\n        title: `Delete chapter ${chapterTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   Yes   ',\r\n        okType: 'danger',\r\n        cancelText: '   No   ',\r\n        onOk() {\r\n          let encodedChapterTitle = encodeURIComponent(chapterTitle);\r\n          axios.delete(API_URL + `Crud/DeleteAlbumChapter/${props.albumId}/${encodedChapterTitle}`)\r\n            .then(function (response) {\r\n              console.log(\"newPageCount\", response.data);\r\n              props.onChapterDeleteSuccess(response.data);\r\n              setChapters(\r\n                chapters.filter(c => c.title !== chapterTitle)\r\n              );\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      placement=\"left\"\r\n      closable={false}\r\n      onClose={props.onClose}\r\n      visible={props.visible}\r\n    >\r\n      <div style={{ padding: \"10px\" }}>\r\n        {chapters.map((chapter, index) => (\r\n          <Row style={{ marginBottom: \"5px\" }} key={chapter.title}>\r\n            <Dropdown overlay={\r\n              <Menu>\r\n                <Menu.Item key=\"1\" onClick={() => handler.rename(chapter.title)}><EditOutlined />Rename</Menu.Item>\r\n                <Menu.Item key=\"2\" onClick={() => handler.delete(chapter.title)}><DeleteOutlined />Delete</Menu.Item>\r\n              </Menu>}\r\n              trigger={['contextMenu']}\r\n            >\r\n              <Col span={10} onClick={() => props.onJumpToPage(chapter.pageIndex)}>\r\n                <img\r\n                  style={{ objectFit: \"contain\", width: \"100%\", maxHeight: \"128px\", border: \"1px solid white\" }}\r\n                  src={API_URL + \"Media/GetThumbnailStream/\" + chapter.pageUncPath + \"/128\"}\r\n                  alt=\"img\"\r\n                >\r\n                </img>\r\n              </Col>\r\n            </Dropdown>\r\n            <Col span={14}>\r\n              <span style={{ color: \"white\" }}>{chapter.title}</span>\r\n            </Col>\r\n          </Row>\r\n        ))};\r\n      </div>\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyChapterDrawer);","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Drawer, Modal, Button, Menu, Input } from 'antd';\r\nimport { API_URL, IS_PUBLIC } from '../../Utilities/Config';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport { ArrowRightOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport MyReaderContextMenu from './MyReaderContextMenu';\r\nimport MyChapterDrawer from './MyChapterDrawer';\r\nimport loadingImg from '../../Resources/loading.gif';\r\n\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\nimport { useSwipeable } from 'react-swipeable';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction MyReaderModal(props) {\r\n  const currentPageIndex = useRef(0);\r\n  const previousPageIndex = useRef(0);\r\n  const [zenpenPageInfo, setZenpenPageInfo] = useState({});\r\n  const [chuhenPageInfo, setChuhenPageInfo] = useState({});\r\n  const [kouhenPageInfo, setKouhenPageInfo] = useState({});\r\n\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n\r\n    console.log(\"pagecount \", props.albumCm.pageCount);\r\n\r\n    let targetPage = props.albumCm.lastPageIndex < props.albumCm.pageCount ? props.albumCm.lastPageIndex : props.albumCm.pageCount - 1;\r\n\r\n    pageHandler.jumpTo(targetPage);\r\n\r\n  }, [props.albumCm]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"keydown\", handleKeyDown2, false);\r\n\r\n    return () => { //component will unmount\r\n      document.removeEventListener(\"keydown\", handleKeyDown2, false);\r\n    };\r\n  }, []);\r\n\r\n  const handleKeyDown2 = (event) => {\r\n    if (event.keyCode === 27) {\r\n      props.onClose(currentPageIndex.current);\r\n    }\r\n  };\r\n\r\n  //#region Event handlers\r\n\r\n  const currentTriad = useRef(\"zenpen\");\r\n  const pageHandler = {\r\n    jumpTo: function (page) {\r\n      if (props.albumCm.albumId === undefined) { return; }\r\n\r\n      const maxIndex = props.albumCm.pageCount - 1;\r\n\r\n      previousPageIndex.current = currentPageIndex.current;\r\n      currentPageIndex.current = Helper.clamp(page, 0, maxIndex);\r\n\r\n      const { newTriad, zenpenIndex, chuhenIndex, kouhenIndex } = (() => {\r\n        function compose(newTriad, zenpenIndex, chuhenIndex, kouhenIndex) {\r\n          return {\r\n            newTriad,\r\n            zenpenIndex,\r\n            chuhenIndex,\r\n            kouhenIndex\r\n          };\r\n        }\r\n\r\n        const cPageI = currentPageIndex.current;\r\n\r\n        if (cPageI % 3 === 0) {\r\n          return compose(\"zenpen\", cPageI, (cPageI + 1) % props.albumCm.pageCount, null);\r\n        }\r\n        if (cPageI % 3 === 1) {\r\n          return compose(\"chuhen\", null, cPageI, (cPageI + 1) % props.albumCm.pageCount);\r\n        }\r\n        if (cPageI % 3 === 2) {\r\n          return compose(\"kouhen\", (cPageI + 1) % props.albumCm.pageCount, null, cPageI);\r\n        }\r\n      })();\r\n      currentTriad.current = newTriad;\r\n\r\n      if (zenpenIndex !== null) {\r\n        axios.get(API_URL + \"File/GetPageinfo/?id=\" + props.albumCm.albumId + \"&index=\" + zenpenIndex)\r\n          .then(function (response) {\r\n            setZenpenPageInfo(response.data);\r\n          })\r\n          .catch(function (error) {\r\n            Helper.apiErrorHandler(error);\r\n          });\r\n      }\r\n\r\n      if (chuhenIndex !== null) {\r\n        axios.get(API_URL + \"File/GetPageinfo/?id=\" + props.albumCm.albumId + \"&index=\" + chuhenIndex)\r\n          .then(function (response) {\r\n            setChuhenPageInfo(response.data);\r\n          })\r\n          .catch(function (error) {\r\n            Helper.apiErrorHandler(error);\r\n          });\r\n      }\r\n\r\n      if (kouhenIndex !== null) {\r\n        axios.get(API_URL + \"File/GetPageinfo/?id=\" + props.albumCm.albumId + \"&index=\" + kouhenIndex)\r\n          .then(function (response) {\r\n            setKouhenPageInfo(response.data);\r\n          })\r\n          .catch(function (error) {\r\n            Helper.apiErrorHandler(error);\r\n          });\r\n      }\r\n    },\r\n    rename: (page, newName) => {\r\n      console.log(`rename page ${page} with name ${newName}`);\r\n      axios.post(API_URL + \"File/RenameFile\", {\r\n        albumId: props.albumCm.albumId,\r\n        pageIndex: page,\r\n        newName: newName\r\n      })\r\n        .then(function (response) {\r\n          pageHandler.jumpTo(currentPageIndex.current - 1);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    delete: (page) => {\r\n      axios.delete(API_URL + `File/DeleteFile/${props.albumCm.albumId}/${page}`)\r\n        .then(function (response) {\r\n          props.onPageDeleteSuccess(props.albumCm.albumId, page);\r\n          //pageHandler.jumpTo(currentPageIndex.current);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const albumHandler = {\r\n    tierChange: (value) => {\r\n      axios.put(API_URL + \"Crud/UpdateAlbumTier\", {\r\n        albumId: props.albumCm.albumId,\r\n        tier: value\r\n      })\r\n        .then(function (response) {\r\n          console.log(response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    recount: () => {\r\n      axios.post(API_URL + \"Crud/RecountAlbumPages\", {\r\n        albumId: props.albumCm.albumId\r\n      })\r\n        .then(function (response) {\r\n          console.log(\"new page count\", response.data);\r\n          props.onChapterDeleteSuccess(props.albumCm.albumId, response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const [showContextMenu, setShowContextMenu] = useState(false);\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n\r\n  const buttonHandler = {\r\n    rightTop: () => {\r\n      props.onClose(props.albumCm.albumId, currentPageIndex.current);\r\n    },\r\n    rightMid: () => {\r\n      pageHandler.jumpTo(currentPageIndex.current + 1);\r\n    },\r\n    rightBot: () => {\r\n      pageHandler.jumpTo(props.albumCm.pageCount - 1);\r\n    },\r\n    midTop: () => {\r\n\r\n    },\r\n    midMid: () => {\r\n      setShowContextMenu(true);\r\n    },\r\n    midBot: () => {\r\n\r\n    },\r\n    leftTop: () => {\r\n      setShowDrawer(true);\r\n    },\r\n    leftMid: () => {\r\n      pageHandler.jumpTo(currentPageIndex.current - 1);\r\n    },\r\n    leftBot: () => {\r\n      pageHandler.jumpTo(0);\r\n    }\r\n  }\r\n\r\n  const swipeHandler = useSwipeable({\r\n    onSwipedLeft: (eventData) => { pageHandler.jumpTo(currentPageIndex.current + 1); },\r\n    onSwipedRight: (eventData) => { pageHandler.jumpTo(currentPageIndex.current - 1); }\r\n  });\r\n\r\n  //#endregion\r\n  const showGuide = IS_PUBLIC && currentPageIndex.current === 0;\r\n  const overlayStyle = getOverlayStyle(showGuide);\r\n  const buttonStyle = {\r\n    side: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.25 * window.innerHeight\r\n    },\r\n    mid: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.5 * window.innerHeight\r\n    }\r\n  }\r\n\r\n  const display = props.isOpen ? \"block\" : \"none\";\r\n\r\n  const currentPageInfo = currentTriad.current === \"zenpen\" ? zenpenPageInfo\r\n    : currentTriad.current === \"chuhen\" ? chuhenPageInfo\r\n      : currentTriad.current === \"kouhen\" ? kouhenPageInfo\r\n        : null;\r\n\r\n  const zenpenPage = <PageDisplay\r\n    id=\"zenpen-page\"\r\n    pageInfo={zenpenPageInfo}\r\n    queue={currentTriad.current === \"zenpen\" ? \"q0\" : currentTriad.current === \"kouhen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  const chuhenPage = <PageDisplay\r\n    id=\"chuhen-page\"\r\n    pageInfo={chuhenPageInfo}\r\n    queue={currentTriad.current === \"chuhen\" ? \"q0\" : currentTriad.current === \"zenpen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  const kouhenPage = <PageDisplay\r\n    id=\"kouhen-page\"\r\n    pageInfo={kouhenPageInfo}\r\n    queue={currentTriad.current === \"kouhen\" ? \"q0\" : currentTriad.current === \"chuhen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  if (props.albumCm === undefined) { return (<></>); }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"overlay overlay-reader\" style={{ display: display, zIndex: 1 }}>\r\n        <div className=\"overlay-content\">\r\n          {zenpenPage}\r\n          {chuhenPage}\r\n          {kouhenPage}\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 2 }}>\r\n          <div className=\"overlay-content\">\r\n            <span className=\"with-shadow\">{currentPageInfo.name}</span>\r\n            <div style={{ position: \"fixed\", bottom: \"0px\", width: \"100%\", textAlign: \"center\" }}>\r\n              <span className=\"with-shadow\">{currentPageIndex.current + 1}/{props.albumCm.pageCount}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 3 }}>\r\n          <div style={overlayStyle.content} {...swipeHandler}>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Browse Chapters\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midTop} style={buttonStyle.side}>\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Close Album\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Previous Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Context Menu\")}\r\n                </div>\r\n                <MyReaderContextMenu\r\n                  albumCm={props.albumCm}\r\n                  initialValue={currentPageIndex.current}\r\n                  pageName={currentPageInfo.name}\r\n                  onTierChange={albumHandler.tierChange}\r\n                  onRecount={() => { albumHandler.recount(); setShowContextMenu(false); }}\r\n                  onJump={(page) => { pageHandler.jumpTo(page); setShowContextMenu(false); }}\r\n                  onUndoJump={() => { pageHandler.jumpTo(previousPageIndex.current); setShowContextMenu(false); }}\r\n                  visible={showContextMenu}\r\n                  onRename={(value) => { pageHandler.rename(currentPageIndex.current, value); setShowContextMenu(false); }}\r\n                  onDelete={() => { pageHandler.delete(currentPageIndex.current); setShowContextMenu(false); }}\r\n                  onCancel={() => setShowContextMenu(false)}\r\n                />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Next Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"First Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midBot} style={buttonStyle.side} />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Last Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <MyChapterDrawer\r\n        visible={showDrawer}\r\n        onClose={() => setShowDrawer(false)}\r\n        albumId={props.albumCm.albumId}\r\n        onJumpToPage={pageHandler.jumpTo}\r\n        onChapterDeleteSuccess={(newPageCount) => props.onChapterDeleteSuccess(props.albumCm.albumId, newPageCount)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst getOverlayStyle = (isGrey) => {\r\n  const result = {\r\n    content: {\r\n      position: 'relative',\r\n      top: '0%',\r\n      width: '100%',\r\n      textAlign: 'center',\r\n      backgroundColor: isGrey ? 'rgba(200, 200, 200, 0.3)' : 'rgba(0, 0, 0, 0)'\r\n    },\r\n    button: {\r\n      position: 'relative',\r\n      boxSizing: 'border-box',\r\n      border: isGrey ? '1px solid black' : '0px'\r\n    }\r\n  };\r\n\r\n  return result;\r\n}\r\n\r\nconst getGuideLabel = (isGrey, text) => {\r\n  return isGrey ?\r\n    <span style={{ textAlign: \"center\", margin: \"auto\", textShadow: \"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black\" }}>\r\n      {text}\r\n    </span> :\r\n    \"\";\r\n}\r\n\r\nfunction PageDisplay(props) {\r\n  const styleShow = { height: window.innerHeight, width: window.innerWidth };\r\n  //const styleShow = { height: 300, width: 300 };\r\n  const styleHide = { height: 0, width: 0, position: \"absolute\" };\r\n  //const styleHide = { height: 150, width: 150 };\r\n\r\n  if (IsVideo(props.pageInfo.extension)) {\r\n    return (\r\n      <video\r\n        autoPlay loop\r\n        id={props.id}\r\n        className=\"img-contain\"\r\n        style={props.queue === \"q0\" ? styleShow : styleHide}\r\n        src={props.queue === \"q0\" ? API_URL + \"Media/StreamVideo?librelPathBase64=\" + props.pageInfo.uncPathEncoded : \"\"}\r\n      >\r\n        video not showing\r\n      </video>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <img\r\n      id={props.id}\r\n      className=\"img-contain\"\r\n      style={props.queue === \"q0\" ? styleShow : styleHide}\r\n      src={props.queue === \"q0\" || props.queue === \"q1\" ? API_URL + \"Media/StreamImage?librelPathBase64=\" + props.pageInfo.uncPathEncoded : loadingImg}\r\n      alt=\"Not loaded\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction IsVideo(extension) {\r\n  if (extension === \".webm\" || extension === \".mp4\") {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default withMyAlert(MyReaderModal);","import React from 'react';\r\nimport { Input } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputTextbox(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Input\r\n            placeholder={props.placeholder}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputTextbox;","import React from 'react';\r\nimport { Rate } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputStar(props) {\r\n  function handleChange(value) {\r\n    props.onChange(props.label, value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Rate\r\n            count={3}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputStar;","import React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputRadio(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Radio.Group onChange={handleChange} value={props.value} style={{ width: \"100%\" }}>\r\n            <Row>\r\n              {props.items.map(item => (\r\n                <Col span={8} key={item}>\r\n                  <Radio key={item} value={item}><span style={{ color: \"white\" }}>{item}</span></Radio>\r\n                </Col>\r\n              ))}\r\n            </Row>\r\n          </Radio.Group>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputRadio;","import React from 'react';\r\nimport { Checkbox } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputCheck(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.checked);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Checkbox onChange={handleChange} checked={props.value} />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputCheck;","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputMulticheck(props) {\r\n\r\n  function handleClick(label) {\r\n    props.onChange(props.label, label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Row gutter={2}>\r\n            {props.items.map((item) => (\r\n              <Col span={8} key={item}>\r\n                <Button\r\n                  key={item}\r\n                  type={props.value.includes(item) ? \"primary\" : \"link\"}\r\n                  ghost={props.value.includes(item) ? true : false}\r\n                  onClick={() => handleClick(item)}\r\n                  style={{ width: \"100%\", textAlign: \"left\", marginBottom: \"2px\" }}\r\n                >\r\n                  {item}\r\n                </Button>\r\n              </Col>)\r\n            )}\r\n          </Row>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputMulticheck;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Modal, Button } from 'antd';\r\nimport { API_URL } from '../Utilities/Config';\r\nimport * as Helper from '../Utilities/Helper';\r\nimport MyInputTextbox from './Editors/MyInputTextbox';\r\nimport MyInputStar from './Editors/MyInputStar';\r\nimport MyInputRadio from './Editors/MyInputRadio';\r\nimport MyInputCheck from './Editors/MyInputCheck';\r\nimport MyInputMulticheck from './Editors/MyInputMulticheck';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\n\r\nimport useSWR from 'swr';\r\n\r\n//import * as DataSource from \"../Data/DataSource\";\r\n\r\nconst lodash = require('lodash/array');\r\nconst axios = require('axios').default;\r\n\r\nfunction MyEditModal(props) {\r\n  const { data: albumInfo, error: aiError } = useSWR(\"Crud/GetAlbumInfo\");\r\n\r\n  const [albumVm, setAlbumVm] = useState({\r\n    albumId: \"\",\r\n    path: \"\", //not updated\r\n    pageCount: 0, //not updated\r\n    lastPageIndex: 0, //not updated\r\n    album: {\r\n      title: \"\",\r\n      category: \"Manga\",\r\n      orientation: \"Portrait\",\r\n      artists: [],\r\n      tags: [],\r\n      languages: [],\r\n      flags: [],\r\n      tier: 0,\r\n      cover: \"\",\r\n      isWip: false,\r\n      isRead: false,\r\n      entryDate: null\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(API_URL + \"Crud/GetAlbumVm?id=\" + props.albumId)\r\n      .then(function (response) {\r\n        console.log(\"GetAlbumVm response.data\", response.data);\r\n        setAlbumVm(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handlers = {\r\n    albumVmChange: function (label, value) {\r\n      let newAlbumVm = { ...albumVm };\r\n      let cleanedValue = value;\r\n      if (label === \"Artists\" || label === \"Flags\") {\r\n        cleanedValue = value.split(\",\");\r\n      }\r\n      else if (label === \"Tags\" || label === \"Languages\") {\r\n        cleanedValue = albumVm.album[Helper.firstLetterLowerCase(label)];\r\n        if (cleanedValue.includes(value)) {\r\n          cleanedValue = lodash.pull(cleanedValue, value);\r\n        }\r\n        else {\r\n          cleanedValue.push(value);\r\n        }\r\n      }\r\n      newAlbumVm.album[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n      setAlbumVm(newAlbumVm);\r\n    },\r\n    ok: function () {\r\n      props.onOk(albumVm);\r\n    },\r\n    cancel: function () {\r\n      props.onCancel();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Edit Metadata\"\r\n      visible={props.isOpen}\r\n      onOk={handlers.ok}\r\n      onCancel={handlers.cancel}\r\n    >\r\n      {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n        <>\r\n          <MyInputTextbox label=\"Title\" value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={albumVm.album.flags.join()} onChange={handlers.albumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={albumVm.album.isRead} onChange={handlers.albumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={albumVm.album.isWip} onChange={handlers.albumVmChange} />\r\n        </>\r\n      )}\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyEditModal);","import React, { useState, useEffect, useRef } from 'react';\r\nimport { API_URL } from '../Utilities/Config';\r\n\r\nimport MyAlbumCard from '../Components/Displays/MyAlbumCard';\r\nimport { Row, Col } from 'antd';\r\nimport MyReaderModal from '../Components/Displays/MyReaderModal';\r\n//import * as Helper from '../Utilities/Helper';\r\nimport MyEditModal from '../Components/MyEditModal';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction AlbumList(props) {\r\n  //#region Display Album List\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"scroll effect\");\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let encodedQuery = (props.query !== undefined) ? encodeURIComponent(props.query) : \"\";\r\n\r\n    axios.get(API_URL + \"Crud/GetAlbumCardModels?page=0&row=0&query=\" + encodedQuery)\r\n      .then(function (response) {\r\n        setAlbumCms(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.query]);\r\n  //#endregion\r\n\r\n  //#region Display Album Pages\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n  const [selectedAlbumId, setSelectedAlbumId] = useState({});\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      setSelectedAlbumId(albumCm.albumId);\r\n      setReaderModalIsOpen(true);\r\n    },\r\n\r\n    close: function (albumId, lastPageIndex) {\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(API_URL + \"Crud/UpdateAlbumOuterValue/\", {\r\n        albumId: albumId,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then(function (response) {\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex\r\n        };\r\n      }));\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Edit Delete\r\n  const [editModalIsOpen, setEditModalIsOpen] = useState(false);\r\n  const [editedAlbumId, setEditedAlbumId] = useState(undefined);\r\n\r\n  const crudHandler = {\r\n    edit: function (albumId) {\r\n      console.log(\"edit album\" + albumId);\r\n      setEditModalIsOpen(true);\r\n      setEditedAlbumId(albumId);\r\n    },\r\n    delete: function (albumId) {\r\n      setAlbumCms(albumCms.filter(albumCm => {\r\n        return albumCm.albumId !== albumId;\r\n      }));\r\n    },\r\n    pageDeleteSuccess: (albumId, page) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1,\r\n          lastPageIndex: page\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (albumId, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const editHandler = {\r\n    ok: function (editedAlbumVm) {\r\n      setEditModalIsOpen(false);\r\n\r\n      axios.post(API_URL + \"Crud/UpdateAlbum/\", editedAlbumVm)\r\n        .then(function (response) {\r\n          console.log(\"edit success. Id: \", response.data);\r\n\r\n          let newAlbumCms = [...albumCms];\r\n          debugger;\r\n          let editedAlbumVmIndex = newAlbumCms.findIndex(a => a.albumId === editedAlbumVm.albumId);\r\n          newAlbumCms[editedAlbumVmIndex].fullTitle = `[${editedAlbumVm.album.artists.join(', ')}] ${editedAlbumVm.album.title}`;\r\n          newAlbumCms[editedAlbumVmIndex].languages = editedAlbumVm.album.languages;\r\n          setAlbumCms(newAlbumCms);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    cancel: function () {\r\n      setEditModalIsOpen(false);\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={0} type=\"flex\">\r\n        {albumCms.map((a, index) => (\r\n          <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n            <MyAlbumCard\r\n              index={index}\r\n              albumCm={a}\r\n              onView={readerHandler.view}\r\n              onEdit={crudHandler.edit}\r\n              onDelete={crudHandler.delete}\r\n              showContextMenu={true}\r\n            />\r\n          </Col>\r\n        ))}\r\n      </Row>\r\n\r\n      <MyReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={albumCms.find(aCm => aCm.albumId === selectedAlbumId)}\r\n      />\r\n      <MyEditModal\r\n        isOpen={editModalIsOpen}\r\n        albumId={editedAlbumId}\r\n        onOk={editHandler.ok}\r\n        onCancel={editHandler.cancel}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(AlbumList);","import { API_URL } from '../Utilities/Config';\r\nimport * as Helper from '../Utilities/Helper';\r\n\r\nconst axios = require('axios').default;\r\n\r\nvar albumInfo = null;\r\n\r\n//#region AlbumInfo\r\nexport const GetAlbumInfo = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo;\r\n}\r\n\r\nexport const GetTags = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.tags;\r\n}\r\nexport const GetCategories = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.categories;\r\n}\r\nexport const GetOrientations = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.orientations;\r\n}\r\nexport const GetLanguages = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.languages;\r\n}\r\n\r\nasync function FetchAlbumInfo() {\r\n  console.log(\"FetchAlbumInfo called\");\r\n  const res = await fetch(API_URL + \"Crud/GetAlbumInfo\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region Queries\r\nvar tagVMs = null;\r\nexport const GetTagVMs = async () => {\r\n  if (tagVMs === null) {\r\n    tagVMs = await FetchTagVMs();\r\n  }\r\n  return tagVMs;\r\n}\r\n\r\nasync function FetchTagVMs() {\r\n  const res = await fetch(API_URL + \"Crud/GetTagVMs\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region AlbumViewer\r\nexport const GetAlbumVMs = (page, row, query) => {\r\n  let encodedQuery = (typeof query !== 'undefined') ? encodeURIComponent(query) : \"\";\r\n  let queryString = \"?page=\" + page + \"&row=\" + row + \"&query=\" + encodedQuery;\r\n\r\n  axios.get(API_URL + \"Crud/GetAlbums\" + queryString)\r\n    .then(function (response) {\r\n      return response.data;\r\n    })\r\n    .catch(function (error) {\r\n      Helper.apiErrorHandler(error);\r\n    });\r\n\r\n  // async function FetchAlbums() {\r\n  //   const res = await fetch(API_URL + \"Crud/GetAlbums\" + queryString, {\r\n  //     method: 'GET',\r\n  //     //headers: '',\r\n  //     mode: 'cors',\r\n  //     cache: 'default'\r\n  //   });\r\n  //   return res.json();\r\n  // };\r\n\r\n  // let result = await FetchAlbums();\r\n  // return result;\r\n}\r\n//#endregion\r\n\r\nexport const InsertAlbum = async (albumVm) => {\r\n  const res = await fetch(API_URL + \"Crud/InsertAlbum\", {\r\n    method: 'POST',\r\n    body: JSON.stringify(albumVm),\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    }\r\n  });\r\n  return await res.json();\r\n}","import React from 'react';\r\nimport { Button, Row, Col } from 'antd';\r\n\r\nfunction MyInputButton(props) {\r\n  function handleClick(event) {\r\n    props.onClick(props.label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Button onClick={handleClick}>{props.label}</Button>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputButton;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport MyInputTextbox from '../Components/Editors/MyInputTextbox';\r\nimport { Button, Row, Col, Upload } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport MyInputRadio from '../Components/Editors/MyInputRadio';\r\nimport MyInputMulticheck from '../Components/Editors/MyInputMulticheck';\r\nimport MyInputCheck from '../Components/Editors/MyInputCheck';\r\nimport MyInputStar from '../Components/Editors/MyInputStar';\r\n\r\nimport * as DataSource from \"../Data/DataSource\";\r\nimport * as Helper from \"../Utilities/Helper\";\r\nimport MyInputButton from '../Components/Editors/MyInputButton';\r\n\r\nvar lodash = require('lodash/array');\r\n\r\n\r\nfunction AlbumAddEdit(props) {\r\n  const [FolderName, setFolderName] = useState(\"\");\r\n  const [Files, setFiles] = useState([]);\r\n  const [AlbumVm, setAlbumVm] = useState({\r\n    title: \"\",\r\n    category: \"Manga\",\r\n    orientation: \"Portrait\",\r\n    artists: [],\r\n    tags: [],\r\n    languages: [],\r\n    flags: [],\r\n    tier: 0,\r\n    cover: \"\",\r\n    isWip: false,\r\n    isRead: false,\r\n    entryDate: null\r\n  });\r\n\r\n  const [Tags, setTags] = useState([]);\r\n  const [Categories, setCategories] = useState([]);\r\n  const [Orientations, setOrientations] = useState([]);\r\n  const [Languages, setLanguages] = useState([]);\r\n\r\n  var webkit;\r\n\r\n  useEffect(() => {\r\n    async function FetchAlbumInfo() {\r\n      let _tag = await DataSource.GetTags();\r\n      let _categories = await DataSource.GetCategories();\r\n      let _orientations = await DataSource.GetOrientations();\r\n      let _languages = await DataSource.GetLanguages();\r\n      setTags(_tag);\r\n      setCategories(_categories);\r\n      setOrientations(_orientations);\r\n      setLanguages(_languages);\r\n    }\r\n    FetchAlbumInfo();\r\n\r\n    webkit = document.getElementById(\"myInput\");\r\n    webkit.onchange = function () {\r\n      console.log(webkit);\r\n      setFiles(webkit.files);\r\n      // var files = webkit.files,\r\n      //   len = files.length,\r\n      //   i;\r\n      // for (i = 0; i < len; i += 1) {\r\n      //   //console.log(files[i]);\r\n      // }\r\n    };\r\n  }, []);\r\n\r\n  function handleAlbumVmChange(label, value) {\r\n    let newAlbumVm = { ...AlbumVm };\r\n    let cleanedValue = value;\r\n    if (label === \"Artists\" || label === \"Flags\") {\r\n      cleanedValue = value.split(\",\");\r\n    }\r\n    else if (label === \"Tags\" || label === \"Languages\") {\r\n      cleanedValue = AlbumVm[Helper.firstLetterLowerCase(label)];\r\n      if (cleanedValue.includes(value)) {\r\n        cleanedValue = lodash.pull(cleanedValue, value);\r\n      }\r\n      else {\r\n        cleanedValue.push(value);\r\n      }\r\n    }\r\n    newAlbumVm[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n    setAlbumVm(newAlbumVm);\r\n  }\r\n\r\n  function handleLogAlbum(event) {\r\n    console.log(AlbumVm);\r\n  }\r\n  function handleSubmit(event) {\r\n    console.log(event);\r\n  }\r\n\r\n  function logWebkitFiles() {\r\n    // for (let i = 0; i < Files.length; i++) {\r\n    //   var reader = new FileReader();\r\n    //   reader.onload = function (e) {\r\n    //     var object = new Object();\r\n    //     object.content = e.target.content;\r\n    //     var json_upload = \"jsonObject=\" + JSON.stringify(object);\r\n\r\n    //     console.log(\"what is e\", e);\r\n    //     console.log(\"what is json_u\", json_upload);\r\n    //   }\r\n    //   reader.readAsBinaryString(Files);\r\n    // }\r\n    console.log(Files[0]);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Add edit page</h3>\r\n      <br />\r\n      <Row justify=\"start\" align=\"middle\" gutter={[16, 24]}>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <MyInputTextbox label=\"Title\" value={AlbumVm.title} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={AlbumVm.artists.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={AlbumVm.category} items={Categories} onChange={handleAlbumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={AlbumVm.tier} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={AlbumVm.flags.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={AlbumVm.tags} items={Tags} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={AlbumVm.orientation} items={Orientations} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={AlbumVm.languages} items={Languages} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={AlbumVm.isRead} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={AlbumVm.isWip} onChange={handleAlbumVmChange} />\r\n          <Button onClick={() => logWebkitFiles()}>Log Webkit Files</Button>\r\n          <MyInputButton label=\"Insert Album\" onClick={handleSubmit} />\r\n          {/* <Upload directory>\r\n            <Button>\r\n              <UploadOutlined /> Select Folder\r\n            </Button>\r\n          </Upload> */}\r\n          <input id=\"myInput\" type=\"file\" webkitdirectory=\"true\" directory multiple />\r\n        </Col>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <p>placeholder for image</p>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AlbumAddEdit;","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport MyAlbumCard from '../Components/Displays/MyAlbumCard';\r\nimport { Row, Col } from 'antd';\r\nimport useSWR from 'swr';\r\n//first commit after github username changes\r\n\r\nfunction GenreList(props) {\r\n  const endpoint = props.page === \"Genres\" ? \"Crud/GetGenreCardModels\" :\r\n    props.page === \"Artists\" ? \"Crud/GetArtistCardModels\" :\r\n      \"NotFound\";\r\n\r\n  const { data: albumCGroups, error } = useSWR(endpoint);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!albumCGroups) { return <div>loading...</div>; }\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      console.log(\"query click\", albumCm);\r\n      props.history.push('/albums?query=' + albumCm.albumId)\r\n    },\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {albumCGroups.map((acg, index) => (\r\n        <Row key={\"acgRow\" + acg.name} gutter={0} type=\"flex\" style={{ border: \"1px solid rgb(83, 83, 83)\", borderRadius: \"8px\", paddingTop: \"8px\", marginBottom: \"5px\" }}>\r\n          { props.page === \"This feature is cancelled\" ? (\r\n            <div style={{ position: \"relative\" }}>\r\n              <div style={{ position: \"absolute\", top: \"-18px\", left: \"10px\" }}>{acg.name}</div>\r\n            </div>) : \"\"\r\n          }\r\n          {acg.albumCms.map((a) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={() => { }}\r\n                onDelete={() => { }}\r\n                showContextMenu={false}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default GenreList;","import React, { useState } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport { Row, Col } from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  MinusOutlined\r\n} from '@ant-design/icons';\r\n\r\nfunction MyTagMenuItem(props) {\r\n  let encodedQuery = encodeURIComponent(props.tag.query);\r\n\r\n  const plusBackground = props.selectStatus === \"plus\" ? \"#1890ff\" : \"\";\r\n  const minusBackground = props.selectStatus === \"minus\" ? \"#1890ff\" : \"\";\r\n\r\n  return (\r\n    <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n      <Row>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onPlus(props.tag.name)}><PlusOutlined style={{ marginRight: \"0px\", backgroundColor: plusBackground }} /></Col>\r\n        <Link to={\"/albums?query=\" + encodedQuery} >\r\n          <Col span={14}>\r\n            <span style={{ fontSize: \"12px\" }}>{props.tag.name}</span>\r\n          </Col>\r\n        </Link>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onMinus(props.tag.name)}><MinusOutlined style={{ marginRight: \"0px\", backgroundColor: minusBackground }} /></Col>\r\n      </Row>\r\n    </li>\r\n  );\r\n}\r\n\r\nexport default MyTagMenuItem;","import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Modal, Input, Button } from 'antd';\r\nimport {\r\n  ConsoleSqlOutlined,\r\n  SearchOutlined\r\n} from '@ant-design/icons';\r\nimport TextArea from 'antd/lib/input/TextArea';\r\n\r\nfunction MyQueryEditor(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(props.query);\r\n  }, [props.query]);\r\n\r\n  function handleOk() {\r\n    setVisible(false);\r\n    props.onOk(query);\r\n  }\r\n\r\n  return (\r\n    <div style={{ paddingLeft: \"24px\" }}>\r\n      <Button type=\"link\" onClick={() => setVisible(true)} style={{ width: \"90%\", textAlign: \"left\", padding: \"0px\" }}>\r\n        <ConsoleSqlOutlined />Query Editor\r\n      </Button>\r\n      <Modal\r\n        visible={visible}\r\n        onCancel={() => setVisible(false)}\r\n        closable={false}\r\n        footer={\r\n          <Button type=\"primary\" onClick={handleOk}>\r\n            <SearchOutlined />Search\r\n          </Button>\r\n        }\r\n      >\r\n        <TextArea onChange={(event) => setQuery(event.target.value)} value={query} autoSize={{ minRows: 2, maxRows: 5 }} />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MyQueryEditor;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport queryString from 'query-string';\r\nimport { API_URL } from './Utilities/Config';\r\nimport { DesktopOnly, MobileOnly } from './Utilities/Display';\r\n\r\nimport { Layout, Menu, Drawer, Button, Row, Col, Input } from 'antd';\r\nimport {\r\n  DesktopOutlined,\r\n  TeamOutlined,\r\n  PartitionOutlined,\r\n  TagsOutlined,\r\n  ReloadOutlined,\r\n  SyncOutlined,\r\n  DatabaseOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport AlbumList from './Pages/AlbumList';\r\nimport AlbumAddEdit from './Pages/AlbumAddEdit';\r\nimport GenreList from './Pages/GenreList';\r\nimport MyTagMenuItem from './Components/MyTagMenuItem';\r\n\r\nimport * as Helper from \"./Utilities/Helper\";\r\nimport withMyAlert from \"./HOCs/withMyAlert\";\r\nimport MyQueryEditor from './Components/Editors/MyQueryEditor';\r\n\r\nimport useSWR, { SWRConfig } from 'swr';\r\n\r\nconst axios = require('axios').default;\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\n//const fetcher = (endpoint) => fetch(API_URL + endpoint).then(res => res.json());\r\n\r\nfunction MasterPage(props) {\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n  const [collapseSider, setCollapseSider] = useState(false);\r\n\r\n  let querStr = queryString.parse(props.location.search).query ?? \"\";\r\n\r\n  let page;\r\n  let selectedMenu;\r\n  if (props.page === \"Albums\") {\r\n    page = <AlbumList query={querStr} />;\r\n    selectedMenu = '2';\r\n  }\r\n  else if (props.page === \"AlbumAddEdit\") {\r\n    page = <AlbumAddEdit />;\r\n    selectedMenu = '1';\r\n  }\r\n  else if (props.page === \"Artists\") {\r\n    page = <GenreList page={props.page} history={props.history} />;\r\n    selectedMenu = '3';\r\n  }\r\n  else if (props.page === \"Genres\") {\r\n    page = <GenreList page={props.page} history={props.history} />;\r\n    selectedMenu = '4';\r\n  }\r\n\r\n  const queryHandler = {\r\n    search: function (query) {\r\n      let correctedQuery = Helper.contains(query.split(\",\")[0], [\":\", \"!\", \">\", \"<\"]) ? query : 'title:' + query;\r\n      queryHandler.goToAlbumList(correctedQuery);\r\n    },\r\n    plus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      let currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryPlus);\r\n      let newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    minus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      let currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryMinus);\r\n      let newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    goToAlbumList: function (query) {\r\n      let currentUrlParams = new URLSearchParams(window.location.search);\r\n      currentUrlParams.set('query', query);\r\n      props.history.push(\"Albums?\" + currentUrlParams.toString());\r\n    }\r\n  }\r\n\r\n  const actionHandler = {\r\n    reload: () => {\r\n      axios.get(API_URL + \"Crud/ReloadDatabase\")\r\n        .then((response) => {\r\n          props.popInfo(\"ReloadDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    },\r\n    rescan: () => {\r\n      axios.get(API_URL + \"Crud/RescanDatabase\")\r\n        .then((response) => {\r\n          props.popInfo(\"ReloadDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    }\r\n  }\r\n\r\n  const menuContent = (\r\n    <>\r\n      <div className=\"logo\"></div>\r\n      <MyQueryEditor query={querStr} onOk={(query) => queryHandler.goToAlbumList(query)} />\r\n      <Menu theme=\"dark\" defaultSelectedKeys={[selectedMenu]} defaultOpenKeys={[\"sub1\"]} mode=\"inline\">\r\n        <Menu.Item key=\"2\">\r\n          <Link to=\"/albums\">\r\n            <DesktopOutlined />\r\n            <span>Albums</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"3\">\r\n          <Link to=\"/artists\">\r\n            <TeamOutlined />\r\n            <span>Artists</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"4\">\r\n          <Link to=\"/genres\">\r\n            <PartitionOutlined />\r\n            <span>Genres</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <SubMenu key=\"sub1\" title={<><TagsOutlined /><span>Tags</span></>} >\r\n          <TagItemsContainer onPlus={queryHandler.plus} onMinus={queryHandler.minus} querStr={querStr} />\r\n        </SubMenu>\r\n        <SubMenu key=\"sub2\" title={<><DatabaseOutlined /><span>Actions</span></>} >\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.reload}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><ReloadOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Reload Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.rescan}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><SyncOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Rescan Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n        </SubMenu>\r\n      </Menu>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <SWRConfig value={{ revalidateOnFocus: false, fetcher: (endpoint) => fetch(API_URL + endpoint).then(res => res.json()) }}>\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <MobileOnly>\r\n          <Layout style={{ position: 'fixed', zIndex: 1, width: '100%', backgroundColor: '#001529' }}>\r\n            <div style={{ textAlign: \"end\", lineHeight: 0 }}>\r\n              <div className=\"hamburger-container\" onClick={() => setShowDrawer(true)}>\r\n                <MenuIcon style={{ fontSize: '32px' }} />\r\n              </div>\r\n            </div>\r\n          </Layout>\r\n          <Drawer\r\n            placement=\"right\"\r\n            closable={false}\r\n            onClose={() => setShowDrawer(false)}\r\n            visible={showDrawer}\r\n          >\r\n            {menuContent}\r\n          </Drawer>\r\n        </MobileOnly>\r\n        <DesktopOnly>\r\n          <Sider collapsible collapsed={collapseSider} onCollapse={(event) => setCollapseSider(event)}>\r\n            {menuContent}\r\n          </Sider>\r\n        </DesktopOnly>\r\n\r\n        <Layout className=\"site-layout\">\r\n          <Content>\r\n            <MobileOnly>\r\n              <div style={{ paddingTop: \"5x\" }}>Padding for mobile</div>\r\n            </MobileOnly>\r\n            <div className=\"site-layout-background\" style={{ paddingTop: 36, paddingLeft: 10, paddingRight: 10, minHeight: 360 }}>\r\n              {page}\r\n            </div>\r\n          </Content>\r\n          <Footer style={{ textAlign: 'center' }}>-----------------</Footer>\r\n        </Layout>\r\n      </Layout>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(MasterPage));\r\n\r\nfunction TagItemsContainer(props) {\r\n  const { data: tags, error } = useSWR(\"Crud/GetTagVMs\");\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!tags) { return <div>loading...</div>; }\r\n\r\n  return (\r\n    <>\r\n      {tags.map((tag, index) => (<MyTagMenuItem key={tag.name} tag={tag} onPlus={props.onPlus} onMinus={props.onMinus} selectStatus={getSelectStatus(tag.name, props.querStr)} />))}\r\n    </>\r\n  )\r\n}\r\n\r\nfunction getSelectStatus(tagName, query) {\r\n  let queryArr = query.split(',');\r\n  let result = queryArr.filter((str) => str.toLowerCase().includes(\"tag:\" + tagName.toLowerCase())).length > 0 ? \"plus\" :\r\n    queryArr.filter((str) => str.toLowerCase().includes(\"tag!\" + tagName.toLowerCase())).length > 0 ? \"minus\" :\r\n      \"none\";\r\n\r\n  return result;\r\n}","import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport './App.scss';\r\nimport { BrowserRouter, MemoryRouter, HashRouter, Route, Switch, Link, Redirect } from 'react-router-dom';\r\n\r\nimport MasterPage from './MasterPage';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route exact path=\"/\" ><Redirect to=\"/genres\" /></Route>\r\n          <Route exact path=\"/albums\" ><MasterPage page=\"Albums\" /></Route>\r\n          <Route exact path=\"/add\" ><MasterPage page=\"AlbumAddEdit\" /></Route>\r\n          <Route exact path=\"/artists\" ><MasterPage page=\"Artists\" /></Route>\r\n          <Route exact path=\"/genres\" ><MasterPage page=\"Genres\" /></Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nconst startApp = () => {\r\n  ReactDOM.render(<App isCordova={true} />, document.getElementById('root'));\r\n  serviceWorker.unregister();\r\n}\r\n\r\nif (window.cordova) {\r\n  document.addEventListener('deviceready', startApp, false);\r\n}\r\nelse {\r\n  startApp();\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA"],"sourceRoot":""}