{"version":3,"sources":["Resources/loading.gif","Utilities/Config.js","Utilities/Display.js","Utilities/Helper.js","HOCs/withMyAlert.js","Components/Displays/MyAlbumCard.js","Components/Displays/MyReaderContextMenu.js","Components/Displays/MyChapterDrawer.js","Components/Displays/MyReaderModal.js","Components/Editors/MyInputTextbox.js","Components/Editors/MyInputStar.js","Components/Editors/MyInputRadio.js","Components/Editors/MyInputCheck.js","Components/Editors/MyInputMulticheck.js","Components/MyEditModal.js","Pages/AlbumList.js","Data/DataSource.js","Components/Editors/MyInputButton.js","Pages/AlbumAddEdit.js","Pages/GenreList.js","Components/MyTagMenuItem.js","Components/Editors/MyQueryEditor.js","MasterPage.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","API_URL","DesktopOnly","children","useMediaQuery","minWidth","MobileOnly","maxWidth","firstLetterLowerCase","string","charAt","toLowerCase","slice","getPercent100","value","maxValue","fraction","withMyAlert","OriginalComponent","props","popInfo","title","stringContent","objContent","Modal","info","content","JSON","stringify","onOk","width","popError","error","popApiError","response","status","statusText","data","warning","confirm","axios","require","default","ColorFromIndex","tier","i","bot","FlagIcon","flagStyle","height","marginRight","marginBottom","language","GB","style","JP","CN","ID","handler","view","onView","albumCm","edit","onEdit","albumId","delete","fullTitle","icon","ExclamationCircleOutlined","okText","okType","cancelText","then","console","log","onDelete","catch","onCancel","menu","Item","key","onClick","EditOutlined","DeleteOutlined","useInView","threshold","rootMargin","ref","inView","paddingBottom","position","overlay","trigger","disabled","showContextMenu","textAlign","className","isRead","src","coverInfo","uncPathEncoded","alt","top","left","languages","map","item","writingMode","textOrientation","color","Array","e","fontWeight","lastPageIndex","percent","Helper","pageCount","showInfo","strokeWidth","paddingLeft","paddingRight","fontSize","lineHeight","MyReaderContextMenu","useState","jumpValue","setJumpValue","useEffect","initialValue","setNewPageName","pageName","showRenameModal","setShowRenameModal","showConfirmDelete","setShowConfirmDelete","tierDisplay","setTierDisplay","newPageName","visible","footer","closable","centered","span","count","onChange","onTierChange","type","onRecount","FileSyncOutlined","marginTop","Math","min","max","target","padding","WebkitBoxSizing","borderRadius","onJump","ArrowRightOutlined","onUndoJump","ArrowLeftOutlined","bodyStyle","backgroundColor","border","TextArea","event","rows","onRename","chapters","setChapters","undefined","get","chapterTitle","encodedChapterTitle","encodeURIComponent","onChapterDeleteSuccess","filter","c","placement","onClose","chapter","index","onJumpToPage","pageIndex","objectFit","maxHeight","pageUncPath","getOverlayStyle","isGrey","button","boxSizing","getGuideLabel","text","margin","textShadow","PageDisplay","styleShow","window","innerHeight","innerWidth","styleHide","extension","IsVideo","pageInfo","autoPlay","loop","id","queue","loadingImg","lpi","pages","indexes","cPageI","pPageI","triad","zenpenIndex","chuhenIndex","kouhenIndex","apm","setApm","alert","targetPage","length","pageHandler","jumpTo","document","addEventListener","handleKeyDown2","removeEventListener","keyCode","close","page","renameObj","number","maxIndex","newPPageI","newCPageI","compose","newTriad","pageCeil","modifier","pagesLen","modifiedPages","newPageInfo","rename","newName","post","onPageDeleteSuccess","albumHandler","tierChange","put","recount","setShowContextMenu","showDrawer","setShowDrawer","buttonHandler","rightTop","rightMid","rightBot","midTop","midMid","midBot","leftTop","leftMid","leftBot","swipeHandler","useSwipeable","onSwipedLeft","eventData","onSwipedRight","overlayStyle","buttonStyle","side","minHeight","mid","currentPageInfo","zenpenPage","chuhenPage","kouhenPage","display","isOpen","zIndex","name","bottom","newPageCount","MyInputTextbox","gutter","label","placeholder","MyInputStar","MyInputRadio","Group","items","MyInputCheck","checked","MyInputMulticheck","includes","ghost","lodash","useSWR","albumInfo","aiError","path","album","category","orientation","artists","tags","flags","cover","isWip","entryDate","albumVm","setAlbumVm","handlers","albumVmChange","newAlbumVm","cleanedValue","split","pull","push","ok","cancel","join","categories","orientations","albumCms","setAlbumCms","scrollTo","encodedQuery","query","readerModalIsOpen","setReaderModalIsOpen","selectedAlbumId","setSelectedAlbumId","readerHandler","aIndex","editModalIsOpen","setEditModalIsOpen","editedAlbumId","setEditedAlbumId","crudHandler","pageDeleteSuccess","chapterDeleteSuccess","editHandler","editedAlbumVm","newAlbumCms","editedAlbumVmIndex","findIndex","a","lg","md","xs","find","aCm","GetTags","FetchAlbumInfo","GetCategories","GetOrientations","GetLanguages","fetch","method","res","json","MyInputButton","AlbumAddEdit","webkit","Files","setFiles","AlbumVm","Tags","setTags","Categories","setCategories","Orientations","setOrientations","Languages","setLanguages","handleAlbumVmChange","DataSource","_tag","_categories","_orientations","_languages","getElementById","onchange","files","justify","align","webkitdirectory","directory","multiple","GenreList","endpoint","albumCGroups","history","acg","paddingTop","MyTagMenuItem","tag","plusBackground","selectStatus","minusBackground","role","onPlus","PlusOutlined","to","onMinus","MinusOutlined","MyQueryEditor","setVisible","setQuery","ConsoleSqlOutlined","SearchOutlined","autoSize","minRows","maxRows","Content","Layout","Header","Footer","Sider","SubMenu","Menu","withRouter","selectedMenu","collapseSider","setCollapseSider","querStr","queryString","parse","location","search","queryHandler","correctedQuery","pattern","forEach","word","goToAlbumList","plus","tagName","targetQueryPlus","targetQueryMinus","newQueries","newQueryString","minus","currentUrlParams","URLSearchParams","set","toString","actionHandler","reload","rescan","menuContent","theme","defaultSelectedKeys","defaultOpenKeys","mode","DesktopOutlined","TeamOutlined","PartitionOutlined","TagsOutlined","TagItemsContainer","DatabaseOutlined","ReloadOutlined","SyncOutlined","revalidateOnFocus","fetcher","collapsible","collapsed","onCollapse","getSelectStatus","queryArr","str","App","exact","Boolean","hostname","match","startApp","ReactDOM","render","isCordova","navigator","serviceWorker","ready","registration","unregister","message","cordova"],"mappings":"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","file":"static/js/main.32c10f8a.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/loading.d47e58c7.gif\";","//WARNING can't figure out how to read .env file in production\r\n//require('dotenv').config();\r\n//const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n//const API_URL = \"http://192.168.8.103:5000/\";\r\n//const API_URL = \"http://localhost:57389/\";\r\nconst API_URL = \"https://ratanajaya.com/\";\r\nconst IS_PUBLIC = false;\r\n\r\n//console.log(\"API URL IS \", API_URL);\r\n\r\nexport { API_URL, IS_PUBLIC }","import { useMediaQuery } from 'react-responsive'\r\n\r\nconst DesktopOnly = ({ children }) => {\r\n  const isDesktop = useMediaQuery({ minWidth: 801 })\r\n  return isDesktop ? children : null\r\n}\r\nconst MobileOnly = ({ children }) => {\r\n  const isMobile = useMediaQuery({ maxWidth: 800 })\r\n  return isMobile ? children : null\r\n}\r\n\r\nexport { DesktopOnly, MobileOnly };","\r\nexport function firstLetterLowerCase(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nexport function apiErrorHandler(error) {\r\n  if (typeof error.response !== undefined) {\r\n    alert(JSON.stringify(error.response, null, \"\\t\"))\r\n  }\r\n  else {\r\n    alert(JSON.stringify(error, null, \"\\t\"));\r\n  }\r\n}\r\n\r\nexport function getPercent100(value, maxValue) {\r\n  let fraction = (value / maxValue) * 100;\r\n  let result = fraction <= 100 ? fraction : 100;\r\n  return result;\r\n}\r\n\r\nexport function contains(target, pattern) {\r\n  var value = 0;\r\n  pattern.forEach(function (word) {\r\n    value = value + target.includes(word);\r\n  });\r\n  return (value === 1);\r\n}\r\n\r\nexport function clamp(number, min, max) {\r\n  return Math.max(min, Math.min(number, max));\r\n}","import React from 'react';\r\nimport { Modal } from 'antd';\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  const width = 500;\r\n\r\n  function popInfo(title, stringContent, objContent) {\r\n    Modal.info({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {JSON.stringify(objContent, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popError(title, stringContent, objContent) {\r\n    Modal.error({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {JSON.stringify(objContent, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popApiError(error) {\r\n    if (error.response == null) {\r\n      Modal.error(JSON.stringify(error));\r\n      return;\r\n    }\r\n    const { status, statusText, data } = error.response;\r\n\r\n    const content = {\r\n      title: `${status} - ${statusText}`,\r\n      content: (\r\n        <span>\r\n          {JSON.stringify(data, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    };\r\n\r\n    if (status >= 400 && status < 500) {\r\n      Modal.warning(content);\r\n    }\r\n    else {\r\n      Modal.error(content);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      popInfo={popInfo}\r\n      popError={popError}\r\n      popApiError={popApiError}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;","import React, { useState, useEffect } from 'react';\r\nimport { useInView } from 'react-intersection-observer';\r\nimport { API_URL } from '../../Utilities/Config';\r\nimport { Dropdown, Menu, Modal, Progress } from 'antd';\r\nimport Flags from 'country-flag-icons/react/3x2';\r\nimport { MoreOutlined, DeleteOutlined, EditOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction MyAlbumCard(props) {\r\n  const handler = {\r\n    view: function () {\r\n      props.onView(props.albumCm)\r\n    },\r\n\r\n    edit: function () {\r\n      props.onEdit(props.albumCm.albumId)\r\n    },\r\n\r\n    delete: function () {\r\n      confirm({\r\n        title: `Delete album ${props.albumCm.fullTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          axios.delete(API_URL + \"Crud/DeleteAlbum/\" + props.albumCm.albumId)\r\n            .then(function (response) {\r\n              console.log(\"del success\", response);\r\n              props.onDelete(props.albumCm.albumId);\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  const menu = (\r\n    <Menu>\r\n      <Menu.Item key=\"1\" onClick={handler.edit}><EditOutlined />Edit</Menu.Item>\r\n      <Menu.Item key=\"2\" onClick={handler.delete}><DeleteOutlined />Delete</Menu.Item>\r\n    </Menu>\r\n  );\r\n\r\n  const [ref, inView, entry] = useInView({\r\n    threshold: 0,\r\n    rootMargin: \"300px 0px 300px 0px\"\r\n  });\r\n\r\n  const absoluteH = \"150px\";\r\n  const flagTopMargin = \"134px\";//absoluteH - (0.5 * height of flags container div)\r\n  const tierTopMargin = \"66px\";//absoluteH / 2 - (0.5 * heights of tier container div)\r\n\r\n  return (\r\n    <div ref={ref} style={{ paddingBottom: '8px', position: \"relative\" }}>\r\n      <Dropdown overlay={menu} trigger={['contextMenu']} disabled={!props.showContextMenu}>\r\n        <div style={{ textAlign: \"center\" }}>\r\n          <div style={{ height: absoluteH, width: \"100%\" }}>\r\n            <img\r\n              onClick={handler.view}\r\n              className={\"img-contain \" + (!props.albumCm.isRead ? \"img-highlight\" : \"\")}\r\n              style={{ height: absoluteH, width: \"100%\", maxWidth: absoluteH }}\r\n              src={inView ? API_URL + \"Media/StreamResizedImage?librelPathBase64=\" + props.albumCm.coverInfo.uncPathEncoded + \"&maxSize=150\" : \"\"}\r\n              alt=\"img\"\r\n            >\r\n            </img>\r\n          </div>\r\n          <div\r\n            style={{ position: \"absolute\", top: flagTopMargin, left: \"50%\", width: \"50%\", maxWidth: \"64px\", textAlign: \"right\" }}\r\n            onClick={handler.view}\r\n          >\r\n            {props.albumCm.languages.map((item, i) => <FlagIcon language={item} key={i} />)}\r\n          </div>\r\n          <div style={{ position: \"absolute\", top: tierTopMargin, left: \"50%\", width: \"50%\", maxWidth: \"72px\", height: \"60px\", textAlign: \"right\", writingMode: \"vertical-rl\", textOrientation: \"upright\", color: \"#52c41a\" }}\r\n            onClick={handler.view}\r\n          >\r\n            <span>{[...Array(props.albumCm.tier)].map((e, i) => <span key={i} style={{ fontWeight: \"bold\", color: ColorFromIndex(props.albumCm.tier, i) }}>l</span>)}</span>\r\n          </div>\r\n          <div style={{ position: \"absolute\", top: absoluteH, textAlign: \"center\", width: \"100%\" }} >\r\n            {props.albumCm.lastPageIndex > 0 ? <Progress percent={Helper.getPercent100(props.albumCm.lastPageIndex + 1, props.albumCm.pageCount)} showInfo={false} strokeWidth={2} style={{ paddingLeft: 3, paddingRight: 3, width: \"70%\" }} /> : <></>}\r\n          </div>\r\n          <span style={{ fontSize: '12px', lineHeight: 1.1 }}>\r\n            {props.albumCm.fullTitle}\r\n          </span>\r\n        </div>\r\n      </Dropdown>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ColorFromIndex(tier, i) {\r\n  const top = \"#22c1c3\";\r\n  const mid = \"#8ebe79\";\r\n  const bot = \"#fdbb2d\";\r\n\r\n  const color =\r\n    tier === 1 ? bot :\r\n      tier === 2 ? i === 0 ? mid : bot :\r\n        tier === 3 ? i === 0 ? top : i === 1 ? mid : bot :\r\n          \"black\";\r\n\r\n  return color;\r\n}\r\n\r\nfunction FlagIcon(props) {\r\n  const flagStyle = { width: \"18px\", height: \"12px\", marginRight: \"2px\", marginBottom: \"2px\" };\r\n\r\n  return (\r\n    <>\r\n      {\r\n        props.language === \"English\" ? <Flags.GB style={flagStyle} /> :\r\n          props.language === \"Japanese\" ? <Flags.JP style={flagStyle} /> :\r\n            props.language === \"Chinese\" ? <Flags.CN style={flagStyle} /> :\r\n              <Flags.ID style={flagStyle} />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyAlbumCard);","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Modal, Button, Menu, Input, Rate } from 'antd';\r\nimport { API_URL } from '../../Utilities/Config';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport { ArrowLeftOutlined, ArrowRightOutlined, DeleteOutlined, EditOutlined, ExclamationCircleOutlined, LineOutlined, FileSyncOutlined } from '@ant-design/icons';\r\n\r\n//import './MyReaderModal.scss';\r\n\r\nfunction MyReaderContextMenu(props) {\r\n  const [jumpValue, setJumpValue] = useState(0);\r\n  useEffect(() => {\r\n    setJumpValue(props.initialValue + 1);\r\n  }, [props.initialValue]);\r\n\r\n  useEffect(() => {\r\n    setNewPageName(props.pageName);\r\n  }, [props.pageName]);\r\n\r\n  const [showRenameModal, setShowRenameModal] = useState(false);\r\n  const [showConfirmDelete, setShowConfirmDelete] = useState(false);\r\n\r\n  const [tierDisplay, setTierDisplay] = useState(0);\r\n  useEffect(() => {\r\n    setTierDisplay(props.albumCm.tier);\r\n  }, [props.albumCm]);\r\n\r\n  const [newPageName, setNewPageName] = useState(\"\");\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={props.visible}\r\n        onCancel={props.onCancel}\r\n        footer={null}\r\n        closable={false}\r\n        centered={true}\r\n        style={{ maxWidth: 300 }}\r\n      //bodyStyle={{ border: \"1px solid black\" }}\r\n      >\r\n        <Row>\r\n          <Col span={24} style={{ marginBottom: 15, textAlign: \"center\" }}>\r\n            <Rate\r\n              count={3}\r\n              value={tierDisplay}\r\n              onChange={(value) => { setTierDisplay(value); props.onTierChange(value); }}\r\n              style={{ fontSize: \"40px\" }}\r\n            />\r\n          </Col>\r\n          <Col span={24}>\r\n            <Button type=\"primary\" onClick={() => props.onRecount()} style={{ width: \"100%\" }}>\r\n              <FileSyncOutlined />Recount Pages\r\n            </Button>\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <input type=\"number\" value={jumpValue} onChange={(e) => setJumpValue(Math.min(Math.max(e.target.value, 1), props.albumCm.pageCount))} style={{ width: \"97%\", padding: \"4px\", WebkitBoxSizing: \"border-box\", borderRadius: \"5px\" }} />\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"right\", marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onJump(jumpValue - 1)} style={{ width: \"97%\", color: \"white\" }}>\r\n              <ArrowRightOutlined />Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onUndoJump()} style={{ width: \"100%\" }}>\r\n              <ArrowLeftOutlined />Undo Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => { props.onCancel(); setShowRenameModal(true); }} style={{ width: \"100%\" }}>\r\n              <EditOutlined />Rename Page\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"danger\" onClick={() => { props.onCancel(); setShowConfirmDelete(true); }} style={{ width: \"100%\" }}>\r\n              <DeleteOutlined />Delete Page\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Modal>\r\n      <Modal\r\n        visible={showRenameModal}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowRenameModal(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <Input.TextArea value={newPageName} onChange={(event) => setNewPageName(event.target.value)} rows={2} />\r\n        <Button type=\"primary\" onClick={() => { setShowRenameModal(false); props.onRename(newPageName); }} style={{ width: \"100%\" }}>\r\n          Rename\r\n        </Button>\r\n      </Modal>\r\n      <Modal\r\n        visible={showConfirmDelete}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowConfirmDelete(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <span style={{ color: \"white\" }}>Are you sure to delete this page?</span>\r\n        <Button type=\"danger\" onClick={() => { setShowConfirmDelete(false); props.onDelete(); }} style={{ width: \"100%\" }}>\r\n          Delete\r\n        </Button>\r\n      </Modal>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MyReaderContextMenu;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Drawer, Modal, Button, Menu, Input, Dropdown } from 'antd';\r\nimport {\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { API_URL } from '../../Utilities/Config';\r\n//import * as Helper from '../../Utilities/Helper';\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction MyChapterDrawer(props) {\r\n  const [chapters, setChapters] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(API_URL + `Crud/GetAlbumChapters?id=${props.albumId}`)\r\n      .then(function (response) {\r\n        setChapters(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handler = {\r\n    rename: (chapterTitle) => {\r\n      console.log(\"rename \", chapterTitle);\r\n    },\r\n    delete: (chapterTitle) => {\r\n      console.log(\"delete \", chapterTitle);\r\n      confirm({\r\n        title: `Delete chapter ${chapterTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   Yes   ',\r\n        okType: 'danger',\r\n        cancelText: '   No   ',\r\n        onOk() {\r\n          let encodedChapterTitle = encodeURIComponent(chapterTitle);\r\n          axios.delete(API_URL + `Crud/DeleteAlbumChapter/${props.albumId}/${encodedChapterTitle}`)\r\n            .then(function (response) {\r\n              console.log(\"newPageCount\", response.data);\r\n              props.onChapterDeleteSuccess(response.data);\r\n              setChapters(\r\n                chapters.filter(c => c.title !== chapterTitle)\r\n              );\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      placement=\"left\"\r\n      closable={false}\r\n      onClose={props.onClose}\r\n      visible={props.visible}\r\n    >\r\n      <div style={{ padding: \"10px\" }}>\r\n        {chapters.map((chapter, index) => (\r\n          <Row style={{ marginBottom: \"5px\" }} key={chapter.title}>\r\n            <Dropdown overlay={\r\n              <Menu>\r\n                <Menu.Item key=\"1\" onClick={() => handler.rename(chapter.title)}><EditOutlined />Rename</Menu.Item>\r\n                <Menu.Item key=\"2\" onClick={() => handler.delete(chapter.title)}><DeleteOutlined />Delete</Menu.Item>\r\n              </Menu>}\r\n              trigger={['contextMenu']}\r\n            >\r\n              <Col span={10} onClick={() => props.onJumpToPage(chapter.pageIndex)}>\r\n                <img\r\n                  style={{ objectFit: \"contain\", width: \"100%\", maxHeight: \"128px\", border: \"1px solid white\" }}\r\n                  src={API_URL + \"Media/StreamResizedImage?librelPathBase64=\" + chapter.pageUncPath + \"&maxSize=128\"}\r\n                  alt=\"img\"\r\n                >\r\n                </img>\r\n              </Col>\r\n            </Dropdown>\r\n            <Col span={14}>\r\n              <span style={{ color: \"white\" }}>{chapter.title}</span>\r\n            </Col>\r\n          </Row>\r\n        ))};\r\n      </div>\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyChapterDrawer);","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Drawer, Modal, Button, Menu, Input } from 'antd';\r\nimport { API_URL, IS_PUBLIC } from '../../Utilities/Config';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport { ArrowRightOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport MyReaderContextMenu from './MyReaderContextMenu';\r\nimport MyChapterDrawer from './MyChapterDrawer';\r\nimport loadingImg from '../../Resources/loading.gif';\r\n\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\nimport { useSwipeable } from 'react-swipeable';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction MyReaderModal(props) {\r\n  console.log(\"MyReaderModal render\");\r\n\r\n  const [apm, setApm] = useState({ //apm = album pagination model\r\n    id: null,\r\n    lpi: 0,\r\n    pages: [],\r\n    indexes: {\r\n      cPageI: 0,\r\n      pPageI: 0,\r\n      triad: \"zenpen\",\r\n      zenpenIndex: 0,\r\n      chuhenIndex: 0,\r\n      kouhenIndex: 0,\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    if (props.albumCm.albumId === apm.id) { return; }\r\n\r\n    axios.get(API_URL + \"File/GetAlbumPageInfos?id=\" + props.albumCm.albumId)\r\n      .then(function (response) {\r\n        setApm({\r\n          id: props.albumCm.albumId,\r\n          lpi: props.albumCm.lastPageIndex,\r\n          pages: response.data,\r\n          indexes: null\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        alert('GetAlbumPageInfos ' + error);\r\n      });\r\n  }, [props.albumCm]);\r\n\r\n  useEffect(() => {\r\n    let targetPage = apm.lpi < apm.pages.length ? apm.lpi : apm.pages.length - 1;\r\n\r\n    pageHandler.jumpTo(targetPage);\r\n  }, [apm.id]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"keydown\", handleKeyDown2, false);\r\n\r\n    return () => { //component will unmount\r\n      document.removeEventListener(\"keydown\", handleKeyDown2, false);\r\n    };\r\n  }, []);\r\n\r\n  const handleKeyDown2 = (event) => {\r\n    if (event.keyCode === 27) {\r\n      pageHandler.close();\r\n    }\r\n  };\r\n\r\n  //#region Event handlers\r\n  const pageHandler = {\r\n    jumpTo: function (page, renameObj) {\r\n      const maxIndex = apm.pages.length - 1;\r\n      const newPPageI = apm.indexes?.cPageI ?? 0;\r\n      const newCPageI = Helper.clamp(page, 0, maxIndex);\r\n\r\n      const { newTriad, zenpenIndex, chuhenIndex, kouhenIndex } = (() => {\r\n        function compose(newTriad, zenpenIndex, chuhenIndex, kouhenIndex) {\r\n          return {\r\n            newTriad,\r\n            zenpenIndex,\r\n            chuhenIndex,\r\n            kouhenIndex\r\n          };\r\n        }\r\n\r\n        function pageCeil(modifier) {\r\n          const pagesLen = apm.pages.length;\r\n          return (((newCPageI + modifier) % pagesLen) + pagesLen) % pagesLen;\r\n        }\r\n\r\n        if (newCPageI % 3 === 0) {\r\n          return compose(\"zenpen\", newCPageI, pageCeil(1), pageCeil(-1));\r\n        }\r\n        if (newCPageI % 3 === 1) {\r\n          return compose(\"chuhen\", pageCeil(-1), newCPageI, pageCeil(1));\r\n        }\r\n        if (newCPageI % 3 === 2) {\r\n          return compose(\"kouhen\", pageCeil(1), pageCeil(-1), newCPageI);\r\n        }\r\n      })();\r\n\r\n      let modifiedPages = apm.pages;\r\n      if (renameObj !== null && renameObj !== undefined) {\r\n        modifiedPages[renameObj.index] = renameObj.newPageInfo;\r\n      }\r\n\r\n      setApm({\r\n        indexes: {\r\n          cPageI: newCPageI,\r\n          pPageI: newPPageI,\r\n          triad: newTriad,\r\n          zenpenIndex: zenpenIndex,\r\n          chuhenIndex: chuhenIndex,\r\n          kouhenIndex: kouhenIndex\r\n        },\r\n        id: apm.id,\r\n        lpi: apm.lpi,\r\n        pages: modifiedPages,\r\n      });\r\n    },\r\n    rename: (page, newName) => {\r\n      console.log(`rename page ${page} with name ${newName}`);\r\n      axios.post(API_URL + \"File/RenameFile\", {\r\n        albumId: apm.id,\r\n        pageIndex: page,\r\n        newName: newName\r\n      })\r\n        .then(function (response) {\r\n          const renameObj = {\r\n            index: page,\r\n            newPageInfo: response.data\r\n          };\r\n          console.log(renameObj);\r\n          pageHandler.jumpTo(apm.indexes.cPageI - 1, renameObj);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    delete: (page) => {\r\n      axios.delete(API_URL + `File/DeleteFile/${apm.id}/${page}`)\r\n        .then(function (response) {\r\n          props.onPageDeleteSuccess(apm.id, page);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    close: () => {\r\n      props.onClose(apm.id, apm.indexes.cPageI);\r\n    }\r\n  }\r\n\r\n  const albumHandler = {\r\n    tierChange: (value) => {\r\n      axios.put(API_URL + \"Crud/UpdateAlbumTier\", {\r\n        albumId: apm.id,\r\n        tier: value\r\n      })\r\n        .then(function (response) {\r\n          console.log(response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    recount: () => {\r\n      axios.post(API_URL + \"Crud/RecountAlbumPages\", {\r\n        albumId: apm.id\r\n      })\r\n        .then(function (response) {\r\n          console.log(\"new page count\", response.data);\r\n          props.onChapterDeleteSuccess(apm.id, response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const [showContextMenu, setShowContextMenu] = useState(false);\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n\r\n  const buttonHandler = {\r\n    rightTop: () => {\r\n      pageHandler.close();\r\n    },\r\n    rightMid: () => {\r\n      pageHandler.jumpTo(apm.indexes.cPageI + 1);\r\n    },\r\n    rightBot: () => {\r\n      pageHandler.jumpTo(apm.pages.length - 1);\r\n    },\r\n    midTop: () => {\r\n\r\n    },\r\n    midMid: () => {\r\n      setShowContextMenu(true);\r\n    },\r\n    midBot: () => {\r\n\r\n    },\r\n    leftTop: () => {\r\n      setShowDrawer(true);\r\n    },\r\n    leftMid: () => {\r\n      pageHandler.jumpTo(apm.indexes.cPageI - 1);\r\n    },\r\n    leftBot: () => {\r\n      pageHandler.jumpTo(0);\r\n    }\r\n  }\r\n\r\n  const swipeHandler = useSwipeable({\r\n    onSwipedLeft: (eventData) => { pageHandler.jumpTo(apm.indexes.cPageI + 1); },\r\n    onSwipedRight: (eventData) => { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n  });\r\n\r\n  //#endregion\r\n  const showGuide = IS_PUBLIC && apm.indexes.cPageI === 0;\r\n  const overlayStyle = getOverlayStyle(showGuide);\r\n  const buttonStyle = {\r\n    side: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.25 * window.innerHeight\r\n    },\r\n    mid: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.5 * window.innerHeight\r\n    }\r\n  }\r\n\r\n  debugger;\r\n  if (apm.indexes === null || apm.pages.length === 0) { return (<>This album has no pages</>); }\r\n\r\n  const currentPageInfo = apm.indexes.triad === \"zenpen\" ? apm.pages[apm.indexes.zenpenIndex]\r\n    : apm.indexes.triad === \"chuhen\" ? apm.pages[apm.indexes.chuhenIndex]\r\n      : apm.indexes.triad === \"kouhen\" ? apm.pages[apm.indexes.kouhenIndex]\r\n        : null;\r\n\r\n  const zenpenPage = <PageDisplay\r\n    id=\"zenpen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.zenpenIndex]}\r\n    queue={apm.indexes.triad === \"zenpen\" ? \"q0\" : apm.indexes.triad === \"kouhen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  const chuhenPage = <PageDisplay\r\n    id=\"chuhen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.chuhenIndex]}\r\n    queue={apm.indexes.triad === \"chuhen\" ? \"q0\" : apm.indexes.triad === \"zenpen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  const kouhenPage = <PageDisplay\r\n    id=\"kouhen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.kouhenIndex]}\r\n    queue={apm.indexes.triad === \"kouhen\" ? \"q0\" : apm.indexes.triad === \"chuhen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"overlay overlay-reader\" style={{ display: props.isOpen ? \"block\" : \"none\", zIndex: 1 }}>\r\n        <div className=\"overlay-content\">\r\n          {zenpenPage}\r\n          {chuhenPage}\r\n          {kouhenPage}\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 2 }}>\r\n          <div className=\"overlay-content\">\r\n            <span className=\"with-shadow\">{currentPageInfo.name}</span>\r\n            <div style={{ position: \"fixed\", bottom: \"0px\", width: \"100%\", textAlign: \"center\" }}>\r\n              <span className=\"with-shadow\">{apm.indexes.cPageI + 1}/{apm.pages.length}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 3 }}>\r\n          <div style={overlayStyle.content} {...swipeHandler}>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Browse Chapters\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midTop} style={buttonStyle.side}>\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Close Album\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Previous Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Context Menu\")}\r\n                </div>\r\n                <MyReaderContextMenu\r\n                  albumCm={props.albumCm}\r\n                  initialValue={apm.indexes.cPageI}\r\n                  pageName={currentPageInfo.name}\r\n                  onTierChange={albumHandler.tierChange}\r\n                  onRecount={() => { albumHandler.recount(); setShowContextMenu(false); }}\r\n                  onJump={(page) => { pageHandler.jumpTo(page); setShowContextMenu(false); }}\r\n                  onUndoJump={() => { pageHandler.jumpTo(apm.indexes.pPageI); setShowContextMenu(false); }}\r\n                  visible={showContextMenu}\r\n                  onRename={(value) => { pageHandler.rename(apm.indexes.cPageI, value); setShowContextMenu(false); }}\r\n                  onDelete={() => { pageHandler.delete(apm.indexes.cPageI); setShowContextMenu(false); }}\r\n                  onCancel={() => setShowContextMenu(false)}\r\n                />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Next Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"First Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midBot} style={buttonStyle.side} />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Last Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <MyChapterDrawer\r\n        visible={showDrawer}\r\n        onClose={() => setShowDrawer(false)}\r\n        albumId={apm.id}\r\n        onJumpToPage={pageHandler.jumpTo}\r\n        onChapterDeleteSuccess={(newPageCount) => props.onChapterDeleteSuccess(apm.id, newPageCount)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst getOverlayStyle = (isGrey) => {\r\n  const result = {\r\n    content: {\r\n      position: 'relative',\r\n      top: '0%',\r\n      width: '100%',\r\n      textAlign: 'center',\r\n      backgroundColor: isGrey ? 'rgba(200, 200, 200, 0.3)' : 'rgba(0, 0, 0, 0)'\r\n    },\r\n    button: {\r\n      position: 'relative',\r\n      boxSizing: 'border-box',\r\n      border: isGrey ? '1px solid black' : '0px'\r\n    }\r\n  };\r\n\r\n  return result;\r\n}\r\n\r\nconst getGuideLabel = (isGrey, text) => {\r\n  return isGrey ?\r\n    <span style={{ textAlign: \"center\", margin: \"auto\", textShadow: \"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black\" }}>\r\n      {text}\r\n    </span> :\r\n    \"\";\r\n}\r\n\r\nfunction PageDisplay(props) {\r\n  const styleShow = { height: window.innerHeight, width: window.innerWidth };\r\n  const styleHide = { height: 0, width: 0, position: \"absolute\" };\r\n  //const styleShow = { height: 300, width: 300 };\r\n  //const styleHide = { height: 150, width: 150 };\r\n\r\n  if (IsVideo(props.pageInfo.extension)) {\r\n    return (\r\n      <video\r\n        autoPlay loop\r\n        id={props.id}\r\n        className=\"img-contain\"\r\n        style={props.queue === \"q0\" ? styleShow : styleHide}\r\n        src={props.queue === \"q0\" ? API_URL + \"Media/StreamPage?albumId=\" + props.albumId + \"&alRelPathBase64=\" + props.pageInfo.uncPathEncoded : \"\"}\r\n      >\r\n        video not showing\r\n      </video>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <img\r\n      id={props.id}\r\n      className=\"img-contain\"\r\n      style={props.queue === \"q0\" ? styleShow : styleHide}\r\n      src={props.queue === \"q0\" || props.queue === \"q1\" ? API_URL + \"Media/StreamPage?albumId=\" + props.albumId + \"&alRelPathBase64=\" + props.pageInfo.uncPathEncoded : loadingImg}\r\n      alt=\"Not loaded\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction IsVideo(extension) {\r\n  if (extension === \".webm\" || extension === \".mp4\") {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default withMyAlert(MyReaderModal);","import React from 'react';\r\nimport { Input } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputTextbox(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Input\r\n            placeholder={props.placeholder}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputTextbox;","import React from 'react';\r\nimport { Rate } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputStar(props) {\r\n  function handleChange(value) {\r\n    props.onChange(props.label, value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Rate\r\n            count={3}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputStar;","import React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputRadio(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Radio.Group onChange={handleChange} value={props.value} style={{ width: \"100%\" }}>\r\n            <Row>\r\n              {props.items.map(item => (\r\n                <Col span={8} key={item}>\r\n                  <Radio key={item} value={item}><span style={{ color: \"white\" }}>{item}</span></Radio>\r\n                </Col>\r\n              ))}\r\n            </Row>\r\n          </Radio.Group>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputRadio;","import React from 'react';\r\nimport { Checkbox } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputCheck(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.checked);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Checkbox onChange={handleChange} checked={props.value} />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputCheck;","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputMulticheck(props) {\r\n\r\n  function handleClick(label) {\r\n    props.onChange(props.label, label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Row gutter={2}>\r\n            {props.items.map((item) => (\r\n              <Col span={8} key={item}>\r\n                <Button\r\n                  key={item}\r\n                  type={props.value.includes(item) ? \"primary\" : \"link\"}\r\n                  ghost={props.value.includes(item) ? true : false}\r\n                  onClick={() => handleClick(item)}\r\n                  style={{ width: \"100%\", textAlign: \"left\", marginBottom: \"2px\" }}\r\n                >\r\n                  {item}\r\n                </Button>\r\n              </Col>)\r\n            )}\r\n          </Row>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputMulticheck;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Modal, Button } from 'antd';\r\nimport { API_URL } from '../Utilities/Config';\r\nimport * as Helper from '../Utilities/Helper';\r\nimport MyInputTextbox from './Editors/MyInputTextbox';\r\nimport MyInputStar from './Editors/MyInputStar';\r\nimport MyInputRadio from './Editors/MyInputRadio';\r\nimport MyInputCheck from './Editors/MyInputCheck';\r\nimport MyInputMulticheck from './Editors/MyInputMulticheck';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\n\r\nimport useSWR from 'swr';\r\n\r\n//import * as DataSource from \"../Data/DataSource\";\r\n\r\nconst lodash = require('lodash/array');\r\nconst axios = require('axios').default;\r\n\r\nfunction MyEditModal(props) {\r\n  const { data: albumInfo, error: aiError } = useSWR(\"Crud/GetAlbumInfo\");\r\n\r\n  const [albumVm, setAlbumVm] = useState({\r\n    albumId: \"\",\r\n    path: \"\", //not updated\r\n    pageCount: 0, //not updated\r\n    lastPageIndex: 0, //not updated\r\n    album: {\r\n      title: \"\",\r\n      category: \"Manga\",\r\n      orientation: \"Portrait\",\r\n      artists: [],\r\n      tags: [],\r\n      languages: [],\r\n      flags: [],\r\n      tier: 0,\r\n      cover: \"\",\r\n      isWip: false,\r\n      isRead: false,\r\n      entryDate: null\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(API_URL + \"Crud/GetAlbumVm?id=\" + props.albumId)\r\n      .then(function (response) {\r\n        console.log(\"GetAlbumVm response.data\", response.data);\r\n        setAlbumVm(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handlers = {\r\n    albumVmChange: function (label, value) {\r\n      let newAlbumVm = { ...albumVm };\r\n      let cleanedValue = value;\r\n      if (label === \"Artists\" || label === \"Flags\") {\r\n        cleanedValue = value.split(\",\");\r\n      }\r\n      else if (label === \"Tags\" || label === \"Languages\") {\r\n        cleanedValue = albumVm.album[Helper.firstLetterLowerCase(label)];\r\n        if (cleanedValue.includes(value)) {\r\n          cleanedValue = lodash.pull(cleanedValue, value);\r\n        }\r\n        else {\r\n          cleanedValue.push(value);\r\n        }\r\n      }\r\n      newAlbumVm.album[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n      setAlbumVm(newAlbumVm);\r\n    },\r\n    ok: function () {\r\n      props.onOk(albumVm);\r\n    },\r\n    cancel: function () {\r\n      props.onCancel();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Edit Metadata\"\r\n      visible={props.isOpen}\r\n      onOk={handlers.ok}\r\n      onCancel={handlers.cancel}\r\n    >\r\n      {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n        <>\r\n          <MyInputTextbox label=\"Title\" value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={albumVm.album.flags.join()} onChange={handlers.albumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={albumVm.album.isRead} onChange={handlers.albumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={albumVm.album.isWip} onChange={handlers.albumVmChange} />\r\n        </>\r\n      )}\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyEditModal);","import React, { useState, useEffect, useRef } from 'react';\r\nimport { API_URL } from '../Utilities/Config';\r\n\r\nimport MyAlbumCard from '../Components/Displays/MyAlbumCard';\r\nimport { Row, Col } from 'antd';\r\nimport MyReaderModal from '../Components/Displays/MyReaderModal';\r\n//import * as Helper from '../Utilities/Helper';\r\nimport MyEditModal from '../Components/MyEditModal';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction AlbumList(props) {\r\n  //#region Display Album List\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"scroll effect\");\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let encodedQuery = (props.query !== undefined) ? encodeURIComponent(props.query) : \"\";\r\n\r\n    axios.get(API_URL + \"Crud/GetAlbumCardModels?page=0&row=0&query=\" + encodedQuery)\r\n      .then(function (response) {\r\n        setAlbumCms(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.query]);\r\n  //#endregion\r\n\r\n  //#region Display Album Pages\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n  const [selectedAlbumId, setSelectedAlbumId] = useState({});\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      setSelectedAlbumId(albumCm.albumId);\r\n      setReaderModalIsOpen(true);\r\n    },\r\n\r\n    close: function (albumId, lastPageIndex) {\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(API_URL + \"Crud/UpdateAlbumOuterValue/\", {\r\n        albumId: albumId,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then(function (response) {\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex,\r\n          isRead: true\r\n        };\r\n      }));\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Edit Delete\r\n  const [editModalIsOpen, setEditModalIsOpen] = useState(false);\r\n  const [editedAlbumId, setEditedAlbumId] = useState(undefined);\r\n\r\n  const crudHandler = {\r\n    edit: function (albumId) {\r\n      console.log(\"edit album\" + albumId);\r\n      setEditModalIsOpen(true);\r\n      setEditedAlbumId(albumId);\r\n    },\r\n    delete: function (albumId) {\r\n      setAlbumCms(albumCms.filter(albumCm => {\r\n        return albumCm.albumId !== albumId;\r\n      }));\r\n    },\r\n    pageDeleteSuccess: (albumId, page) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1,\r\n          lastPageIndex: page\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (albumId, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const editHandler = {\r\n    ok: function (editedAlbumVm) {\r\n      setEditModalIsOpen(false);\r\n\r\n      axios.post(API_URL + \"Crud/UpdateAlbum/\", editedAlbumVm)\r\n        .then(function (response) {\r\n          console.log(\"edit success. Id: \", response.data);\r\n\r\n          let newAlbumCms = [...albumCms];\r\n          let editedAlbumVmIndex = newAlbumCms.findIndex(a => a.albumId === editedAlbumVm.albumId);\r\n          newAlbumCms[editedAlbumVmIndex].fullTitle = `[${editedAlbumVm.album.artists.join(', ')}] ${editedAlbumVm.album.title}`;\r\n          newAlbumCms[editedAlbumVmIndex].languages = editedAlbumVm.album.languages;\r\n          setAlbumCms(newAlbumCms);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    cancel: function () {\r\n      setEditModalIsOpen(false);\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={0} type=\"flex\">\r\n        {albumCms.map((a, index) => (\r\n          <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n            <MyAlbumCard\r\n              index={index}\r\n              albumCm={a}\r\n              onView={readerHandler.view}\r\n              onEdit={crudHandler.edit}\r\n              onDelete={crudHandler.delete}\r\n              showContextMenu={true}\r\n            />\r\n          </Col>\r\n        ))}\r\n      </Row>\r\n\r\n      <MyReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={albumCms.find(aCm => aCm.albumId === selectedAlbumId)}\r\n      />\r\n      <MyEditModal\r\n        isOpen={editModalIsOpen}\r\n        albumId={editedAlbumId}\r\n        onOk={editHandler.ok}\r\n        onCancel={editHandler.cancel}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(AlbumList);","import { API_URL } from '../Utilities/Config';\r\nimport * as Helper from '../Utilities/Helper';\r\n\r\nconst axios = require('axios').default;\r\n\r\nvar albumInfo = null;\r\n\r\n//#region AlbumInfo\r\nexport const GetAlbumInfo = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo;\r\n}\r\n\r\nexport const GetTags = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.tags;\r\n}\r\nexport const GetCategories = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.categories;\r\n}\r\nexport const GetOrientations = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.orientations;\r\n}\r\nexport const GetLanguages = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.languages;\r\n}\r\n\r\nasync function FetchAlbumInfo() {\r\n  console.log(\"FetchAlbumInfo called\");\r\n  const res = await fetch(API_URL + \"Crud/GetAlbumInfo\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region Queries\r\nvar tagVMs = null;\r\nexport const GetTagVMs = async () => {\r\n  if (tagVMs === null) {\r\n    tagVMs = await FetchTagVMs();\r\n  }\r\n  return tagVMs;\r\n}\r\n\r\nasync function FetchTagVMs() {\r\n  const res = await fetch(API_URL + \"Crud/GetTagVMs\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region AlbumViewer\r\nexport const GetAlbumVMs = (page, row, query) => {\r\n  let encodedQuery = (typeof query !== 'undefined') ? encodeURIComponent(query) : \"\";\r\n  let queryString = \"?page=\" + page + \"&row=\" + row + \"&query=\" + encodedQuery;\r\n\r\n  axios.get(API_URL + \"Crud/GetAlbums\" + queryString)\r\n    .then(function (response) {\r\n      return response.data;\r\n    })\r\n    .catch(function (error) {\r\n      Helper.apiErrorHandler(error);\r\n    });\r\n\r\n  // async function FetchAlbums() {\r\n  //   const res = await fetch(API_URL + \"Crud/GetAlbums\" + queryString, {\r\n  //     method: 'GET',\r\n  //     //headers: '',\r\n  //     mode: 'cors',\r\n  //     cache: 'default'\r\n  //   });\r\n  //   return res.json();\r\n  // };\r\n\r\n  // let result = await FetchAlbums();\r\n  // return result;\r\n}\r\n//#endregion\r\n\r\nexport const InsertAlbum = async (albumVm) => {\r\n  const res = await fetch(API_URL + \"Crud/InsertAlbum\", {\r\n    method: 'POST',\r\n    body: JSON.stringify(albumVm),\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    }\r\n  });\r\n  return await res.json();\r\n}","import React from 'react';\r\nimport { Button, Row, Col } from 'antd';\r\n\r\nfunction MyInputButton(props) {\r\n  function handleClick(event) {\r\n    props.onClick(props.label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Button onClick={handleClick}>{props.label}</Button>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputButton;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport MyInputTextbox from '../Components/Editors/MyInputTextbox';\r\nimport { Button, Row, Col, Upload } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport MyInputRadio from '../Components/Editors/MyInputRadio';\r\nimport MyInputMulticheck from '../Components/Editors/MyInputMulticheck';\r\nimport MyInputCheck from '../Components/Editors/MyInputCheck';\r\nimport MyInputStar from '../Components/Editors/MyInputStar';\r\n\r\nimport * as DataSource from \"../Data/DataSource\";\r\nimport * as Helper from \"../Utilities/Helper\";\r\nimport MyInputButton from '../Components/Editors/MyInputButton';\r\n\r\nvar lodash = require('lodash/array');\r\n\r\n\r\nfunction AlbumAddEdit(props) {\r\n  const [FolderName, setFolderName] = useState(\"\");\r\n  const [Files, setFiles] = useState([]);\r\n  const [AlbumVm, setAlbumVm] = useState({\r\n    title: \"\",\r\n    category: \"Manga\",\r\n    orientation: \"Portrait\",\r\n    artists: [],\r\n    tags: [],\r\n    languages: [],\r\n    flags: [],\r\n    tier: 0,\r\n    cover: \"\",\r\n    isWip: false,\r\n    isRead: false,\r\n    entryDate: null\r\n  });\r\n\r\n  const [Tags, setTags] = useState([]);\r\n  const [Categories, setCategories] = useState([]);\r\n  const [Orientations, setOrientations] = useState([]);\r\n  const [Languages, setLanguages] = useState([]);\r\n\r\n  var webkit;\r\n\r\n  useEffect(() => {\r\n    async function FetchAlbumInfo() {\r\n      let _tag = await DataSource.GetTags();\r\n      let _categories = await DataSource.GetCategories();\r\n      let _orientations = await DataSource.GetOrientations();\r\n      let _languages = await DataSource.GetLanguages();\r\n      setTags(_tag);\r\n      setCategories(_categories);\r\n      setOrientations(_orientations);\r\n      setLanguages(_languages);\r\n    }\r\n    FetchAlbumInfo();\r\n\r\n    webkit = document.getElementById(\"myInput\");\r\n    webkit.onchange = function () {\r\n      console.log(webkit);\r\n      setFiles(webkit.files);\r\n      // var files = webkit.files,\r\n      //   len = files.length,\r\n      //   i;\r\n      // for (i = 0; i < len; i += 1) {\r\n      //   //console.log(files[i]);\r\n      // }\r\n    };\r\n  }, []);\r\n\r\n  function handleAlbumVmChange(label, value) {\r\n    let newAlbumVm = { ...AlbumVm };\r\n    let cleanedValue = value;\r\n    if (label === \"Artists\" || label === \"Flags\") {\r\n      cleanedValue = value.split(\",\");\r\n    }\r\n    else if (label === \"Tags\" || label === \"Languages\") {\r\n      cleanedValue = AlbumVm[Helper.firstLetterLowerCase(label)];\r\n      if (cleanedValue.includes(value)) {\r\n        cleanedValue = lodash.pull(cleanedValue, value);\r\n      }\r\n      else {\r\n        cleanedValue.push(value);\r\n      }\r\n    }\r\n    newAlbumVm[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n    setAlbumVm(newAlbumVm);\r\n  }\r\n\r\n  function handleLogAlbum(event) {\r\n    console.log(AlbumVm);\r\n  }\r\n  function handleSubmit(event) {\r\n    console.log(event);\r\n  }\r\n\r\n  function logWebkitFiles() {\r\n    // for (let i = 0; i < Files.length; i++) {\r\n    //   var reader = new FileReader();\r\n    //   reader.onload = function (e) {\r\n    //     var object = new Object();\r\n    //     object.content = e.target.content;\r\n    //     var json_upload = \"jsonObject=\" + JSON.stringify(object);\r\n\r\n    //     console.log(\"what is e\", e);\r\n    //     console.log(\"what is json_u\", json_upload);\r\n    //   }\r\n    //   reader.readAsBinaryString(Files);\r\n    // }\r\n    console.log(Files[0]);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Add edit page</h3>\r\n      <br />\r\n      <Row justify=\"start\" align=\"middle\" gutter={[16, 24]}>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <MyInputTextbox label=\"Title\" value={AlbumVm.title} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={AlbumVm.artists.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={AlbumVm.category} items={Categories} onChange={handleAlbumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={AlbumVm.tier} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={AlbumVm.flags.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={AlbumVm.tags} items={Tags} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={AlbumVm.orientation} items={Orientations} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={AlbumVm.languages} items={Languages} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={AlbumVm.isRead} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={AlbumVm.isWip} onChange={handleAlbumVmChange} />\r\n          <Button onClick={() => logWebkitFiles()}>Log Webkit Files</Button>\r\n          <MyInputButton label=\"Insert Album\" onClick={handleSubmit} />\r\n          {/* <Upload directory>\r\n            <Button>\r\n              <UploadOutlined /> Select Folder\r\n            </Button>\r\n          </Upload> */}\r\n          <input id=\"myInput\" type=\"file\" webkitdirectory=\"true\" directory multiple />\r\n        </Col>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <p>placeholder for image</p>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AlbumAddEdit;","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport MyAlbumCard from '../Components/Displays/MyAlbumCard';\r\nimport { Row, Col } from 'antd';\r\nimport useSWR from 'swr';\r\n//first commit after github username changes\r\n\r\nfunction GenreList(props) {\r\n  const endpoint = props.page === \"Genres\" ? \"Crud/GetGenreCardModels\" :\r\n    props.page === \"Artists\" ? \"Crud/GetArtistCardModels?tier=1\" :\r\n      \"NotFound\";\r\n\r\n  const { data: albumCGroups, error } = useSWR(endpoint);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!albumCGroups) { return <div>loading...</div>; }\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      console.log(\"query click\", albumCm);\r\n      props.history.push('/albums?query=' + albumCm.albumId)\r\n    },\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {albumCGroups.map((acg, index) => (\r\n        <Row key={\"acgRow\" + acg.name} gutter={0} type=\"flex\" style={{ border: \"1px solid rgb(83, 83, 83)\", borderRadius: \"8px\", paddingTop: \"8px\", marginBottom: \"5px\" }}>\r\n          { props.page === \"This feature is cancelled\" ? (\r\n            <div style={{ position: \"relative\" }}>\r\n              <div style={{ position: \"absolute\", top: \"-18px\", left: \"10px\" }}>{acg.name}</div>\r\n            </div>) : \"\"\r\n          }\r\n          {acg.albumCms.map((a) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={() => { }}\r\n                onDelete={() => { }}\r\n                showContextMenu={false}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default GenreList;","import React, { useState } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport { Row, Col } from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  MinusOutlined\r\n} from '@ant-design/icons';\r\n\r\nfunction MyTagMenuItem(props) {\r\n  let encodedQuery = encodeURIComponent(props.tag.query);\r\n\r\n  const plusBackground = props.selectStatus === \"plus\" ? \"#1890ff\" : \"\";\r\n  const minusBackground = props.selectStatus === \"minus\" ? \"#1890ff\" : \"\";\r\n\r\n  return (\r\n    <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n      <Row>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onPlus(props.tag.name)}><PlusOutlined style={{ marginRight: \"0px\", backgroundColor: plusBackground }} /></Col>\r\n        <Link to={\"/albums?query=\" + encodedQuery} >\r\n          <Col span={14}>\r\n            <span style={{ fontSize: \"12px\" }}>{props.tag.name}</span>\r\n          </Col>\r\n        </Link>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onMinus(props.tag.name)}><MinusOutlined style={{ marginRight: \"0px\", backgroundColor: minusBackground }} /></Col>\r\n      </Row>\r\n    </li>\r\n  );\r\n}\r\n\r\nexport default MyTagMenuItem;","import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Modal, Input, Button } from 'antd';\r\nimport {\r\n  ConsoleSqlOutlined,\r\n  SearchOutlined\r\n} from '@ant-design/icons';\r\nimport TextArea from 'antd/lib/input/TextArea';\r\n\r\nfunction MyQueryEditor(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(props.query);\r\n  }, [props.query]);\r\n\r\n  function handleOk() {\r\n    setVisible(false);\r\n    props.onOk(query);\r\n  }\r\n\r\n  return (\r\n    <div style={{ paddingLeft: \"24px\" }}>\r\n      <Button type=\"link\" onClick={() => setVisible(true)} style={{ width: \"90%\", textAlign: \"left\", padding: \"0px\" }}>\r\n        <ConsoleSqlOutlined />Query Editor\r\n      </Button>\r\n      <Modal\r\n        visible={visible}\r\n        onCancel={() => setVisible(false)}\r\n        closable={false}\r\n        footer={\r\n          <Button type=\"primary\" onClick={handleOk}>\r\n            <SearchOutlined />Search\r\n          </Button>\r\n        }\r\n      >\r\n        <TextArea onChange={(event) => setQuery(event.target.value)} value={query} autoSize={{ minRows: 2, maxRows: 5 }} />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MyQueryEditor;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport queryString from 'query-string';\r\nimport { API_URL } from './Utilities/Config';\r\nimport { DesktopOnly, MobileOnly } from './Utilities/Display';\r\n\r\nimport { Layout, Menu, Drawer, Button, Row, Col, Input } from 'antd';\r\nimport {\r\n  DesktopOutlined,\r\n  TeamOutlined,\r\n  PartitionOutlined,\r\n  TagsOutlined,\r\n  ReloadOutlined,\r\n  SyncOutlined,\r\n  DatabaseOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport AlbumList from './Pages/AlbumList';\r\nimport AlbumAddEdit from './Pages/AlbumAddEdit';\r\nimport GenreList from './Pages/GenreList';\r\nimport MyTagMenuItem from './Components/MyTagMenuItem';\r\n\r\nimport * as Helper from \"./Utilities/Helper\";\r\nimport withMyAlert from \"./HOCs/withMyAlert\";\r\nimport MyQueryEditor from './Components/Editors/MyQueryEditor';\r\n\r\nimport useSWR, { SWRConfig } from 'swr';\r\n\r\nconst axios = require('axios').default;\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\n//const fetcher = (endpoint) => fetch(API_URL + endpoint).then(res => res.json());\r\n\r\nfunction MasterPage(props) {\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n  const [collapseSider, setCollapseSider] = useState(false);\r\n\r\n  let querStr = queryString.parse(props.location.search).query ?? \"\";\r\n\r\n  let page;\r\n  let selectedMenu;\r\n  if (props.page === \"Albums\") {\r\n    page = <AlbumList query={querStr} />;\r\n    selectedMenu = '2';\r\n  }\r\n  else if (props.page === \"AlbumAddEdit\") {\r\n    page = <AlbumAddEdit />;\r\n    selectedMenu = '1';\r\n  }\r\n  else if (props.page === \"Artists\") {\r\n    page = <GenreList page={props.page} history={props.history} />;\r\n    selectedMenu = '3';\r\n  }\r\n  else if (props.page === \"Genres\") {\r\n    page = <GenreList page={props.page} history={props.history} />;\r\n    selectedMenu = '4';\r\n  }\r\n\r\n  const queryHandler = {\r\n    search: function (query) {\r\n      let correctedQuery = Helper.contains(query.split(\",\")[0], [\":\", \"!\", \">\", \"<\"]) ? query : 'title:' + query;\r\n      queryHandler.goToAlbumList(correctedQuery);\r\n    },\r\n    plus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      let currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryPlus);\r\n      let newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    minus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      let currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryMinus);\r\n      let newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    goToAlbumList: function (query) {\r\n      let currentUrlParams = new URLSearchParams(window.location.search);\r\n      currentUrlParams.set('query', query);\r\n      props.history.push(\"Albums?\" + currentUrlParams.toString());\r\n    }\r\n  }\r\n\r\n  const actionHandler = {\r\n    reload: () => {\r\n      axios.get(API_URL + \"Crud/ReloadDatabase\")\r\n        .then((response) => {\r\n          props.popInfo(\"ReloadDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    },\r\n    rescan: () => {\r\n      axios.get(API_URL + \"Crud/RescanDatabase\")\r\n        .then((response) => {\r\n          props.popInfo(\"RescanDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    }\r\n  }\r\n\r\n  const menuContent = (\r\n    <>\r\n      <div className=\"logo\"></div>\r\n      <MyQueryEditor query={querStr} onOk={(query) => queryHandler.goToAlbumList(query)} />\r\n      <Menu theme=\"dark\" defaultSelectedKeys={[selectedMenu]} defaultOpenKeys={[\"sub1\"]} mode=\"inline\">\r\n        <Menu.Item key=\"2\">\r\n          <Link to=\"/albums\">\r\n            <DesktopOutlined />\r\n            <span>Albums</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"3\">\r\n          <Link to=\"/artists\">\r\n            <TeamOutlined />\r\n            <span>Artists</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"4\">\r\n          <Link to=\"/genres\">\r\n            <PartitionOutlined />\r\n            <span>Genres</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <SubMenu key=\"sub1\" title={<><TagsOutlined /><span>Tags</span></>} >\r\n          <TagItemsContainer onPlus={queryHandler.plus} onMinus={queryHandler.minus} querStr={querStr} />\r\n        </SubMenu>\r\n        <SubMenu key=\"sub2\" title={<><DatabaseOutlined /><span>Actions</span></>} >\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.reload}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><ReloadOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Reload Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.rescan}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><SyncOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Rescan Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n        </SubMenu>\r\n      </Menu>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <SWRConfig value={{ revalidateOnFocus: false, fetcher: (endpoint) => fetch(API_URL + endpoint).then(res => res.json()) }}>\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <MobileOnly>\r\n          <Layout style={{ position: 'fixed', zIndex: 1, width: '100%', backgroundColor: '#001529' }}>\r\n            <div style={{ textAlign: \"end\", lineHeight: 0 }}>\r\n              <div className=\"hamburger-container\" onClick={() => setShowDrawer(true)}>\r\n                <MenuIcon style={{ fontSize: '32px' }} />\r\n              </div>\r\n            </div>\r\n          </Layout>\r\n          <Drawer\r\n            placement=\"right\"\r\n            closable={false}\r\n            onClose={() => setShowDrawer(false)}\r\n            visible={showDrawer}\r\n          >\r\n            {menuContent}\r\n          </Drawer>\r\n        </MobileOnly>\r\n        <DesktopOnly>\r\n          <Sider collapsible collapsed={collapseSider} onCollapse={(event) => setCollapseSider(event)}>\r\n            {menuContent}\r\n          </Sider>\r\n        </DesktopOnly>\r\n\r\n        <Layout className=\"site-layout\">\r\n          <Content>\r\n            <MobileOnly>\r\n              <div style={{ paddingTop: \"5x\" }}>Padding for mobile</div>\r\n            </MobileOnly>\r\n            <div className=\"site-layout-background\" style={{ paddingTop: 36, paddingLeft: 10, paddingRight: 10, minHeight: 360 }}>\r\n              {page}\r\n            </div>\r\n          </Content>\r\n          <Footer style={{ textAlign: 'center' }}>-----------------</Footer>\r\n        </Layout>\r\n      </Layout>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(MasterPage));\r\n\r\nfunction TagItemsContainer(props) {\r\n  const { data: tags, error } = useSWR(\"Crud/GetTagVMs\");\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!tags) { return <div>loading...</div>; }\r\n\r\n  return (\r\n    <>\r\n      {tags.map((tag, index) => (<MyTagMenuItem key={tag.name} tag={tag} onPlus={props.onPlus} onMinus={props.onMinus} selectStatus={getSelectStatus(tag.name, props.querStr)} />))}\r\n    </>\r\n  )\r\n}\r\n\r\nfunction getSelectStatus(tagName, query) {\r\n  let queryArr = query.split(',');\r\n  let result = queryArr.filter((str) => str.toLowerCase().includes(\"tag:\" + tagName.toLowerCase())).length > 0 ? \"plus\" :\r\n    queryArr.filter((str) => str.toLowerCase().includes(\"tag!\" + tagName.toLowerCase())).length > 0 ? \"minus\" :\r\n      \"none\";\r\n\r\n  return result;\r\n}","import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport './App.scss';\r\nimport { BrowserRouter, MemoryRouter, HashRouter, Route, Switch, Link, Redirect } from 'react-router-dom';\r\n\r\nimport MasterPage from './MasterPage';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route exact path=\"/\" ><Redirect to=\"/genres\" /></Route>\r\n          <Route exact path=\"/albums\" ><MasterPage page=\"Albums\" /></Route>\r\n          <Route exact path=\"/add\" ><MasterPage page=\"AlbumAddEdit\" /></Route>\r\n          <Route exact path=\"/artists\" ><MasterPage page=\"Artists\" /></Route>\r\n          <Route exact path=\"/genres\" ><MasterPage page=\"Genres\" /></Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nconst startApp = () => {\r\n  ReactDOM.render(<App isCordova={true} />, document.getElementById('root'));\r\n  serviceWorker.unregister();\r\n}\r\n\r\nif (window.cordova) {\r\n  document.addEventListener('deviceready', startApp, false);\r\n}\r\nelse {\r\n  startApp();\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA"],"sourceRoot":""}