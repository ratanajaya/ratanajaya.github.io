"use strict";(self.webpackChunkwishui=self.webpackChunkwishui||[]).push([[312],{4386:function(n,i,e){var t=e(9065),r={getWish:function(n){return t.AQ.get("Master/GetWish",{params:n})},getWishes:function(){return t.AQ.get("Master/GetWishes")},insertWish:function(n){return t.AQ.post("Master/InsertWish",n)},updateWish:function(n){return t.AQ.post("Master/UpdateWish",n)},deleteWish:function(n){return t.AQ.delete("Master/DeleteWish",{params:n})}};i.Z=r},9312:function(n,i,e){e.r(i),e.d(i,{default:function(){return y}});var t=e(2982),r=e(885),s=e(890),u=e(7621),a=e(9504),o=e(3963),l=e(6151),d=e(4386),c=e(9065),h={getDailyWishesByDate:function(n){return c.AQ.get("Transaction/GetDailyWishesByDate",{params:n})},insertDailyWish:function(n){return c.AQ.post("Transaction/InsertDailyWish",n)}},f=e(2897),v=e(7630),p=e(9318),m=e(2791),x=e(8931),w=e(5206),g=e(184);function y(){var n=(0,m.useState)(!1),i=(0,r.Z)(n,2),e=i[0],c=i[1],y=(0,m.useState)([]),W=(0,r.Z)(y,2),b=W[0],j=W[1],Z=(0,m.useState)((new Date).toISOString()),I=(0,r.Z)(Z,2),k=I[0],O=(I[1],(0,x.k6)());function D(n,i){var e=b.find((function(i){return i.wishId===n}));c(!0),h.insertDailyWish(e).then((function(e){e.success?(j((function(i){var e=i.findIndex((function(i){return i.wishId===n}));return i[e].locked=!0,(0,t.Z)(i)})),w.Am.success("Saved!",{autoClose:500}),function(n){n===S.current.length-1&&window.scrollTo({top:0,behavior:"smooth"});var i=S.current[n+1].offsetTop;window.scrollTo({top:window.pageYOffset+i-120,behavior:"smooth"})}(i)):w.Am.error(e.message)})).catch((function(){})).finally((function(){return c(!1)}))}(0,m.useEffect)((function(){c(!0),d.Z.getWishes().then((function(n){h.getDailyWishesByDate({date:null}).then((function(i){var e=n.filter((function(n){return n.entityState===f.Z.entityState.active})).map((function(n){var e,t,r=n.wishOptions.sort((function(n,i){return n.value-i.value})),s=Math.floor(r.length/2),u=r.length%2!==0?r[s].value:(r[s-1].value+r[s].value)/2,a=null===(e=r.find((function(n){return n.value===u})))||void 0===e?void 0:e.id,o=i.find((function(i){return i.wishId===n.id}));return{locked:null!=o,wish:n,pkDate:k,wishId:n.id,optionId:null!==(t=null===o||void 0===o?void 0:o.selectedOptionId)&&void 0!==t?t:a,remark:null,subWishOptions:n.subWishes.filter((function(n){return n.entityState===f.Z.entityState.active})).map((function(n){var i,e,t=null===o||void 0===o?void 0:o.dailySubWishes.find((function(i){return i.subWishId===n.id}));return{subWish:n,subWishId:n.id,optionId:null!==(i=null===t||void 0===t||null===(e=t.selectedOption)||void 0===e?void 0:e.id)&&void 0!==i?i:a,remark:null}}))}}));j(e)})).catch((function(){})).finally((function(){return c(!1)}))})).catch((function(){return c(!1)})).finally((function(){}))}),[]);var S=(0,m.useRef)([]);var A=0===b.length?"nothing":b.length>0&&b.length>0&&b.every((function(n){return n.locked}))?"finished":"normal";return(0,g.jsxs)(p.Z,{title:"Track Mood",loading:e,children:["nothing"===A?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(s.Z,{variant:"body1",children:["There's nothing here ",(0,g.jsx)("a",{href:"/Wishes/Create",onClick:function(n){n.preventDefault(),O.push("/Wishes/Create")},children:"create a new wish"})," to start using this app"]})}):"normal"===A?(0,g.jsxs)(s.Z,{variant:"body1",children:["Today is ","".concat(v.Z.formatFriendlyDate(k)),"! How do you feel of your wishes?"]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(s.Z,{variant:"body1",children:"\ud83c\udf89You have rated all of your wishes today!\ud83c\udf89"}),(0,g.jsx)("div",{className:"divider-4"}),(0,g.jsx)(s.Z,{variant:"body1",children:"\ud83c\udf89Come back again tomorrow!\ud83c\udf89"}),(0,g.jsx)("div",{className:"divider-8"})]}),b.map((function(n,i){var e,r,d=n.wish,c=d.wishOptions.sort((function(n,i){return n.value-i.value})).map((function(n){return{value:n.value,label:n.value}})),h=c.map((function(n){return{value:n.value}})),f=d.wishOptions.reduce((function(n,i){return i.value<n?i.value:n}),0),v=d.wishOptions.reduce((function(n,i){return i.value>n?i.value:n}),0),p=null!==(e=null===(r=d.wishOptions.find((function(i){return i.id===n.optionId})))||void 0===r?void 0:r.value)&&void 0!==e?e:0;return(0,g.jsx)(u.Z,{sx:{width:"100%",marginBottom:"12px"},ref:function(n){return S.current[i]=n},children:(0,g.jsxs)(a.Z,{children:[(0,g.jsx)(s.Z,{variant:"h6",children:d.name}),(0,g.jsxs)("div",{style:{padding:"0px 8px"},children:[(0,g.jsx)(o.ZP,{value:p,valueLabelFormat:function(n,i){var e=d.wishOptions.find((function(i){return i.value===n}));return e?e.name:""},step:null,valueLabelDisplay:"auto",min:f,max:v,marks:c,sx:{marginLeft:"8px"},disabled:n.locked,onChange:function(n,i){j((function(n){var e,r=null===(e=d.wishOptions.find((function(n){return n.value===i})))||void 0===e?void 0:e.id,s=n.findIndex((function(n){return n.wishId===d.id}));return n[s].optionId=r,(0,t.Z)(n)}))}}),n.subWishOptions.map((function(i){var e,r,u=null!==(e=null===(r=d.wishOptions.find((function(n){return n.id===i.optionId})))||void 0===r?void 0:r.value)&&void 0!==e?e:0;return(0,g.jsxs)("div",{children:[(0,g.jsx)(s.Z,{variant:"subtitle1",children:i.subWish.name}),(0,g.jsx)(o.ZP,{value:u,valueLabelFormat:function(n,i){var e=d.wishOptions.find((function(i){return i.value===n}));return e?e.name:""},step:null,valueLabelDisplay:"auto",min:f,max:v,marks:h,sx:{marginLeft:"8px"},disabled:n.locked,onChange:function(n,e){j((function(n){var r,s=null===(r=d.wishOptions.find((function(n){return n.value===e})))||void 0===r?void 0:r.id,u=n.findIndex((function(n){return n.wishId===d.id})),a=n[u].subWishOptions.findIndex((function(n){return n.subWishId===i.subWishId}));return n[u].subWishOptions[a].optionId=s,(0,t.Z)(n)}))}})]},i.subWishId)}))]}),!n.locked&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"divider-8"}),(0,g.jsx)("div",{style:{textAlign:"right",marginTop:"8px"},children:(0,g.jsx)(l.Z,{variant:"outlined",color:"primary",disabled:n.locked,onClick:function(){return D(n.wishId,i)},children:"Save"})})]})]})},d.id)}))]})}},9318:function(n,i,e){e.d(i,{Z:function(){return a}});var t=e(1614),r=e(890),s=(e(2791),e(5821)),u=e(184);function a(n){return(0,u.jsxs)("div",{children:[(0,u.jsxs)(t.Z,{children:[(0,u.jsx)("div",{className:"divider-64"}),(0,u.jsx)("div",{className:"divider-12"}),(0,u.jsx)(r.Z,{variant:"h6",children:n.title}),(0,u.jsx)("div",{className:"divider-12"}),n.children]}),(0,u.jsx)(s.Z,{open:n.loading})]})}}}]);
//# sourceMappingURL=312.ca456040.chunk.js.map