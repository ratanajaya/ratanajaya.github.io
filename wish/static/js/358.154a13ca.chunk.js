"use strict";(self.webpackChunkwishui=self.webpackChunkwishui||[]).push([[358],{4386:function(n,i,e){var t=e(9065),r={getWish:function(n){return t.A.get("Master/GetWish",{params:n})},getWishes:function(){return t.A.get("Master/GetWishes")},insertWish:function(n){return t.A.post("Master/InsertWish",n)},updateWish:function(n){return t.A.post("Master/UpdateWish",n)},deleteWish:function(n){return t.A.delete("Master/DeleteWish",{params:n})}};i.Z=r},4847:function(n,i,e){var t=e(9065),r={getDailyWishesByDate:function(n){return t.A.get("Transaction/GetDailyWishesByDate",{params:n})},insertDailyWish:function(n){return t.A.post("Transaction/InsertDailyWish",n)},getDailyWishSummaries:function(){return t.A.get("Transaction/GetDailyWishSummaries")}};i.Z=r},3358:function(n,i,e){e.r(i),e.d(i,{default:function(){return y}});var t=e(2982),r=e(885),s=e(890),u=e(7621),a=e(9504),o=e(3963),l=e(9489),d=e(6151),c=e(4386),h=e(4847),v=e(2897),f=e(7630),p=e(9318),m=e(2791),x=e(8931),g=e(5985),w=e(184);function y(){var n=(0,m.useState)(!1),i=(0,r.Z)(n,2),e=i[0],y=i[1],W=(0,m.useState)([]),b=(0,r.Z)(W,2),j=b[0],Z=b[1],I=(0,m.useState)((new Date).toISOString()),k=(0,r.Z)(I,2),D=k[0],O=(k[1],(0,x.k6)());function S(n,i){var e=j.find((function(i){return i.wishId===n}));y(!0),h.Z.insertDailyWish(e).then((function(e){e.success?(Z((function(i){var e=i.findIndex((function(i){return i.wishId===n}));return i[e].locked=!0,(0,t.Z)(i)})),g.Am.success("Saved!",{autoClose:500}),function(n){n===A.current.length-1&&window.scrollTo({top:0,behavior:"smooth"});var i=A.current[n+1].offsetTop;window.scrollTo({top:window.pageYOffset+i-120,behavior:"smooth"})}(i)):g.Am.error(e.message)})).catch((function(){})).finally((function(){return y(!1)}))}(0,m.useEffect)((function(){y(!0),c.Z.getWishes().then((function(n){h.Z.getDailyWishesByDate({date:null}).then((function(i){var e=n.filter((function(n){return n.entityState===v.Z.entityState.active})).map((function(n){var e,t,r,s=n.wishOptions.sort((function(n,i){return n.value-i.value})),u=Math.floor(s.length/2),a=s.length%2!==0?s[u].value:(s[u-1].value+s[u].value)/2,o=null===(e=s.find((function(n){return n.value===a})))||void 0===e?void 0:e.id,l=i.find((function(i){return i.wishId===n.id}));return{locked:null!=l,wish:n,pkDate:D,wishId:n.id,optionId:null!==(t=null===l||void 0===l?void 0:l.selectedOptionId)&&void 0!==t?t:o,remark:null!==(r=null===l||void 0===l?void 0:l.remark)&&void 0!==r?r:null,subWishOptions:n.subWishes.filter((function(n){return n.entityState===v.Z.entityState.active})).map((function(n){var i,e,t=null===l||void 0===l?void 0:l.dailySubWishes.find((function(i){return i.subWishId===n.id}));return{subWish:n,subWishId:n.id,optionId:null!==(i=null===t||void 0===t||null===(e=t.selectedOption)||void 0===e?void 0:e.id)&&void 0!==i?i:o,remark:null}}))}}));Z(e)})).catch((function(){})).finally((function(){return y(!1)}))})).catch((function(){return y(!1)})).finally((function(){}))}),[]);var A=(0,m.useRef)([]);var C=0===j.length?"nothing":j.length>0&&j.length>0&&j.every((function(n){return n.locked}))?"finished":"normal";return(0,w.jsxs)(p.Z,{title:"Track Mood",loading:e,children:["nothing"===C?(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(s.Z,{variant:"body1",children:["There's nothing here ",(0,w.jsx)("a",{href:"/Wishes/Create",onClick:function(n){n.preventDefault(),O.push("/Wishes/Create")},children:"create a new wish"})," to start using this app"]})}):"normal"===C?(0,w.jsxs)(s.Z,{variant:"body1",children:["Today is ","".concat(f.Z.formatFriendlyDate(D)),"! How do you feel of your wishes?"]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.Z,{variant:"body1",children:"\ud83c\udf89You have rated all of your wishes today!\ud83c\udf89"}),(0,w.jsx)("div",{className:"divider-4"}),(0,w.jsx)(s.Z,{variant:"body1",children:"\ud83c\udf89Come back again tomorrow!\ud83c\udf89"}),(0,w.jsx)("div",{className:"divider-8"})]}),j.map((function(n,i){var e,r,c,h=n.wish,v=h.wishOptions.sort((function(n,i){return n.value-i.value})).map((function(n){return{value:n.value,label:n.value}})),f=v.map((function(n){return{value:n.value}})),p=h.wishOptions.reduce((function(n,i){return i.value<n?i.value:n}),0),m=h.wishOptions.reduce((function(n,i){return i.value>n?i.value:n}),0),x=null!==(e=null===(r=h.wishOptions.find((function(i){return i.id===n.optionId})))||void 0===r?void 0:r.value)&&void 0!==e?e:0;return(0,w.jsx)(u.Z,{sx:{width:"100%",marginBottom:"12px"},ref:function(n){return A.current[i]=n},children:(0,w.jsxs)(a.Z,{children:[(0,w.jsx)(s.Z,{variant:"h6",children:h.name}),(0,w.jsxs)("div",{style:{padding:"0px 8px"},children:[(0,w.jsx)(o.ZP,{value:x,valueLabelFormat:function(n,i){var e=h.wishOptions.find((function(i){return i.value===n}));return e?e.name:""},step:null,valueLabelDisplay:"auto",min:p,max:m,marks:v,sx:{marginLeft:"8px"},disabled:n.locked,onChange:function(n,i){Z((function(n){var e,r=null===(e=h.wishOptions.find((function(n){return n.value===i})))||void 0===e?void 0:e.id,s=n.findIndex((function(n){return n.wishId===h.id}));return n[s].optionId=r,(0,t.Z)(n)}))}}),n.subWishOptions.map((function(i){var e,r,u=null!==(e=null===(r=h.wishOptions.find((function(n){return n.id===i.optionId})))||void 0===r?void 0:r.value)&&void 0!==e?e:0;return(0,w.jsxs)("div",{children:[(0,w.jsx)(s.Z,{variant:"subtitle1",children:i.subWish.name}),(0,w.jsx)(o.ZP,{value:u,valueLabelFormat:function(n,i){var e=h.wishOptions.find((function(i){return i.value===n}));return e?e.name:""},step:null,valueLabelDisplay:"auto",min:p,max:m,marks:f,sx:{marginLeft:"8px"},disabled:n.locked,onChange:function(n,e){Z((function(n){var r,s=null===(r=h.wishOptions.find((function(n){return n.value===e})))||void 0===r?void 0:r.id,u=n.findIndex((function(n){return n.wishId===h.id})),a=n[u].subWishOptions.findIndex((function(n){return n.subWishId===i.subWishId}));return n[u].subWishOptions[a].optionId=s,(0,t.Z)(n)}))}})]},i.subWishId)}))]}),(0,w.jsx)("div",{className:"divider-8"}),(0,w.jsx)("div",{style:{paddingLeft:"8px"},children:(0,w.jsx)(l.Z,{multiline:!0,label:"Remark",value:null!==(c=n.remark)&&void 0!==c?c:"",disabled:n.locked,onChange:function(n){Z((function(i){var e=i.findIndex((function(n){return n.wishId===h.id}));return i[e].remark=n.target.value,(0,t.Z)(i)}))},sx:{width:"100%"}})}),!n.locked&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"divider-8"}),(0,w.jsx)("div",{style:{textAlign:"right",marginTop:"8px"},children:(0,w.jsx)(d.Z,{variant:"outlined",color:"primary",disabled:n.locked,onClick:function(){return S(n.wishId,i)},children:"Save"})})]})]})},h.id)}))]})}},9318:function(n,i,e){e.d(i,{Z:function(){return a}});var t=e(9164),r=e(890),s=(e(2791),e(5821)),u=e(184);function a(n){return(0,u.jsxs)("div",{children:[(0,u.jsxs)(t.Z,{children:[(0,u.jsx)("div",{className:"divider-64"}),(0,u.jsx)("div",{className:"divider-12"}),(0,u.jsx)(r.Z,{variant:"h6",children:n.title}),(0,u.jsx)("div",{className:"divider-12"}),n.children]}),(0,u.jsx)(s.Z,{open:n.loading})]})}}}]);
//# sourceMappingURL=358.154a13ca.chunk.js.map