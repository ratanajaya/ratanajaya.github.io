{"version":3,"sources":["Resources/loading.gif","Utilities/Config.js","Utilities/Display.js","Utilities/Helper.js","HOCs/withMyAlert.js","Components/Displays/MyAlbumCard.js","Components/Displays/MyReaderContextMenu.js","Components/Displays/MyChapterDrawer.js","Components/Displays/MyReaderModal.js","Components/Editors/MyInputTextbox.js","Components/Editors/MyInputStar.js","Components/Editors/MyInputRadio.js","Components/Editors/MyInputCheck.js","Components/Editors/MyInputMulticheck.js","Components/MyEditModal.js","Pages/AlbumList.js","Data/DataSource.js","Components/Editors/MyInputButton.js","Pages/AlbumAddEdit.js","Pages/GenreList.js","Components/MyTagMenuItem.js","Components/Editors/MyQueryEditor.js","MasterPage.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","API_URL","DesktopOnly","children","useMediaQuery","minWidth","MobileOnly","maxWidth","firstLetterLowerCase","string","charAt","toLowerCase","slice","getPercent100","value","maxValue","fraction","withMyAlert","OriginalComponent","props","popInfo","title","stringContent","objContent","Modal","info","content","JSON","stringify","onOk","width","popError","error","popApiError","response","status","statusText","data","warning","confirm","axios","require","default","ColorFromIndex","tier","e","rgb","r","g","b","alpha","BorderFromIndex","FlagIcon","flagStyle","height","marginRight","marginBottom","language","GB","style","JP","CN","ID","handler","view","onView","albumCm","edit","onEdit","albumId","delete","fullTitle","icon","ExclamationCircleOutlined","okText","okType","cancelText","then","console","log","onDelete","catch","onCancel","menu","Item","key","onClick","EditOutlined","DeleteOutlined","useInView","threshold","rootMargin","ref","inView","paddingBottom","position","overlay","trigger","disabled","showContextMenu","textAlign","display","borderLeft","isRead","objectFit","src","coverInfo","uncPathEncoded","alt","left","top","borderRight","borderBottom","right","bottom","color","lineHeight","languages","map","item","i","backgroundColor","borderTop","lastPageIndex","Helper","pageCount","fontSize","MyReaderContextMenu","useState","jumpValue","setJumpValue","useEffect","initialValue","setNewPageName","pageName","showRenameModal","setShowRenameModal","showConfirmDelete","setShowConfirmDelete","tierDisplay","setTierDisplay","undefined","newPageName","visible","footer","closable","centered","span","count","onChange","onTierChange","type","onRecount","FileSyncOutlined","marginTop","Math","min","max","target","padding","WebkitBoxSizing","borderRadius","onJump","ArrowRightOutlined","onUndoJump","ArrowLeftOutlined","bodyStyle","border","TextArea","event","rows","onRename","chapters","setChapters","get","chapterTitle","encodedChapterTitle","encodeURIComponent","onChapterDeleteSuccess","filter","c","placement","onClose","chapter","index","onJumpToPage","pageIndex","maxHeight","pageUncPath","getOverlayStyle","isGrey","button","boxSizing","getGuideLabel","text","margin","textShadow","PageDisplay","styleShow","window","innerHeight","innerWidth","styleHide","extension","IsVideo","pageInfo","autoPlay","loop","id","queue","loadingImg","lpi","pages","indexes","cPageI","pPageI","triad","zenpenIndex","chuhenIndex","kouhenIndex","apm","setApm","alert","targetPage","length","pageHandler","jumpTo","document","addEventListener","handleKeyDown2","removeEventListener","keyCode","close","page","renameObj","number","maxIndex","newPPageI","newCPageI","compose","newTriad","pageCeil","modifier","pagesLen","modifiedPages","newPageInfo","post","rename","newName","onPageDeleteSuccess","albumHandler","tierChange","put","recount","setShowContextMenu","showDrawer","setShowDrawer","buttonHandler","rightTop","rightMid","rightBot","midTop","midMid","midBot","leftTop","leftMid","leftBot","swipeHandler","useSwipeable","onSwipedLeft","eventData","onSwipedRight","showGuide","overlayStyle","buttonStyle","side","minHeight","mid","currentPageInfo","zenpenPage","chuhenPage","kouhenPage","className","isOpen","zIndex","name","newPageCount","MyInputTextbox","gutter","label","placeholder","MyInputStar","MyInputRadio","Group","items","MyInputCheck","checked","MyInputMulticheck","includes","ghost","lodash","useSWR","albumInfo","aiError","path","album","category","orientation","artists","tags","flags","cover","isWip","entryDate","albumVm","setAlbumVm","handlers","albumVmChange","newAlbumVm","cleanedValue","split","pull","push","ok","cancel","join","categories","orientations","albumCms","setAlbumCms","scrollTo","encodedQuery","query","readerModalIsOpen","setReaderModalIsOpen","selectedAlbumId","setSelectedAlbumId","readerHandler","aIndex","editModalIsOpen","setEditModalIsOpen","editedAlbumId","setEditedAlbumId","crudHandler","pageDeleteSuccess","chapterDeleteSuccess","editHandler","editedAlbumVm","newAlbumCms","editedAlbumVmIndex","findIndex","a","lg","md","xs","find","aCm","GetTags","FetchAlbumInfo","GetCategories","GetOrientations","GetLanguages","fetch","method","res","json","MyInputButton","AlbumAddEdit","webkit","Files","setFiles","AlbumVm","Tags","setTags","Categories","setCategories","Orientations","setOrientations","Languages","setLanguages","handleAlbumVmChange","DataSource","_tag","_categories","_orientations","_languages","getElementById","onchange","files","justify","align","webkitdirectory","directory","multiple","GenreList","endpoint","albumCGroups","history","acg","paddingTop","MyTagMenuItem","tag","plusBackground","selectStatus","minusBackground","role","paddingLeft","paddingRight","onPlus","PlusOutlined","to","onMinus","MinusOutlined","MyQueryEditor","setVisible","setQuery","ConsoleSqlOutlined","SearchOutlined","autoSize","minRows","maxRows","Content","Layout","Header","Footer","Sider","SubMenu","Menu","withRouter","selectedMenu","collapseSider","setCollapseSider","querStr","queryString","parse","location","search","queryHandler","correctedQuery","pattern","forEach","word","goToAlbumList","plus","tagName","targetQueryPlus","targetQueryMinus","newQueries","newQueryString","minus","currentUrlParams","URLSearchParams","set","toString","actionHandler","reload","rescan","menuContent","theme","defaultSelectedKeys","defaultOpenKeys","mode","DesktopOutlined","TeamOutlined","PartitionOutlined","TagsOutlined","TagItemsContainer","DatabaseOutlined","ReloadOutlined","SyncOutlined","revalidateOnFocus","fetcher","collapsible","collapsed","onCollapse","getSelectStatus","queryArr","str","App","exact","Boolean","hostname","match","startApp","ReactDOM","render","isCordova","navigator","serviceWorker","ready","registration","unregister","message","cordova"],"mappings":"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","file":"static/js/main.d53db4f3.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/loading.d47e58c7.gif\";","//WARNING can't figure out how to read .env file in production\r\n//require('dotenv').config();\r\n//const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n//const API_URL = \"http://192.168.8.103:5000/\";\r\n//const API_URL = \"http://localhost:57389/\";\r\nconst API_URL = \"https://ratanajaya.com/\";\r\nconst IS_PUBLIC = true;\r\n\r\n//console.log(\"API URL IS \", API_URL);\r\n\r\nexport { API_URL, IS_PUBLIC }","import { useMediaQuery } from 'react-responsive'\r\n\r\nconst DesktopOnly = ({ children }) => {\r\n  const isDesktop = useMediaQuery({ minWidth: 801 })\r\n  return isDesktop ? children : null\r\n}\r\nconst MobileOnly = ({ children }) => {\r\n  const isMobile = useMediaQuery({ maxWidth: 800 })\r\n  return isMobile ? children : null\r\n}\r\n\r\nexport { DesktopOnly, MobileOnly };","\r\nexport function firstLetterLowerCase(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nexport function apiErrorHandler(error) {\r\n  if (typeof error.response !== undefined) {\r\n    alert(JSON.stringify(error.response, null, \"\\t\"))\r\n  }\r\n  else {\r\n    alert(JSON.stringify(error, null, \"\\t\"));\r\n  }\r\n}\r\n\r\nexport function getPercent100(value, maxValue) {\r\n  let fraction = (value / maxValue) * 100;\r\n  let result = fraction <= 100 ? fraction : 100;\r\n  return result;\r\n}\r\n\r\nexport function contains(target, pattern) {\r\n  var value = 0;\r\n  pattern.forEach(function (word) {\r\n    value = value + target.includes(word);\r\n  });\r\n  return (value === 1);\r\n}\r\n\r\nexport function clamp(number, min, max) {\r\n  return Math.max(min, Math.min(number, max));\r\n}","import React from 'react';\r\nimport { Modal } from 'antd';\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  const width = 500;\r\n\r\n  function popInfo(title, stringContent, objContent) {\r\n    Modal.info({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {JSON.stringify(objContent, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popError(title, stringContent, objContent) {\r\n    Modal.error({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {JSON.stringify(objContent, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popApiError(error) {\r\n    if (error.response == null) {\r\n      Modal.error(JSON.stringify(error));\r\n      return;\r\n    }\r\n    const { status, statusText, data } = error.response;\r\n\r\n    const content = {\r\n      title: `${status} - ${statusText}`,\r\n      content: (\r\n        <span>\r\n          {JSON.stringify(data, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    };\r\n\r\n    if (status >= 400 && status < 500) {\r\n      Modal.warning(content);\r\n    }\r\n    else {\r\n      Modal.error(content);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      popInfo={popInfo}\r\n      popError={popError}\r\n      popApiError={popApiError}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;","import React, { useState, useEffect } from 'react';\r\nimport { useInView } from 'react-intersection-observer';\r\nimport { API_URL } from '../../Utilities/Config';\r\nimport { Dropdown, Menu, Modal, Progress } from 'antd';\r\nimport Flags from 'country-flag-icons/react/3x2';\r\nimport { MoreOutlined, DeleteOutlined, EditOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction MyAlbumCard(props) {\r\n  const handler = {\r\n    view: function () {\r\n      props.onView(props.albumCm)\r\n    },\r\n\r\n    edit: function () {\r\n      props.onEdit(props.albumCm.albumId)\r\n    },\r\n\r\n    delete: function () {\r\n      confirm({\r\n        title: `Delete album ${props.albumCm.fullTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          axios.delete(API_URL + \"Crud/DeleteAlbum/\" + props.albumCm.albumId)\r\n            .then(function (response) {\r\n              console.log(\"del success\", response);\r\n              props.onDelete(props.albumCm.albumId);\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  const menu = (\r\n    <Menu>\r\n      <Menu.Item key=\"1\" onClick={handler.edit}><EditOutlined />Edit</Menu.Item>\r\n      <Menu.Item key=\"2\" onClick={handler.delete}><DeleteOutlined />Delete</Menu.Item>\r\n    </Menu>\r\n  );\r\n\r\n  const [ref, inView, entry] = useInView({\r\n    threshold: 0,\r\n    rootMargin: \"300px 0px 300px 0px\"\r\n  });\r\n\r\n  const absoluteH = \"150px\";\r\n\r\n  return (\r\n    <div ref={ref} style={{ paddingBottom: '8px', position: \"relative\" }}>\r\n      <Dropdown overlay={menu} trigger={['contextMenu']} disabled={!props.showContextMenu}>\r\n        <div style={{ textAlign: \"center\" }}>\r\n          <div style={{ height: absoluteH, width: \"100%\" }}>\r\n            <div style={{\r\n              display: \"inline-block\", position: \"relative\",\r\n              height: absoluteH, width: \"100%\", maxWidth: absoluteH,\r\n              borderLeft: !props.albumCm.isRead ? \"1px solid #ddbe14\" : \"\",\r\n            }}>\r\n              <img\r\n                onClick={handler.view}\r\n                style={{\r\n                  objectFit: \"contain\",\r\n                  height: \"100%\", width: \"100%\"\r\n                }}\r\n                src={inView ? API_URL + \"Media/StreamResizedImage?librelPathBase64=\" + props.albumCm.coverInfo.uncPathEncoded + \"&maxSize=150\" : \"\"}\r\n                alt=\"img\"\r\n              />\r\n              {!props.albumCm.isRead ?\r\n                <div style={{\r\n                  position: \"absolute\",\r\n                  height: 0,\r\n                  width: 0,\r\n                  left: \"0px\",\r\n                  top: \"0px\",\r\n                  borderLeft: \"15px solid #ddbe14\",\r\n                  borderRight: \"15px solid transparent\",\r\n                  borderBottom: \"15px solid transparent\"\r\n                }} /> : \"\"\r\n              }\r\n              <div style={{\r\n                position: \"absolute\",\r\n                right: \"3px\",\r\n                bottom: \"3px\",\r\n                color: \"white\",\r\n                lineHeight: \"0px\"\r\n              }}>\r\n                {props.albumCm.languages.map((item, i) => <FlagIcon language={item} key={i} />)}\r\n              </div>\r\n              <div style={{\r\n                position: \"absolute\",\r\n                right: \"0px\",\r\n                bottom: \"0px\",\r\n                height: \"100%\",\r\n                width: \"2px\"\r\n              }}>\r\n                {[3, 2, 1].map((e, i) =>\r\n                  <div key={`tierBar-${i}`}\r\n                    style={{\r\n                      width: \"100%\",\r\n                      height: \"33%\",\r\n                      backgroundColor: ColorFromIndex(props.albumCm.tier, e),\r\n                      borderTop: BorderFromIndex(props.albumCm.tier, e)\r\n                    }} />\r\n                )}\r\n              </div>\r\n              <div style={{\r\n                position: \"absolute\",\r\n                left: \"0px\",\r\n                bottom: \"0px\",\r\n                width: \"100%\",\r\n                height: \"3px\",\r\n                backgroundColor: \"white\",\r\n                display: props.albumCm.lastPageIndex > 0 ? \"block\" : \"none\"\r\n              }}>\r\n                <div style={{\r\n                  backgroundColor: \"DodgerBlue\",\r\n                  height: \"100%\",\r\n                  width: `${Helper.getPercent100(props.albumCm.lastPageIndex + 1, props.albumCm.pageCount)}%`\r\n                }} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <span style={{ fontSize: '12px', lineHeight: 1.1 }}>\r\n            {props.albumCm.fullTitle}\r\n          </span>\r\n        </div>\r\n      </Dropdown>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ColorFromIndex(tier, e) {\r\n  const top = { r: 34, g: 193, b: 195 };\r\n  const mid = { r: 142, g: 190, b: 121 };\r\n  const bot = { r: 253, g: 187, b: 45 };\r\n\r\n  const rgb = e === 3 ? top : e === 2 ? mid : bot;\r\n  const alpha = tier < e ? 0 : 1;\r\n\r\n  const color = `rgba(${rgb.r},${rgb.g},${rgb.b},${alpha})`;\r\n\r\n  return color;\r\n}\r\n\r\nfunction BorderFromIndex(tier, e) {\r\n  return tier > e && (e === 1 || e === 2) ? \"2px solid black\" : \"0px\";\r\n}\r\n\r\nfunction FlagIcon(props) {\r\n  const flagStyle = { width: \"18px\", height: \"12px\", marginRight: \"2px\", marginBottom: \"2px\" };\r\n\r\n  return (\r\n    <>\r\n      {\r\n        props.language === \"English\" ? <Flags.GB style={flagStyle} /> :\r\n          props.language === \"Japanese\" ? <Flags.JP style={flagStyle} /> :\r\n            props.language === \"Chinese\" ? <Flags.CN style={flagStyle} /> :\r\n              <Flags.ID style={flagStyle} />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyAlbumCard);","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Modal, Button, Menu, Input, Rate } from 'antd';\r\nimport { API_URL } from '../../Utilities/Config';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport { ArrowLeftOutlined, ArrowRightOutlined, DeleteOutlined, EditOutlined, ExclamationCircleOutlined, LineOutlined, FileSyncOutlined } from '@ant-design/icons';\r\n\r\n//import './MyReaderModal.scss';\r\n\r\nfunction MyReaderContextMenu(props) {\r\n  const [jumpValue, setJumpValue] = useState(0);\r\n  useEffect(() => {\r\n    setJumpValue(props.initialValue + 1);\r\n  }, [props.initialValue]);\r\n\r\n  useEffect(() => {\r\n    setNewPageName(props.pageName);\r\n  }, [props.pageName]);\r\n\r\n  const [showRenameModal, setShowRenameModal] = useState(false);\r\n  const [showConfirmDelete, setShowConfirmDelete] = useState(false);\r\n\r\n  const [tierDisplay, setTierDisplay] = useState(0);\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    setTierDisplay(props.albumCm.tier);\r\n  }, [props.albumCm]);\r\n\r\n  const [newPageName, setNewPageName] = useState(\"\");\r\n\r\n  if (props.albumCm === undefined) { return (<></>); }\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={props.visible}\r\n        onCancel={props.onCancel}\r\n        footer={null}\r\n        closable={false}\r\n        centered={true}\r\n        style={{ maxWidth: 300 }}\r\n      //bodyStyle={{ border: \"1px solid black\" }}\r\n      >\r\n        <Row>\r\n          <Col span={24} style={{ marginBottom: 15, textAlign: \"center\" }}>\r\n            <Rate\r\n              count={3}\r\n              value={tierDisplay}\r\n              onChange={(value) => { setTierDisplay(value); props.onTierChange(value); }}\r\n              style={{ fontSize: \"40px\" }}\r\n            />\r\n          </Col>\r\n          <Col span={24}>\r\n            <Button type=\"primary\" onClick={() => props.onRecount()} style={{ width: \"100%\" }}>\r\n              <FileSyncOutlined />Recount Pages\r\n            </Button>\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <input type=\"number\" value={jumpValue} onChange={(e) => setJumpValue(Math.min(Math.max(e.target.value, 1), props.albumCm.pageCount))} style={{ width: \"97%\", padding: \"4px\", WebkitBoxSizing: \"border-box\", borderRadius: \"5px\" }} />\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"right\", marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onJump(jumpValue - 1)} style={{ width: \"97%\", color: \"white\" }}>\r\n              <ArrowRightOutlined />Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onUndoJump()} style={{ width: \"100%\" }}>\r\n              <ArrowLeftOutlined />Undo Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => { props.onCancel(); setShowRenameModal(true); }} style={{ width: \"100%\" }}>\r\n              <EditOutlined />Rename Page\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"danger\" onClick={() => { props.onCancel(); setShowConfirmDelete(true); }} style={{ width: \"100%\" }}>\r\n              <DeleteOutlined />Delete Page\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Modal>\r\n      <Modal\r\n        visible={showRenameModal}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowRenameModal(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <Input.TextArea value={newPageName} onChange={(event) => setNewPageName(event.target.value)} rows={2} />\r\n        <Button type=\"primary\" onClick={() => { setShowRenameModal(false); props.onRename(newPageName); }} style={{ width: \"100%\" }}>\r\n          Rename\r\n        </Button>\r\n      </Modal>\r\n      <Modal\r\n        visible={showConfirmDelete}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowConfirmDelete(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <span style={{ color: \"white\" }}>Are you sure to delete this page?</span>\r\n        <Button type=\"danger\" onClick={() => { setShowConfirmDelete(false); props.onDelete(); }} style={{ width: \"100%\" }}>\r\n          Delete\r\n        </Button>\r\n      </Modal>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MyReaderContextMenu;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Drawer, Modal, Button, Menu, Input, Dropdown } from 'antd';\r\nimport {\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { API_URL } from '../../Utilities/Config';\r\n//import * as Helper from '../../Utilities/Helper';\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction MyChapterDrawer(props) {\r\n  const [chapters, setChapters] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(API_URL + `Crud/GetAlbumChapters?id=${props.albumId}`)\r\n      .then(function (response) {\r\n        setChapters(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handler = {\r\n    rename: (chapterTitle) => {\r\n      console.log(\"rename \", chapterTitle);\r\n    },\r\n    delete: (chapterTitle) => {\r\n      console.log(\"delete \", chapterTitle);\r\n      confirm({\r\n        title: `Delete chapter ${chapterTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   Yes   ',\r\n        okType: 'danger',\r\n        cancelText: '   No   ',\r\n        onOk() {\r\n          let encodedChapterTitle = encodeURIComponent(chapterTitle);\r\n          axios.delete(API_URL + `Crud/DeleteAlbumChapter/${props.albumId}/${encodedChapterTitle}`)\r\n            .then(function (response) {\r\n              console.log(\"newPageCount\", response.data);\r\n              props.onChapterDeleteSuccess(response.data);\r\n              setChapters(\r\n                chapters.filter(c => c.title !== chapterTitle)\r\n              );\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      placement=\"left\"\r\n      closable={false}\r\n      onClose={props.onClose}\r\n      visible={props.visible}\r\n    >\r\n      <div style={{ padding: \"10px\" }}>\r\n        {chapters.map((chapter, index) => (\r\n          <Row style={{ marginBottom: \"5px\" }} key={chapter.title}>\r\n            <Dropdown overlay={\r\n              <Menu>\r\n                <Menu.Item key=\"1\" onClick={() => handler.rename(chapter.title)}><EditOutlined />Rename</Menu.Item>\r\n                <Menu.Item key=\"2\" onClick={() => handler.delete(chapter.title)}><DeleteOutlined />Delete</Menu.Item>\r\n              </Menu>}\r\n              trigger={['contextMenu']}\r\n            >\r\n              <Col span={10} onClick={() => props.onJumpToPage(chapter.pageIndex)}>\r\n                <img\r\n                  style={{ objectFit: \"contain\", width: \"100%\", maxHeight: \"128px\", border: \"1px solid white\" }}\r\n                  src={API_URL + \"Media/StreamResizedImage?librelPathBase64=\" + chapter.pageUncPath + \"&maxSize=128\"}\r\n                  alt=\"img\"\r\n                >\r\n                </img>\r\n              </Col>\r\n            </Dropdown>\r\n            <Col span={14}>\r\n              <span style={{ color: \"white\" }}>{chapter.title}</span>\r\n            </Col>\r\n          </Row>\r\n        ))};\r\n      </div>\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyChapterDrawer);","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Drawer, Modal, Button, Menu, Input } from 'antd';\r\nimport { API_URL, IS_PUBLIC } from '../../Utilities/Config';\r\nimport * as Helper from '../../Utilities/Helper';\r\nimport { ArrowRightOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport MyReaderContextMenu from './MyReaderContextMenu';\r\nimport MyChapterDrawer from './MyChapterDrawer';\r\nimport loadingImg from '../../Resources/loading.gif';\r\n\r\nimport withMyAlert from '../../HOCs/withMyAlert';\r\nimport { useSwipeable } from 'react-swipeable';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction MyReaderModal(props) {\r\n  console.log(\"MyReaderModal render\");\r\n\r\n  const [apm, setApm] = useState({ //apm = album pagination model\r\n    id: null,\r\n    lpi: 0,\r\n    pages: [],\r\n    indexes: {\r\n      cPageI: 0,\r\n      pPageI: 0,\r\n      triad: \"zenpen\",\r\n      zenpenIndex: 0,\r\n      chuhenIndex: 0,\r\n      kouhenIndex: 0,\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    if (props.albumCm.albumId === apm.id) { return; }\r\n\r\n    axios.get(API_URL + \"File/GetAlbumPageInfos?id=\" + props.albumCm.albumId)\r\n      .then(function (response) {\r\n        setApm({\r\n          id: props.albumCm.albumId,\r\n          lpi: props.albumCm.lastPageIndex,\r\n          pages: response.data,\r\n          indexes: null\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        alert('GetAlbumPageInfos ' + error);\r\n      });\r\n  }, [props.albumCm]);\r\n\r\n  useEffect(() => {\r\n    const targetPage = apm.lpi < apm.pages.length ? apm.lpi : apm.pages.length - 1;\r\n\r\n    pageHandler.jumpTo(targetPage);\r\n  }, [apm.id]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"keydown\", handleKeyDown2, false);\r\n\r\n    return () => { //component will unmount\r\n      document.removeEventListener(\"keydown\", handleKeyDown2, false);\r\n    };\r\n  }, []);\r\n\r\n  const handleKeyDown2 = (event) => {\r\n    if (event.keyCode === 27) {\r\n      pageHandler.close();\r\n    }\r\n  };\r\n\r\n  //#region Event handlers\r\n  const pageHandler = {\r\n    jumpTo: function (page, renameObj) {\r\n      const maxIndex = apm.pages.length - 1;\r\n      const newPPageI = apm.indexes?.cPageI ?? 0;\r\n      const newCPageI = Helper.clamp(page, 0, maxIndex);\r\n\r\n      const { newTriad, zenpenIndex, chuhenIndex, kouhenIndex } = (() => {\r\n        function compose(newTriad, zenpenIndex, chuhenIndex, kouhenIndex) {\r\n          return {\r\n            newTriad,\r\n            zenpenIndex,\r\n            chuhenIndex,\r\n            kouhenIndex\r\n          };\r\n        }\r\n\r\n        function pageCeil(modifier) {\r\n          const pagesLen = apm.pages.length;\r\n          return (((newCPageI + modifier) % pagesLen) + pagesLen) % pagesLen;\r\n        }\r\n\r\n        if (newCPageI % 3 === 0) {\r\n          return compose(\"zenpen\", newCPageI, pageCeil(1), pageCeil(-1));\r\n        }\r\n        if (newCPageI % 3 === 1) {\r\n          return compose(\"chuhen\", pageCeil(-1), newCPageI, pageCeil(1));\r\n        }\r\n        if (newCPageI % 3 === 2) {\r\n          return compose(\"kouhen\", pageCeil(1), pageCeil(-1), newCPageI);\r\n        }\r\n      })();\r\n\r\n      let modifiedPages = apm.pages;\r\n      if (renameObj !== null && renameObj !== undefined) {\r\n        modifiedPages[renameObj.index] = renameObj.newPageInfo;\r\n      }\r\n\r\n      setApm({\r\n        indexes: {\r\n          cPageI: newCPageI,\r\n          pPageI: newPPageI,\r\n          triad: newTriad,\r\n          zenpenIndex: zenpenIndex,\r\n          chuhenIndex: chuhenIndex,\r\n          kouhenIndex: kouhenIndex\r\n        },\r\n        id: apm.id,\r\n        lpi: apm.lpi,\r\n        pages: modifiedPages,\r\n      });\r\n\r\n      if (apm.id != null && page === apm.pages.length - 1) {\r\n        axios.post(API_URL + \"Crud/UpdateAlbumOuterValue/\", {\r\n          albumId: apm.id,\r\n          lastPageIndex: page\r\n        })\r\n          .then((response) => {\r\n          })\r\n          .catch((error) => {\r\n            props.popApiError(error);\r\n          });\r\n      }\r\n    },\r\n    rename: (page, newName) => {\r\n      console.log(`rename page ${page} with name ${newName}`);\r\n      axios.post(API_URL + \"File/RenameFile\", {\r\n        albumId: apm.id,\r\n        pageIndex: page,\r\n        newName: newName\r\n      })\r\n        .then(function (response) {\r\n          const renameObj = {\r\n            index: page,\r\n            newPageInfo: response.data\r\n          };\r\n          console.log(renameObj);\r\n          pageHandler.jumpTo(apm.indexes.cPageI - 1, renameObj);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    delete: (page) => {\r\n      axios.delete(API_URL + `File/DeleteFile/${apm.id}/${page}`)\r\n        .then(function (response) {\r\n          props.onPageDeleteSuccess(apm.id, page);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    close: () => {\r\n      props.onClose(apm.id, apm.indexes.cPageI);\r\n    }\r\n  }\r\n\r\n  const albumHandler = {\r\n    tierChange: (value) => {\r\n      axios.put(API_URL + \"Crud/UpdateAlbumTier\", {\r\n        albumId: apm.id,\r\n        tier: value\r\n      })\r\n        .then(function (response) {\r\n          console.log(response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    recount: () => {\r\n      axios.post(API_URL + \"Crud/RecountAlbumPages\", {\r\n        albumId: apm.id\r\n      })\r\n        .then(function (response) {\r\n          console.log(\"new page count\", response.data);\r\n          props.onChapterDeleteSuccess(apm.id, response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const [showContextMenu, setShowContextMenu] = useState(false);\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n\r\n  const buttonHandler = {\r\n    rightTop: () => {\r\n      pageHandler.close();\r\n    },\r\n    rightMid: () => {\r\n      pageHandler.jumpTo(apm.indexes.cPageI + 1);\r\n    },\r\n    rightBot: () => {\r\n      pageHandler.jumpTo(apm.pages.length - 1);\r\n    },\r\n    midTop: () => {\r\n\r\n    },\r\n    midMid: () => {\r\n      setShowContextMenu(true);\r\n    },\r\n    midBot: () => {\r\n\r\n    },\r\n    leftTop: () => {\r\n      setShowDrawer(true);\r\n    },\r\n    leftMid: () => {\r\n      pageHandler.jumpTo(apm.indexes.cPageI - 1);\r\n    },\r\n    leftBot: () => {\r\n      pageHandler.jumpTo(0);\r\n    }\r\n  }\r\n\r\n  const swipeHandler = useSwipeable({\r\n    onSwipedLeft: (eventData) => { pageHandler.jumpTo(apm.indexes.cPageI + 1); },\r\n    onSwipedRight: (eventData) => { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n  });\r\n\r\n  //#endregion\r\n  const showGuide = IS_PUBLIC && apm.indexes !== null && apm.indexes.cPageI === 0;\r\n  const overlayStyle = getOverlayStyle(showGuide);\r\n  const buttonStyle = {\r\n    side: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.25 * window.innerHeight\r\n    },\r\n    mid: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.5 * window.innerHeight\r\n    }\r\n  }\r\n\r\n  if (apm.indexes === null || apm.pages.length === 0) { return (<></>); }\r\n\r\n  const currentPageInfo = apm.indexes.triad === \"zenpen\" ? apm.pages[apm.indexes.zenpenIndex]\r\n    : apm.indexes.triad === \"chuhen\" ? apm.pages[apm.indexes.chuhenIndex]\r\n      : apm.indexes.triad === \"kouhen\" ? apm.pages[apm.indexes.kouhenIndex]\r\n        : null;\r\n\r\n  const zenpenPage = <PageDisplay\r\n    id=\"zenpen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.zenpenIndex]}\r\n    queue={apm.indexes.triad === \"zenpen\" ? \"q0\" : apm.indexes.triad === \"kouhen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  const chuhenPage = <PageDisplay\r\n    id=\"chuhen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.chuhenIndex]}\r\n    queue={apm.indexes.triad === \"chuhen\" ? \"q0\" : apm.indexes.triad === \"zenpen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  const kouhenPage = <PageDisplay\r\n    id=\"kouhen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.kouhenIndex]}\r\n    queue={apm.indexes.triad === \"kouhen\" ? \"q0\" : apm.indexes.triad === \"chuhen\" ? \"q1\" : \"q2\"}\r\n  />;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"overlay overlay-reader\" style={{ display: props.isOpen ? \"block\" : \"none\", zIndex: 1 }}>\r\n        <div className=\"overlay-content\">\r\n          {zenpenPage}\r\n          {chuhenPage}\r\n          {kouhenPage}\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 2 }}>\r\n          <div className=\"overlay-content\">\r\n            <span className=\"with-shadow\">{currentPageInfo.name}</span>\r\n            <div style={{ position: \"fixed\", bottom: \"0px\", width: \"100%\", textAlign: \"center\" }}>\r\n              <span className=\"with-shadow\">{apm.indexes.cPageI + 1}/{apm.pages.length}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 3 }}>\r\n          <div style={overlayStyle.content} {...swipeHandler}>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Browse Chapters\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midTop} style={buttonStyle.side}>\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Close Album\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Previous Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Context Menu\")}\r\n                </div>\r\n                <MyReaderContextMenu\r\n                  albumCm={props.albumCm}\r\n                  initialValue={apm.indexes.cPageI}\r\n                  pageName={currentPageInfo.name}\r\n                  onTierChange={albumHandler.tierChange}\r\n                  onRecount={() => { albumHandler.recount(); setShowContextMenu(false); }}\r\n                  onJump={(page) => { pageHandler.jumpTo(page); setShowContextMenu(false); }}\r\n                  onUndoJump={() => { pageHandler.jumpTo(apm.indexes.pPageI); setShowContextMenu(false); }}\r\n                  visible={showContextMenu}\r\n                  onRename={(value) => { pageHandler.rename(apm.indexes.cPageI, value); setShowContextMenu(false); }}\r\n                  onDelete={() => { pageHandler.delete(apm.indexes.cPageI); setShowContextMenu(false); }}\r\n                  onCancel={() => setShowContextMenu(false)}\r\n                />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Next Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"First Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midBot} style={buttonStyle.side} />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Last Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <MyChapterDrawer\r\n        visible={showDrawer}\r\n        onClose={() => setShowDrawer(false)}\r\n        albumId={apm.id}\r\n        onJumpToPage={pageHandler.jumpTo}\r\n        onChapterDeleteSuccess={(newPageCount) => props.onChapterDeleteSuccess(apm.id, newPageCount)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst getOverlayStyle = (isGrey) => {\r\n  const result = {\r\n    content: {\r\n      position: 'relative',\r\n      top: '0%',\r\n      width: '100%',\r\n      textAlign: 'center',\r\n      backgroundColor: isGrey ? 'rgba(200, 200, 200, 0.3)' : 'rgba(0, 0, 0, 0)'\r\n    },\r\n    button: {\r\n      position: 'relative',\r\n      boxSizing: 'border-box',\r\n      border: isGrey ? '1px solid black' : '0px'\r\n    }\r\n  };\r\n\r\n  return result;\r\n}\r\n\r\nconst getGuideLabel = (isGrey, text) => {\r\n  return isGrey ?\r\n    <span style={{ textAlign: \"center\", margin: \"auto\", textShadow: \"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black\" }}>\r\n      {text}\r\n    </span> :\r\n    \"\";\r\n}\r\n\r\nfunction PageDisplay(props) {\r\n  const styleShow = { objectFit: \"contain\", height: window.innerHeight, width: window.innerWidth };\r\n  const styleHide = { objectFit: \"contain\", height: 0, width: 0, position: \"absolute\" };\r\n  //const styleShow = { height: 300, width: 300 };\r\n  //const styleHide = { height: 150, width: 150 };\r\n\r\n  if (IsVideo(props.pageInfo.extension)) {\r\n    return (\r\n      <video\r\n        autoPlay loop\r\n        id={props.id}\r\n        style={props.queue === \"q0\" ? styleShow : styleHide}\r\n        src={props.queue === \"q0\" ? API_URL + \"Media/StreamPage?albumId=\" + props.albumId + \"&alRelPathBase64=\" + props.pageInfo.uncPathEncoded : \"\"}\r\n      >\r\n        video not showing\r\n      </video>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <img\r\n      id={props.id}\r\n      style={props.queue === \"q0\" ? styleShow : styleHide}\r\n      src={props.queue === \"q0\" || props.queue === \"q1\" ? API_URL + \"Media/StreamPage?albumId=\" + props.albumId + \"&alRelPathBase64=\" + props.pageInfo.uncPathEncoded : loadingImg}\r\n      alt=\"Not loaded\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction IsVideo(extension) {\r\n  if (extension === \".webm\" || extension === \".mp4\") {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default withMyAlert(MyReaderModal);","import React from 'react';\r\nimport { Input } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputTextbox(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Input\r\n            placeholder={props.placeholder}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputTextbox;","import React from 'react';\r\nimport { Rate } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputStar(props) {\r\n  function handleChange(value) {\r\n    props.onChange(props.label, value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Rate\r\n            count={3}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputStar;","import React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputRadio(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Radio.Group onChange={handleChange} value={props.value} style={{ width: \"100%\" }}>\r\n            <Row>\r\n              {props.items.map(item => (\r\n                <Col span={8} key={item}>\r\n                  <Radio key={item} value={item}><span style={{ color: \"white\" }}>{item}</span></Radio>\r\n                </Col>\r\n              ))}\r\n            </Row>\r\n          </Radio.Group>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputRadio;","import React from 'react';\r\nimport { Checkbox } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputCheck(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.checked);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Checkbox onChange={handleChange} checked={props.value} />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputCheck;","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputMulticheck(props) {\r\n\r\n  function handleClick(label) {\r\n    props.onChange(props.label, label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Row gutter={2}>\r\n            {props.items.map((item) => (\r\n              <Col span={8} key={item}>\r\n                <Button\r\n                  key={item}\r\n                  type={props.value.includes(item) ? \"primary\" : \"link\"}\r\n                  ghost={props.value.includes(item) ? true : false}\r\n                  onClick={() => handleClick(item)}\r\n                  style={{ width: \"100%\", textAlign: \"left\", marginBottom: \"2px\" }}\r\n                >\r\n                  {item}\r\n                </Button>\r\n              </Col>)\r\n            )}\r\n          </Row>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputMulticheck;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Row, Col, Modal, Button } from 'antd';\r\nimport { API_URL } from '../Utilities/Config';\r\nimport * as Helper from '../Utilities/Helper';\r\nimport MyInputTextbox from './Editors/MyInputTextbox';\r\nimport MyInputStar from './Editors/MyInputStar';\r\nimport MyInputRadio from './Editors/MyInputRadio';\r\nimport MyInputCheck from './Editors/MyInputCheck';\r\nimport MyInputMulticheck from './Editors/MyInputMulticheck';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\n\r\nimport useSWR from 'swr';\r\n\r\n//import * as DataSource from \"../Data/DataSource\";\r\n\r\nconst lodash = require('lodash/array');\r\nconst axios = require('axios').default;\r\n\r\nfunction MyEditModal(props) {\r\n  const { data: albumInfo, error: aiError } = useSWR(\"Crud/GetAlbumInfo\");\r\n\r\n  const [albumVm, setAlbumVm] = useState({\r\n    albumId: \"\",\r\n    path: \"\", //not updated\r\n    pageCount: 0, //not updated\r\n    lastPageIndex: 0, //not updated\r\n    album: {\r\n      title: \"\",\r\n      category: \"Manga\",\r\n      orientation: \"Portrait\",\r\n      artists: [],\r\n      tags: [],\r\n      languages: [],\r\n      flags: [],\r\n      tier: 0,\r\n      cover: \"\",\r\n      isWip: false,\r\n      isRead: false,\r\n      entryDate: null\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(API_URL + \"Crud/GetAlbumVm?id=\" + props.albumId)\r\n      .then(function (response) {\r\n        console.log(\"GetAlbumVm response.data\", response.data);\r\n        setAlbumVm(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handlers = {\r\n    albumVmChange: function (label, value) {\r\n      let newAlbumVm = { ...albumVm };\r\n      let cleanedValue = value;\r\n      if (label === \"Artists\" || label === \"Flags\") {\r\n        cleanedValue = value.split(\",\");\r\n      }\r\n      else if (label === \"Tags\" || label === \"Languages\") {\r\n        cleanedValue = albumVm.album[Helper.firstLetterLowerCase(label)];\r\n        if (cleanedValue.includes(value)) {\r\n          cleanedValue = lodash.pull(cleanedValue, value);\r\n        }\r\n        else {\r\n          cleanedValue.push(value);\r\n        }\r\n      }\r\n      newAlbumVm.album[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n      setAlbumVm(newAlbumVm);\r\n    },\r\n    ok: function () {\r\n      props.onOk(albumVm);\r\n    },\r\n    cancel: function () {\r\n      props.onCancel();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Edit Metadata\"\r\n      visible={props.isOpen}\r\n      onOk={handlers.ok}\r\n      onCancel={handlers.cancel}\r\n    >\r\n      {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n        <>\r\n          <MyInputTextbox label=\"Title\" value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={albumVm.album.flags.join()} onChange={handlers.albumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={albumVm.album.isRead} onChange={handlers.albumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={albumVm.album.isWip} onChange={handlers.albumVmChange} />\r\n        </>\r\n      )}\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyEditModal);","import React, { useState, useEffect, useRef } from 'react';\r\nimport { API_URL } from '../Utilities/Config';\r\n\r\nimport MyAlbumCard from '../Components/Displays/MyAlbumCard';\r\nimport { Row, Col } from 'antd';\r\nimport MyReaderModal from '../Components/Displays/MyReaderModal';\r\n//import * as Helper from '../Utilities/Helper';\r\nimport MyEditModal from '../Components/MyEditModal';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction AlbumList(props) {\r\n  //#region Display Album List\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const encodedQuery = (props.query !== undefined) ? encodeURIComponent(props.query) : \"\";\r\n\r\n    axios.get(API_URL + \"Crud/GetAlbumCardModels?page=0&row=0&query=\" + encodedQuery)\r\n      .then((response) => {\r\n        setAlbumCms(response.data);\r\n      })\r\n      .catch((error) => {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.query]);\r\n  //#endregion\r\n\r\n  //#region Display Album Pages\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n  const [selectedAlbumId, setSelectedAlbumId] = useState({});\r\n\r\n  const readerHandler = {\r\n    view: (albumCm) => {\r\n      setSelectedAlbumId(albumCm.albumId);\r\n      setReaderModalIsOpen(true);\r\n    },\r\n\r\n    close: (albumId, lastPageIndex) => {\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(API_URL + \"Crud/UpdateAlbumOuterValue/\", {\r\n        albumId: albumId,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then((response) => {\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex,\r\n          isRead: lastPageIndex === albumCm.pageCount - 1 ? true : albumCm.isRead\r\n        };\r\n      }));\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Edit Delete\r\n  const [editModalIsOpen, setEditModalIsOpen] = useState(false);\r\n  const [editedAlbumId, setEditedAlbumId] = useState(undefined);\r\n\r\n  const crudHandler = {\r\n    edit: (albumId) => {\r\n      console.log(\"edit album\" + albumId);\r\n      setEditModalIsOpen(true);\r\n      setEditedAlbumId(albumId);\r\n    },\r\n    delete: (albumId) => {\r\n      setAlbumCms(albumCms.filter(albumCm => {\r\n        return albumCm.albumId !== albumId;\r\n      }));\r\n    },\r\n    pageDeleteSuccess: (albumId, page) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1,\r\n          lastPageIndex: page\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (albumId, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const editHandler = {\r\n    ok: (editedAlbumVm) => {\r\n      setEditModalIsOpen(false);\r\n\r\n      axios.post(API_URL + \"Crud/UpdateAlbum/\", editedAlbumVm)\r\n        .then((response) => {\r\n          console.log(\"edit success. Id: \", response.data);\r\n\r\n          let newAlbumCms = [...albumCms];\r\n          let editedAlbumVmIndex = newAlbumCms.findIndex(a => a.albumId === editedAlbumVm.albumId);\r\n          newAlbumCms[editedAlbumVmIndex].fullTitle = `[${editedAlbumVm.album.artists.join(', ')}] ${editedAlbumVm.album.title}`;\r\n          newAlbumCms[editedAlbumVmIndex].languages = editedAlbumVm.album.languages;\r\n          setAlbumCms(newAlbumCms);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    cancel: () => {\r\n      setEditModalIsOpen(false);\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={0} type=\"flex\">\r\n        {albumCms.map((a, index) => (\r\n          <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n            <MyAlbumCard\r\n              index={index}\r\n              albumCm={a}\r\n              onView={readerHandler.view}\r\n              onEdit={crudHandler.edit}\r\n              onDelete={crudHandler.delete}\r\n              showContextMenu={true}\r\n            />\r\n          </Col>\r\n        ))}\r\n      </Row>\r\n\r\n      <MyReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={albumCms.find(aCm => aCm.albumId === selectedAlbumId)}\r\n      />\r\n      <MyEditModal\r\n        isOpen={editModalIsOpen}\r\n        albumId={editedAlbumId}\r\n        onOk={editHandler.ok}\r\n        onCancel={editHandler.cancel}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(AlbumList);","import { API_URL } from '../Utilities/Config';\r\nimport * as Helper from '../Utilities/Helper';\r\n\r\nconst axios = require('axios').default;\r\n\r\nvar albumInfo = null;\r\n\r\n//#region AlbumInfo\r\nexport const GetAlbumInfo = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo;\r\n}\r\n\r\nexport const GetTags = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.tags;\r\n}\r\nexport const GetCategories = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.categories;\r\n}\r\nexport const GetOrientations = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.orientations;\r\n}\r\nexport const GetLanguages = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.languages;\r\n}\r\n\r\nasync function FetchAlbumInfo() {\r\n  console.log(\"FetchAlbumInfo called\");\r\n  const res = await fetch(API_URL + \"Crud/GetAlbumInfo\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region Queries\r\nvar tagVMs = null;\r\nexport const GetTagVMs = async () => {\r\n  if (tagVMs === null) {\r\n    tagVMs = await FetchTagVMs();\r\n  }\r\n  return tagVMs;\r\n}\r\n\r\nasync function FetchTagVMs() {\r\n  const res = await fetch(API_URL + \"Crud/GetTagVMs\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region AlbumViewer\r\nexport const GetAlbumVMs = (page, row, query) => {\r\n  let encodedQuery = (typeof query !== 'undefined') ? encodeURIComponent(query) : \"\";\r\n  let queryString = \"?page=\" + page + \"&row=\" + row + \"&query=\" + encodedQuery;\r\n\r\n  axios.get(API_URL + \"Crud/GetAlbums\" + queryString)\r\n    .then(function (response) {\r\n      return response.data;\r\n    })\r\n    .catch(function (error) {\r\n      Helper.apiErrorHandler(error);\r\n    });\r\n\r\n  // async function FetchAlbums() {\r\n  //   const res = await fetch(API_URL + \"Crud/GetAlbums\" + queryString, {\r\n  //     method: 'GET',\r\n  //     //headers: '',\r\n  //     mode: 'cors',\r\n  //     cache: 'default'\r\n  //   });\r\n  //   return res.json();\r\n  // };\r\n\r\n  // let result = await FetchAlbums();\r\n  // return result;\r\n}\r\n//#endregion\r\n\r\nexport const InsertAlbum = async (albumVm) => {\r\n  const res = await fetch(API_URL + \"Crud/InsertAlbum\", {\r\n    method: 'POST',\r\n    body: JSON.stringify(albumVm),\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    }\r\n  });\r\n  return await res.json();\r\n}","import React from 'react';\r\nimport { Button, Row, Col } from 'antd';\r\n\r\nfunction MyInputButton(props) {\r\n  function handleClick(event) {\r\n    props.onClick(props.label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Button onClick={handleClick}>{props.label}</Button>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputButton;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport MyInputTextbox from '../Components/Editors/MyInputTextbox';\r\nimport { Button, Row, Col, Upload } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport MyInputRadio from '../Components/Editors/MyInputRadio';\r\nimport MyInputMulticheck from '../Components/Editors/MyInputMulticheck';\r\nimport MyInputCheck from '../Components/Editors/MyInputCheck';\r\nimport MyInputStar from '../Components/Editors/MyInputStar';\r\n\r\nimport * as DataSource from \"../Data/DataSource\";\r\nimport * as Helper from \"../Utilities/Helper\";\r\nimport MyInputButton from '../Components/Editors/MyInputButton';\r\n\r\nvar lodash = require('lodash/array');\r\n\r\n\r\nfunction AlbumAddEdit(props) {\r\n  const [FolderName, setFolderName] = useState(\"\");\r\n  const [Files, setFiles] = useState([]);\r\n  const [AlbumVm, setAlbumVm] = useState({\r\n    title: \"\",\r\n    category: \"Manga\",\r\n    orientation: \"Portrait\",\r\n    artists: [],\r\n    tags: [],\r\n    languages: [],\r\n    flags: [],\r\n    tier: 0,\r\n    cover: \"\",\r\n    isWip: false,\r\n    isRead: false,\r\n    entryDate: null\r\n  });\r\n\r\n  const [Tags, setTags] = useState([]);\r\n  const [Categories, setCategories] = useState([]);\r\n  const [Orientations, setOrientations] = useState([]);\r\n  const [Languages, setLanguages] = useState([]);\r\n\r\n  var webkit;\r\n\r\n  useEffect(() => {\r\n    async function FetchAlbumInfo() {\r\n      let _tag = await DataSource.GetTags();\r\n      let _categories = await DataSource.GetCategories();\r\n      let _orientations = await DataSource.GetOrientations();\r\n      let _languages = await DataSource.GetLanguages();\r\n      setTags(_tag);\r\n      setCategories(_categories);\r\n      setOrientations(_orientations);\r\n      setLanguages(_languages);\r\n    }\r\n    FetchAlbumInfo();\r\n\r\n    webkit = document.getElementById(\"myInput\");\r\n    webkit.onchange = function () {\r\n      console.log(webkit);\r\n      setFiles(webkit.files);\r\n      // var files = webkit.files,\r\n      //   len = files.length,\r\n      //   i;\r\n      // for (i = 0; i < len; i += 1) {\r\n      //   //console.log(files[i]);\r\n      // }\r\n    };\r\n  }, []);\r\n\r\n  function handleAlbumVmChange(label, value) {\r\n    let newAlbumVm = { ...AlbumVm };\r\n    let cleanedValue = value;\r\n    if (label === \"Artists\" || label === \"Flags\") {\r\n      cleanedValue = value.split(\",\");\r\n    }\r\n    else if (label === \"Tags\" || label === \"Languages\") {\r\n      cleanedValue = AlbumVm[Helper.firstLetterLowerCase(label)];\r\n      if (cleanedValue.includes(value)) {\r\n        cleanedValue = lodash.pull(cleanedValue, value);\r\n      }\r\n      else {\r\n        cleanedValue.push(value);\r\n      }\r\n    }\r\n    newAlbumVm[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n    setAlbumVm(newAlbumVm);\r\n  }\r\n\r\n  function handleLogAlbum(event) {\r\n    console.log(AlbumVm);\r\n  }\r\n  function handleSubmit(event) {\r\n    console.log(event);\r\n  }\r\n\r\n  function logWebkitFiles() {\r\n    // for (let i = 0; i < Files.length; i++) {\r\n    //   var reader = new FileReader();\r\n    //   reader.onload = function (e) {\r\n    //     var object = new Object();\r\n    //     object.content = e.target.content;\r\n    //     var json_upload = \"jsonObject=\" + JSON.stringify(object);\r\n\r\n    //     console.log(\"what is e\", e);\r\n    //     console.log(\"what is json_u\", json_upload);\r\n    //   }\r\n    //   reader.readAsBinaryString(Files);\r\n    // }\r\n    console.log(Files[0]);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Add edit page</h3>\r\n      <br />\r\n      <Row justify=\"start\" align=\"middle\" gutter={[16, 24]}>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <MyInputTextbox label=\"Title\" value={AlbumVm.title} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={AlbumVm.artists.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={AlbumVm.category} items={Categories} onChange={handleAlbumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={AlbumVm.tier} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={AlbumVm.flags.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={AlbumVm.tags} items={Tags} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={AlbumVm.orientation} items={Orientations} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={AlbumVm.languages} items={Languages} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={AlbumVm.isRead} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={AlbumVm.isWip} onChange={handleAlbumVmChange} />\r\n          <Button onClick={() => logWebkitFiles()}>Log Webkit Files</Button>\r\n          <MyInputButton label=\"Insert Album\" onClick={handleSubmit} />\r\n          {/* <Upload directory>\r\n            <Button>\r\n              <UploadOutlined /> Select Folder\r\n            </Button>\r\n          </Upload> */}\r\n          <input id=\"myInput\" type=\"file\" webkitdirectory=\"true\" directory multiple />\r\n        </Col>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <p>placeholder for image</p>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AlbumAddEdit;","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport MyAlbumCard from '../Components/Displays/MyAlbumCard';\r\nimport { Row, Col } from 'antd';\r\nimport useSWR from 'swr';\r\n//first commit after github username changes\r\n\r\nfunction GenreList(props) {\r\n  const endpoint = props.page === \"Genres\" ? \"Crud/GetGenreCardModels\" :\r\n    props.page === \"Artists\" ? \"Crud/GetArtistCardModels?tier=1\" :\r\n      \"NotFound\";\r\n\r\n  const { data: albumCGroups, error } = useSWR(endpoint);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!albumCGroups) { return <div>loading...</div>; }\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      console.log(\"query click\", albumCm);\r\n      props.history.push('/albums?query=' + albumCm.albumId)\r\n    },\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {albumCGroups.map((acg, index) => (\r\n        <Row key={\"acgRow\" + acg.name} gutter={0} type=\"flex\" style={{ border: \"1px solid rgb(83, 83, 83)\", borderRadius: \"8px\", paddingTop: \"8px\", marginBottom: \"5px\" }}>\r\n          { props.page === \"This feature is cancelled\" ? (\r\n            <div style={{ position: \"relative\" }}>\r\n              <div style={{ position: \"absolute\", top: \"-18px\", left: \"10px\" }}>{acg.name}</div>\r\n            </div>) : \"\"\r\n          }\r\n          {acg.albumCms.map((a) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={() => { }}\r\n                onDelete={() => { }}\r\n                showContextMenu={false}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default GenreList;","import React, { useState } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport { Row, Col } from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  MinusOutlined\r\n} from '@ant-design/icons';\r\n\r\nfunction MyTagMenuItem(props) {\r\n  let encodedQuery = encodeURIComponent(props.tag.query);\r\n\r\n  const plusBackground = props.selectStatus === \"plus\" ? \"#1890ff\" : \"\";\r\n  const minusBackground = props.selectStatus === \"minus\" ? \"#1890ff\" : \"\";\r\n\r\n  return (\r\n    <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n      <Row>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onPlus(props.tag.name)}><PlusOutlined style={{ marginRight: \"0px\", backgroundColor: plusBackground }} /></Col>\r\n        <Link to={\"/albums?query=\" + encodedQuery} >\r\n          <Col span={14}>\r\n            <span style={{ fontSize: \"12px\" }}>{props.tag.name}</span>\r\n          </Col>\r\n        </Link>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onMinus(props.tag.name)}><MinusOutlined style={{ marginRight: \"0px\", backgroundColor: minusBackground }} /></Col>\r\n      </Row>\r\n    </li>\r\n  );\r\n}\r\n\r\nexport default MyTagMenuItem;","import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Modal, Input, Button } from 'antd';\r\nimport {\r\n  ConsoleSqlOutlined,\r\n  SearchOutlined\r\n} from '@ant-design/icons';\r\nimport TextArea from 'antd/lib/input/TextArea';\r\n\r\nfunction MyQueryEditor(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(props.query);\r\n  }, [props.query]);\r\n\r\n  function handleOk() {\r\n    setVisible(false);\r\n    props.onOk(query);\r\n  }\r\n\r\n  return (\r\n    <div style={{ paddingLeft: \"24px\" }}>\r\n      <Button type=\"link\" onClick={() => setVisible(true)} style={{ width: \"90%\", textAlign: \"left\", padding: \"0px\" }}>\r\n        <ConsoleSqlOutlined />Query Editor\r\n      </Button>\r\n      <Modal\r\n        visible={visible}\r\n        onCancel={() => setVisible(false)}\r\n        closable={false}\r\n        footer={\r\n          <Button type=\"primary\" onClick={handleOk}>\r\n            <SearchOutlined />Search\r\n          </Button>\r\n        }\r\n      >\r\n        <TextArea onChange={(event) => setQuery(event.target.value)} value={query} autoSize={{ minRows: 2, maxRows: 5 }} />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MyQueryEditor;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport queryString from 'query-string';\r\nimport { API_URL } from './Utilities/Config';\r\nimport { DesktopOnly, MobileOnly } from './Utilities/Display';\r\n\r\nimport { Layout, Menu, Drawer, Button, Row, Col, Input } from 'antd';\r\nimport {\r\n  DesktopOutlined,\r\n  TeamOutlined,\r\n  PartitionOutlined,\r\n  TagsOutlined,\r\n  ReloadOutlined,\r\n  SyncOutlined,\r\n  DatabaseOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport AlbumList from './Pages/AlbumList';\r\nimport AlbumAddEdit from './Pages/AlbumAddEdit';\r\nimport GenreList from './Pages/GenreList';\r\nimport MyTagMenuItem from './Components/MyTagMenuItem';\r\n\r\nimport * as Helper from \"./Utilities/Helper\";\r\nimport withMyAlert from \"./HOCs/withMyAlert\";\r\nimport MyQueryEditor from './Components/Editors/MyQueryEditor';\r\n\r\nimport useSWR, { SWRConfig } from 'swr';\r\n\r\nconst axios = require('axios').default;\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\n//const fetcher = (endpoint) => fetch(API_URL + endpoint).then(res => res.json());\r\n\r\nfunction MasterPage(props) {\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n  const [collapseSider, setCollapseSider] = useState(false);\r\n\r\n  let querStr = queryString.parse(props.location.search).query ?? \"\";\r\n\r\n  let page;\r\n  let selectedMenu;\r\n  if (props.page === \"Albums\") {\r\n    page = <AlbumList query={querStr} />;\r\n    selectedMenu = '2';\r\n  }\r\n  else if (props.page === \"AlbumAddEdit\") {\r\n    page = <AlbumAddEdit />;\r\n    selectedMenu = '1';\r\n  }\r\n  else if (props.page === \"Artists\") {\r\n    page = <GenreList page={props.page} history={props.history} />;\r\n    selectedMenu = '3';\r\n  }\r\n  else if (props.page === \"Genres\") {\r\n    page = <GenreList page={props.page} history={props.history} />;\r\n    selectedMenu = '4';\r\n  }\r\n\r\n  const queryHandler = {\r\n    search: function (query) {\r\n      let correctedQuery = Helper.contains(query.split(\",\")[0], [\":\", \"!\", \">\", \"<\"]) ? query : 'title:' + query;\r\n      queryHandler.goToAlbumList(correctedQuery);\r\n    },\r\n    plus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      let currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryPlus);\r\n      let newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    minus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      let currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryMinus);\r\n      let newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    goToAlbumList: function (query) {\r\n      let currentUrlParams = new URLSearchParams(window.location.search);\r\n      currentUrlParams.set('query', query);\r\n      props.history.push(\"Albums?\" + currentUrlParams.toString());\r\n    }\r\n  }\r\n\r\n  const actionHandler = {\r\n    reload: () => {\r\n      axios.get(API_URL + \"Crud/ReloadDatabase\")\r\n        .then((response) => {\r\n          props.popInfo(\"ReloadDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    },\r\n    rescan: () => {\r\n      axios.get(API_URL + \"Crud/RescanDatabase\")\r\n        .then((response) => {\r\n          props.popInfo(\"RescanDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    }\r\n  }\r\n\r\n  const menuContent = (\r\n    <>\r\n      <div className=\"logo\"></div>\r\n      <MyQueryEditor query={querStr} onOk={(query) => queryHandler.goToAlbumList(query)} />\r\n      <Menu theme=\"dark\" defaultSelectedKeys={[selectedMenu]} defaultOpenKeys={[\"sub1\"]} mode=\"inline\">\r\n        <Menu.Item key=\"2\">\r\n          <Link to=\"/albums\">\r\n            <DesktopOutlined />\r\n            <span>Albums</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"3\">\r\n          <Link to=\"/artists\">\r\n            <TeamOutlined />\r\n            <span>Artists</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"4\">\r\n          <Link to=\"/genres\">\r\n            <PartitionOutlined />\r\n            <span>Genres</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <SubMenu key=\"sub1\" title={<><TagsOutlined /><span>Tags</span></>} >\r\n          <TagItemsContainer onPlus={queryHandler.plus} onMinus={queryHandler.minus} querStr={querStr} />\r\n        </SubMenu>\r\n        <SubMenu key=\"sub2\" title={<><DatabaseOutlined /><span>Actions</span></>} >\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.reload}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><ReloadOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Reload Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.rescan}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><SyncOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Rescan Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n        </SubMenu>\r\n      </Menu>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <SWRConfig value={{ revalidateOnFocus: false, fetcher: (endpoint) => fetch(API_URL + endpoint).then(res => res.json()) }}>\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <MobileOnly>\r\n          <Layout style={{ position: 'fixed', zIndex: 1, width: '100%', backgroundColor: '#001529' }}>\r\n            <div style={{ textAlign: \"end\", lineHeight: 0 }}>\r\n              <div className=\"hamburger-container\" onClick={() => setShowDrawer(true)}>\r\n                <MenuIcon style={{ fontSize: '32px' }} />\r\n              </div>\r\n            </div>\r\n          </Layout>\r\n          <Drawer\r\n            placement=\"right\"\r\n            closable={false}\r\n            onClose={() => setShowDrawer(false)}\r\n            visible={showDrawer}\r\n          >\r\n            {menuContent}\r\n          </Drawer>\r\n        </MobileOnly>\r\n        <DesktopOnly>\r\n          <Sider collapsible collapsed={collapseSider} onCollapse={(event) => setCollapseSider(event)}>\r\n            {menuContent}\r\n          </Sider>\r\n        </DesktopOnly>\r\n\r\n        <Layout className=\"site-layout\">\r\n          <Content>\r\n            <MobileOnly>\r\n              <div style={{ paddingTop: \"5x\" }}>Padding for mobile</div>\r\n            </MobileOnly>\r\n            <div className=\"site-layout-background\" style={{ paddingTop: 36, paddingLeft: 10, paddingRight: 10, minHeight: 360 }}>\r\n              {page}\r\n            </div>\r\n          </Content>\r\n          <Footer style={{ textAlign: 'center' }}>-----------------</Footer>\r\n        </Layout>\r\n      </Layout>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(MasterPage));\r\n\r\nfunction TagItemsContainer(props) {\r\n  const { data: tags, error } = useSWR(\"Crud/GetTagVMs\");\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!tags) { return <div>loading...</div>; }\r\n\r\n  return (\r\n    <>\r\n      {tags.map((tag, index) => (<MyTagMenuItem key={tag.name} tag={tag} onPlus={props.onPlus} onMinus={props.onMinus} selectStatus={getSelectStatus(tag.name, props.querStr)} />))}\r\n    </>\r\n  )\r\n}\r\n\r\nfunction getSelectStatus(tagName, query) {\r\n  let queryArr = query.split(',');\r\n  let result = queryArr.filter((str) => str.toLowerCase().includes(\"tag:\" + tagName.toLowerCase())).length > 0 ? \"plus\" :\r\n    queryArr.filter((str) => str.toLowerCase().includes(\"tag!\" + tagName.toLowerCase())).length > 0 ? \"minus\" :\r\n      \"none\";\r\n\r\n  return result;\r\n}","import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport './App.scss';\r\nimport { BrowserRouter, MemoryRouter, HashRouter, Route, Switch, Link, Redirect } from 'react-router-dom';\r\n\r\nimport MasterPage from './MasterPage';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route exact path=\"/\" ><Redirect to=\"/genres\" /></Route>\r\n          <Route exact path=\"/albums\" ><MasterPage page=\"Albums\" /></Route>\r\n          <Route exact path=\"/add\" ><MasterPage page=\"AlbumAddEdit\" /></Route>\r\n          <Route exact path=\"/artists\" ><MasterPage page=\"Artists\" /></Route>\r\n          <Route exact path=\"/genres\" ><MasterPage page=\"Genres\" /></Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nconst startApp = () => {\r\n  ReactDOM.render(<App isCordova={true} />, document.getElementById('root'));\r\n  serviceWorker.unregister();\r\n}\r\n\r\nif (window.cordova) {\r\n  document.addEventListener('deviceready', startApp, false);\r\n}\r\nelse {\r\n  startApp();\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA"],"sourceRoot":""}