{"version":3,"sources":["_shared/HOCs/withMyAlert.js","_utils/Helper.js","_utils/Config.js","_utils/UriHelper.js","_shared/Displays/MyAlbumCard.js","_shared/Modals/TextDialog.js","_shared/Modals/DirNodeDialog.js","_shared/ReaderModal/ReaderModalContextMenu.js","_shared/ReaderModal/ReaderModalChapterDrawer.js","_shared/HOCs/withPageManager.js","_shared/ReaderModal/ReaderModal.js","SelfComps/SelfComps.js","_shared/Editors/MyInputTextbox.js","_shared/Editors/MyInputStar.js","_shared/Editors/MyInputRadio.js","_shared/Editors/MyInputCheck.js","_shared/Editors/MyInputMulticheck.js","Albums/EditModal.js","_utils/Display.js","Albums/Albums.js","Genres/Genres.js","FileManagement/FileManagement.js","Setting/Setting.js","AppMasterPage.js","App.js","serviceWorker.js","index.js","_resources/loading.gif"],"names":["withMyAlert","OriginalComponent","props","popInfo","title","stringContent","objContent","Modal","info","content","JSON","stringify","onOk","width","popError","error","popApiError","response","undefined","status","statusText","data","warning","toString","firstLetterLowerCase","string","charAt","toLowerCase","slice","getPercent100","value","maxValue","fraction","clamp","number","min","max","Math","pathJoin","parts","sep","validParts","filter","e","separator","replace","RegExp","join","formatDate","date","Date","toLocaleString","publicMediaUrl","apiBaseUrl","mediaBaseUrl","resMediaBaseUrl","main","sc","media","resMedia","withBase","type","endpoint","GetAlbumCardModels","page","row","query","cleanQuery","encodeURIComponent","GetLibraryDirNodes","UpdateAlbumOuterValue","RefreshAlbum","path","cleanPath","GetAlbumPageInfos","includeDetail","RescanDatabase","QuickScan","CleanLibrary","StreamPage","libRelPath","cleanType","cleanLibRelPath","toISOString","StreamResizedImage","maxSize","cleanLibrelPath","EditMenuInbetweener","useEffect","onVisible","ColorFromIndex","tier","rgb","r","g","b","alpha","BorderFromIndex","FlagIcon","flagStyle","height","marginRight","marginBottom","language","GB","style","JP","CN","ID","handler","view","onView","albumCm","edit","onEdit","useInView","threshold","rootMargin","ref","inView","menu","paddingBottom","position","textAlign","overlay","trigger","disabled","showContextMenu","display","maxWidth","borderLeft","isRead","onClick","objectFit","src","_uri","coverInfo","uncPathEncoded","alt","left","top","borderRight","borderBottom","right","bottom","color","lineHeight","languages","map","item","i","key","backgroundColor","borderTop","lastPageIndex","Helper","pageCount","note","className","fontSize","fullTitle","TextDialog","useState","setValue","initialValue","visible","footer","centered","closable","onCancel","onClose","TextArea","onChange","event","target","rows","btnText","axios","require","default","TreeNode","Tree","DirectoryTree","nodes","setNodes","selected","setSelected","get","then","catch","treeHandlers","loadData","treeNode","Promise","resolve","childs","dataRef","name","prev","select","MyDirTree","onLoadData","onSelect","keys","renderTreeNodes","ReaderModalContextMenu","jumpValue","setJumpValue","changeJumpValue","val","showRenameModal","setShowRenameModal","showDirNodeModal","setShowDirNodeModal","tierDisplay","setTierDisplay","span","count","onTierChange","onRecount","FileSyncOutlined","marginTop","padding","WebkitBoxSizing","borderRadius","onJump","ArrowRightOutlined","onUndoJump","ArrowLeftOutlined","EditOutlined","SwapOutlined","onDelete","DeleteOutlined","pageName","onRename","onMove","confirm","chapters","setChapters","albumPath","chapterTitle","console","log","icon","ExclamationCircleOutlined","okText","okType","cancelText","delete","chapterName","cleanCName","onChapterDeleteSuccess","c","placement","chapter","index","Item","onJumpToPage","pageIndex","maxHeight","border","pageUncPath","deletePage","delObj","onSuccess","onError","alRelPath","cleanAPath","movePage","movObj","post","message","FileComparison","file1","srcInfo","file2","dstInfo","overwrite","f1","f2","class","getStyle","size","toFixed","createdDate","moment","format","a","fontWeight","getOverlayStyle","isGrey","button","boxSizing","getGuideLabel","text","margin","textShadow","PageDisplay","styleByRotation","isLandscape","transform","styleShow","styleHide","extension","IsVideo","pageInfo","autoPlay","loop","id","queue","loadingImg","withPageManager","lpi","pages","indexes","cPageI","pPageI","triad","zenpenIndex","chuhenIndex","kouhenIndex","apm","setApm","orientation","fileInfos","length","targetPage","pageHandler","jumpTo","document","addEventListener","handleKeyDown2","removeEventListener","keyCode","close","renameObj","maxIndex","newPPageI","newCPageI","_helper","compose","newTriad","pageCeil","modifier","pagesLen","modifiedPages","newPageInfo","rename","newVal","oldVal","srcAlRelPath","currentPageInfo","dstAlRelPath","arr","split","pop","push","dst","oldPageIdx","findIndex","oldPage","splice","renamedPage","sort","localeCompare","move","newDir","removePageFromApm","chapterDeleteSuccess","newPageCount","newIndexes","clampIndexes","changeDetailVisibility","createDate","albumHandler","tierChange","put","recount","setShowContextMenu","showDrawer","setShowDrawer","buttonHandler","rightTop","rightMid","rightBot","midTop","midMid","midBot","leftTop","leftMid","leftBot","swipeHandler","useSwipeable","onSwipedUp","eventData","onSwipedDown","onSwipedLeft","onSwipedRight","showGuide","overlayStyle","buttonStyle","side","minHeight","window","innerHeight","mid","zenpenPage","DEBUGPageTriad","chuhenPage","kouhenPage","isOpen","zIndex","bytes","decimals","k","dm","sizes","floor","parseFloat","pow","updateDate","withRouter","scrollTo","albumCms","setAlbumCms","selectedAlbumCm","setSelectedAlbumCm","readerModalIsOpen","setReaderModalIsOpen","handleRefresh","reject","queryParts","readerHandler","history","aIndex","crudHandler","pageDeleteSuccess","onRefresh","gutter","lg","md","xs","onPageDeleteSuccess","MyInputTextbox","sm","label","placeholder","MyInputStar","MyInputRadio","Group","items","MyInputCheck","checked","MyInputMulticheck","includes","ghost","lodash","useSWR","albumInfo","aiError","album","category","artists","tags","flags","cover","isWip","entryDate","albumVm","setAlbumVm","handlers","albumVmChange","newAlbumVm","cleanedValue","pull","ok","cancel","editFiles","onEditFiles","refresh","temp","tabIndex","role","aria-labelledby","stopPropagation","aria-label","viewBox","focusable","data-icon","fill","aria-hidden","d","categories","orientations","DesktopOnly","children","useMediaQuery","minWidth","MobileOnly","maxPage","setMaxPage","filteredAlbumCms","setFilteredAlbumCms","acmsPaged","tierFilter","body","overflow","editModalIsOpen","setEditModalIsOpen","editedAlbumPath","setEditedAlbumId","editHandler","editedAlbumVm","newAlbumCms","editedAlbumVmIndex","as","entry","isIntersecting","Genres","uri","albumCGroups","acg","paddingTop","chonkyFileActions","defineFileAction","requiresSelection","toolbar","contextMenu","ChonkyIconName","code","trash","folder","ChonkyActions","EnableGridView","EnableListView","UploadFiles","CreateFolder","action","createFolder","setTextDialog","setViewModel","viewModel","subDir","fsNodes","unshift","nodeType","openFolder","payload","targetFile","isDir","targetSubDir","newDirChains","dirChains","rootChain","prevViewModel","cModel","state","selectedFiles","find","dir","newFsNodes","n","forEach","prevState","afterAction","dragNDrop","draggedFile","destination","fileName","srcObj","splitMoveModel","dstObj","srcFsNode","lv1Idx","lv2Idx","modifiedSrcFsNode","targetParentIdx","compare","nameA","nameB","defaultTextDialog","textDialog","chonkyModels","setChonkyModels","newModels","thumbnailUrl","childrenCount","selectable","draggable","dndBackend","TouchBackend","HTML5Backend","DndProvider","backend","darkMode","files","folderChain","fileActions","disableDragAndDropProvider","disableDefaultFileActions","onFileAction","EndDragNDrop","OpenFiles","OpenParentFolder","ROOT_CSS","css","setDefaultButton","isLoading","percent","eventMsgs","execute","btnName","setButton","progress","sse","EventSource","onmessage","res","resData","parse","currentStep","maxStep","isError","reload","fullScan","quickScan","clean","checkApiUrl","checkMediaUrl","checkResMediaUrl","SettingForm","ActionButton","setApiBaseUrl","setMediaBaseUrl","setResMediaBaseUrl","checkUrl","url","RowBase","col0","SettingFormLabel","col1","Search","onSearch","enterButton","localStorage","setItem","float","flexDirection","loading","block","flex","marginLeft","justifyContent","strokeLinecap","hidden","paddingRight","Layout","Header","Content","Footer","Sider","SubMenu","Menu","collapseSider","setCollapseSider","setTierFilter","handleSetTierFilter","querStr","queryString","location","search","pageStr","rowStr","pathStr","selectedMenu","queryHandler","correctedQuery","pattern","word","goToAlbumList","plus","tagName","targetQueryPlus","targetQueryMinus","newQueries","newQueryString","minus","currentUrlParams","URLSearchParams","set","menuContent","QueryEditor","theme","defaultSelectedKeys","defaultOpenKeys","mode","to","DesktopOutlined","TeamOutlined","PartitionOutlined","TagsOutlined","TagMenuContainer","onPlus","onMinus","SettingOutlined","getButtonDisplay","att","isTierMatch","revalidateOnFocus","fetcher","fetch","json","MenuOutlined","collapsible","collapsed","onCollapse","paddingLeft","tag","TagMenuItem","selectStatus","getSelectStatus","queryArr","str","encodedQuery","plusBackground","minusBackground","PlusOutlined","MinusOutlined","setVisible","setQuery","ConsoleSqlOutlined","SearchOutlined","App","exact","Boolean","hostname","match","startApp","setChonkyDefaults","iconComponent","ChonkyIconFA","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister","cordova","module","exports"],"mappings":"4cA2EeA,EAxEK,SAAAC,GAAiB,OAAI,YAAmB,IAAbC,EAAY,oBA8DzD,OACE,kBAACD,EAAD,iBACMC,EADN,CAEEC,QA9DJ,SAAiBC,EAAOC,EAAeC,GACrCC,IAAMC,KAAK,CACTJ,MAAQA,EACRK,QACE,oCACE,8BAAOJ,GACP,6BAAMC,EAAaI,KAAKC,UAAUL,EAAY,KAAM,GAAK,KAG7DM,KARS,aASTC,MAZU,OAiEVC,SAjDJ,SAAkBV,EAAOC,EAAeC,GACtCC,IAAMQ,MAAM,CACVX,MAAQA,EACRK,QACE,oCACE,8BAAOJ,GACP,6BAAMC,EAAaI,KAAKC,UAAUL,EAAY,KAAM,GAAK,KAG7DM,KARU,aASVC,MA1BU,OAkEVG,YApCJ,SAAqBD,GACnB,GAAuB,OAAnBA,EAAME,eAAwCC,IAAnBH,EAAME,SAArC,CAD0B,MAUWF,EAAME,SAAnCE,EAVkB,EAUlBA,OAAQC,EAVU,EAUVA,WAAYC,EAVF,EAUEA,KAEtBZ,EAAU,CACdL,MAAM,GAAD,OAAKe,EAAL,cAAiBC,GACtBX,QACE,8BACGC,KAAKC,UAAUU,EAAM,KAAM,IAGhCT,KAPc,aAQdC,MAlDU,KAqDRM,GAAU,KAAOA,EAAS,IAC5BZ,IAAMe,QAAQb,GAGdF,IAAMQ,MAAMN,QAzBZF,IAAMQ,MAAM,CACVX,MAAQ,cACRK,QAAUM,EAAMQ,WAChBX,KAHU,aAIVC,MApCQ,YCHT,SAASW,EAAqBC,GACnC,OAAOA,EAAOC,OAAO,GAAGC,cAAgBF,EAAOG,MAAM,GAYhD,SAASC,EAAcC,EAAOC,GACnC,GAAgB,IAAbA,EAAgB,OAAO,EAE1B,IAAIC,EAAYF,EAAQC,EAAY,IAEpC,OADaC,GAAY,IAAMA,EAAW,IAYrC,SAASC,EAAMC,EAAQC,EAAKC,GACjC,OAAOC,KAAKD,IAAID,EAAKE,KAAKF,IAAID,EAAQE,IAajC,SAASE,EAASC,EAAOC,GAC9B,IAAIC,EAAaF,EAAMG,QAAO,SAAAC,GAAO,OAAY,MAALA,GAAmB,KAANA,KACrDC,EAAYJ,GAAO,IACnBK,EAAY,IAAIC,OAAOF,EAAU,OAAQ,KAE7C,OAAOH,EAAWM,KAAKH,GAAWC,QAAQA,EAASD,GAe9C,SAASI,EAAWC,GACzB,OAAO,IAAIC,KAAKD,GAAME,iBChExB,ICGMC,EAAiB,qOAKnBC,EANiB,iCAejBC,EACmBF,EAQnBG,EACmBH,EAQjBI,EAAI,UAAMH,EAAN,SACJI,EAAE,UAAMJ,EAAN,OACFK,EAAQJ,EACRK,EAAWJ,EAwBjB,SAASK,EAASC,EAAMC,GAEtB,MAAM,GAAN,OADsB,IAATD,EAAaJ,EAAKD,GAC/B,OAAiBM,GAInB,IAgBMC,EAAqB,SAACF,EAAMG,EAAMC,EAAKC,GAC3C,IAAMC,OAAuBjD,IAAVgD,EAAsBE,mBAAmBF,GAAS,GACrE,OAAON,EAASC,EAAD,kCAAkCG,EAAlC,gBAA8CC,EAA9C,kBAA2DE,KAMtEE,EAAqB,SAACR,GAC1B,OAAOD,EAASC,EAAM,uBAQlBS,GAAwB,SAACT,GAC7B,OAAOD,EAASC,EAAM,0BASlBU,GAAe,SAACV,EAAMW,GAC1B,IAAMC,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,4BAA4BY,KAavCC,GAAoB,SAACb,EAAMW,EAAMG,GACrC,IAAMF,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,iCAAiCY,EAAjC,iCAA4DE,QAA5D,IAA4DA,QA2BvEC,GAAiB,SAACf,GACtB,OAAOD,EAASC,EAAD,mBAKXgB,GAAY,SAAChB,GACjB,OAAOD,EAASC,EAAM,cAElBiB,GAAe,SAACjB,GACpB,OAAOD,EAASC,EAAM,iBAYlBkB,GAAa,SAACC,EAAYnB,GAC9B,IAAMoB,EAAS,OAAGpB,QAAH,IAAGA,IAAQ,EACpBqB,EAAkBd,mBAAmBY,GAE3C,OAAOtB,EAAMb,QAAQ,eAAeQ,GAAYR,QAAQ,eAAeqC,GAAiBrC,QAAQ,SAASoC,GAAWpC,QAAQ,eAAgB,IAAIK,MAAQiC,gBAGpJC,GAAqB,SAACJ,EAAYK,EAASxB,GAC/C,IAAMoB,EAAS,OAAGpB,QAAH,IAAGA,IAAQ,EACpByB,EAAkBlB,mBAAmBY,GAE3C,OAAOrB,EAASd,QAAQ,eAAeQ,GAAYR,QAAQ,eAAeyC,GAAiBzC,QAAQ,YAAYwC,GAASxC,QAAQ,SAASoC,GAAWpC,QAAQ,eAAgB,IAAIK,MAAQiC,gBCnE1L,SAASI,GAAoBrF,GAI3B,OAHAsF,qBAAU,WACRtF,EAAMuF,cACN,CAACvF,IACK,qCAGV,SAASwF,GAAeC,EAAMhD,GAC5B,IAIMiD,EAAY,IAANjD,EAJA,CAAEkD,EAAG,GAAIC,EAAG,IAAKC,EAAG,KAIE,IAANpD,EAHhB,CAAEkD,EAAG,IAAKC,EAAG,IAAKC,EAAG,KACrB,CAAEF,EAAG,IAAKC,EAAG,IAAKC,EAAG,IAG3BC,EAAQL,EAAOhD,EAAI,EAAI,EAE7B,MAAM,QAAN,OAAeiD,EAAIC,EAAnB,YAAwBD,EAAIE,EAA5B,YAAiCF,EAAIG,EAArC,YAA0CC,EAA1C,KAGF,SAASC,GAAgBN,EAAMhD,GAC7B,OAAOgD,EAAOhD,IAAY,IAANA,GAAiB,IAANA,GAAW,kBAAoB,MAGhE,SAASuD,GAAShG,GAChB,IAAMiG,EAAY,CAAEtF,MAAO,OAAQuF,OAAQ,OAAQC,YAAa,MAAOC,aAAc,OAErF,OACE,oCAEuB,YAAnBpG,EAAMqG,SAAyB,kBAAC,IAAMC,GAAP,CAAUC,MAAON,IAC3B,aAAnBjG,EAAMqG,SAA0B,kBAAC,IAAMG,GAAP,CAAUD,MAAON,IAC5B,YAAnBjG,EAAMqG,SAAyB,kBAAC,IAAMI,GAAP,CAAUF,MAAON,IAC9C,kBAAC,IAAMS,GAAP,CAAUH,MAAON,KAMhBnG,UArJf,SAAqBE,GACnB,IAAM2G,EAAU,CACdC,KAAM,WACJ5G,EAAM6G,OAAO7G,EAAM8G,UAGrBC,KAAM,WACD/G,EAAMgH,QAAQhH,EAAMgH,OAAOhH,EAAM8G,QAAQxC,QAPtB,EAWG2C,YAAU,CACrCC,UAAW,EACXC,WAAY,wBAbY,mBAWnBC,EAXmB,KAWdC,EAXc,KAkBpBC,GAlBoB,KAkBb,kBAACjC,GAAD,CAAqBE,UAAWoB,EAAQI,QACrD,OACE,yBAAKK,IAAKA,EAAKb,MAAO,CAAEgB,cAAe,MAAOC,SAAU,WAAYC,UAAW,WAC7E,yBAAKlB,MAAO,CAAEL,OALA,QAKmBvF,MAAO,SACtC,kBAAC,IAAD,CAAU+G,QAASJ,EAAMK,QAAS,CAAC,eAAgBC,UAAW5H,EAAM6H,iBACpE,yBAAKtB,MAAO,CACRuB,QAAS,eAAgBN,SAAU,WACnCtB,OATQ,QASWvF,MAAO,OAAQoH,SAT1B,QAURC,WAAahI,EAAM8G,QAAQmB,OAA+B,GAAtB,qBAEtCC,QAASvB,EAAQC,MAEhBS,EACC,yBACEd,MAAO,CACL4B,UAAW,UACXjC,OAAQ,OAAQvF,MAAO,QAEzByH,IAAKC,GAAwBrI,EAAM8G,QAAQwB,UAAUC,eAAgB,IAAKvI,EAAM2D,MAChF6E,IAAI,QACD,KAGLxI,EAAM8G,QAAQmB,OAUN,GATR,yBAAK1B,MAAO,CACViB,SAAU,WACVtB,OAAQ,EACRvF,MAAO,EACP8H,KAAM,MACNC,IAAK,MACLV,WAAY,qBACZW,YAAa,yBACbC,aAAc,4BAIlB,yBAAKrC,MAAO,CACViB,SAAU,WACVqB,MAAO,MACPC,OAAQ,MACRC,MAAO,QACPC,WAAY,QAEXhJ,EAAM8G,QAAQmC,UAAUC,KAAI,SAACC,EAAMC,GAAP,OAAa,kBAACpD,GAAD,CAAUK,SAAU8C,EAAME,IAAKD,QAE3E,yBAAK7C,MAAO,CACViB,SAAU,WACVqB,MAAO,MACPC,OAAQ,MACR5C,OAAQ,OACRvF,MAAO,QAEN,CAAC,EAAG,EAAG,GAAGuI,KAAI,SAACzG,EAAG2G,GAAJ,OACb,yBAAKC,IAAG,kBAAaD,GACnB7C,MAAO,CACL5F,MAAO,OACPuF,OAAQ,MACRoD,gBAAiB9D,GAAexF,EAAM8G,QAAQrB,KAAMhD,GACpD8G,UAAWxD,GAAgB/F,EAAM8G,QAAQrB,KAAMhD,UAIvD,yBAAK8D,MAAO,CACViB,SAAU,WACViB,KAAM,MACNK,OAAQ,MACRnI,MAAO,OACPuF,OAAQ,MACRoD,gBAAiB,QACjBxB,QAAS9H,EAAM8G,QAAQ0C,cAAgB,EAAI,QAAU,SAErD,yBAAKjD,MAAO,CACV+C,gBAAiB,aACjBpD,OAAQ,OACRvF,MAAM,GAAD,OAAK8I,EAAqBzJ,EAAM8G,QAAQ0C,cAAgB,EAAGxJ,EAAM8G,QAAQ4C,WAAzE,SAGe,OAAvB1J,EAAM8G,QAAQ6C,MAAwC,KAAvB3J,EAAM8G,QAAQ6C,KAC5C,yBAAKC,UAAU,cACZ5J,EAAM8G,QAAQ6C,MACR,GAEX,iCAKJ,0BAAMpD,MAAO,CAAEsD,SAAU,OAAQb,WAAY,MAC1ChJ,EAAM8G,QAAQgD,e,kGCxFRC,OAzBf,SAAoB/J,GAAQ,IAAD,IACCgK,mBAAS,IADV,mBAClBpI,EADkB,KACXqI,EADW,KAIzB,OAFA3E,qBAAU,WAAQ2E,EAASjK,EAAMkK,gBAAiB,CAAClK,EAAMkK,eAGvD,kBAAC,IAAD,CACEC,QAASnK,EAAMmK,QACfC,OAAQ,KACRC,UAAU,EACVC,UAAU,EACVC,SAAU,kBAAMvK,EAAMwK,WACtBjE,MAAO,CAAEwB,SAAU,IAAKN,UAAW,WAGnC,kBAAC,KAAMgD,SAAP,CAAgB7I,MAAOA,EAAO8I,SAAU,SAACC,GAAD,OAAWV,EAASU,EAAMC,OAAOhJ,QAAQiJ,KAAM,IACvF,kBAAC,IAAD,CACEtE,MAAO,CAAE5F,MAAO,QAAUgD,KAAK,UAC/BuE,QAAS,WAAQlI,EAAMU,KAAKkB,EAAO5B,EAAMkK,cAAelK,EAAMwK,YAFhE,UAIGxK,EAAM8K,eAJT,QAIoB,Y,qBClBpBC,GAAQC,EAAQ,IAASC,QAEvBC,GAA4BC,KAA5BD,SAAUE,GAAkBD,KAAlBC,cAuEHtL,UArEf,SAAuBE,GAAQ,IAAD,EACFgK,mBAAS,IADP,mBACrBqB,EADqB,KACdC,EADc,OAEItB,mBAAS,MAFb,mBAErBuB,EAFqB,KAEXC,EAFW,KAI5BlG,qBAAU,WACRyF,GAAMU,IAAIpD,EAAwB,IAC7BqD,MAAK,SAAC3K,GACLuK,EAASvK,EAASI,SAEnBwK,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,QAExB,IAEF,IAAM+K,EAAe,CACnBC,SAAU,SAACC,GAsBT,OArBe,IAAIC,SAAQ,SAAAC,GACrBF,EAAS9L,MAAMiM,OACjBD,IAGFjB,GAAMU,IAAN,UAAapD,EAAwB,GAArC,iBAAgDyD,EAAS9L,MAAMkM,QAAQC,OACpET,MAAK,SAAC3K,GACL+K,EAAS9L,MAAMkM,QAAQD,OAASlL,EAASI,KAEzCmK,GAAS,SAACc,GACR,OAAO,aACFA,MAGPJ,OAEDL,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,UAM1BwL,OAAQ,SAAChD,GACPmC,EAAYnC,KAIhB,OACE,kBAAC,IAAD,CACEc,QAASnK,EAAMmK,QACfC,OAAQ,KACRC,UAAU,EACVC,UAAU,EACVC,SAAU,kBAAMvK,EAAMwK,WACtBjE,MAAO,CAAE5F,MAAO,IAAKoH,SAAU,SAG/B,kBAACuE,GAAD,CACEjB,MAAOA,EACPkB,WAAYX,EAAaC,SACzBW,SAAUZ,EAAaS,SAEzB,kBAAC,IAAD,CACE9F,MAAO,CAAE5F,MAAO,QAAUgD,KAAK,UAC/BuE,QAAS,WAAQlI,EAAMU,KAAK6K,GAAWvL,EAAMwK,YAF/C,iBAYN,SAAS8B,GAAUtM,GAgBjB,OACE,kBAACoL,GAAD,CACES,SAAU7L,EAAMuM,WAChBC,SAAU,SAACC,GAAD,OAAUzM,EAAMwM,SAASC,EAAK,MAlBpB,SAAlBC,EAAmBvL,GAYvB,OAXaA,EAAK+H,KAAI,SAAAC,GACpB,OAAIA,EAAK8C,OAEL,kBAACf,GAAD,CAAUhL,MAAOiJ,EAAKgD,KAAM9C,IAAKF,EAAKgD,KAAMD,QAAS/C,GAClDuD,EAAgBvD,EAAK8C,SAIrB,kBAACf,GAAD,CAAUhL,MAAOiJ,EAAKgD,KAAM9C,IAAKF,EAAKgD,KAAMD,QAAS/C,OAW3DuD,CAAgB1M,EAAMqL,QCedsB,OA3Gf,SAAgC3M,GAAQ,IAAD,EACHgK,mBAAS,GADN,mBAC9B4C,EAD8B,KACnBC,EADmB,KAErCvH,qBAAU,WACRuH,EAAa7M,EAAMkK,aAAe,KACjC,CAAClK,EAAMkK,eAEV,IAAM4C,EAAkB,SAACC,GACvBF,EAAa1K,KAAKF,IAAIE,KAAKD,IAAI6K,EAAK,GAAI/M,EAAM8G,QAAQ4C,aAPnB,EAUSM,oBAAS,GAVlB,mBAU9BgD,EAV8B,KAUbC,EAVa,OAWWjD,oBAAS,GAXpB,mBAW9BkD,EAX8B,KAWZC,EAXY,OAcCnD,mBAAS,GAdV,mBAc9BoD,EAd8B,KAcjBC,EAdiB,KAoBrC,OALA/H,qBAAU,gBACctE,IAAlBhB,EAAM8G,SACVuG,EAAerN,EAAM8G,QAAQrB,QAC5B,CAACzF,EAAM8G,eAEY9F,IAAlBhB,EAAM8G,QAAiC,qCAGzC,oCACE,kBAAC,IAAD,CACEqD,QAASnK,EAAMmK,QACfI,SAAUvK,EAAMuK,SAChBH,OAAQ,KACRE,UAAU,EACVD,UAAU,EACV9D,MAAO,CAAEwB,SAAU,MAGnB,kBAAC,IAAD,KACkB,IAAf/H,EAAM2D,KACL,kBAAC,IAAD,CAAK2J,KAAM,GAAI/G,MAAO,CAAEH,aAAc,GAAIqB,UAAW,WACnD,kBAAC,KAAD,CACE8F,MAAO,EACP3L,MAAOwL,EACP1C,SAAU,SAAC9I,GAAYyL,EAAezL,GAAQ5B,EAAMwN,aAAa5L,IACjE2E,MAAO,CAAEsD,SAAU,WAGvB,GACF,kBAAC,IAAD,CAAKyD,KAAM,IACT,kBAAC,IAAD,CAAQ3J,KAAK,UAAUuE,QAAS,kBAAMlI,EAAMyN,aAAalH,MAAO,CAAE5F,MAAO,SACvE,kBAAC+M,GAAA,EAAD,MADF,kBAIF,kBAAC,IAAD,CAAKJ,KAAM,GAAI/G,MAAO,CAAEkB,UAAW,OAAQkG,UAAW,IACpD,2BAAOhK,KAAK,SAAS/B,MAAOgL,EAAWlC,SAAU,SAACjI,GAAD,OAAOqK,EAAgBrK,EAAEmI,OAAOhJ,QAAQ2E,MAAO,CAAE5F,MAAO,MAAOiN,QAAS,MAAOC,gBAAiB,aAAcC,aAAc,MAAO/E,MAAO,YAE7L,kBAAC,IAAD,CAAKuE,KAAM,EAAG/G,MAAO,CAAEkB,UAAW,OAAQkG,UAAW,IACnD,kBAAC,IAAD,CAAQhK,KAAK,QAAQ4C,MAAO,CAAE5F,MAAO,MAAOoI,MAAO,SACjDb,QAAS,kBAAM4E,EAAgBF,EAAY,KAD7C,MAIF,kBAAC,IAAD,CAAKU,KAAM,EAAG/G,MAAO,CAAEkB,UAAW,QAASkG,UAAW,IACpD,kBAAC,IAAD,CAAQhK,KAAK,QAAQ4C,MAAO,CAAE5F,MAAO,MAAOoI,MAAO,SACjDb,QAAS,kBAAM4E,EAAgBF,EAAY,KAD7C,MAIF,kBAAC,IAAD,CAAKU,KAAM,GAAI/G,MAAO,CAAEoH,UAAW,IACjC,kBAAC,IAAD,CAAQhK,KAAK,UAAUuE,QAAS,kBAAMlI,EAAM+N,OAAOnB,EAAY,IAAIrG,MAAO,CAAE5F,MAAO,SACjF,kBAACqN,GAAA,EAAD,MADF,SAIF,kBAAC,IAAD,CAAKV,KAAM,GAAI/G,MAAO,CAAEoH,UAAW,IACjC,kBAAC,IAAD,CAAQhK,KAAK,UAAUuE,QAAS,kBAAMlI,EAAMiO,cAAc1H,MAAO,CAAE5F,MAAO,SACxE,kBAACuN,GAAA,EAAD,MADF,cAIF,kBAAC,IAAD,CAAKZ,KAAM,GAAI/G,MAAO,CAAEoH,UAAW,IACjC,kBAAC,IAAD,CAAQhK,KAAK,UAAUuE,QAAS,WAAQlI,EAAMuK,WAAY0C,GAAmB,IAAU1G,MAAO,CAAE5F,MAAO,SACrG,kBAACwN,GAAA,EAAD,MADF,gBAIc,IAAfnO,EAAM2D,KACL,kBAAC,IAAD,CAAK2J,KAAM,GAAI/G,MAAO,CAAEoH,UAAW,IACjC,kBAAC,IAAD,CAAQhK,KAAK,UAAUuE,QAAS,WAAQlI,EAAMuK,WAAY4C,GAAoB,IAAU5G,MAAO,CAAE5F,MAAO,SACtG,kBAACyN,GAAA,EAAD,MADF,cAIF,GACF,kBAAC,IAAD,CAAKd,KAAM,GAAI/G,MAAO,CAAEoH,UAAW,IACjC,kBAAC,IAAD,CAAQhK,KAAK,SAASuE,QAAS,WAAQlI,EAAMuK,WAAYvK,EAAMqO,YAAe9H,MAAO,CAAE5F,MAAO,SAC5F,kBAAC2N,GAAA,EAAD,MADF,kBAMN,kBAAC,GAAD,CACEnE,QAAS6C,EAAiBxC,QAAS,kBAAMyC,GAAmB,IAC5D/C,aAAclK,EAAMuO,SACpB7N,KAAMV,EAAMwO,WAEE,IAAfxO,EAAM2D,KACL,kBAAC,GAAD,CACEwG,QAAS+C,EACT1C,QAAS,kBAAM2C,GAAoB,IACnCzM,KAAMV,EAAMyO,SAEf,K,WClGCC,GAAYrO,IAAZqO,QACF3D,GAAQC,EAAQ,IAASC,QAoFhBnL,UAlFf,SAAkCE,GAAQ,IAAD,EACPgK,mBAAS,IADF,mBAChC2E,EADgC,KACtBC,EADsB,KAGvCtJ,qBAAU,gBACgBtE,IAApBhB,EAAM6O,WACV9D,GAAMU,ILuGe,SAAC9H,EAAMW,GAC9B,IAAMC,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,gCAAgCY,IKzGnC8D,CAAsBrI,EAAM2D,KAAM3D,EAAM6O,YAC/CnD,MAAK,SAAU3K,GACd6N,EAAY7N,EAASI,SAEtBwK,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,QAErB,CAACb,EAAM6O,YAEV,IAAMlI,EACI,SAACmI,GAEPC,QAAQC,IAAI,UAAWF,IAHrBnI,EAKI,SAACmI,GACPC,QAAQC,IAAI,UAAWF,GACvBJ,GAAQ,CACNxO,MAAM,kBAAD,OAAoB4O,EAApB,KACLG,KAAM,kBAACC,GAAA,EAAD,MACNC,OAAQ,8BACRC,OAAQ,SACRC,WAAY,6BACZ3O,KANM,WAOJqK,GAAMuE,OLyGW,SAAC3L,EAAMW,EAAMiL,GACtC,IAAMhL,EAAYL,mBAAmBI,GAC/BkL,EAAatL,mBAAmBqL,GACtC,OAAO7L,EAASC,EAAD,kCAAkCY,EAAlC,wBAA2DiL,IK5GrDnH,CAAwBrI,EAAM2D,KAAM3D,EAAM6O,UAAWC,IAC/DpD,MAAK,SAAU3K,GACdgO,QAAQC,IAAI,eAAgBjO,EAASI,MACrCnB,EAAMyP,uBAAuB1O,EAASI,MACtCyN,EACED,EAASnM,QAAO,SAAAkN,GAAC,OAAIA,EAAExP,QAAU4O,SAGpCnD,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,OAGxB0J,SAnBM,gBAyBZ,OACE,kBAAC,IAAD,CACEoF,UAAU,OACVrF,UAAU,EACVE,QAASxK,EAAMwK,QACfL,QAASnK,EAAMmK,SAEf,yBAAK5D,MAAO,CAAEqH,QAAS,SACpBe,EAASzF,KAAI,SAAC0G,EAASC,GAAV,OACZ,kBAAC,IAAD,CAAKtJ,MAAO,CAAEH,aAAc,OAASiD,IAAKuG,EAAQ1P,OAChD,kBAAC,IAAD,CAAUwH,QACR,kBAAC,IAAD,KACE,kBAAC,IAAKoI,KAAN,CAAWzG,IAAI,IAAInB,QAAS,kBAAMvB,EAAeiJ,EAAQ1P,SAAQ,kBAACiO,GAAA,EAAD,MAAjE,UACA,kBAAC,IAAK2B,KAAN,CAAWzG,IAAI,IAAInB,QAAS,kBAAMvB,EAAeiJ,EAAQ1P,SAAQ,kBAACoO,GAAA,EAAD,MAAjE,WAEF3G,QAAS,CAAC,gBAEV,kBAAC,IAAD,CAAK2F,KAAM,GAAIpF,QAAS,kBAAMlI,EAAM+P,aAAaH,EAAQI,aACvD,yBACEzJ,MAAO,CAAE4B,UAAW,UAAWxH,MAAO,OAAQsP,UAAW,QAASC,OAAQ,mBAC1E9H,IAAKC,GAAwBuH,EAAQO,YAAa,IAAKnQ,EAAM2D,MAC7D6E,IAAI,UAKV,kBAAC,IAAD,CAAK8E,KAAM,IACT,0BAAM/G,MAAO,CAAEwC,MAAO,UAAY6G,EAAQ1P,YApBlD,S,mDC9DEwO,GAAYrO,IAAZqO,QACF3D,GAAQC,EAAQ,IAASC,QAiEhBnL,GA/DK,SAAAC,GAAiB,OAAI,YAAmB,IAAbC,EAAY,oBAsDzD,OACE,kBAACD,EAAD,iBACMC,EADN,CAEEoQ,WAxDJ,SAAoBC,EAAQC,EAAWC,GACrC7B,GAAQ,CACNxO,MAAM,UAAD,OAAYmQ,EAAOG,UAAnB,KACLvB,KAAM,kBAACC,GAAA,EAAD,MACNC,OAAQ,8BACRC,OAAQ,SACRC,WAAY,6BACZ3O,KANM,WAOJqK,GAAMuE,ON4HK,SAAC3L,EAAMW,EAAMkM,GAC9B,IAAMjM,EAAYL,mBAAmBI,GAC/BmM,EAAavM,mBAAmBsM,GACtC,OAAO9M,EAASC,EAAD,0BAA0BY,EAA1B,sBAAiDkM,IM/H7CpI,CAAgBrI,EAAM2D,KAAM0M,EAAOxB,UAAWwB,EAAOG,YAC/D9E,MAAK,SAAU3K,GACduP,EAAUvP,MAEX4K,OAAM,SAAU9K,GACf0P,EAAQ1P,OAGd0J,SAfM,gBAwDNmG,SApCJ,SAASA,EAASC,EAAQL,EAAWC,GN2GtB,IAAC5M,EM1GdoH,GAAM6F,MN0GQjN,EM1GW3D,EAAM2D,KN2G1BD,EAASC,EAAD,aM3GyBgN,GACnCjF,MAAK,SAAC3K,GACyB,mCAA1BA,EAASI,KAAK0P,QAChBnC,GAAQ,CACNxO,MAAM,aACN+O,KAAM,kBAACC,GAAA,EAAD,MACN3O,QAAS,kBAACuQ,GAAD,CAAgBC,MAAOhQ,EAASI,KAAK6P,QAASC,MAAOlQ,EAASI,KAAK+P,UAC5E/B,OAAQ,8BACRC,OAAQ,SACRC,WAAY,6BACZ3O,KAPM,WAaJgQ,EALe,gBACVC,EADU,CAEbQ,WAAW,IAGOb,IAEtB/F,SAfM,eAoBR+F,EAAUvP,MAGb4K,OAAM,SAAC9K,GACN0P,EAAQ1P,YAehB,SAASiQ,GAAe9Q,GACtB,IAAMoR,EAAKpR,EAAM+Q,MACXM,EAAKrR,EAAMiR,MAEjB,OACE,2BAAOK,MAAM,mBAAmB/K,MAAO,CAAE5F,MAAO,SAC9C,4BACE,sCACA,4CAEF,4BACE,4BAAKyQ,EAAGjF,MACR,4BAAKkF,EAAGlF,OAEV,4BACE,wBAAI5F,MAAOgL,EAASH,EAAGI,KAAMH,EAAGG,QAASJ,EAAGI,KAAO,MAAMC,QAAQ,GAAjE,OACA,wBAAIlL,MAAOgL,EAASF,EAAGG,KAAMJ,EAAGI,QAASH,EAAGG,KAAO,MAAMC,QAAQ,GAAjE,QAEF,4BACE,wBAAIlL,MAAOgL,EAASH,EAAGM,YAAaL,EAAGK,cAAeC,KAAOP,EAAGM,aAAaE,OAAO,qBACpF,wBAAIrL,MAAOgL,EAASF,EAAGK,YAAaN,EAAGM,cAAeC,KAAON,EAAGK,aAAaE,OAAO,uBAK1F,SAASL,EAASM,EAAGhM,GAEnB,MAAO,CACLiM,WAFiBD,EAAIhM,EAAI,OAAS,WCtFxC,IAAMkF,GAAQC,EAAQ,IAASC,QA6iB/B,IAAM8G,GAAkB,SAACC,GAgBvB,MAfe,CACbzR,QAAS,CACPiH,SAAU,WACVkB,IAAK,KACL/H,MAAO,OACP8G,UAAW,SACX6B,gBAAiB0I,EAAS,2BAA6B,oBAEzDC,OAAQ,CACNzK,SAAU,WACV0K,UAAW,aACXhC,OAAQ8B,EAAS,kBAAoB,SAOrCG,GAAgB,SAACH,EAAQI,GAC7B,OAAOJ,EACL,0BAAMzL,MAAO,CAAEkB,UAAW,SAAU4K,OAAQ,OAAQC,WAAY,yDAC7DF,GAEH,IAGJ,SAASG,GAAYvS,GACnB,IAAMwS,EAAkBxS,EAAMyS,YAC5B,CACEC,UAAW,0EACX/R,MAAO,QACPuF,OAAQ,SAEV,CACEwM,UAAW,4DACX/R,MAAO,QACPuF,OAAQ,SAGNyM,EAAS,aACbxK,UAAW,WACRqK,GAECI,EAAY,CAAEzK,UAAW,UAAWjC,OAAQ,EAAGvF,MAAO,EAAG6G,SAAU,YAMzE,OAFAuH,QAAQC,IAAI,cAAehP,GAyB7B,SAAiB6S,GACf,GAAkB,UAAdA,GAAuC,SAAdA,EAC3B,OAAO,EAET,OAAO,EA3BHC,CAAQ9S,EAAM+S,SAASF,WAEvB,2BACEG,UAAQ,EAACC,MAAI,EACbC,GAAIlT,EAAMkT,GACV3M,MAAuB,OAAhBvG,EAAMmT,MAAiBR,EAAYC,EAC1CxK,IAAqB,OAAhBpI,EAAMmT,MAAiB9K,GAAA,UAAmBrI,EAAM6O,UAAzB,aAAuC7O,EAAM+S,SAASxK,gBAAkBvI,EAAM2D,MAAQ,IAJpH,qBAYF,yBACEuP,GAAIlT,EAAMkT,GACV3M,MAAuB,OAAhBvG,EAAMmT,MAAiBR,EAAYC,EAC1CxK,IAAqB,OAAhBpI,EAAMmT,OAAkC,OAAhBnT,EAAMmT,MAAiB9K,GAAA,UAAmBrI,EAAM6O,UAAzB,aAAuC7O,EAAM+S,SAASxK,gBAAkBvI,EAAM2D,MAAQyP,KAC1I5K,IAAI,eAYK6K,UAAgBvT,GA3nB/B,SAAqBE,GAAQ,IAAD,EACJgK,mBAAS,CAC7B1F,KAAM,KACNgP,IAAK,EACLC,MAAO,GACPC,QAAS,CACPC,OAAQ,EACRC,OAAQ,EACRC,MAAO,SACPC,YAAa,EACbC,YAAa,EACbC,YAAa,GAEfrB,aAAa,EACbhO,eAAe,IAdS,mBACnBsP,EADmB,KACdC,EADc,KAiB1B1O,qBAAU,gBACctE,IAAlBhB,EAAM8G,SAA2C,OAAlB9G,EAAM8G,SACrC9G,EAAM8G,QAAQxC,OAASyP,EAAIzP,MAC/ByG,GAAMU,IAAIpD,GAAuBrI,EAAM2D,KAAM3D,EAAM8G,QAAQxC,KAAMyP,EAAItP,gBAClEiH,MAAK,SAAU3K,GACdiT,EAAO,CACL1P,KAAMtE,EAAM8G,QAAQxC,KACpBgP,IAAKtT,EAAM8G,QAAQ0C,cACnBiJ,YAA2C,cAA9B1R,EAASI,KAAK8S,YAC3BV,MAAOxS,EAASI,KAAK+S,UACrBV,QAAS,KACT/O,cAAesP,EAAItP,gBAGjBzE,EAAM8G,QAAQ4C,YAAc3I,EAASI,KAAK+S,UAAUC,OAAwB,IAAfnU,EAAM2D,OACrEoL,QAAQC,IAAR,qBAA0BhP,EAAM8G,QAAQ4C,UAAxC,8CAAuF3I,EAASI,KAAK+S,UAAUC,OAA/G,MACApJ,GAAMU,IAAIpD,GAAkBrI,EAAM2D,KAAM3D,EAAM8G,QAAQxC,OACnDoH,MAAK,SAAU3K,OAEf4K,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,UAIzB8K,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,QAGrB,CAACb,EAAM8G,UAEVxB,qBAAU,WACR,IAAM8O,EAAaL,EAAIT,IAAMS,EAAIR,MAAMY,OAASJ,EAAIT,IAAMS,EAAIR,MAAMY,OAAS,EAE7EE,EAAYC,OAAOF,KAClB,CAACL,EAAIzP,OAERgB,qBAAU,WAGR,OAFAiP,SAASC,iBAAiB,UAAWC,GAAgB,GAE9C,WACLF,SAASG,oBAAoB,UAAWD,GAAgB,MAEzD,IAEH,IAAMA,EAAiB,SAAC9J,GACA,KAAlBA,EAAMgK,SACRN,EAAYO,SAKVP,EAAc,CAClBC,OAAQ,SAAUxQ,EAAM+Q,GAAY,IAAD,IAC3BC,EAAWf,EAAIR,MAAMY,OAAS,EAC9BY,EAAS,oBAAGhB,EAAIP,eAAP,aAAG,EAAaC,cAAhB,QAA0B,EACnCuB,EAAYC,EAAcnR,EAAM,EAAGgR,GAHR,EAK4B,WAC3D,SAASI,EAAQC,EAAUvB,EAAaC,EAAaC,GACnD,MAAO,CACLqB,WACAvB,cACAC,cACAC,eAIJ,SAASsB,EAASC,GAChB,IAAMC,EAAWvB,EAAIR,MAAMY,OAC3B,QAAUa,EAAYK,GAAYC,EAAYA,GAAYA,EAG5D,OAAIN,EAAY,IAAM,EACbE,EAAQ,SAAUF,EAAWI,EAAS,GAAIA,GAAU,IAEzDJ,EAAY,IAAM,EACbE,EAAQ,SAAUE,GAAU,GAAIJ,EAAWI,EAAS,IAEzDJ,EAAY,IAAM,EACbE,EAAQ,SAAUE,EAAS,GAAIA,GAAU,GAAIJ,QADtD,EArB2D,GAArDG,EALyB,EAKzBA,SAAUvB,EALe,EAKfA,YAAaC,EALE,EAKFA,YAAaC,EALX,EAKWA,YA0BxCyB,EAAgBxB,EAAIR,MACN,OAAdsB,QAAoC7T,IAAd6T,IACxBU,EAAcV,EAAUhF,OAASgF,EAAUW,aAG7CxB,EAAO,CACLR,QAAS,CACPC,OAAQuB,EACRtB,OAAQqB,EACRpB,MAAOwB,EACPvB,YAAaA,EACbC,YAAaA,EACbC,YAAaA,GAEfxP,KAAMyP,EAAIzP,KACVgP,IAAKS,EAAIT,IACTb,YAAasB,EAAItB,YACjBhO,cAAesP,EAAItP,cACnB8O,MAAOgC,IAGO,MAAZxB,EAAIzP,MAAgBR,IAASiQ,EAAIR,MAAMY,OAAS,GAAoB,IAAfnU,EAAM2D,MAC7DoH,GAAM6F,KAAKvI,GAA2BrI,EAAM2D,MAAO,CACjDkL,UAAWkF,EAAIzP,KACfkF,cAAe1F,IAEd4H,MAAK,SAAC3K,OAEN4K,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,OAI1B4U,OAAQ,SAACC,EAAQC,GACf,IAAMC,EAAeC,EAAgBtN,eAC/BuN,EAAgB,WACpB,IAAIC,EAAMF,EAAgBtN,eAAeyN,MAAM,MAI/C,OAHAD,EAAIE,MACJF,EAAIG,KAAKR,GAEFT,EAAiBc,EAAK,MALT,GAQhBpF,EAAS,CACbQ,WAAW,EACX/I,IAAK,CACHyG,UAAWkF,EAAIzP,KACfkM,UAAWoF,GAEbO,IAAK,CACHtH,UAAWkF,EAAIzP,KACfkM,UAAWsF,IAIf9V,EAAM0Q,SAASC,GACb,SAAC5P,GACC,IAAMqV,EAAarC,EAAIR,MAAM8C,WAAU,SAAA5T,GAAC,OAAIA,EAAE8F,iBAAmBqN,KAC3DU,EAAUvC,EAAIR,MAAMgD,OAAOH,EAAY,GAAG,GAC1CI,EAAW,eACZF,EADY,CAEfnK,KAAMuJ,EACNnN,eAAgBuN,IAGlB/B,EAAIR,MAAQQ,EAAIR,MAAM/Q,QAAO,SAAAC,GAAC,OAAIA,EAAE8F,iBAAmBuN,KACvD/B,EAAIR,MAAM2C,KAAKM,GACfzC,EAAIR,MAAMkD,MAAK,SAAC5E,EAAGhM,GAAJ,OAAUgM,EAAEtJ,eAAemO,cAAc7Q,EAAE0C,mBAE1DyL,GAAO,SAAC5H,GACN,OAAO,eACFA,SAIT,SAACvL,GACCb,EAAMc,YAAYD,OAIxB8V,KAAM,SAACC,GACL7H,QAAQC,IAAI,oBAAqB4H,GAEjC,IAAMhB,EAAeC,EAAgBtN,eAE/BoI,EAAS,CACbQ,WAAW,EACX/I,IAAK,CACHyG,UAAWkF,EAAIzP,KACfkM,UAAWoF,GAEbO,IAAK,CACHtH,UAAW+H,EACXpG,UAAWqF,EAAgB1J,OAI/BnM,EAAM0Q,SAASC,GACb,SAAC5P,GACC8V,EAAkBhB,EAAgBtN,gBAClCyL,GAAO,SAAC5H,GACN,OAAO,eACFA,SAIT,SAACvL,GACCb,EAAMc,YAAYD,OAIxByO,OAAQ,SAACyD,GACP,IAAM1C,EAAS,CACbxB,UAAWkF,EAAIzP,KACfkM,UAAWuC,EAASxK,gBAGtBvI,EAAMoQ,WAAWC,GACf,SAACtP,GACC8V,EAAkB9D,EAASxK,gBAC3ByL,GAAO,SAAA5H,GACL,sBACKA,SAIT,SAACvL,GACCb,EAAMc,YAAYD,OAGxB+T,MAAO,WACL5U,EAAMwK,QAAQuJ,EAAIzP,KAAMyP,EAAIP,QAAQC,SAEtCqD,qBAAsB,SAACC,GACrB/W,EAAMyP,uBAAuBsE,EAAIzP,KAAMyS,GACvChM,GAAMU,IAAIpD,GAAuBrI,EAAM2D,KAAM3D,EAAM8G,QAAQxC,OAC1DoH,MAAK,SAAU3K,GACd,IAAMiW,EAAaC,EAAalD,EAAIP,QAASzS,EAASI,KAAK+S,UAAUC,OAAS,GAE9EH,EAAO,CACL1P,KAAMtE,EAAM8G,QAAQxC,KACpBgP,IAAKtT,EAAM8G,QAAQ0C,cACnBiJ,YAA2C,cAA9B1R,EAASI,KAAK8S,YAC3BV,MAAOxS,EAASI,KAAK+S,UACrBV,QAAQ,eAAKO,EAAIP,QAAV,GAAsBwD,GAC7BvS,cAAesP,EAAItP,mBAGtBkH,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,QAKxB,SAASgW,EAAkBtO,GACzB,IAAMrG,EAAM6R,EAAIR,MAAMY,OAAS,EACzB6C,EAAaC,EAAalD,EAAIP,QAAStR,GAC7C6R,EAAIP,QAAJ,eAAmBO,EAAIP,QAAvB,GAAkCwD,GAElCjD,EAAIR,MAAQQ,EAAIR,MAAM/Q,QAAO,SAAAsB,GAAI,OAAIA,EAAKyE,iBAAmBA,KAG/D,SAAS0O,EAAazD,EAAStR,GAC7B,MAAM,CACJuR,OAAOwB,EAAczB,EAAQC,OAAQ,EAAGvR,GACxCwR,OAAOuB,EAAczB,EAAQE,OAAQ,EAAGxR,GACxC0R,YAAYqB,EAAczB,EAAQI,YAAa,EAAG1R,GAClD2R,YAAYoB,EAAczB,EAAQK,YAAa,EAAG3R,GAClD4R,YAAYmB,EAAczB,EAAQM,YAAa,EAAG5R,IAItD,SAASgV,IACP,IAAMzS,GAAiBsP,EAAItP,cAExBA,GAA6C,OAA5BsP,EAAIR,MAAM,GAAG4D,WAC/BpM,GAAMU,IAAIpD,GAAuBrI,EAAM2D,KAAM3D,EAAM8G,QAAQxC,KAAMG,IAChEiH,MAAK,SAAU3K,GACdiT,GAAO,SAAA5H,GAGL,OAFAA,EAAK3H,cAAgBA,EACrB2H,EAAKmH,MAAQxS,EAASI,KAAK+S,UACpB,eAAK9H,SAGfT,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,MAIpBmT,GAAO,SAAA5H,GAEL,OADAA,EAAK3H,cAAgBA,EACd,eAAK2H,MAKlB,IAAMgL,EAAe,CACnBC,WAAY,SAACzV,GPhNO,IAAC+B,EOiNnBoH,GAAMuM,KPjNa3T,EOiNY3D,EAAM2D,KPhNlCD,EAASC,EAAM,oBOgN0B,CAC1CkL,UAAWkF,EAAIzP,KACfmB,KAAM7D,IAEL8J,MAAK,SAAU3K,GACdgO,QAAQC,IAAIjO,EAASI,SAEtBwK,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,OAGxB0W,QAAS,WACPxM,GAAMU,IP1Nc,SAAC9H,EAAMW,GAC/B,IAAMC,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,iCAAiCY,IOwNlC8D,CAAuBrI,EAAM2D,KAAMoQ,EAAIzP,OAC9CoH,MAAK,SAAU3K,GACdgO,QAAQC,IAAI,iBAAkBjO,EAASI,MACvCnB,EAAMyP,uBAAuBsE,EAAIzP,KAAMvD,EAASI,SAEjDwK,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,QA5TA,EAiUoBmJ,oBAAS,GAjU7B,mBAiUnBnC,EAjUmB,KAiUF2P,EAjUE,OAkUUxN,oBAAS,GAlUnB,mBAkUnByN,EAlUmB,KAkUPC,EAlUO,KAoUpBC,EAAgB,CACpBC,SAAU,WACJ7D,EAAItB,YAAeiF,GAAc,GAC9BrD,EAAYO,SAErBiD,SAAU,WACJ9D,EAAItB,YAAeyE,IAChB7C,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,IAEjDqE,SAAU,WACJ/D,EAAItB,YAAe4B,EAAYO,QAC5BP,EAAYC,OAAOP,EAAIR,MAAMY,OAAS,IAE/C4D,OAAQ,WACFhE,EAAItB,YAAe4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,GACxDyD,KAETc,OAAQ,WACNR,GAAmB,IAErBS,OAAQ,WACFlE,EAAItB,aAAe4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,IAGjEyE,QAAS,WACHnE,EAAItB,YAAe4B,EAAYC,OAAO,GACnCoD,GAAc,IAEvBS,QAAS,WACHpE,EAAItB,aACD4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,IAEjD2E,QAAS,WACHrE,EAAItB,YAAe4B,EAAYC,OAAOP,EAAIR,MAAMY,OAAS,GACtDE,EAAYC,OAAO,KAIxB+D,EAAeC,wBAAa,CAChCC,WAAY,SAACC,GACPzE,EAAItB,aACR4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,IAE1CgF,aAAc,SAACD,GACTzE,EAAItB,aACR4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,IAE1CiF,aAAc,SAACF,GACVzE,EAAItB,aACP4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,IAE1CkF,cAAe,SAACH,GACXzE,EAAItB,aACP4B,EAAYC,OAAOP,EAAIP,QAAQC,OAAS,MAKtCmF,EAAyC,OAAhB7E,EAAIP,SAA2C,IAAvBO,EAAIP,QAAQC,OAC7DoF,EAAe9G,GAAgB6G,GAC/BE,EAAc,CAClBC,KAAK,eACAF,EAAa5G,OADd,CAEF+G,UAAW,IAAOC,OAAOC,cAE3BC,IAAI,eACCN,EAAa5G,OADf,CAED+G,UAAW,GAAMC,OAAOC,eAI5B,GAAoB,OAAhBnF,EAAIP,SAAyC,IAArBO,EAAIR,MAAMY,OAAgB,OAAQ,qCAE9DpF,QAAQC,IAAI,aAAc+E,GAE1B,IAAM8B,EAAwC,WAAtB9B,EAAIP,QAAQG,MAAqBI,EAAIR,MAAMQ,EAAIP,QAAQI,aACrD,WAAtBG,EAAIP,QAAQG,MAAqBI,EAAIR,MAAMQ,EAAIP,QAAQK,aAC/B,WAAtBE,EAAIP,QAAQG,MAAqBI,EAAIR,MAAMQ,EAAIP,QAAQM,aACrD,KAEFsF,EAAa,kBAAC7G,GAAD,CACjBW,GAAG,cACHrE,UAAWkF,EAAIzP,KACfyO,SAAUgB,EAAIR,MAAMQ,EAAIP,QAAQI,aAChCT,MAA6B,WAAtBY,EAAIP,QAAQG,MAAqB,KAA6B,WAAtBI,EAAIP,QAAQG,MAAqB,KAAO,KACvFlB,YAAasB,EAAItB,YACjB9O,KAAM3D,EAAM2D,KACZ0V,eAAe,WAGXC,EAAa,kBAAC/G,GAAD,CACjBW,GAAG,cACHrE,UAAWkF,EAAIzP,KACfyO,SAAUgB,EAAIR,MAAMQ,EAAIP,QAAQK,aAChCV,MAA6B,WAAtBY,EAAIP,QAAQG,MAAqB,KAA6B,WAAtBI,EAAIP,QAAQG,MAAqB,KAAO,KACvFlB,YAAasB,EAAItB,YACjB9O,KAAM3D,EAAM2D,KACZ0V,eAAe,WAGXE,EAAa,kBAAChH,GAAD,CACjBW,GAAG,cACHrE,UAAWkF,EAAIzP,KACfyO,SAAUgB,EAAIR,MAAMQ,EAAIP,QAAQM,aAChCX,MAA6B,WAAtBY,EAAIP,QAAQG,MAAqB,KAA6B,WAAtBI,EAAIP,QAAQG,MAAqB,KAAO,KACvFlB,YAAasB,EAAItB,YACjB9O,KAAM3D,EAAM2D,KACZ0V,eAAe,WAGjB,OACE,oCACE,yBAAKzP,UAAU,yBAAyBrD,MAAO,CAAEuB,QAAS9H,EAAMwZ,OAAS,QAAU,OAAQC,OAAQ,IAGjG,yBAAKlT,MAAO,CAAEL,OAAQ,QAASsB,SAAU,WAAYiB,KAAM,EAAGC,IAAK,IAChE0Q,EACAE,EACAC,GAEH,yBAAK3P,UAAU,UAAUrD,MAAO,CAAEkT,OAAQ,IACxC,yBAAK7P,UAAU,mBACb,0BAAMA,UAAU,eAAeiM,EAAgB1J,MAC/C,yBAAK5F,MAAO,CAAEiB,SAAU,QAASsB,OAAQ,MAAOnI,MAAO,OAAQ8G,UAAW,WACxE,0BAAMmC,UAAU,eAAemK,EAAIP,QAAQC,OAAS,EAApD,IAAwDM,EAAIR,MAAMY,WAItEJ,EAAItP,cACJ,yBAAKmF,UAAU,UAAUrD,MAAO,CAAEkT,OAAQ,IACxC,yBAAK7P,UAAU,mBACb,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAK0D,KAAM,GAAG,yBAAK/G,MAAOuS,EAAYC,QACtC,kBAAC,IAAD,CAAKzL,KAAM,IAAI,yBAAK/G,MAAOuS,EAAYC,QACvC,kBAAC,IAAD,CAAKzL,KAAM,GACT,yBAAK1D,UAAU,cAAcrD,MAAK,aAAIkB,UAAU,QAAUqR,EAAYC,OACpE,6BTxab,SAAqBW,GAAqB,IAAdC,EAAa,uDAAF,EAC5C,GAAc,IAAVD,EAAa,MAAO,UAExB,IAAME,EAAI,KACJC,EAAKF,EAAW,EAAI,EAAIA,EACxBG,EAAQ,CAAC,QAAS,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAE5D1Q,EAAIjH,KAAK4X,MAAM5X,KAAK6M,IAAI0K,GAASvX,KAAK6M,IAAI4K,IAEhD,OAAOI,YAAYN,EAAQvX,KAAK8X,IAAIL,EAAGxQ,IAAIqI,QAAQoI,IAAO,IAAMC,EAAM1Q,GS+Z9C6L,CAAoBY,EAAgBrE,KAAM,IAChD,6BAAMyD,EAAmBY,EAAgBsB,aACzC,6BAAMlC,EAAmBY,EAAgBqE,kBAV/B,qCAiBtB,yBAAKtQ,UAAU,UAAUrD,MAAO,CAAEkT,OAAQ,IACxC,uCAAKlT,MAAOsS,EAAatY,SAAa8X,GACpC,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAK/K,KAAM,GACT,yBAAKpF,QAASyP,EAAcO,QAAS3R,MAAOuS,EAAYC,MAEpD5G,GAAcyG,EAAW,qBAK/B,kBAAC,IAAD,CAAKtL,KAAM,IACT,yBAAKpF,QAASyP,EAAcI,OAAQxR,MAAOuS,EAAYC,MACpD5G,GAAcyG,EAAW,oBAG9B,kBAAC,IAAD,CAAKtL,KAAM,GACT,yBAAKpF,QAASyP,EAAcC,SAAUrR,MAAOuS,EAAYC,MACtD5G,GAAcyG,EAAW,kBAIhC,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKtL,KAAM,GACT,yBAAKpF,QAASyP,EAAcQ,QAAS5R,MAAOuS,EAAYK,KACrDhH,GAAcyG,EAAW,mBAG9B,kBAAC,IAAD,CAAKtL,KAAM,IACT,yBAAKpF,QAASyP,EAAcK,OAAQzR,MAAOuS,EAAYK,KACpDhH,GAAcyG,EAAW,kBAG9B,kBAAC,IAAD,CAAKtL,KAAM,GACT,yBAAKpF,QAASyP,EAAcE,SAAUtR,MAAOuS,EAAYK,KACtDhH,GAAcyG,EAAW,gBAIhC,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKtL,KAAM,GACT,yBAAKpF,QAASyP,EAAcS,QAAS7R,MAAOuS,EAAYC,MACrD5G,GAAcyG,EAAW,gBAG9B,kBAAC,IAAD,CAAKtL,KAAM,IACT,yBAAKpF,QAASyP,EAAcM,OAAQ1R,MAAOuS,EAAYC,QAEzD,kBAAC,IAAD,CAAKzL,KAAM,GACT,yBAAKpF,QAASyP,EAAcG,SAAUvR,MAAOuS,EAAYC,MACtD5G,GAAcyG,EAAW,mBAOtC,kBAAC,GAAD,CACEzO,QAAStC,EACTf,QAAS9G,EAAM8G,QACfoD,aAAc6J,EAAIP,QAAQC,OAC1BlF,SAAUsH,EAAgB1J,KAC1BxI,KAAM3D,EAAM2D,KAEZ6J,aAAc4J,EAAaC,WAC3B5J,UAAW,WAAQ2J,EAAaG,UAAWC,GAAmB,IAC9DzJ,OAAQ,SAACjK,GAAWuQ,EAAYC,OAAOxQ,GAAO0T,GAAmB,IACjEvJ,WAAY,WAAQoG,EAAYC,OAAOP,EAAIP,QAAQE,QAAS8D,GAAmB,IAC/EhJ,SAAU,SAACkH,EAAQC,GAAatB,EAAYoB,OAAOC,EAAQC,GAAS6B,GAAmB,IACvF/I,OAAQ,SAACmI,GAAavC,EAAYsC,KAAKC,GAASY,GAAmB,IACnEnJ,SAAU,WAAQgG,EAAY/E,OAAOuG,GAAkB2B,GAAmB,IAC1EjN,SAAU,kBAAMiN,GAAmB,MAErC,kBAAC,GAAD,CACErN,QAASsN,EACT5I,UAAWkF,EAAIzP,KACfX,KAAM3D,EAAM2D,KAEZ6G,QAAS,kBAAMkN,GAAc,IAC7B3H,aAAcsE,EAAYC,OAC1B7E,uBAAwB4E,EAAYyC,4B,UCviBtC/L,IADc1K,IAAZqO,QACM1D,EAAQ,IAASC,SA4HhBkP,mBAAWra,GA1H1B,SAAmBE,GACjB+O,QAAQC,IAAI,uBAGZ1J,qBAAU,WACR2T,OAAOmB,SAAS,EAAG,KAClB,IANqB,MAQQpQ,mBAAS,IARjB,mBAQjBqQ,EARiB,KAQPC,EARO,OASsBtQ,mBAAS,MAT/B,mBASjBuQ,EATiB,KASAC,EATA,OAU0BxQ,oBAAS,GAVnC,mBAUjByQ,EAViB,KAUEC,EAVF,KAYlBC,EAAgB,WACpB,OAAO,IAAI5O,SAAQ,SAACC,EAAS4O,GAAY,IAC/BtW,EAAStE,EAAM6a,WAAfvW,KACFC,EAAS,OAAGD,QAAH,IAAGA,IAAQ,GAE1ByG,GAAMU,IAAIpD,EAfD,EAe+B,EAAG,EAAG9D,IAC3CmH,MAAK,SAAC3K,GACLuZ,EAAYvZ,EAASI,MACrB4N,QAAQC,IAAI,YAAajO,EAASI,MAClC6K,EAAQ,yBAETL,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,GAClB+Z,EAAO,4BAIftV,qBAAU,WAAQqV,MAAoB,CAAC3a,EAAM6a,aAE7C,IAAMC,EAAgB,CACpBlU,KAAM,SAAC8C,EAAW5C,GACC,IAAd4C,EACD1J,EAAM+a,QAAQ7E,KAAK,WAAapP,EAAQxC,OAGxCkW,EAAmB1T,GACnB4T,GAAqB,KAIzB9F,MAAO,SAACtQ,EAAMkF,GACZkR,GAAqB,GAErB3P,GAAM6F,KAAKvI,GA3CF,GA2CoC,CAC3CwG,UAAWvK,EACXkF,cAAeA,IAEdkC,MAAK,SAAC3K,OAEN4K,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,MAGtByZ,EAAYD,EAASnR,KAAI,SAACpC,EAASkU,GACjC,OAAIlU,EAAQxC,OAASA,EACZwC,EAEF,eACFA,EADL,CAEE0C,cAAeA,UAMjByR,EAAc,CAClBC,kBAAmB,SAAC5W,GAClBgW,EAAYD,EAASnR,KAAI,SAACpC,EAASkU,GACjC,OAAIlU,EAAQxC,OAASA,EACZwC,EAEF,eACFA,EADL,CAEE4C,UAAW5C,EAAQ4C,UAAY,SAIrCoN,qBAAsB,SAACxS,EAAMyS,GAC3BuD,EAAYD,EAASnR,KAAI,SAACpC,EAASkU,GACjC,OAAIlU,EAAQxC,OAASA,EACZwC,EAEF,eACFA,EADL,CAEE4C,UAAWqN,EACXvN,cAAe,UAMvB,OACE,oCACE,kBAAC,KAAD,CAAe2R,UAAWR,GACxB,kBAAC,IAAD,CAAKS,OAAQ,EAAGzX,KAAK,QAClB0W,EAASnR,KAAI,SAAC2I,EAAGhC,GAAJ,OACZ,kBAAC,IAAD,CAAKtJ,MAAO,CAAEkB,UAAW,UAAY4T,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAAIlS,IAAK,WAAawI,EAAEvN,MAC7E,kBAAC,GAAD,CACEuL,MAAOA,EACP/I,QAAS+K,EACThL,OAAQ,SAACC,GAAD,OAAagU,EAAclU,KAAKiL,EAAEnI,UAAW5C,IACrDe,iBAAiB,EACjBlE,KAAM,UAMhB,kBAAC,GAAD,CACE6V,OAAQiB,EACRjQ,QAASsQ,EAAclG,MACvB4G,oBAAqBP,EAAYC,kBACjCzL,uBAAwBwL,EAAYnE,qBACpChQ,QAASyT,EACT5W,KAAM,SCzGC8X,OAvBf,SAAwBzb,GAKtB,OACE,oCACE,kBAAC,IAAD,CAAKob,OAAQ,CAAC,EAAG,IACf,kBAAC,IAAD,CAAKM,GAAI,GACP,+BAAQ1b,EAAM2b,QAEhB,kBAAC,IAAD,CAAKD,GAAI,IACP,kBAAC,KAAD,CACEE,YAAa5b,EAAM4b,YACnBha,MAAO5B,EAAM4B,MACb8I,SAdV,SAAsBC,GACpB3K,EAAM0K,SAAS1K,EAAM2b,MAAOhR,EAAMC,OAAOhJ,cCqB9Bia,OAvBf,SAAqB7b,GAKnB,OACE,oCACE,kBAAC,IAAD,CAAKob,OAAQ,CAAC,EAAG,IACf,kBAAC,IAAD,CAAK9N,KAAM,GACT,+BAAQtN,EAAM2b,QAEhB,kBAAC,IAAD,CAAKrO,KAAM,IACT,kBAAC,KAAD,CACEC,MAAO,EACP3L,MAAO5B,EAAM4B,MACb8I,SAdV,SAAsB9I,GACpB5B,EAAM0K,SAAS1K,EAAM2b,MAAO/Z,U,WCwBjBka,OA1Bf,SAAsB9b,GAIpB,OACE,oCACE,kBAAC,IAAD,CAAKob,OAAQ,CAAC,EAAG,IACf,kBAAC,IAAD,CAAKM,GAAI,GACP,+BAAQ1b,EAAM2b,QAEhB,kBAAC,IAAD,CAAKD,GAAI,IACP,kBAAC,KAAMK,MAAP,CAAarR,SAVrB,SAAsBC,GACpB3K,EAAM0K,SAAS1K,EAAM2b,MAAOhR,EAAMC,OAAOhJ,QASEA,MAAO5B,EAAM4B,MAAO2E,MAAO,CAAE5F,MAAO,SACvE,kBAAC,IAAD,KACGX,EAAMgc,MAAM9S,KAAI,SAAAC,GAAI,OACnB,kBAAC,IAAD,CAAKmE,KAAM,EAAGjE,IAAKF,GACjB,kBAAC,KAAD,CAAOE,IAAKF,EAAMvH,MAAOuH,GAAM,0BAAM5C,MAAO,CAAEwC,MAAO,UAAYI,c,WCIpE8S,OAnBf,SAAsBjc,GAKpB,OACE,oCACE,kBAAC,IAAD,CAAKob,OAAQ,CAAC,EAAG,IACf,kBAAC,IAAD,CAAK9N,KAAM,GACT,+BAAQtN,EAAM2b,QAEhB,kBAAC,IAAD,CAAKrO,KAAM,IACT,kBAAC,KAAD,CAAU5C,SAXlB,SAAsBC,GACpB3K,EAAM0K,SAAS1K,EAAM2b,MAAOhR,EAAMC,OAAOsR,UAUDA,QAASlc,EAAM4B,YCsB5Cua,OAlCf,SAA2Bnc,GAMzB,OACE,oCACE,kBAAC,IAAD,CAAKob,OAAQ,CAAC,EAAG,IACf,kBAAC,IAAD,CAAKM,GAAI,GACP,+BAAQ1b,EAAM2b,QAEhB,kBAAC,IAAD,CAAKD,GAAI,IACP,kBAAC,IAAD,CAAKN,OAAQ,GACVpb,EAAMgc,MAAM9S,KAAI,SAACC,GAAD,OACf,kBAAC,IAAD,CAAKmE,KAAM,EAAGjE,IAAKF,GACjB,kBAAC,IAAD,CACEE,IAAKF,EACLxF,KAAM3D,EAAM4B,MAAMwa,SAASjT,GAAQ,UAAY,OAC/CkT,QAAOrc,EAAM4B,MAAMwa,SAASjT,GAC5BjB,QAAS,kBAlBJyT,EAkBsBxS,OAjBzCnJ,EAAM0K,SAAS1K,EAAM2b,MAAOA,GAD9B,IAAqBA,GAmBLpV,MAAO,CAAE5F,MAAO,OAAQ8G,UAAW,OAAQrB,aAAc,QAExD+C,YCZbmT,GAAStR,EAAQ,KACjBD,GAAQC,EAAQ,IAASC,QAiJhBnL,UA/If,SAAmBE,GAAQ,IAAD,EACoBuc,YdmDtC,GAAN,OAAUjZ,EAAV,iBcnDckZ,EADU,EAChBrb,KAAwBsb,EADR,EACC5b,MADD,EAGMmJ,mBAAS,CACrC1F,KAAM,GACNoF,UAAW,EACXF,cAAe,EACfkT,MAAO,CACLxc,MAAO,GACPyc,SAAU,QACV1I,YAAa,WACb2I,QAAS,GACTC,KAAM,GACN5T,UAAW,GACX6T,MAAO,GACPrX,KAAM,EACNsX,MAAO,GACPC,OAAO,EACP/U,QAAQ,EACRgV,UAAW,QAnBS,mBAGjBC,EAHiB,KAGRC,EAHQ,KAuBxB7X,qBAAU,gBACgBtE,IAApBhB,EAAM6O,WAEV9D,GAAMU,IdqCS,SAAC9H,EAAMW,GACxB,IAAMC,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,0BAA0BY,IcvC7B8D,CAAgBrI,EAAM2D,KAAM3D,EAAM6O,YACzCnD,MAAK,SAAU3K,GACdoc,EAAWpc,EAASI,SAErBwK,OAAM,SAAU9K,GACfb,EAAMc,YAAYD,QAGrB,CAACb,EAAM6O,YAEV,IAAMuO,EAAW,CACfC,cAAe,SAAU1B,EAAO/Z,GAC9B,IAAI0b,EAAU,gBAAQJ,GAClBK,EAAe3b,EACL,YAAV+Z,EACF4B,EAAe3b,EAAMoU,MAAM,KAEV,SAAV2F,GAA8B,cAAVA,KAC3B4B,EAAeL,EAAQR,MAAMzH,EAA6B0G,KACzCS,SAASxa,GACxB2b,EAAejB,GAAOkB,KAAKD,EAAc3b,GAGzC2b,EAAarH,KAAKtU,IAGtB0b,EAAWZ,MAAMzH,EAA6B0G,IAAU4B,EACxDJ,EAAWG,IAEbG,GAAI,WACFzd,EAAMU,KAAKwc,IAEbQ,OAAQ,WACN1d,EAAMuK,YAERoT,UAAW,WACT3d,EAAM4d,YAAYV,IAEpB5N,OAAQ,WACNtP,EAAMqO,SAAS6O,IAEjBW,QAAS,WACP7d,EAAMmb,UAAU+B,KAIdY,EACJ,yBAAKlU,UAAU,kBACb,yBAAKA,UAAU,mBACf,yBAAKmU,UAAW,EAAGnU,UAAU,iBAAiBoU,KAAK,SAASC,kBAAgB,iBAAiB/V,QAASkV,EAASM,QAC7G,yBAAKM,KAAK,WAAWpU,UAAU,eAAe1B,QAAS,SAACzF,GAAD,OAAOA,EAAEyb,oBAC9D,yBAAKtU,UAAU,qBACb,4BAAQ1B,QAASkV,EAASM,OAAQ/Z,KAAK,SAASwa,aAAW,QAAQvU,UAAU,mBAC3E,0BAAMA,UAAU,qBACd,uBAAGuU,aAAW,cAAcvU,UAAU,8CACpC,yBAAKwU,QAAQ,gBAAgBC,UAAU,QAAQzU,UAAU,GAAG0U,YAAU,QAAQC,KAAK,eAAeC,cAAY,OAAOjY,MAAO,CAAEL,OAAQ,MAAOvF,MAAO,QAClJ,0BAAM8d,EAAE,mUAMhB,yBAAK7U,UAAU,uBACb,yBAAKA,UAAU,qBAAqBsJ,GAAG,kBAAvC,kBAEF,yBAAKtJ,UAAU,qBACZ6S,EAAU,4BAA+BD,EACxC,oCACE,kBAAC,GAAD,CAAgBb,MAAM,QAAQ/Z,MAAOsb,EAAQR,MAAMxc,MAAOwK,SAAU0S,EAASC,gBAC7E,kBAAC,GAAD,CAAgB1B,MAAM,UAAU/Z,MAAOsb,EAAQR,MAAME,QAAQ/Z,OAAQ6H,SAAU0S,EAASC,gBACxF,kBAAC,GAAD,CAAc1B,MAAM,WAAW/Z,MAAOsb,EAAQR,MAAMC,SAAUX,MAAOQ,EAAUkC,WAAYhU,SAAU0S,EAASC,gBAC9G,kBAAC,GAAD,CAAc1B,MAAM,cAAc/Z,MAAOsb,EAAQR,MAAMzI,YAAa+H,MAAOQ,EAAUmC,aAAcjU,SAAU0S,EAASC,gBACtH,kBAAC,GAAD,CAAa1B,MAAM,OAAO/Z,MAAOsb,EAAQR,MAAMjX,KAAMiF,SAAU0S,EAASC,gBACxE,kBAAC,GAAD,CAAgB1B,MAAM,OAAO/Z,MAAOsb,EAAQR,MAAM/S,KAAMe,SAAU0S,EAASC,gBAC3E,kBAAC,GAAD,CAAmB1B,MAAM,OAAO/Z,MAAOsb,EAAQR,MAAMG,KAAMb,MAAOQ,EAAUK,KAAMnS,SAAU0S,EAASC,gBACrG,kBAAC,GAAD,CAAmB1B,MAAM,YAAY/Z,MAAOsb,EAAQR,MAAMzT,UAAW+S,MAAOQ,EAAUvT,UAAWyB,SAAU0S,EAASC,gBACpH,kBAAC,GAAD,CAAc1B,MAAM,SAAS/Z,MAAOsb,EAAQR,MAAMzU,OAAQyC,SAAU0S,EAASC,gBAC7E,kBAAC,GAAD,CAAc1B,MAAM,QAAQ/Z,MAAOsb,EAAQR,MAAMM,MAAOtS,SAAU0S,EAASC,iBAXzB,cAexD,yBAAKzT,UAAU,uBACb,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAK0D,KAAM,GACT,kBAAC,IAAD,CAAQpF,QAASkV,EAAS9N,OAAQ3L,KAAK,SAAS4C,MAAO,CAAE5F,MAAO,SAAhE,WAIF,kBAAC,IAAD,CAAK2M,KAAM,IACX,kBAAC,IAAD,CAAKA,KAAM,GACT,kBAAC,IAAD,CAAQpF,QAASkV,EAASS,QAASla,KAAK,QAAQ4C,MAAO,CAAE5F,MAAO,OAAQoI,MAAO,UAA/E,YAIF,kBAAC,IAAD,CAAKuE,KAAM,IACX,kBAAC,IAAD,CAAKA,KAAM,GACT,kBAAC,IAAD,CAAQpF,QAASkV,EAASO,UAAWha,KAAK,QAAQ4C,MAAO,CAAE5F,MAAO,OAAQoI,MAAO,UAAjF,UAIF,kBAAC,IAAD,CAAKuE,KAAM,IACX,kBAAC,IAAD,CAAKA,KAAM,GACT,kBAAC,IAAD,CAAQpF,QAASkV,EAASK,GAAI9Z,KAAK,UAAU4C,MAAO,CAAE5F,MAAO,SAA7D,eAYhB,OAAQ,oCAAGX,EAAMwZ,OAASsE,EAAO,O,UC5J7Bc,GAAc,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAErB,OADkBC,yBAAc,CAAEC,SAAU,MACzBF,EAAW,MAE1BG,GAAa,SAAC,GAAkB,IAAhBH,EAAe,EAAfA,SAEpB,OADiBC,yBAAc,CAAE/W,SAAU,MACzB8W,EAAW,MCSvBnQ,GAAYrO,IAAZqO,QACF3D,GAAQC,EAAQ,IAASC,QAyPhBkP,mBAAWra,GAvP1B,SAAgBE,GACd+O,QAAQC,IAAI,oBAGZ1J,qBAAU,WACR2T,OAAOmB,SAAS,EAAG,KAClB,IAGH,IATqB,EAUWpQ,mBAAS,IAVpB,mBAUdqQ,EAVc,KAUJC,EAVI,OAWStQ,mBAAS,GAXlB,mBAWdiV,EAXc,KAWLC,EAXK,KAafvE,EAAgB,WACpB,OAAO,IAAI5O,SAAQ,SAACC,EAAS4O,GAAY,IAAD,EACT5a,EAAM6a,WAA3B/W,EAD8B,EAC9BA,KAAMC,EADwB,EACxBA,IAAKC,EADmB,EACnBA,MAEnB+G,GAAMU,IAAIpD,EAfD,EAe+BvE,EAAMC,EAAKC,IAChD0H,MAAK,SAAC3K,GACLuZ,EAAYvZ,EAASI,MACrB6K,EAAQ,yBAETL,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,GAClB+Z,EAAO,4BAIftV,qBAAU,WAAQqV,MAAoB,CAAC3a,EAAM6a,aA5BxB,MA8B2B7Q,mBAAS,IA9BpC,mBA8BdmV,EA9Bc,KA8BIC,EA9BJ,KA+BrB9Z,qBAAU,WACR,IAGM+Z,GAHoC,OAArBrf,EAAMsf,WAAsBjF,EAC7CA,EAAS7X,QAAO,SAAAqP,GAAO,OAAOA,EAAEpM,OAASzF,EAAMsf,eAEpB5d,MAAM,EA1BtB,IA0ByBud,GAExCG,EAAoBC,KACnB,CAAChF,EAAU4E,EAASjf,EAAMsf,aAtCR,MA+C6BtV,oBAAS,GA/CtC,mBA+CdyQ,EA/Cc,KA+CKC,EA/CL,KAgDrBpV,qBAAU,WACR,IAAIia,EAAOhL,SAASgL,KAElBA,EAAKhZ,MAAMiZ,SADV/E,EACqB,SAGA,YAExB,CAACA,IAxDkB,MA0DyBzQ,mBAAS,MA1DlC,mBA0DduQ,EA1Dc,KA0DGC,EA1DH,KA4DfM,EAAgB,CACpBlU,KAAM,SAACE,GACLiI,QAAQC,IAAI,OAAQlI,GAEpB0T,EAAmB1T,GACnB4T,GAAqB,IAGvB9F,MAAO,SAACtQ,EAAMkF,GACZuF,QAAQC,IAAI,iCACZ0L,GAAqB,GAErB3P,GAAM6F,KAAKvI,GAtEF,GAsEoC,CAC3CwG,UAAWvK,EACXkF,cAAeA,IAEdkC,MAAK,SAAC3K,OAEN4K,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,MAGtByZ,EAAYD,EAASnR,KAAI,SAACpC,EAASkU,GACjC,OAAIlU,EAAQxC,OAASA,EACZwC,EAEF,eACFA,EADL,CAEE0C,cAAeA,EACfvB,OAAQuB,IAAkB1C,EAAQ4C,UAAY,GAAW5C,EAAQmB,eAzFpD,EAiGyB+B,oBAAS,GAjGlC,mBAiGdyV,EAjGc,KAiGGC,EAjGH,OAkGuB1V,wBAAShJ,GAlGhC,mBAkGd2e,EAlGc,KAkGGC,EAlGH,KAoGf3E,EAAc,CAClBlU,KAAM,SAACzC,GACLob,GAAmB,GACnBE,EAAiBtb,IAEnB4W,kBAAmB,SAAC5W,GAClBgW,EAAYD,EAASnR,KAAI,SAACpC,EAASkU,GACjC,OAAIlU,EAAQxC,OAASA,EACZwC,EAEF,eACFA,EADL,CAEE4C,UAAW5C,EAAQ4C,UAAY,SAIrCoN,qBAAsB,SAACxS,EAAMyS,GAC3BuD,EAAYD,EAASnR,KAAI,SAACpC,EAASkU,GACjC,OAAIlU,EAAQxC,OAASA,EACZwC,EAEF,eACFA,EADL,CAEE4C,UAAWqN,EACXvN,cAAe,UAMjBqW,EAAc,CAClBpC,GAAI,SAACqC,GACHJ,GAAmB,GACnB3U,GAAM6F,KhBrDJ,GAAN,OAAUtN,EAAV,egBqDuCwc,GAChCpU,MAAK,SAAC3K,GACLgO,QAAQC,IAAI,uBAAwBjO,EAASI,MAE7C,IAAI4e,EAAW,aAAO1F,GAClB2F,EAAqBD,EAAY1J,WAAU,SAAAxE,GAAC,OAAIA,EAAEvN,OAASwb,EAAcxb,QAC7Eyb,EAAYC,GAAoBlW,UAAhC,WAAgDgW,EAAcpD,MAAME,QAAQ/Z,KAAK,MAAjF,aAA2Fid,EAAcpD,MAAMxc,OAC/G6f,EAAYC,GAAoB/W,UAAY6W,EAAcpD,MAAMzT,UAEhE8W,EAAYC,GAAoBrW,KAAOmW,EAAcpD,MAAM/S,KAE3D2Q,EAAYyF,MAEbpU,OAAM,SAAC9K,GAENb,EAAMc,YAAYD,OAGxB6c,OAAQ,WACNgC,GAAmB,IAErBpQ,OAAQ,SAAC4N,GACP,IAAMR,EAAQQ,EAAQR,MACtBhO,GAAQ,CACNxO,MAAM,iBAAD,OAAmBwc,EAAME,QAAQ/Z,KAAK,MAAtC,aAAgD6Z,EAAMxc,MAAtD,KACL+O,KAAM,kBAACC,GAAA,EAAD,MACNC,OAAQ,8BACRC,OAAQ,SACRC,WAAY,6BACZ3O,KANM,WAOJqK,GAAMuE,OhBnEI,SAAC3L,EAAMW,GACzB,IAAMC,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,2BAA2BY,IgBiErB8D,CAjKR,EAiK+B6U,EAAQ5Y,OACzCoH,MAAK,SAAU3K,GACd2e,GAAmB,GAEnBpF,EAAYD,EAAS7X,QAAO,SAAAsE,GAC1B,OAAOA,EAAQxC,OAAS4Y,EAAQ5Y,YAGnCqH,OAAM,SAAU9K,GACf6e,GAAmB,GACnB1f,EAAMc,YAAYD,OAGxB0J,SApBM,gBAwBVsT,QAAS,SAACX,GACRwC,GAAmB,GACnB3U,GAAMU,IAAIpD,GAAkB,EAAG6U,EAAQ5Y,OACpCoH,MAAK,SAAC3K,GACLf,EAAMC,QAAQ,gBAAiBc,EAASI,KAAM,SAE/CwK,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,OAGxB8c,UAAW,SAACT,GACVwC,GAAmB,GACnB1f,EAAM+a,QAAQ7E,KAAK,uBAAyBgH,EAAQ5Y,QAMxD,OACE,oCACE,kBAAC,KAAD,CAAe6W,UAAWR,GAExB,kBAAC,IAAD,CAAKS,OAAQ,EAAGzX,KAAK,QAClBwb,EAAiBjW,KAAI,SAAC2I,EAAGhC,GAAJ,OACpB,kBAAC,IAAD,CAAKtJ,MAAO,CAAEkB,UAAW,UAAY4T,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAAIlS,IAAK,WAAawI,EAAEvN,MAC7E,kBAAC,GAAD,CACEuL,MAAOA,EACP/I,QAAS+K,EACThL,OAAQiU,EAAclU,KACtBI,OAAQiU,EAAYlU,KAEpBc,iBAAiB,SAKzB,kBAAC,IAAD,CAAQoY,GAAG,MAAMvV,SAhLvB,SAAsBrD,EAAQ6Y,GAC5BnR,QAAQC,IAAI,eAAgBkR,GACzBA,EAAMC,gBAAgBjB,EAAWD,EAAU,KA+KxC,yBAAK1Y,MAAO,CAAC5F,MAAM,OAAQuF,OAAO,MAAOoD,gBAAgB,mBAG7D,yBAAK/C,MAAO,CAACiB,SAAS,QAASkB,IAAI,EAAGY,gBAAgB,kBACpD,kBAAC,GAAD,KAAY,yBAAK/C,MAAO,CAACiB,SAAS,WAAWtB,OAAO,WACpD,yBAAKK,MAAO,CAACiB,SAAS,WAAY8B,gBAAgB,YAAlD,iBACa+Q,EAASlG,OADtB,sBAC0CgL,EAAiBhL,UAI7D,kBAAC,GAAD,CACEqF,OAAQiB,EACRjQ,QAASsQ,EAAclG,MACvB4G,oBAAqBP,EAAYC,kBACjCzL,uBAAwBwL,EAAYnE,qBACpChQ,QAASyT,IAEX,kBAAC,GAAD,CACEf,OAAQiG,EACR5Q,UAAW8Q,EACXjf,KAAMmf,EAAYpC,GAClBlT,SAAUsV,EAAYnC,OACtBrP,SAAUwR,EAAYvQ,OACtB6L,UAAW0E,EAAYhC,QACvBD,YAAaiC,EAAYlC,iBCjNlByC,OA5Cf,SAAgBpgB,GACd,IAAMqgB,EAAqB,WAAfrgB,EAAM8D,KjBmEZ,GAAN,OAAUR,EAAV,sBiBlEiB,YAAftD,EAAM8D,KjBqEF,GAAN,OAAUR,EAAV,+BiBpEI,KAHiB,EAKiBiZ,YAAO8D,GAA/BC,EALO,EAKbnf,KAER,GAPqB,EAKON,MAEf,OAAO,uCACpB,IAAKyf,EAAgB,OAAO,2CAE5B,IAAMxF,EAAgB,CACpBlU,KAAM,SAAUE,GACdiI,QAAQC,IAAI,cAAelI,GAC3B9G,EAAM+a,QAAQ7E,KAAK,iBAAmBpP,EAAQxC,QAIlD,OACE,oCACGgc,EAAapX,KAAI,SAACqX,EAAK1Q,GAAN,OAChB,kBAAC,IAAD,CAAKxG,IAAK,SAAWkX,EAAIpU,KAAMiP,OAAQ,EAAGzX,KAAK,OAAO4C,MAAO,CAAE2J,OAAQ,4BAA6BpC,aAAc,MAAO0S,WAAY,MAAOpa,aAAc,QACvI,8BAAfpG,EAAM8D,KACN,yBAAKyC,MAAO,CAAEiB,SAAU,aACtB,yBAAKjB,MAAO,CAAEiB,SAAU,WAAYkB,IAAK,QAASD,KAAM,SAAW8X,EAAIpU,OAC/D,GAEXoU,EAAIlG,SAASnR,KAAI,SAAC2I,GAAD,OAChB,kBAAC,IAAD,CAAKtL,MAAO,CAAEkB,UAAW,UAAY4T,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAAIlS,IAAK,WAAawI,EAAEvN,MAC7E,kBAAC,GAAD,CACEuL,MAAOA,EACP/I,QAAS+K,EACThL,OAAQiU,EAAclU,KACtBI,OAAQ,aACRqH,SAAU,aACVxG,iBAAiB,c,gDCxB3BkD,IADc1K,IAAZqO,QACM1D,EAAQ,IAASC,SAyXhBoI,UAAgBvT,GAvX/B,SAAwBE,GACtB,IAAMygB,EAAoB,CACxBC,aAAiB,CACfxN,GAAI,gBACJyN,mBAAmB,EACnB1O,OAAQ,CACN9F,KAAM,IACNyU,SAAS,EACTC,aAAa,EACb5R,KAAM6R,KAAeC,QAGzBL,aAAiB,CACfxN,GAAI,gBACJyN,mBAAmB,EACnB1O,OAAQ,CACN9F,KAAM,IACNyU,SAAS,EACTC,aAAa,EACb5R,KAAM6R,KAAeE,SAGzBN,aAAiB,CACfxN,GAAI,cACJyN,mBAAmB,EACnB1O,OAAQ,CACN9F,KAAM,IACNyU,SAAS,EACTC,aAAa,EACb5R,KAAM6R,KAAeG,UAGzBC,KAAcC,eACdD,KAAcE,eACdF,KAAcG,YACdH,KAAcI,cAcVC,EAAS,CACbC,aAAc,SAACrgB,GACbsgB,EAAc,CACZtX,SAAS,EACTW,QAAS,gBACTZ,aAAc,GACdxJ,KAAM,SAACqM,EAAK4I,GACV5G,QAAQC,IAAI,cAAejC,GAC3B2U,GAAa,SAACtV,GAWZ,OAVyB,OAArBuV,EAAUC,QACZ5hB,EAAMY,SAAS,oBAAqB,kDAEtCwL,EAAKyV,QAAQC,QAAQ,CACnB3V,KAAMY,EACNyE,KAAM,EACNuQ,SAAU,EACVxZ,eAAgB,KAChB0D,OAAQ,KAEH,gBACFG,UAMb4V,WAAY,SAAC7gB,GACX,GAAKA,EAAK8gB,QAAQC,WAAWC,MAA7B,CAEA,IAAMC,EAAgD,SAAjCjhB,EAAK8gB,QAAQC,WAAW/V,KAC3ChL,EAAK8gB,QAAQC,WAAW/V,KACxB,KACIkW,EAAgC,OAAjBD,EAAA,uBACfT,EAAUW,WADK,CACM,CAAEpP,GAAI,IAAK/G,KAAMiW,EAAcD,OAAO,KAC/DI,EAEFb,GAAa,SAACc,GAGZ,OAFAA,EAAcZ,OAASQ,EACvBI,EAAcF,UAAYD,EACnB,gBACFG,QAITlT,OAAQ,SAACnO,GAAU,IAAD,EACVshB,EAASthB,EAAKuhB,MAAMC,cAAc,GAClCf,EAAM,UAAGD,EAAUW,UAAUM,MAAK,SAAAC,GAAG,MAAe,MAAXA,EAAI3P,aAAvC,aAAG,EAAiD/G,KAE1DkE,EAAU,WACd,IAAMG,EAAYiS,EAAON,MAAQM,EAAOtW,KAAO8I,EAAiB,CAAC2M,EAAQa,EAAOtW,MAAO,MAEvF,MAAO,CACL0C,UAAW8S,EAAU9S,UACrB2B,UAAWA,GALC,GAShBxQ,EAAMoQ,WAAWC,GACf,SAACtP,GACCgO,QAAQC,IAAI,iBAAkBjO,GAC9B,IAAM+hB,EACDL,EAAON,OAAmB,MAAVP,EACVD,EAAUE,QAAQrf,QAAO,SAAAugB,GAAC,OAAIA,EAAE5W,OAASsW,EAAOtW,SAGvDwV,EAAUE,QAAQmB,SAAQ,SAAAD,GACpBA,EAAE5W,OAASyV,IACbmB,EAAE9W,OAAS8W,EAAE9W,OAAOzJ,QAAO,SAAAkN,GAAC,OAAIA,EAAEvD,OAASsW,EAAOtW,YAG/CwV,EAAUE,SAIrBH,GAAa,SAACuB,GAAD,uBACRA,EADQ,CAEXpB,QAASiB,UAGb,SAACjiB,GACCb,EAAMc,YAAYD,OAGxB4U,OAAQ,SAACtU,GACiC,IAApCA,EAAKuhB,MAAMC,cAAcxO,QAC7BsN,EAAc,CACZtX,SAAS,EACTW,QAAS,SACTZ,aAAc/I,EAAKuhB,MAAMC,cAAc,GAAGxW,KAC1CzL,KAAM,SAACqM,EAAK4I,GACV,IAAMC,EAAeX,EAAiB,CAAC0M,EAAUC,OAAQjM,GAAS,MAC5DG,EAAeb,EAAiB,CAAC0M,EAAUC,OAAQ7U,GAAM,MAEzD4D,EAAS,CACbQ,WAAW,EACX/I,IAAK,CACHyG,UAAW8S,EAAU9S,UACrB2B,UAAWoF,GAEbO,IAAK,CACHtH,UAAW8S,EAAU9S,UACrB2B,UAAWsF,IAIf9V,EAAM0Q,SAASC,GACb,SAAC5P,GACCmiB,EAAYvM,KAAKhG,MACjB,SAAC9P,GACDb,EAAMc,YAAYD,UAK5BsiB,UAAW,SAAChiB,GACV,IAAIA,EAAK8gB,QAAQmB,YAAYjB,OACxBhhB,EAAK8gB,QAAQoB,YAAYlB,MAA9B,CAEA,IAAMmB,EAAWniB,EAAK8gB,QAAQmB,YAAYjX,KACpCyJ,EAAeX,EAAiB,CAAC0M,EAAUC,OAAQ0B,GAAW,MAE9DxN,EAAeb,EAAiB,CADW,SAAlC9T,EAAK8gB,QAAQoB,YAAYlX,KAAkBhL,EAAK8gB,QAAQoB,YAAYlX,KAAO,KAC3CmX,GAAW,MAEpD3S,EAAS,CACbQ,WAAW,EACX/I,IAAK,CACHyG,UAAW8S,EAAU9S,UACrB2B,UAAWoF,GAEbO,IAAK,CACHtH,UAAW8S,EAAU9S,UACrB2B,UAAWsF,IAIf9V,EAAM0Q,SAASC,GACb,SAAC5P,GACCmiB,EAAYvM,KAAKhG,MACjB,SAAC9P,GACDb,EAAMc,YAAYD,SAKpBqiB,EAAc,CAClBvM,KAAM,SAAChG,GACaA,EAAOvI,IAAIyG,UAA7B,IACM0U,EAASC,EAAe7S,EAAOvI,IAAIoI,WACnCiT,EAASD,EAAe7S,EAAOwF,IAAI3F,WAEnCkT,EAAa,WACjB,GAAqB,OAAlBH,EAAO3B,OAAgB,CACxB,IAAM+B,EAAShC,EAAUE,QAAQxL,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASoX,EAAOD,YAClE,OAAO3B,EAAUE,QAAQtL,OAAOoN,EAAQ,GAAG,GAG3C,IAAMA,EAAShC,EAAUE,QAAQxL,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASoX,EAAO3B,UAC5DgC,EAASjC,EAAUE,QAAQ8B,GAAQ1X,OAAOoK,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASoX,EAAOD,YACjF,OAAO3B,EAAUE,QAAQ8B,GAAQ1X,OAAOsK,OAAOqN,EAAQ,GAAG,GAR3C,GAYbC,EAAiB,gBAClBH,EADkB,CAErBvX,KAAMsX,EAAOH,WAgBTQ,GAbe,WAEnB,GAAqB,OAAlBL,EAAO7B,OAAgB,CACxB,IAAM+B,EAAShC,EAAUE,QAAQxL,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASsX,EAAOH,YAClE,IAAe,IAAZK,EAAsBhC,EAAUE,QAAQtL,OAAOoN,EAAQ,GAAG,OAE3D,CACF,IAAMA,EAAShC,EAAUE,QAAQxL,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASsX,EAAO7B,UAC5DgC,EAASjC,EAAUE,QAAQ8B,GAAQ1X,OAAOoK,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASsX,EAAOH,YACjF,IAAe,IAAZM,EAAsBjC,EAAUE,QAAQ8B,GAAQ1X,OAAOsK,OAAOqN,EAAQ,GAAG,IAT3D,GAcE,OAAlBH,EAAO7B,OACDD,EAAUE,QAAQxL,WAAU,SAAA0M,GAAC,OAAIA,EAAE5W,OAASsX,EAAO7B,UAErD,MAkBT,SAAS4B,EAAehT,GACtB,IAAMuF,EAAMvF,EAAUwF,MAAM,MAC5B,OAAkB,IAAfD,EAAI5B,OACE,CACLyN,OAAQ7L,EAAI,GACZuN,SAAUvN,EAAI,IAIT,CACL6L,OAAQ,KACR0B,SAAUvN,EAAI,IAIpB,SAASgO,EAAQlS,EAAGhM,GAClB,GAAIgM,EAAEkQ,WAAalc,EAAEkc,SAAU,CAC7B,IAAIiC,EAAQnS,EAAE1F,KAAK1K,cAAewiB,EAAQpe,EAAEsG,KAAK1K,cACjD,OAAIuiB,EAAQC,GACF,EACND,EAAQC,EACH,EACF,EAET,OAAOpS,EAAEkQ,SAAWlc,EAAEkc,SAAW,GAAK,EAvCjB,OAApB+B,GACDnC,EAAUE,QAAQiC,GAAiB7X,OAAOiK,KAAK2N,GAC/ClC,EAAUE,QAAQiC,GAAiB7X,OAAOwK,KAAKsN,KAG/CpC,EAAUE,QAAQ3L,KAAK2N,GACvBlC,EAAUE,QAAQpL,KAAKsN,IAGzBrC,GAAa,SAACtV,GACZ,OAAO,gBACFA,QAiCL8X,EAAoB,CAAE/Z,SAAS,EAAOD,aAAc,KAAMY,QAAS,MAxR5C,EAyROd,mBAASka,GAzRhB,mBAyRtBC,EAzRsB,KAyRV1C,EAzRU,KA2RvBc,EAAY,CAAC,CAAErP,GAAI,IAAK/G,KAAM,OAAQgW,OAAO,IA3RtB,EA4RKnY,mBAAS,CACzC6E,UAAW,KACX3O,MAAO,GACP0hB,OAAQ,KACRC,QAAS,GACTS,UAAWC,IAjSgB,mBA4RtBZ,EA5RsB,KA4RXD,EA5RW,KAoS7Bpc,qBAAU,WACW,KAAftF,EAAMsE,MAA8B,OAAftE,EAAMsE,WAAgCtD,IAAfhB,EAAMsE,MAEtDyG,GAAMU,IlBxLc,SAAC9H,EAAMW,GAC7B,IAAMC,EAAYL,mBAAmBI,GACrC,OAAOZ,EAASC,EAAD,+BAA+BY,IkBsLlC8D,CAAqBrI,EAAM2D,KAAM3D,EAAMsE,OAC9CoH,MAAK,SAAC3K,GACL2gB,EAAa,CACX7S,UAAW7O,EAAMsE,KACjBpE,MAAOa,EAASI,KAAKjB,MACrB0hB,OAAQ,KACRC,QAAS9gB,EAASI,KAAK0gB,QACvBS,UAAWC,IAGbxT,QAAQC,IAAIjO,EAASI,SAEtBwK,OAAM,SAAC9K,GACNb,EAAMc,YAAYD,QAGrB,CAACb,EAAMsE,OAvTmB,MAyTW0F,mBAAS,IAzTpB,mBAyTtBoa,EAzTsB,KAyTRC,EAzTQ,KA0T7B/e,qBAAU,WACR,IAIMgf,GAJqC,OAArB3C,EAAUC,OAC9BD,EAAUE,QAAQe,MAAK,SAAAG,GAAC,OAAIA,EAAE5W,OAASwV,EAAUC,UAAQ3V,OACzD0V,EAAUE,SAEoB3Y,KAAI,SAAC6Z,EAAGlT,GAAW,IAAD,EAChD,MAAO,CACLqD,GAAIrD,EAAQ,EACZ1D,KAAM4W,EAAE5W,KACRgW,MAAsB,IAAfY,EAAEhB,SACTwC,aAA6B,IAAfxB,EAAEhB,SAAiB1Z,GAAwB0a,EAAExa,eAAgB,KAAO,KAClFiJ,KAAMuR,EAAEvR,KACRgT,cAAa,UAAEzB,EAAE9W,cAAJ,aAAE,EAAUkI,OACzBsQ,YAAY,EACZC,UAA0B,IAAf3B,EAAEhB,aAIjBsC,EAAgBC,KACf,CAAC3C,IAEJ,IAAMgD,EHvVC7F,yBAAc,CAAE/W,SAAU,MGuVD6c,KAAeC,KAE/C,OACE,oCACE,yBAAKte,MAAO,CACV5F,MAAO,OACPiN,QAAS,kBACTrE,UAAW,iBACXX,aAAc,iBACdxC,aAAc,QAEd,4BAAKub,EAAUzhB,QAEjB,yBAAKqG,MAAO,CAAEL,OAAQ,SACpB,kBAAC4e,GAAA,EAAD,CAAaC,QAASJ,GACpB,kBAAC,KAAD,CACEK,UAAU,EAEVC,MAAOb,EAAcc,YAAavD,EAAUW,UAAW6C,YAAa1E,EACpE2E,4BAA4B,EAC5BC,2BAA2B,EAC3BC,aA9TuB,SAACnkB,GAChB,kBAAZA,EAAK+R,GAAwBqO,EAAOjS,OAAOnO,GAC1B,kBAAZA,EAAK+R,GAAwBqO,EAAO9L,OAAOtU,GAC/B,gBAAZA,EAAK+R,GAAsBnE,QAAQC,IAAI7N,EAAK+R,IAC5C/R,EAAK+R,KAAOgO,KAAcqE,aAAarS,GAAIqO,EAAO4B,UAAUhiB,GAC5DA,EAAK+R,KAAOgO,KAAcG,YAAYnO,GAAInE,QAAQC,IAAI7N,EAAK+R,IAC3D/R,EAAK+R,KAAOgO,KAAcsE,UAAUtS,GAAIqO,EAAOS,WAAW7gB,GAC1DA,EAAK+R,KAAOgO,KAAcuE,iBAAiBvS,GAAInE,QAAQC,IAAI7N,EAAK+R,IAChE/R,EAAK+R,KAAOgO,KAAcI,aAAapO,IAAIqO,EAAOC,aAAargB,KAwThE,kBAAC,KAAD,MACA,kBAAC,KAAD,MACA,kBAAC,KAAD,MACA,kBAAC,KAAD,SAIN,kBAAC,GAAD,CACEgJ,QAASga,EAAWha,QAASK,QAAS,kBAAMiX,EAAcyC,IAC1Dha,aAAcia,EAAWja,aACzBxJ,KAAMyjB,EAAWzjB,KACjBoK,QAASqZ,EAAWrZ,e,0CCzXtBC,GAAQC,EAAQ,IAASC,QAEzBya,GAAWC,aAAI,CACnBzf,OAAQ,IACRvF,MAAO,SAgGMb,UA7Ff,SAAiBE,GAWf,SAAS4lB,EAAiBxT,EAAKnD,EAAK9C,EAAKkU,GACvC,MAAO,CACLwF,WAAW,EACXC,QAAS,EACTC,UAAW,GACX3T,KAAMA,EACNnD,KAAMA,EACN+W,QAAS,WAjBb,IAAoBC,EAASJ,EAATI,EAkBH9Z,EAlBY0Z,GAkBN,EAjBrBK,GAAU,SAAC9Z,GAGT,OAFAA,EAAK6Z,GAASJ,UAAYA,EAC1BzZ,EAAK6Z,GAASE,SAAWN,EAAY,EAAI,IAClC,eACFzZ,MAeH,IAAMga,EAAM,IAAIC,YAAYhG,EAAK,IACjC+F,EAAIE,UAAY,SAACC,GACf,IAAMC,EAAUhmB,KAAKimB,MAAMF,EAAIplB,MAAO4N,QAAQC,IAAI,WAAYwX,GAC9D,IAAMX,EAAYW,EAAQE,cAAgBF,EAAQG,QAC9Cd,GAAWO,EAAIxR,QAChB4R,EAAQI,SAAS5mB,EAAMY,SAAS,YAAa4lB,EAAQ3V,SAExD,IAAMiV,EAAU7Q,EAAsBuR,EAAQE,YAAaF,EAAQG,SACnET,GAAU,SAAA9Z,GAIR,OAHAA,EAAKD,GAAM2Z,QAAUA,EACrB1Z,EAAKD,GAAM0Z,UAAYA,EACvBzZ,EAAKD,GAAM4Z,UAAU7P,KAAKsQ,GACnB,eACFpa,SAlCM,InB4ICzI,EmB5ID,EA0COqG,mBAAS,CACnC6c,OAAQjB,EAAiB,SAAS,SAAS,SnBkGtCliB,EAASC,EAAM,mBmBjGpBmjB,SAAUlB,EAAiB,YAAa,OAAQ,WAAYvd,MAC5D0e,UAAWnB,EAAiB,aAAc,UAAW,YAAYvd,MACjE2e,MAAOpB,EAAiB,gBAAiB,SAAS,QAASvd,MAE3D4e,YAAY,CACVpB,WAAW,EACXC,QAAS,EACTC,UAAW,GACX3T,KAAM,YACNnD,KAAM,eACN+W,QAAS,MAEXkB,cAAc,CACZrB,WAAW,EACXC,QAAS,EACTC,UAAW,GACX3T,KAAM,YACNnD,KAAM,eACN+W,QAAS,MAEXmB,iBAAiB,CACftB,WAAW,EACXC,QAAS,EACTC,UAAW,GACX3T,KAAM,YACNnD,KAAM,eACN+W,QAAS,QAtEQ,mBA0Cd/T,EA1Cc,KA0CNiU,EA1CM,KA0ErB,OACE,oCACE,kBAACkB,GAAgBpnB,GAEjB,kBAAC,KAAD,CAASiU,YAAY,OAAO1N,MAAO,CAACwC,MAAM,UAA1C,WAGA,kBAACse,GAAiBpV,EAAO4U,QACzB,kBAACQ,GAAiBpV,EAAO6U,UACzB,kBAACO,GAAiBpV,EAAO8U,WACzB,kBAACM,GAAiBpV,EAAO+U,OAEzB,kBAAC,KAAD,CAAS/S,YAAY,OAAO1N,MAAO,CAACwC,MAAM,UAA1C,oBASN,SAASqe,GAAYpnB,GAAO,IAAD,EAEWgK,mBAAS,MAFpB,mBAElB7G,EAFkB,KAENmkB,EAFM,KAGzBhiB,qBAAU,WACRgiB,EnB3EKnkB,KmB4EL,IALuB,MAOe6G,mBAAS,MAPxB,mBAOlB5G,EAPkB,KAOJmkB,EAPI,KAQzBjiB,qBAAU,WACRiiB,EnBzEKnkB,KmB0EL,IAVuB,MAYqB4G,mBAAS,MAZ9B,mBAYlB3G,EAZkB,KAYDmkB,EAZC,KAiBzB,SAASC,EAASC,GAEhB3c,GAAMU,IAAIic,GACPhc,MAAK,SAAC3K,GAELf,EAAMC,QAAN,UAAiBc,EAASE,OAA1B,YAAoCF,EAASG,YAAc,GAAIH,EAASI,SAEzEwK,OAAM,SAAC9K,GAENb,EAAMc,YAAYD,MAIxB,OAjBAyE,qBAAU,WACRkiB,EnBvEKnkB,KmBwEL,IAgBA,oCACE,kBAACskB,GAAD,CAASlgB,UAAU,QACjBmgB,KACE,kBAACC,EAAD,CAAkBzV,KAAK,QAEzB0V,KACE,kBAAC,KAAMC,OAAP,CACEnmB,MAAOuB,EACPuH,SAAU,SAACjI,GAAQ6kB,EAAc7kB,EAAEmI,OAAOhJ,QAC1ComB,SAAU,WAAQP,EAAStkB,IAC3ByE,UpBxJM,EoByJNqgB,aAAW,MAIjB,kBAACN,GAAD,CAASlgB,UAAU,QACjBmgB,KACE,kBAACC,EAAD,CAAkBzV,KAAK,UAEzB0V,KACE,kBAAC,KAAMC,OAAP,CACEnmB,MAAOwB,EACPsH,SAAU,SAACjI,GAAQ8kB,EAAgB9kB,EAAEmI,OAAOhJ,QAC5ComB,SAAU,WAAQP,EAASrkB,IAC3BwE,UpBtKM,EoBuKNqgB,aAAW,MAIjB,kBAACN,GAAD,CAASlgB,UAAU,QACjBmgB,KACE,kBAACC,EAAD,CAAkBzV,KAAK,cAEzB0V,KACE,kBAAC,KAAMC,OAAP,CACEnmB,MAAOyB,EACPqH,SAAU,SAACjI,GAAQ+kB,EAAmB/kB,EAAEmI,OAAOhJ,QAC/ComB,SAAU,WAAQP,EAASpkB,IAC3BuE,UpBpLM,EoBqLNqgB,aAAW,MAIjB,kBAACN,GAAD,CAASlgB,UAAU,QACjBqgB,KACE,kBAAC,IAAD,CACEnkB,KAAK,UACLuE,QAAS,WnBnJE,IAACwf,ImBoJUvkB,EnBnJhC8V,OAAOiP,aAAaC,QAAQ,aAAcT,GAMnB,SAACA,GACxBzO,OAAOiP,aAAaC,QAAQ,eAAgBT,GmB6IhCrf,CAAsBjF,GnBvIR,SAACskB,GAC3BzO,OAAOiP,aAAaC,QAAQ,kBAAmBT,GmBuInCrf,CAAyBhF,IAE3BkD,MAAO,CAAE5F,MAAM,OAAQoH,SAAS,SAChCH,UpBnMM,GoB2LR,WAiBR,SAASigB,EAAiB7nB,GACxB,IAAMuG,EAAM,CACVia,WAAW,MACX1O,WAAW,QAGb,OACE,oCACE,yBAAKvL,MAAK,aAAG6hB,MAAM,QAAW7hB,IAASvG,EAAMoS,MAC7C,yBAAK7L,MAAK,aAAG6hB,MAAM,SAAY7hB,IAA/B,OAMR,SAAS8gB,GAAarnB,GACLA,EAAM+lB,UAAU7c,KAAI,SAAAzG,GAAC,OAAIA,EAAEoO,WAAShO,KAAK,MACxD,OACE,oCACA,yBAAK0D,MAAO,CAACuB,QAAQ,OAAQugB,cAAc,MAAOjiB,aAAa,QAC7D,yBAAKG,MAAO,CAAC5F,MAAM,UACnB,kBAAC,IAAD,CACEsO,KAAMjP,EAAMiP,KACZtL,KAAK,UACL2kB,QAAStoB,EAAM6lB,UACf3d,QAASlI,EAAMgmB,QACfuC,OAAO,EACPhiB,MAAO,CAAE5F,MAAM,OAAQoH,SAAS,SAChCH,UpBxOU,GoB0OT5H,EAAMoS,OAGT,yBAAK7L,MAAO,CACVL,OAAO,OACPsiB,KAAK,OACLC,WAAW,OACX3gB,QAAQ,OACR4gB,eAAgB,WAChBL,cAAe,WAEf,kBAAC,KAAD,CAAUM,cAAc,SAAS7C,QAAS9lB,EAAM8lB,YAGpD,yBAAK8C,OAAmC,IAA3B5oB,EAAM+lB,UAAU5R,OAC3B5N,MAAO,CAACuB,QAAQ,OAAQugB,cAAc,MAAOjiB,aAAa,QAC1D,yBAAKG,MAAO,CAAC5F,MAAM,WACnB,yBAAK4F,MAAO,CAEViiB,KAAK,OACLC,WAAW,OACXI,aAAa,SAEb,kBAAC,KAAD,CAAgBjf,UAAW8b,IACxB1lB,EAAM+lB,UAAU7c,KAAI,SAAAzG,GAAC,OAAI,uBAAG8D,MAAO,CAACH,aAAa,UAAW3D,EAAEoO,gBAQzE,SAAS8W,GAAQ3nB,GAAO,IAAD,EACfuG,EAAQ,CACZuB,QAAQ,OACRugB,cAAc,MACdjiB,aAAa,MACbqB,UAAS,UAAEzH,EAAMyH,iBAAR,QAAqB,QAGhC,OACE,oCACA,yBAAKlB,MAAOA,GACV,yBAAKA,MAAO,CAAC5F,MAAM,UAChBX,EAAM4nB,MAET,yBAAKrhB,MAAO,CACVL,OAAO,OACPsiB,KAAK,OACLC,WAAW,OACX3gB,QAAQ,OACR4gB,eAAgB,WAChBL,cAAe,WAEdroB,EAAM8nB,QC3Q4BgB,IAAnCC,O,IAAQC,GAA2BF,IAA3BE,QAASC,GAAkBH,IAAlBG,OAAQC,GAAUJ,IAAVI,MACzBC,GAAYC,IAAZD,QA6MOhP,mBAAWra,GA1M1B,SAAuBE,GAAQ,IAAD,UACQgK,oBAAS,GADjB,mBACrByN,EADqB,KACTC,EADS,OAEc1N,oBAAS,GAFvB,mBAErBqf,EAFqB,KAENC,EAFM,OAIQtf,mBAAS,MAJjB,mBAIrBsV,EAJqB,KAITiK,EAJS,KAKtBC,EAAsB,SAAC/jB,GAE3B8jB,EADgB9jB,IAAS6Z,EAAa,KAAO7Z,IAGzCgkB,EAAO,UAAGC,IAAYjD,MAAMzmB,EAAM2pB,SAASC,QAAQ5lB,aAA5C,QAAqD,GAC5D6lB,EAAO,UAAGH,IAAYjD,MAAMzmB,EAAM2pB,SAASC,QAAQ9lB,YAA5C,QAAoD,EAC3DgmB,EAAM,UAAGJ,IAAYjD,MAAMzmB,EAAM2pB,SAASC,QAAQ7lB,WAA5C,QAAmD,EACzDgmB,EAAO,UAAGL,IAAYjD,MAAMzmB,EAAM2pB,SAASC,QAAQtlB,YAA5C,QAAoD,GAEjEyK,QAAQC,IAAI,yBAEZ,IAAM6L,EAAa,CACjB7W,MAAOylB,EACP3lB,KAAM+lB,EACN9lB,IAAK+lB,EACLxlB,KAAMylB,GApBoB,EAuBI,WAC9B,SAAS7U,EAAQpR,EAAMkmB,GACrB,MAAO,CACLlmB,KAAMA,EACNkmB,aAAcA,GAGlB,GAAkB,OAAfhqB,EAAM8D,KACP,OAAOoR,EACL,kBAAC,GAAD,CAAW2F,WAAYA,EAAYyE,WAAYA,IAC7C,KAED,GAAmB,WAAftf,EAAM8D,KACb,OAAOoR,EACL,kBAAC,GAAD,CAAQ2F,WAAYA,EAAYyE,WAAYA,IAC1C,KAED,GAAmB,YAAftf,EAAM8D,KACb,OAAOoR,EACL,kBAAC,GAAD,CAAQpR,KAAM9D,EAAM8D,KAAMiX,QAAS/a,EAAM+a,UACvC,KAED,GAAmB,WAAf/a,EAAM8D,KACb,OAAOoR,EACL,kBAAC,GAAD,CAAQpR,KAAM9D,EAAM8D,KAAMiX,QAAS/a,EAAM+a,UACvC,KAED,GAAmB,mBAAf/a,EAAM8D,KAA2B,CAAC,IAAD,EAClCQ,EAAI,UAAGolB,IAAYjD,MAAMzmB,EAAM2pB,SAASC,QAAQtlB,YAA5C,QAAoD,GAC9D,OAAO4Q,EAAQ,kBAAC,GAAD,CAAgB5Q,KAAMA,IAAU,IAE5C,MAAmB,YAAftE,EAAM8D,KACNoR,EACL,kBAAC,GAAD,CAASpR,KAAM9D,EAAM8D,OACnB,UAHD,EA/ByB,GAAxBA,EAvBoB,EAuBpBA,KAAMkmB,EAvBc,EAuBdA,aAsCRC,EAAe,CACnBL,OAAQ,SAAU5lB,GAChB,IAAMkmB,EtBrEL,SAAkBtf,EAAQuf,GAC/B,IAAIvoB,EAAQ,EAIZ,OAHAuoB,EAAQnH,SAAQ,SAAUoH,GACxBxoB,GAAgBgJ,EAAOwR,SAASgO,MAEhB,IAAVxoB,EsBgEmB6H,CAAgBzF,EAAMgS,MAAM,KAAK,GAAI,CAAC,IAAK,IAAK,IAAK,MAAQhS,EAAQ,SAAWA,EACvGimB,EAAaI,cAAcH,IAE7BI,KAAM,SAAUC,GACd,IAAMC,EAAkB,OAASD,EAC3BE,EAAmB,OAASF,EAG9BG,GAD+B,KAAZjB,EAAiBA,EAAQzT,MAAM,KAAO,IAC7BxT,QAAO,SAAC2G,EAAM0G,GAAP,QAAmB1G,IAASqhB,GAAmBrhB,IAASshB,MAC/FC,EAAWxU,KAAKsU,GAChB,IAAMG,EAAiBD,EAAW7nB,KAAK,KAEvConB,EAAaI,cAAcM,IAE7BC,MAAO,SAAUL,GACf,IAAMC,EAAkB,OAASD,EAC3BE,EAAmB,OAASF,EAG9BG,GAD+B,KAAZjB,EAAiBA,EAAQzT,MAAM,KAAO,IAC7BxT,QAAO,SAAC2G,EAAM0G,GAAP,QAAmB1G,IAASqhB,GAAmBrhB,IAASshB,MAC/FC,EAAWxU,KAAKuU,GAChB,IAAME,EAAiBD,EAAW7nB,KAAK,KAEvConB,EAAaI,cAAcM,IAE7BN,cAAe,SAAUrmB,GACvB,IAAI6mB,EAAmB,IAAIC,gBAAgB7R,OAAO0Q,SAASC,QAC3DiB,EAAiBE,IAAI,QAAS/mB,GAC9BhE,EAAM+a,QAAQ7E,KAAK,UAAY2U,EAAiBxpB,cAI9C2pB,EACJ,oCACE,yBAAKphB,UAAU,SAGf,kBAACqhB,GAAD,CAAajnB,MAAOylB,EAAS/oB,KAAM,SAACsD,GAAD,OAAWimB,EAAaI,cAAcrmB,MACzE,kBAAC,IAAD,CAAMknB,MAAM,OAAOC,oBAAqB,CAACnB,GAAeoB,gBAAiB,CAAC,QAASC,KAAK,UAQpF,GACF,kBAAC,IAAKvb,KAAN,CAAWzG,IAAI,KACb,kBAAC,IAAD,CAAMiiB,GAAG,WACP,kBAACC,EAAA,EAAD,MACA,0CAGJ,kBAAC,IAAKzb,KAAN,CAAWzG,IAAI,KACb,kBAAC,IAAD,CAAMiiB,GAAG,YACP,kBAACE,EAAA,EAAD,MACA,2CAGJ,kBAAC,IAAK1b,KAAN,CAAWzG,IAAI,KACb,kBAAC,IAAD,CAAMiiB,GAAG,WACP,kBAACG,EAAA,EAAD,MACA,0CAGJ,kBAACtC,GAAD,CAAS9f,IAAI,OAAOnJ,MAAO,oCAAE,kBAACwrB,EAAA,EAAD,MAAgB,wCAC3C,kBAACC,GAAD,CAAkBC,OAAQ3B,EAAaK,KAAMuB,QAAS5B,EAAaW,MAAOnB,QAASA,KAErF,kBAAC,IAAK3Z,KAAN,CAAWzG,IAAI,KACb,kBAAC,IAAD,CAAMiiB,GAAG,YACP,kBAACQ,EAAA,EAAD,MACA,6CAOJC,EAAmB,SAACC,EAAKvmB,GAC7B,IAAMwmB,EAAcxmB,IAAS6Z,EAC7B,MAAY,SAAR0M,EACKC,EAAc,UAAY,OAG1BA,GAIX,OACE,kBAAC,IAAD,CAAWrqB,MAAO,CAAEsqB,mBAAmB,EAAOC,QAAS,SAAC9L,GAAD,OAAS+L,MAAM/L,GAAK3U,MAAK,SAAA6a,GAAG,OAAIA,EAAI8F,aACzF,kBAAC,IAAD,CAAQ9lB,MAAO,CAAEyS,UAAW,UAC1B,kBAAC,GAAD,KACE,kBAAC,IAAD,CAAQpP,UAAU,iBAChB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAK0D,KAAM,EAAG1D,UAAU,0BACtB,kBAAC,IAAD,CAAQ1B,QAAS,kBAAMshB,EAAoB,IAAI7lB,KAAMooB,EAAiB,OAAQ,GAAI1P,MAAO0P,EAAiB,QAAS,GAAIxlB,MAAO,CAAE5F,MAAO,SAAvI,WAEF,kBAAC,IAAD,CAAK2M,KAAM,EAAG1D,UAAU,0BACtB,kBAAC,IAAD,CAAQ1B,QAAS,kBAAMshB,EAAoB,IAAI7lB,KAAMooB,EAAiB,OAAQ,GAAI1P,MAAO0P,EAAiB,QAAS,GAAIxlB,MAAO,CAAE5F,MAAO,SAAvI,WAEF,kBAAC,IAAD,CAAK2M,KAAM,EAAG1D,UAAU,0BACtB,kBAAC,IAAD,CAAQ1B,QAAS,kBAAMshB,EAAoB,IAAI7lB,KAAMooB,EAAiB,OAAQ,GAAI1P,MAAO0P,EAAiB,QAAS,GAAIxlB,MAAO,CAAE5F,MAAO,SAAvI,WAEF,kBAAC,IAAD,CAAK2M,KAAM,EAAG1D,UAAU,sBAAsB1B,QAAS,kBAAMwP,GAAc,KACzE,kBAAC4U,EAAA,EAAD,CAAc1iB,UAAU,iBAI9B,kBAAC,IAAD,CACE+F,UAAU,QACVrF,UAAU,EACVE,QAAS,kBAAMkN,GAAc,IAC7BvN,QAASsN,GAERuT,IAGL,kBAAC,GAAD,KACE,kBAAC9B,GAAD,CAAOqD,aAAW,EAACC,UAAWnD,EAAeoD,WAAY,SAAC9hB,GAAD,OAAW2e,EAAiB3e,KAClFqgB,IAIL,kBAAC,IAAD,CAAQphB,UAAU,eAChB,kBAACof,GAAD,KACE,kBAAC,GAAD,KACE,yBAAKziB,MAAO,CAAEia,WAAY,OAA1B,uBAEF,yBAAK5W,UAAU,yBAAyBrD,MAAO,CAAEia,WAAY,GAAIkM,YAAa,GAAI7D,aAAc,GAAI7P,UAAW,MAC5GlV,IAGL,kBAACmlB,GAAD,CAAQ1iB,MAAO,CAAEkB,UAAW,WAA5B,4BASV,SAASkkB,GAAiB3rB,GAAQ,IAAD,EACDuc,YpBhKxB,GAAN,OAAUjZ,EAAV,coBgKcuZ,EADiB,EACvB1b,KAER,OAH+B,EACXN,MAEA,uCACfgc,EAGH,oCACGA,EAAK3T,KAAI,SAACyjB,EAAK9c,GAAN,OAAiB,kBAAC+c,GAAD,CAAavjB,IAAKsjB,EAAIxgB,KAAMwgB,IAAKA,EAAKf,OAAQ5rB,EAAM4rB,OAAQC,QAAS7rB,EAAM6rB,QAASgB,aAAcC,EAAgBH,EAAIxgB,KAAMnM,EAAMypB,eAJ7I,2CAQpB,SAASqD,EAAgBvC,EAASvmB,GAChC,IAAM+oB,EAAW/oB,EAAMgS,MAAM,KAK7B,OAJe+W,EAASvqB,QAAO,SAACwqB,GAAD,OAASA,EAAIvrB,cAAc2a,SAAS,OAASmO,EAAQ9oB,kBAAgB0S,OAAS,EAAI,OAC/G4Y,EAASvqB,QAAO,SAACwqB,GAAD,OAASA,EAAIvrB,cAAc2a,SAAS,OAASmO,EAAQ9oB,kBAAgB0S,OAAS,EAAI,QAChG,QAMR,SAASyY,GAAY5sB,GACnB,IAAMitB,EAAe/oB,mBAAmBlE,EAAM2sB,IAAI3oB,OAC5CkpB,EAAwC,SAAvBltB,EAAM6sB,aAA0B,UAAY,GAC7DM,EAAyC,UAAvBntB,EAAM6sB,aAA2B,UAAY,GAErE,OACE,wBAAIjjB,UAAU,gBAAgBoU,KAAK,WAAWzX,MAAO,CAAEmmB,YAAa,OAAQ7D,aAAc,MAAO3iB,OAAO,OAAQyH,UAAU,MAAOvH,aAAa,QAC5I,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKkH,KAAM,EAAG/G,MAAO,CAAEkB,UAAW,UAAYS,QAAS,kBAAMlI,EAAM4rB,OAAO5rB,EAAM2sB,IAAIxgB,QAAO,kBAACihB,EAAA,EAAD,CAAc7mB,MAAO,CAAEJ,YAAa,MAAOmD,gBAAiB4jB,MACvJ,kBAAC,IAAD,CAAM5B,GAAI,iBAAmB2B,GAC3B,kBAAC,IAAD,CAAK3f,KAAM,IACT,0BAAM/G,MAAO,CAAEsD,SAAU,SAAW7J,EAAM2sB,IAAIxgB,QAGlD,kBAAC,IAAD,CAAKmB,KAAM,EAAG/G,MAAO,CAAEkB,UAAW,UAAYS,QAAS,kBAAMlI,EAAM6rB,QAAQ7rB,EAAM2sB,IAAIxgB,QAAO,kBAACkhB,EAAA,EAAD,CAAe9mB,MAAO,CAAEJ,YAAa,MAAOmD,gBAAiB6jB,QAMjK,SAASlC,GAAYjrB,GAAQ,IAAD,EACIgK,oBAAS,GADb,mBACnBG,EADmB,KACVmjB,EADU,OAEAtjB,mBAAS,IAFT,mBAEnBhG,EAFmB,KAEZupB,EAFY,KAa1B,OATAjoB,qBAAU,WACRioB,EAASvtB,EAAMgE,SACd,CAAChE,EAAMgE,QAQR,yBAAKuC,MAAO,CAAEmmB,YAAa,SACzB,kBAAC,IAAD,CAAQ/oB,KAAK,OAAOuE,QAAS,kBAAMolB,GAAW,IAAO/mB,MAAO,CAAE5F,MAAO,MAAO8G,UAAW,OAAQmG,QAAS,QACtG,kBAAC4f,EAAA,EAAD,MADF,gBAGA,kBAAC,IAAD,CACErjB,QAASA,EACTI,SAAU,kBAAM+iB,GAAW,IAC3BhjB,UAAU,EACVF,OACE,kBAAC,IAAD,CAAQzG,KAAK,UAAUuE,QAf/B,WACEolB,GAAW,GACXttB,EAAMU,KAAKsD,KAcH,kBAACypB,EAAA,EAAD,MADF,WAKF,kBAAC,IAAD,CACE/iB,SAAU,SAACC,GAAD,OAAW4iB,EAAS5iB,EAAMC,OAAOhJ,QAC3CA,MAAOoC,MCrRF0pB,OAnBf,WACE,OACE,yBAAK9jB,UAAU,OACb,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAO+jB,OAAK,EAACrpB,KAAK,KAAK,kBAAC,IAAD,CAAUgnB,GAAG,aACpC,kBAAC,IAAD,CAAOqC,OAAK,EAACrpB,KAAK,OAAO,kBAAC,GAAD,CAAeR,KAAK,QAC7C,kBAAC,IAAD,CAAO6pB,OAAK,EAACrpB,KAAK,WAAW,kBAAC,GAAD,CAAeR,KAAK,YAEjD,kBAAC,IAAD,CAAO6pB,OAAK,EAACrpB,KAAK,YAAY,kBAAC,GAAD,CAAeR,KAAK,aAClD,kBAAC,IAAD,CAAO6pB,OAAK,EAACrpB,KAAK,WAAW,kBAAC,GAAD,CAAeR,KAAK,YACjD,kBAAC,IAAD,CAAO6pB,OAAK,EAACrpB,KAAK,mBAAmB,kBAAC,GAAD,CAAeR,KAAK,oBACzD,kBAAC,IAAD,CAAO6pB,OAAK,EAACrpB,KAAK,YAAY,kBAAC,GAAD,CAAeR,KAAK,iBCRxC8pB,QACW,cAA7B3U,OAAO0Q,SAASkE,UAEe,UAA7B5U,OAAO0Q,SAASkE,UAEhB5U,OAAO0Q,SAASkE,SAASC,MACvB,2D,cCVAC,GAAW,WACfC,aAAkB,CAAEC,cAAeC,OACnCC,IAASC,OAAO,kBAAC,GAAD,MAAS7Z,SAAS8Z,eAAe,SDyH7C,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrB9iB,MAAK,SAAA+iB,GACJA,EAAaC,gBAEd/iB,OAAM,SAAA9K,GACLkO,QAAQlO,MAAMA,EAAMgQ,aC3HxBoI,OAAO0V,QACTpa,SAASC,iBAAiB,cAAeuZ,IAAU,GAGnDA,M,oBClBFa,EAAOC,QAAU,IAA0B,qC","file":"static/js/main.953b1b49.chunk.js","sourcesContent":["import React from 'react';\r\nimport { Modal } from 'antd';\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  const width = 500;\r\n\r\n  function popInfo(title, stringContent, objContent) {\r\n    Modal.info({\r\n      title: (title),\r\n      content: (\r\n        <>\r\n          <span>{stringContent}</span>\r\n          <pre>{objContent ? JSON.stringify(objContent, null, 2) : \"\"}</pre>\r\n        </>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popError(title, stringContent, objContent) {\r\n    Modal.error({\r\n      title: (title),\r\n      content: (\r\n        <>\r\n          <span>{stringContent}</span>\r\n          <pre>{objContent ? JSON.stringify(objContent, null, 2) : \"\"}</pre>\r\n        </>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popApiError(error) {\r\n    if (error.response === null || error.response === undefined) {\r\n      Modal.error({\r\n        title: ('No response'),\r\n        content: (error.toString()),\r\n        onOk() { },\r\n        width: width\r\n      });\r\n      return;\r\n    }\r\n    const { status, statusText, data } = error.response;\r\n\r\n    const content = {\r\n      title: `${status} - ${statusText}`,\r\n      content: (\r\n        <span>\r\n          {JSON.stringify(data, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    };\r\n\r\n    if (status >= 400 && status < 500) {\r\n      Modal.warning(content);\r\n    }\r\n    else {\r\n      Modal.error(content);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      popInfo={popInfo}\r\n      popError={popError}\r\n      popApiError={popApiError}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;","\r\nexport function firstLetterLowerCase(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nexport function apiErrorHandler(error) {\r\n  if (typeof error.response !== undefined) {\r\n    alert(JSON.stringify(error.response, null, \"\\t\"))\r\n  }\r\n  else {\r\n    alert(JSON.stringify(error, null, \"\\t\"));\r\n  }\r\n}\r\n\r\nexport function getPercent100(value, maxValue) {\r\n  if(maxValue === 0) return 0;\r\n\r\n  let fraction = (value / maxValue) * 100;\r\n  let result = fraction <= 100 ? fraction : 100;\r\n  return result;\r\n}\r\n\r\nexport function contains(target, pattern) {\r\n  var value = 0;\r\n  pattern.forEach(function (word) {\r\n    value = value + target.includes(word);\r\n  });\r\n  return (value === 1);\r\n}\r\n\r\nexport function clamp(number, min, max) {\r\n  return Math.max(min, Math.min(number, max));\r\n}\r\n\r\nexport function clickReport(event) {\r\n  const result = {\r\n    ecy: event.clientY,\r\n    epy: event.pageY,\r\n    ety: event.touches && event.touches[0] ? event.touches[0].clientY : null,\r\n    echy: event.changedTouches && event.changedTouches[0] ? event.changedTouches[0].clientY : null\r\n  };\r\n  return result;\r\n}\r\n\r\nexport function pathJoin(parts, sep){\r\n  var validParts = parts.filter(e => { return e != null && e !== \"\" });\r\n  var separator = sep || '/';\r\n  var replace   = new RegExp(separator+'{1,}', 'g');\r\n  \r\n  return validParts.join(separator).replace(replace, separator);\r\n}\r\n\r\nexport function formatBytes(bytes, decimals = 2){\r\n  if (bytes === 0) return '0 Bytes';\r\n\r\n  const k = 1024;\r\n  const dm = decimals < 0 ? 0 : decimals;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\n\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\r\n}\r\n\r\nexport function formatDate(date){\r\n  return new Date(date).toLocaleString();\r\n}","//const API_URL = \"http://192.168.1.5:5000/\";\r\nconst API_URL = \"http://localhost:51474/\";\r\n//const API_URL = \"https://wkr.azurewebsites.net/\";\r\nconst IS_PUBLIC = true;\r\n\r\nconst STORAGE_URL = \"https://wkrstorage.file.core.windows.net/library/\";\r\nconst SAS_TOKEN = \"?sv=2020-02-10&ss=f&srt=o&sp=r&se=2022-03-08T01:36:14Z&st=2021-05-09T17:36:14Z&spr=https&sig=zNFZiJ0sRJw%2B0wbG5ndCoJF%2FitA03CzK4CNZYiXLvoI%3D\";\r\n\r\nexport { API_URL, IS_PUBLIC, STORAGE_URL, SAS_TOKEN }","import { IS_PUBLIC } from \"./Config\";\r\n\r\n//Public:  https://wkrstorage.file.core.windows.net/library/[libRelPath]?sv=2020-02-10&ss=f&srt=o&sp=r&se=2022-03-08T01:36:14Z&st=2021-05-09T17:36:14Z&spr=https&sig=zNFZiJ0sRJw%2B0wbG5ndCoJF%2FitA03CzK4CNZYiXLvoI%3D&antiCache=[antiCache]\r\nconst publicApiUrl = 'https://wkr.azurewebsites.net/';\r\nconst publicMediaUrl = 'https://wkrstorage.file.core.windows.net/library/[libRelPath]?sv=2020-02-10&ss=f&srt=o&sp=r&se=2022-03-08T01:36:14Z&st=2021-05-09T17:36:14Z&spr=https&sig=zNFZiJ0sRJw%2B0wbG5ndCoJF%2FitA03CzK4CNZYiXLvoI%3D&antiCache=[antiCache]';\r\nconst privateApiUrl = 'http://192.168.1.5:5000/';\r\nconst privateMediaUrl = '[apiBaseUrl]Media/StreamPage?libRelPath=[libRelPath]&type=[type]';\r\nconst privateResMediaUrl = '[apiBaseUrl]Media/StreamResizedImage?libRelPath=[libRelPath]&maxSize=[maxSize]&type=[type]';\r\n\r\nvar apiBaseUrl = (() => {\r\n  if(IS_PUBLIC) return publicApiUrl;\r\n\r\n  const storedUrl = window.localStorage.getItem('apiBaseUrl');\r\n  if(storedUrl != null && storedUrl !== '') return storedUrl;\r\n\r\n  return privateApiUrl;\r\n})();\r\n\r\nvar mediaBaseUrl = (() => {\r\n  if(IS_PUBLIC) return publicMediaUrl;\r\n\r\n  const storedUrl = window.localStorage.getItem('mediaBaseUrl');\r\n  if(storedUrl != null && storedUrl !== '') return storedUrl;\r\n\r\n  return privateMediaUrl;\r\n})();\r\n\r\nvar resMediaBaseUrl = (() => {\r\n  if(IS_PUBLIC) return publicMediaUrl;\r\n\r\n  const storedUrl = window.localStorage.getItem('resMediaBaseUrl');\r\n  if(storedUrl != null && storedUrl !== '') return storedUrl;\r\n\r\n  return privateResMediaUrl;\r\n})();\r\n\r\nconst main = `${apiBaseUrl}Main/`;\r\nconst sc = `${apiBaseUrl}Sc/`;\r\nconst media = mediaBaseUrl;\r\nconst resMedia = resMediaBaseUrl;\r\n\r\n\r\nconst GetApiBaseUrl = () => {\r\n  return apiBaseUrl;\r\n}\r\nconst SaveApiBaseUrl = (url) => {\r\n  window.localStorage.setItem('apiBaseUrl', url);\r\n}\r\n\r\nconst GetMediaBaseUrl = () => {\r\n  return mediaBaseUrl;\r\n}\r\nconst SaveMediaBaseUrl = (url) => {\r\n  window.localStorage.setItem('mediaBaseUrl', url);\r\n}\r\n\r\nconst GetResMediaBaseUrl = () => {\r\n  return resMediaBaseUrl;\r\n}\r\nconst SaveResMediaBaseUrl = (url) => {\r\n  window.localStorage.setItem('resMediaBaseUrl', url);\r\n}\r\n\r\nfunction withBase(type, endpoint){\r\n  const base = type === 1 ? sc : main;\r\n  return `${base}${endpoint}`;\r\n}\r\n\r\n//#region Album Query\r\nconst GetAlbumInfo = () => {\r\n  return `${main}GetAlbumInfo`;\r\n}\r\nconst GetTagVMs = () => {\r\n  return `${main}GetTagVMs`;\r\n}\r\nconst GetGenreCardModels = () => {\r\n  return `${main}GetGenreCardModels`;\r\n}\r\nconst GetFeaturedArtistCardModels = () => {\r\n  return `${main}GetFeaturedArtistCardModels`;\r\n}\r\nconst GetAlbumVm = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumVm?path=${cleanPath}`);\r\n}\r\nconst GetAlbumCardModels = (type, page, row, query) => {\r\n  const cleanQuery = query !== undefined ? encodeURIComponent(query) : \"\";\r\n  return withBase(type, `GetAlbumCardModels?page=${page}&row=${row}&query=${cleanQuery}`);\r\n}\r\nconst GetRemovableAlbums = (type) => {\r\n  //Not implemented\r\n  return withBase(type);\r\n}\r\nconst GetLibraryDirNodes = (type) => {\r\n  return withBase(type, \"GetLibraryDirNodes\");\r\n}\r\n//#endregion\r\n\r\n//#region Album Command\r\nconst UpdateAlbum = (type) => {\r\n  return `${main}UpdateAlbum`;\r\n}\r\nconst UpdateAlbumOuterValue = (type) => {\r\n  return withBase(type, 'UpdateAlbumOuterValue');\r\n}\r\nconst UpdateAlbumTier = (type) => {\r\n  return withBase(type, 'UpdateAlbumTier');\r\n}\r\nconst RecountAlbumPages = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `RecountAlbumPages?path=${cleanPath}`);\r\n}\r\nconst RefreshAlbum = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `RefreshAlbum?path=${cleanPath}`);\r\n}\r\nconst DeleteAlbum = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `DeleteAlbum?path=${cleanPath}`);\r\n}\r\n//#endregion\r\n\r\n//#region Page Query\r\nconst GetAlbumChapters = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumChapters?path=${cleanPath}`);\r\n}\r\nconst GetAlbumPageInfos = (type, path, includeDetail) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumPageInfos?path=${cleanPath}&includeDetail=${includeDetail ?? false}`);\r\n}\r\nconst GetAlbumFsNodes = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumFsNodes?path=${cleanPath}`);\r\n}\r\n//#endregion\r\n\r\n//#region Page Command\r\nconst MoveFile = (type) => {\r\n  return withBase(type, `MoveFile`);\r\n}\r\n\r\nconst DeleteFile = (type, path, alRelPath) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  const cleanAPath = encodeURIComponent(alRelPath);\r\n  return withBase(type, `DeleteFile?path=${cleanPath}&alRelPath=${cleanAPath}`)\r\n}\r\n\r\nconst DeleteAlbumChapter = (type, path, chapterName) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  const cleanCName = encodeURIComponent(chapterName);\r\n  return withBase(type, `DeleteAlbumChapter?path=${cleanPath}&chapterName=${cleanCName}`);\r\n}\r\n//#endregion\r\n\r\n//#region Library Command\r\nconst RescanDatabase = (type) => {\r\n  return withBase(type, `RescanDatabase`);\r\n}\r\nconst ReloadDatabase = (type) => {\r\n  return withBase(type, 'ReloadDatabase');\r\n}\r\nconst QuickScan = (type) => {\r\n  return withBase(type, 'QuickScan');\r\n}\r\nconst CleanLibrary = (type) => {\r\n  return withBase(type, 'CleanLibrary');\r\n}\r\nconst GetEventStream = (type) => {\r\n  return withBase(type, 'GetEventStream');\r\n}\r\n//#endregion\r\n\r\n//#region Media\r\n//Private: http://localhost:51474/Media/StreamPage?libRelPath=[libRelPath]&type=[type]\r\n//PrivateRes: http://localhost:51474/Media/StreamResizedImage?libRelPath=[libRelPath]&maxSize=[maxSize]&type=[type]\r\n//Public:  https://wkrstorage.file.core.windows.net/library/[libRelPath]?sv=2020-02-10&ss=f&srt=o&sp=r&se=2022-03-08T01:36:14Z&st=2021-05-09T17:36:14Z&spr=https&sig=zNFZiJ0sRJw%2B0wbG5ndCoJF%2FitA03CzK4CNZYiXLvoI%3D&antiCache=[antiCache]\r\n\r\nconst StreamPage = (libRelPath, type) => {\r\n  const cleanType = type ?? 0;\r\n  const cleanLibRelPath = encodeURIComponent(libRelPath);\r\n\r\n  return media.replace('[apiBaseUrl]',apiBaseUrl).replace('[libRelPath]',cleanLibRelPath).replace('[type]',cleanType).replace('[antiCache]', (new Date()).toISOString());\r\n}\r\n\r\nconst StreamResizedImage = (libRelPath, maxSize, type) => {\r\n  const cleanType = type ?? 0;\r\n  const cleanLibrelPath = encodeURIComponent(libRelPath);\r\n  \r\n  return resMedia.replace('[apiBaseUrl]',apiBaseUrl).replace('[libRelPath]',cleanLibrelPath).replace('[maxSize]',maxSize).replace('[type]',cleanType).replace('[antiCache]', (new Date()).toISOString());\r\n}\r\n//#endregion\r\n\r\nexport {\r\n  SaveApiBaseUrl,\r\n  SaveMediaBaseUrl,\r\n  SaveResMediaBaseUrl,\r\n  GetApiBaseUrl,\r\n  GetMediaBaseUrl,\r\n  GetResMediaBaseUrl,\r\n\r\n  GetAlbumInfo,\r\n  GetTagVMs,\r\n\r\n  GetAlbumVm,\r\n  GetAlbumCardModels,\r\n  GetGenreCardModels,\r\n  GetFeaturedArtistCardModels,\r\n  GetRemovableAlbums,\r\n  GetLibraryDirNodes,\r\n\r\n  UpdateAlbum,\r\n  UpdateAlbumOuterValue,\r\n  UpdateAlbumTier,\r\n  RecountAlbumPages,\r\n  RefreshAlbum,\r\n  DeleteAlbum,\r\n\r\n  GetAlbumChapters,\r\n  GetAlbumPageInfos,\r\n  GetAlbumFsNodes,\r\n\r\n  MoveFile,\r\n  DeleteFile,\r\n  DeleteAlbumChapter,\r\n\r\n  RescanDatabase,\r\n  ReloadDatabase,\r\n  QuickScan,\r\n  CleanLibrary,\r\n  GetEventStream,\r\n\r\n  StreamPage, \r\n  StreamResizedImage \r\n};","import React, { useState, useEffect, useCallback } from 'react';\r\n\r\nimport { Dropdown } from 'antd';\r\nimport { useInView } from 'react-intersection-observer';\r\nimport Flags from 'country-flag-icons/react/3x2';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport * as Helper from '../../_utils/Helper';\r\nimport * as _uri from '../../_utils/UriHelper';\r\n\r\nfunction MyAlbumCard(props) {\r\n  const handler = {\r\n    view: function () {\r\n      props.onView(props.albumCm)\r\n    },\r\n\r\n    edit: function () {\r\n      if(props.onEdit) props.onEdit(props.albumCm.path);\r\n    },\r\n  }\r\n\r\n  const [ref, inView, entry] = useInView({\r\n    threshold: 0,\r\n    rootMargin: \"300px 0px 300px 0px\"\r\n  });\r\n\r\n  const absoluteH = \"150px\";\r\n\r\n  const menu = <EditMenuInbetweener onVisible={handler.edit}></EditMenuInbetweener>;\r\n  return (\r\n    <div ref={ref} style={{ paddingBottom: '8px', position: \"relative\", textAlign: \"center\" }}>\r\n      <div style={{ height: absoluteH, width: \"100%\" }} >\r\n        <Dropdown overlay={menu} trigger={['contextMenu']} disabled={!props.showContextMenu}>\r\n        <div style={{\r\n            display: \"inline-block\", position: \"relative\",\r\n            height: absoluteH, width: \"100%\", maxWidth: absoluteH,\r\n            borderLeft: !props.albumCm.isRead ? \"1px solid #ddbe14\" : \"\",\r\n          }}\r\n          onClick={handler.view}\r\n        >\r\n          {inView ? \r\n            <img\r\n              style={{\r\n                objectFit: \"contain\",\r\n                height: \"100%\", width: \"100%\"\r\n              }}\r\n              src={_uri.StreamResizedImage(props.albumCm.coverInfo.uncPathEncoded, 150, props.type)}\r\n              alt=\"img\"\r\n            /> : null\r\n          }\r\n\r\n          {!props.albumCm.isRead ?\r\n            <div style={{\r\n              position: \"absolute\",\r\n              height: 0,\r\n              width: 0,\r\n              left: \"0px\",\r\n              top: \"0px\",\r\n              borderLeft: \"15px solid #ddbe14\",\r\n              borderRight: \"15px solid transparent\",\r\n              borderBottom: \"15px solid transparent\"\r\n            }} /> : \"\"\r\n          }\r\n\r\n          <div style={{\r\n            position: \"absolute\",\r\n            right: \"3px\",\r\n            bottom: \"3px\",\r\n            color: \"white\",\r\n            lineHeight: \"0px\"\r\n          }}>\r\n            {props.albumCm.languages.map((item, i) => <FlagIcon language={item} key={i} />)}\r\n          </div>\r\n          <div style={{\r\n            position: \"absolute\",\r\n            right: \"0px\",\r\n            bottom: \"0px\",\r\n            height: \"100%\",\r\n            width: \"2px\"\r\n          }}>\r\n            {[3, 2, 1].map((e, i) =>\r\n              <div key={`tierBar-${i}`}\r\n                style={{\r\n                  width: \"100%\",\r\n                  height: \"33%\",\r\n                  backgroundColor: ColorFromIndex(props.albumCm.tier, e),\r\n                  borderTop: BorderFromIndex(props.albumCm.tier, e)\r\n                }} />\r\n            )}\r\n          </div>\r\n          <div style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            bottom: \"0px\",\r\n            width: \"100%\",\r\n            height: \"3px\",\r\n            backgroundColor: \"white\",\r\n            display: props.albumCm.lastPageIndex > 0 ? \"block\" : \"none\"\r\n          }}>\r\n            <div style={{\r\n              backgroundColor: \"DodgerBlue\",\r\n              height: \"100%\",\r\n              width: `${Helper.getPercent100(props.albumCm.lastPageIndex + 1, props.albumCm.pageCount)}%`\r\n            }} />\r\n          </div>\r\n          {props.albumCm.note !== null && props.albumCm.note !== \"\" ?\r\n            <div className=\"album-flag\">\r\n              {props.albumCm.note}\r\n            </div> : \"\"\r\n          }\r\n          <div>\r\n          </div>\r\n        </div>\r\n        </Dropdown>\r\n      </div>\r\n      <span style={{ fontSize: '12px', lineHeight: 1.1 }}>\r\n        {props.albumCm.fullTitle}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction EditMenuInbetweener(props) {\r\n  useEffect(() => {\r\n    props.onVisible();\r\n  },[props]);\r\n  return (<></>)\r\n}\r\n\r\nfunction ColorFromIndex(tier, e) {\r\n  const top = { r: 34, g: 193, b: 195 };\r\n  const mid = { r: 142, g: 190, b: 121 };\r\n  const bot = { r: 253, g: 187, b: 45 };\r\n\r\n  const rgb = e === 3 ? top : e === 2 ? mid : bot;\r\n  const alpha = tier < e ? 0 : 1;\r\n\r\n  return `rgba(${rgb.r},${rgb.g},${rgb.b},${alpha})`;\r\n}\r\n\r\nfunction BorderFromIndex(tier, e) {\r\n  return tier > e && (e === 1 || e === 2) ? \"2px solid black\" : \"0px\";\r\n}\r\n\r\nfunction FlagIcon(props) {\r\n  const flagStyle = { width: \"18px\", height: \"12px\", marginRight: \"2px\", marginBottom: \"2px\" };\r\n\r\n  return (\r\n    <>\r\n      {\r\n        props.language === \"English\" ? <Flags.GB style={flagStyle} /> :\r\n          props.language === \"Japanese\" ? <Flags.JP style={flagStyle} /> :\r\n            props.language === \"Chinese\" ? <Flags.CN style={flagStyle} /> :\r\n              <Flags.ID style={flagStyle} />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyAlbumCard);","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Input } from 'antd';\r\n\r\nfunction TextDialog(props) {\r\n  const [value, setValue] = useState(\"\");\r\n  useEffect(() => { setValue(props.initialValue) }, [props.initialValue]);\r\n\r\n  return (\r\n    <Modal\r\n      visible={props.visible}\r\n      footer={null}\r\n      centered={true}\r\n      closable={false}\r\n      onCancel={() => props.onClose()}\r\n      style={{ maxWidth: 300, textAlign: \"center\" }}\r\n      //bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n    >\r\n      <Input.TextArea value={value} onChange={(event) => setValue(event.target.value)} rows={2} />\r\n      <Button\r\n        style={{ width: \"100%\" }} type=\"primary\"\r\n        onClick={() => { props.onOk(value, props.initialValue); props.onClose(); }}\r\n      >\r\n        {props.btnText ?? 'Rename'}\r\n      </Button>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default TextDialog;","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Input, Tree } from 'antd';\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport * as _uri from '../../_utils/UriHelper';\r\nconst axios = require('axios').default;\r\n\r\nconst { TreeNode, DirectoryTree } = Tree;\r\n\r\nfunction DirNodeDialog(props) {\r\n  const [nodes, setNodes] = useState([]);\r\n  const [selected, setSelected] = useState(null);\r\n\r\n  useEffect(() => {\r\n    axios.get(_uri.GetLibraryDirNodes(1))\r\n        .then((response) => {\r\n          setNodes(response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n  },[]);\r\n\r\n  const treeHandlers = {\r\n    loadData: (treeNode) =>{\r\n      const result = new Promise(resolve => {\r\n        if (treeNode.props.childs) {\r\n          resolve();\r\n          return;\r\n        }\r\n        axios.get(`${_uri.GetLibraryDirNodes(1)}?path=${treeNode.props.dataRef.name}`)\r\n          .then((response) => {\r\n            treeNode.props.dataRef.childs = response.data;\r\n  \r\n            setNodes((prev) => {\r\n              return ([\r\n                ...prev\r\n              ]);\r\n            });\r\n            resolve();\r\n          })\r\n          .catch((error) => {\r\n            props.popApiError(error);\r\n          });\r\n      });\r\n  \r\n      return result;\r\n    },\r\n    select: (key) => {\r\n      setSelected(key);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      visible={props.visible}\r\n      footer={null}\r\n      centered={true}\r\n      closable={false}\r\n      onCancel={() => props.onClose()}\r\n      style={{ width: 400, maxWidth: \"95vh\" }}\r\n      //bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n    >\r\n      <MyDirTree \r\n        nodes={nodes} \r\n        onLoadData={treeHandlers.loadData}\r\n        onSelect={treeHandlers.select}\r\n      />\r\n      <Button\r\n        style={{ width: \"100%\" }} type=\"primary\"\r\n        onClick={() => { props.onOk(selected); props.onClose(); }}\r\n      >\r\n        Move Here\r\n      </Button>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(DirNodeDialog);\r\n\r\nfunction MyDirTree(props){\r\n  const renderTreeNodes = (data) => {\r\n    var result = data.map(item => {\r\n      if (item.childs) {\r\n        return (\r\n          <TreeNode title={item.name} key={item.name} dataRef={item}>\r\n            {renderTreeNodes(item.childs)}\r\n          </TreeNode>\r\n        );\r\n      }\r\n      return <TreeNode title={item.name} key={item.name} dataRef={item} />;\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\n  return (\r\n    <DirectoryTree \r\n      loadData={props.onLoadData} \r\n      onSelect={(keys) => props.onSelect(keys[0])}\r\n    >\r\n      {renderTreeNodes(props.nodes)}\r\n    </DirectoryTree>\r\n  );\r\n}","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Modal, Button, Rate } from 'antd';\r\nimport { ArrowLeftOutlined, ArrowRightOutlined, DeleteOutlined, EditOutlined, FileSyncOutlined, SwapOutlined } from '@ant-design/icons';\r\n\r\nimport TextDialog from '../Modals/TextDialog';\r\nimport DirNodeDialog from '../Modals/DirNodeDialog';\r\n\r\nfunction ReaderModalContextMenu(props) {\r\n  const [jumpValue, setJumpValue] = useState(0);\r\n  useEffect(() => {\r\n    setJumpValue(props.initialValue + 1);\r\n  }, [props.initialValue]);\r\n\r\n  const changeJumpValue = (val) => {\r\n    setJumpValue(Math.min(Math.max(val, 1), props.albumCm.pageCount));\r\n  };\r\n\r\n  const [showRenameModal, setShowRenameModal] = useState(false);\r\n  const [showDirNodeModal, setShowDirNodeModal] = useState(false);\r\n  //const [showConfirmDelete, setShowConfirmDelete] = useState(false);\r\n\r\n  const [tierDisplay, setTierDisplay] = useState(0);\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    setTierDisplay(props.albumCm.tier);\r\n  }, [props.albumCm]);\r\n\r\n  if (props.albumCm === undefined) { return (<></>); }\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={props.visible}\r\n        onCancel={props.onCancel}\r\n        footer={null}\r\n        closable={false}\r\n        centered={true}\r\n        style={{ maxWidth: 300 }}\r\n      //bodyStyle={{ border: \"1px solid black\" }}\r\n      >\r\n        <Row>\r\n          {props.type !== 1 ? \r\n            <Col span={24} style={{ marginBottom: 15, textAlign: \"center\" }}>\r\n              <Rate\r\n                count={3}\r\n                value={tierDisplay}\r\n                onChange={(value) => { setTierDisplay(value); props.onTierChange(value); }}\r\n                style={{ fontSize: \"40px\" }}\r\n              />\r\n            </Col>\r\n          : \"\" }\r\n          <Col span={24}>\r\n            <Button type=\"primary\" onClick={() => props.onRecount()} style={{ width: \"100%\" }}>\r\n              <FileSyncOutlined />Recount Pages\r\n            </Button>\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <input type=\"number\" value={jumpValue} onChange={(e) => changeJumpValue(e.target.value)} style={{ width: \"97%\", padding: \"4px\", WebkitBoxSizing: \"border-box\", borderRadius: \"5px\", color: \"black\" }} />\r\n          </Col>\r\n          <Col span={6} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <Button type=\"ghost\" style={{ width: \"97%\", color: \"white\" }}\r\n              onClick={() => changeJumpValue(jumpValue - 1)}\r\n            >-</Button>\r\n          </Col>\r\n          <Col span={6} style={{ textAlign: \"right\", marginTop: 5 }}>\r\n            <Button type=\"ghost\" style={{ width: \"97%\", color: \"white\" }}\r\n              onClick={() => changeJumpValue(jumpValue + 1)}\r\n            >+</Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onJump(jumpValue - 1)} style={{ width: \"100%\" }}>\r\n              <ArrowRightOutlined />Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onUndoJump()} style={{ width: \"100%\" }}>\r\n              <ArrowLeftOutlined />Undo Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => { props.onCancel(); setShowRenameModal(true); }} style={{ width: \"100%\" }}>\r\n              <EditOutlined />Rename Page\r\n            </Button>\r\n          </Col>\r\n          {props.type === 1 ? \r\n            <Col span={24} style={{ marginTop: 5 }}>\r\n              <Button type=\"primary\" onClick={() => { props.onCancel(); setShowDirNodeModal(true); }} style={{ width: \"100%\" }}>\r\n                <SwapOutlined />Move Page\r\n              </Button>\r\n            </Col>\r\n          : \"\"}\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"danger\" onClick={() => { props.onCancel(); props.onDelete(); }} style={{ width: \"100%\" }}>\r\n              <DeleteOutlined />Delete Page\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Modal>\r\n      <TextDialog\r\n        visible={showRenameModal} onClose={() => setShowRenameModal(false)}\r\n        initialValue={props.pageName}\r\n        onOk={props.onRename}\r\n      />\r\n      {props.type === 1 ? \r\n        <DirNodeDialog \r\n          visible={showDirNodeModal} \r\n          onClose={() => setShowDirNodeModal(false)}\r\n          onOk={props.onMove}\r\n        />\r\n      :\"\"}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ReaderModalContextMenu;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Drawer, Modal, Menu, Dropdown } from 'antd';\r\nimport {\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport * as _uri from '../../_utils/UriHelper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction ReaderModalChapterDrawer(props) {\r\n  const [chapters, setChapters] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (props.albumPath === undefined) { return; }\r\n    axios.get(_uri.GetAlbumChapters(props.type, props.albumPath))\r\n      .then(function (response) {\r\n        setChapters(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n  }, [props.albumPath]);\r\n\r\n  const handler = {\r\n    rename: (chapterTitle) => {\r\n      //TODO\r\n      console.log(\"rename \", chapterTitle);\r\n    },\r\n    delete: (chapterTitle) => {\r\n      console.log(\"delete \", chapterTitle);\r\n      confirm({\r\n        title: `Delete chapter ${chapterTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   Yes   ',\r\n        okType: 'danger',\r\n        cancelText: '   No   ',\r\n        onOk() {\r\n          axios.delete(_uri.DeleteAlbumChapter(props.type, props.albumPath, chapterTitle))\r\n            .then(function (response) {\r\n              console.log(\"newPageCount\", response.data);\r\n              props.onChapterDeleteSuccess(response.data);\r\n              setChapters(\r\n                chapters.filter(c => c.title !== chapterTitle)\r\n              );\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      placement=\"left\"\r\n      closable={false}\r\n      onClose={props.onClose}\r\n      visible={props.visible}\r\n    >\r\n      <div style={{ padding: \"10px\" }}>\r\n        {chapters.map((chapter, index) => (\r\n          <Row style={{ marginBottom: \"5px\" }} key={chapter.title}>\r\n            <Dropdown overlay={\r\n              <Menu>\r\n                <Menu.Item key=\"1\" onClick={() => handler.rename(chapter.title)}><EditOutlined />Rename</Menu.Item>\r\n                <Menu.Item key=\"2\" onClick={() => handler.delete(chapter.title)}><DeleteOutlined />Delete</Menu.Item>\r\n              </Menu>}\r\n              trigger={['contextMenu']}\r\n            >\r\n              <Col span={10} onClick={() => props.onJumpToPage(chapter.pageIndex)}>\r\n                <img\r\n                  style={{ objectFit: \"contain\", width: \"100%\", maxHeight: \"128px\", border: \"1px solid white\" }}\r\n                  src={_uri.StreamResizedImage(chapter.pageUncPath, 150, props.type)}\r\n                  alt=\"img\"\r\n                >\r\n                </img>\r\n              </Col>\r\n            </Dropdown>\r\n            <Col span={14}>\r\n              <span style={{ color: \"white\" }}>{chapter.title}</span>\r\n            </Col>\r\n          </Row>\r\n        ))};\r\n      </div>\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(ReaderModalChapterDrawer);","import React from 'react';\r\nimport { Modal } from 'antd';\r\nimport * as _uri from '../../_utils/UriHelper';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport moment from 'moment';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  function deletePage(delObj, onSuccess, onError){\r\n    confirm({\r\n      title: `Delete ${delObj.alRelPath}?`,\r\n      icon: <ExclamationCircleOutlined />,\r\n      okText: '   YES   ',\r\n      okType: 'danger',\r\n      cancelText: '   NO   ',\r\n      onOk() {\r\n        axios.delete(_uri.DeleteFile(props.type, delObj.albumPath, delObj.alRelPath))\r\n          .then(function (response) {\r\n            onSuccess(response);\r\n          })\r\n          .catch(function (error) {\r\n            onError(error);\r\n          });\r\n      },\r\n      onCancel() {\r\n      },\r\n    });\r\n  }\r\n\r\n  function movePage(movObj, onSuccess, onError){\r\n    axios.post(_uri.MoveFile(props.type), movObj)\r\n      .then((response) =>{\r\n        if (response.data.message === \"Destination file already exist\") {\r\n          confirm({\r\n            title: `Overwrite?`,\r\n            icon: <ExclamationCircleOutlined />,\r\n            content: <FileComparison file1={response.data.srcInfo} file2={response.data.dstInfo} />,\r\n            okText: '   YES   ',\r\n            okType: 'danger',\r\n            cancelText: '   NO   ',\r\n            onOk() {\r\n              const newMovObj = {\r\n                ...movObj,\r\n                overwrite: true\r\n              }\r\n\r\n              movePage(newMovObj, onSuccess);\r\n            },\r\n            onCancel() {\r\n            },\r\n          });\r\n        }\r\n        else{\r\n          onSuccess(response);\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        onError(error);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      deletePage={deletePage}\r\n      movePage={movePage}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;\r\n\r\nfunction FileComparison(props) {\r\n  const f1 = props.file1;\r\n  const f2 = props.file2;\r\n\r\n  return (\r\n    <table class=\"comparison-table\" style={{ width: \"100%\" }}>\r\n      <tr>\r\n        <th>Source</th>\r\n        <th>Destination</th>\r\n      </tr>\r\n      <tr>\r\n        <td>{f1.name}</td>\r\n        <td>{f2.name}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style={getStyle(f1.size, f2.size)}>{(f1.size / 1024).toFixed(2)} KB</td>\r\n        <td style={getStyle(f2.size, f1.size)}>{(f2.size / 1024).toFixed(2)} KB</td>\r\n      </tr>\r\n      <tr>\r\n        <td style={getStyle(f1.createdDate, f2.createdDate)}>{moment(f1.createdDate).format('YYYY-MM-DD hh:mm')}</td>\r\n        <td style={getStyle(f2.createdDate, f1.createdDate)}>{moment(f2.createdDate).format('YYYY-MM-DD hh:mm')}</td>\r\n      </tr>\r\n    </table>\r\n  );\r\n\r\n  function getStyle(a, b) {\r\n    const fontWeight = a > b ? \"bold\" : \"normal\";\r\n    return {\r\n      fontWeight: fontWeight\r\n    };\r\n  }\r\n}","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport { useSwipeable } from 'react-swipeable';\r\n\r\nimport ReaderModalContextMenu from './ReaderModalContextMenu';\r\nimport ReaderModalChapterDrawer from './ReaderModalChapterDrawer';\r\nimport { IS_PUBLIC } from '../../_utils/Config';\r\nimport loadingImg from '../../_resources/loading.gif';\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport withPageManager from '../HOCs/withPageManager';\r\nimport * as _helper from '../../_utils/Helper';\r\nimport * as _uri from \"../../_utils/UriHelper\";\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction ReaderModal(props) {\r\n  const [apm, setApm] = useState({ //apm = album pagination model\r\n    path: null,\r\n    lpi: 0,\r\n    pages: [],\r\n    indexes: {\r\n      cPageI: 0,\r\n      pPageI: 0,\r\n      triad: \"zenpen\",\r\n      zenpenIndex: 0,\r\n      chuhenIndex: 0,\r\n      kouhenIndex: 0,\r\n    },\r\n    isLandscape: false,\r\n    includeDetail: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined || props.albumCm === null) { return; }\r\n    if (props.albumCm.path === apm.path) { return; }\r\n    axios.get(_uri.GetAlbumPageInfos(props.type, props.albumCm.path, apm.includeDetail))\r\n      .then(function (response) {\r\n        setApm({\r\n          path: props.albumCm.path,\r\n          lpi: props.albumCm.lastPageIndex,\r\n          isLandscape: response.data.orientation === \"Landscape\",\r\n          pages: response.data.fileInfos,\r\n          indexes: null,\r\n          includeDetail: apm.includeDetail\r\n        });\r\n\r\n        if (props.albumCm.pageCount !== response.data.fileInfos.length & props.type !== 1) {\r\n          console.log(`PageCount (${props.albumCm.pageCount}) does not match fileInfos length (${response.data.fileInfos.length})`);\r\n          axios.get(_uri.RefreshAlbum(props.type, props.albumCm.path))\r\n            .then(function (response) {\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n    \r\n  }, [props.albumCm]);\r\n\r\n  useEffect(() => {\r\n    const targetPage = apm.lpi < apm.pages.length ? apm.lpi : apm.pages.length - 1;\r\n\r\n    pageHandler.jumpTo(targetPage);\r\n  }, [apm.path]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"keydown\", handleKeyDown2, false);\r\n\r\n    return () => { //component will unmount\r\n      document.removeEventListener(\"keydown\", handleKeyDown2, false);\r\n    };\r\n  }, []);\r\n\r\n  const handleKeyDown2 = (event) => {\r\n    if (event.keyCode === 27) {\r\n      pageHandler.close();\r\n    }\r\n  };\r\n\r\n  //#region Event handlers\r\n  const pageHandler = {\r\n    jumpTo: function (page, renameObj) {\r\n      const maxIndex = apm.pages.length - 1;\r\n      const newPPageI = apm.indexes?.cPageI ?? 0;\r\n      const newCPageI = _helper.clamp(page, 0, maxIndex);\r\n\r\n      const { newTriad, zenpenIndex, chuhenIndex, kouhenIndex } = (() => {\r\n        function compose(newTriad, zenpenIndex, chuhenIndex, kouhenIndex) {\r\n          return {\r\n            newTriad,\r\n            zenpenIndex,\r\n            chuhenIndex,\r\n            kouhenIndex\r\n          };\r\n        }\r\n\r\n        function pageCeil(modifier) {\r\n          const pagesLen = apm.pages.length;\r\n          return (((newCPageI + modifier) % pagesLen) + pagesLen) % pagesLen;\r\n        }\r\n\r\n        if (newCPageI % 3 === 0) {\r\n          return compose(\"zenpen\", newCPageI, pageCeil(1), pageCeil(-1));\r\n        }\r\n        if (newCPageI % 3 === 1) {\r\n          return compose(\"chuhen\", pageCeil(-1), newCPageI, pageCeil(1));\r\n        }\r\n        if (newCPageI % 3 === 2) {\r\n          return compose(\"kouhen\", pageCeil(1), pageCeil(-1), newCPageI);\r\n        }\r\n      })();\r\n\r\n      let modifiedPages = apm.pages;\r\n      if (renameObj !== null && renameObj !== undefined) {\r\n        modifiedPages[renameObj.index] = renameObj.newPageInfo;\r\n      }\r\n\r\n      setApm({\r\n        indexes: {\r\n          cPageI: newCPageI,\r\n          pPageI: newPPageI,\r\n          triad: newTriad,\r\n          zenpenIndex: zenpenIndex,\r\n          chuhenIndex: chuhenIndex,\r\n          kouhenIndex: kouhenIndex\r\n        },\r\n        path: apm.path,\r\n        lpi: apm.lpi,\r\n        isLandscape: apm.isLandscape,\r\n        includeDetail: apm.includeDetail,\r\n        pages: modifiedPages,\r\n      });\r\n\r\n      if (apm.path != null && page === apm.pages.length - 1 && props.type !== 1) {\r\n        axios.post(_uri.UpdateAlbumOuterValue(props.type), {\r\n          albumPath: apm.path,\r\n          lastPageIndex: page\r\n        })\r\n          .then((response) => {\r\n          })\r\n          .catch((error) => {\r\n            props.popApiError(error);\r\n          });\r\n      }\r\n    },\r\n    rename: (newVal, oldVal) => {\r\n      const srcAlRelPath = currentPageInfo.uncPathEncoded;\r\n      const dstAlRelPath = (() => {\r\n        var arr = currentPageInfo.uncPathEncoded.split('\\\\');\r\n        arr.pop();\r\n        arr.push(newVal);\r\n\r\n        return _helper.pathJoin(arr, '\\\\');\r\n      })();\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: apm.path,\r\n          alRelPath: srcAlRelPath,\r\n        },\r\n        dst: {\r\n          albumPath: apm.path,\r\n          alRelPath: dstAlRelPath\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          const oldPageIdx = apm.pages.findIndex(e => e.uncPathEncoded === srcAlRelPath);\r\n          const oldPage = apm.pages.splice(oldPageIdx, 1)[0];\r\n          const renamedPage = {\r\n            ...oldPage,\r\n            name: newVal,\r\n            uncPathEncoded: dstAlRelPath\r\n          };\r\n          \r\n          apm.pages = apm.pages.filter(e => e.uncPathEncoded !== dstAlRelPath);//this line is for overwrite\r\n          apm.pages.push(renamedPage);\r\n          apm.pages.sort((a, b) => a.uncPathEncoded.localeCompare(b.uncPathEncoded));\r\n\r\n          setApm((prev) => {\r\n            return ({\r\n              ...prev\r\n            });\r\n          });\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        }\r\n      )\r\n    },\r\n    move: (newDir) => {\r\n      console.log('reader model move', newDir);\r\n\r\n      const srcAlRelPath = currentPageInfo.uncPathEncoded;\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: apm.path,\r\n          alRelPath: srcAlRelPath,\r\n        },\r\n        dst: {\r\n          albumPath: newDir,\r\n          alRelPath: currentPageInfo.name\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          removePageFromApm(currentPageInfo.uncPathEncoded);\r\n          setApm((prev) => {\r\n            return ({\r\n              ...prev\r\n            });\r\n          });\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        }\r\n      )\r\n    },\r\n    delete: (pageInfo) => {\r\n      const delObj = {\r\n        albumPath: apm.path,\r\n        alRelPath: pageInfo.uncPathEncoded\r\n      };\r\n\r\n      props.deletePage(delObj,\r\n        (response) => {\r\n          removePageFromApm(pageInfo.uncPathEncoded);\r\n          setApm(prev => {\r\n            return{\r\n              ...prev\r\n            }\r\n          });\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    close: () => {\r\n      props.onClose(apm.path, apm.indexes.cPageI);\r\n    },\r\n    chapterDeleteSuccess: (newPageCount) => {\r\n      props.onChapterDeleteSuccess(apm.path, newPageCount);\r\n      axios.get(_uri.GetAlbumPageInfos(props.type, props.albumCm.path))\r\n      .then(function (response) {\r\n        const newIndexes = clampIndexes(apm.indexes, response.data.fileInfos.length - 1);\r\n\r\n        setApm({\r\n          path: props.albumCm.path,\r\n          lpi: props.albumCm.lastPageIndex,\r\n          isLandscape: response.data.orientation === \"Landscape\",\r\n          pages: response.data.fileInfos,\r\n          indexes: {...apm.indexes, ...newIndexes},\r\n          includeDetail: apm.includeDetail\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n    }\r\n  }\r\n\r\n  function removePageFromApm(uncPathEncoded){\r\n    const max = apm.pages.length - 2;\r\n    const newIndexes = clampIndexes(apm.indexes, max);\r\n    apm.indexes = { ...apm.indexes,...newIndexes};\r\n    \r\n    apm.pages = apm.pages.filter(page => page.uncPathEncoded !== uncPathEncoded);\r\n  }\r\n\r\n  function clampIndexes(indexes, max){\r\n    return{\r\n      cPageI:_helper.clamp(indexes.cPageI, 0, max),\r\n      pPageI:_helper.clamp(indexes.pPageI, 0, max),\r\n      zenpenIndex:_helper.clamp(indexes.zenpenIndex, 0, max),\r\n      chuhenIndex:_helper.clamp(indexes.chuhenIndex, 0, max),\r\n      kouhenIndex:_helper.clamp(indexes.kouhenIndex, 0, max)\r\n    }\r\n  }\r\n\r\n  function changeDetailVisibility(){\r\n    const includeDetail = !apm.includeDetail;\r\n\r\n    if(includeDetail && apm.pages[0].createDate === null){\r\n      axios.get(_uri.GetAlbumPageInfos(props.type, props.albumCm.path, includeDetail))\r\n      .then(function (response) {\r\n        setApm(prev => {\r\n          prev.includeDetail = includeDetail;\r\n          prev.pages = response.data.fileInfos\r\n          return { ...prev };\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n    }\r\n    else{\r\n      setApm(prev => {\r\n        prev.includeDetail = includeDetail;\r\n        return { ...prev };\r\n      });\r\n    }\r\n  }\r\n\r\n  const albumHandler = {\r\n    tierChange: (value) => {\r\n      axios.put(_uri.UpdateAlbumTier(props.type), {\r\n        albumPath: apm.path,\r\n        tier: value\r\n      })\r\n        .then(function (response) {\r\n          console.log(response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    recount: () => {\r\n      axios.get(_uri.RecountAlbumPages(props.type, apm.path))\r\n        .then(function (response) {\r\n          console.log(\"new page count\", response.data);\r\n          props.onChapterDeleteSuccess(apm.path, response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const [showContextMenu, setShowContextMenu] = useState(false);\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n\r\n  const buttonHandler = {\r\n    rightTop: () => {\r\n      if (apm.isLandscape) { setShowDrawer(true); }\r\n      else { pageHandler.close(); }\r\n    },\r\n    rightMid: () => {\r\n      if (apm.isLandscape) { changeDetailVisibility(); }\r\n      else { pageHandler.jumpTo(apm.indexes.cPageI + 1); }\r\n    },\r\n    rightBot: () => {\r\n      if (apm.isLandscape) { pageHandler.close(); }\r\n      else { pageHandler.jumpTo(apm.pages.length - 1); }\r\n    },\r\n    midTop: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n      else { changeDetailVisibility(); }\r\n    },\r\n    midMid: () => {\r\n      setShowContextMenu(true);\r\n    },\r\n    midBot: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.indexes.cPageI + 1); }\r\n      else { }\r\n    },\r\n    leftTop: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(0); }\r\n      else { setShowDrawer(true); }\r\n    },\r\n    leftMid: () => {\r\n      if (apm.isLandscape) { }\r\n      else { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n    },\r\n    leftBot: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.pages.length - 1); }\r\n      else { pageHandler.jumpTo(0); }\r\n    }\r\n  }\r\n\r\n  const swipeHandler = useSwipeable({\r\n    onSwipedUp: (eventData) => { \r\n      if(!apm.isLandscape) return;\r\n      pageHandler.jumpTo(apm.indexes.cPageI + 1);\r\n    },\r\n    onSwipedDown: (eventData) => { \r\n      if(!apm.isLandscape) return;\r\n      pageHandler.jumpTo(apm.indexes.cPageI - 1);\r\n    },\r\n    onSwipedLeft: (eventData) => { \r\n      if(apm.isLandscape) return; \r\n      pageHandler.jumpTo(apm.indexes.cPageI + 1); \r\n    },\r\n    onSwipedRight: (eventData) => { \r\n      if(apm.isLandscape) return; \r\n      pageHandler.jumpTo(apm.indexes.cPageI - 1); \r\n    }\r\n  });\r\n\r\n  //#endregion\r\n  const showGuide = IS_PUBLIC && apm.indexes !== null && apm.indexes.cPageI === 0;\r\n  const overlayStyle = getOverlayStyle(showGuide);\r\n  const buttonStyle = {\r\n    side: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.25 * window.innerHeight\r\n    },\r\n    mid: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.5 * window.innerHeight\r\n    }\r\n  }\r\n\r\n  if (apm.indexes === null || apm.pages.length === 0) { return (<></>); }\r\n\r\n  console.log('currentApm', apm);\r\n\r\n  const currentPageInfo = apm.indexes.triad === \"zenpen\" ? apm.pages[apm.indexes.zenpenIndex]\r\n    : apm.indexes.triad === \"chuhen\" ? apm.pages[apm.indexes.chuhenIndex]\r\n      : apm.indexes.triad === \"kouhen\" ? apm.pages[apm.indexes.kouhenIndex]\r\n        : null;\r\n\r\n  const zenpenPage = <PageDisplay\r\n    id=\"zenpen-page\"\r\n    albumPath={apm.path}\r\n    pageInfo={apm.pages[apm.indexes.zenpenIndex]}\r\n    queue={apm.indexes.triad === \"zenpen\" ? \"q0\" : apm.indexes.triad === \"kouhen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n    type={props.type}\r\n    DEBUGPageTriad=\"zenpen\"\r\n  />;\r\n\r\n  const chuhenPage = <PageDisplay\r\n    id=\"chuhen-page\"\r\n    albumPath={apm.path}\r\n    pageInfo={apm.pages[apm.indexes.chuhenIndex]}\r\n    queue={apm.indexes.triad === \"chuhen\" ? \"q0\" : apm.indexes.triad === \"zenpen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n    type={props.type}\r\n    DEBUGPageTriad=\"chuhen\"\r\n  />;\r\n\r\n  const kouhenPage = <PageDisplay\r\n    id=\"kouhen-page\"\r\n    albumPath={apm.path}\r\n    pageInfo={apm.pages[apm.indexes.kouhenIndex]}\r\n    queue={apm.indexes.triad === \"kouhen\" ? \"q0\" : apm.indexes.triad === \"chuhen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n    type={props.type}\r\n    DEBUGPageTriad=\"kouhen\"\r\n  />;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"overlay overlay-reader\" style={{ display: props.isOpen ? \"block\" : \"none\", zIndex: 1 }}>\r\n        {/* <div className=\"overlay-content\"> */}\r\n        {/* <div style={{ position: \"relative\", top: \"0%\", textAlign: \"center\", height: window.innerHeight, width: window.innerWidth }}> */}\r\n        <div style={{ height: \"100vh\", position: \"absolute\", left: 0, top: 0 }}>\r\n          {zenpenPage}\r\n          {chuhenPage}\r\n          {kouhenPage}\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 2 }}>\r\n          <div className=\"overlay-content\">\r\n            <span className=\"with-shadow\">{currentPageInfo.name}</span>\r\n            <div style={{ position: \"fixed\", bottom: \"0px\", width: \"100%\", textAlign: \"center\" }}>\r\n              <span className=\"with-shadow\">{apm.indexes.cPageI + 1}/{apm.pages.length}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {!apm.includeDetail ? <></> : \r\n          <div className=\"overlay\" style={{ zIndex: 3 }}>\r\n            <div className=\"overlay-content\">\r\n              <Row>\r\n                <Col span={6}><div style={buttonStyle.side}></div></Col>\r\n                <Col span={12}><div style={buttonStyle.side}></div></Col>\r\n                <Col span={6}>\r\n                  <div className=\"with-shadow\" style={{ textAlign:\"left\",...buttonStyle.side}}>\r\n                    <div>{_helper.formatBytes(currentPageInfo.size, 0)}</div>\r\n                    <div>{_helper.formatDate(currentPageInfo.createDate)}</div>\r\n                    <div>{_helper.formatDate(currentPageInfo.updateDate)}</div>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        }\r\n        <div className=\"overlay\" style={{ zIndex: 4 }}>\r\n          <div style={overlayStyle.content} {...swipeHandler}>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftTop} style={buttonStyle.side}>\r\n                  {\r\n                    getGuideLabel(showGuide, \"Browse Chapters\")\r\n                    //WARNING, getGuideLabel mechanism has not been updated to conform with rotation mechanic (isLandscape)\r\n                  }\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Show File Info\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Close Album\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Previous Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Context Menu\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Next Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"First Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midBot} style={buttonStyle.side} />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Last Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ReaderModalContextMenu\r\n        visible={showContextMenu}\r\n        albumCm={props.albumCm}\r\n        initialValue={apm.indexes.cPageI}\r\n        pageName={currentPageInfo.name}\r\n        type={props.type}\r\n\r\n        onTierChange={albumHandler.tierChange}\r\n        onRecount={() => { albumHandler.recount(); setShowContextMenu(false); }}\r\n        onJump={(page) => { pageHandler.jumpTo(page); setShowContextMenu(false); }}\r\n        onUndoJump={() => { pageHandler.jumpTo(apm.indexes.pPageI); setShowContextMenu(false); }}\r\n        onRename={(newVal, oldVal) => { pageHandler.rename(newVal, oldVal); setShowContextMenu(false); }}\r\n        onMove={(newDir) => { pageHandler.move(newDir); setShowContextMenu(false); }}\r\n        onDelete={() => { pageHandler.delete(currentPageInfo); setShowContextMenu(false); }}\r\n        onCancel={() => setShowContextMenu(false)}\r\n      />\r\n      <ReaderModalChapterDrawer\r\n        visible={showDrawer}\r\n        albumPath={apm.path}\r\n        type={props.type}\r\n\r\n        onClose={() => setShowDrawer(false)}\r\n        onJumpToPage={pageHandler.jumpTo}\r\n        onChapterDeleteSuccess={pageHandler.chapterDeleteSuccess}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst getOverlayStyle = (isGrey) => {\r\n  const result = {\r\n    content: {\r\n      position: 'relative',\r\n      top: '0%',\r\n      width: '100%',\r\n      textAlign: 'center',\r\n      backgroundColor: isGrey ? 'rgba(200, 200, 200, 0.3)' : 'rgba(0, 0, 0, 0)'\r\n    },\r\n    button: {\r\n      position: 'relative',\r\n      boxSizing: 'border-box',\r\n      border: isGrey ? '1px solid black' : '0px'\r\n    }\r\n  };\r\n\r\n  return result;\r\n}\r\n\r\nconst getGuideLabel = (isGrey, text) => {\r\n  return isGrey ?\r\n    <span style={{ textAlign: \"center\", margin: \"auto\", textShadow: \"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black\" }}>\r\n      {text}\r\n    </span> :\r\n    \"\";\r\n}\r\n\r\nfunction PageDisplay(props) {\r\n  const styleByRotation = props.isLandscape ?\r\n    {\r\n      transform: \"translatex(calc(50vw - 50%)) translatey(calc(50vh - 50%)) rotate(90deg)\",\r\n      width: \"100vh\",\r\n      height: \"100vw\",\r\n    } :\r\n    {\r\n      transform: \"translatex(calc(50vw - 50%)) translatey(calc(50vh - 50%))\",\r\n      width: \"100vw\",\r\n      height: \"100vh\"\r\n    };\r\n\r\n  const styleShow = {\r\n    objectFit: \"contain\",\r\n    ...styleByRotation\r\n  };\r\n  const styleHide = { objectFit: \"contain\", height: 0, width: 0, position: \"absolute\" };\r\n  //const styleShow = { height: 300, width: 300 };\r\n  //const styleHide = { height: 150, width: 150 };\r\n\r\n  console.log('pageDisplay', props);\r\n\r\n  if (IsVideo(props.pageInfo.extension)) {\r\n    return (\r\n      <video\r\n        autoPlay loop\r\n        id={props.id}\r\n        style={props.queue === \"q0\" ? styleShow : styleHide}\r\n        src={props.queue === \"q0\" ? _uri.StreamPage(`${props.albumPath}\\\\${props.pageInfo.uncPathEncoded}`, props.type) : \"\"}\r\n      >\r\n        video not showing\r\n      </video>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <img\r\n      id={props.id}\r\n      style={props.queue === \"q0\" ? styleShow : styleHide}\r\n      src={props.queue === \"q0\" || props.queue === \"q1\" ? _uri.StreamPage(`${props.albumPath}\\\\${props.pageInfo.uncPathEncoded}`, props.type) : loadingImg}\r\n      alt=\"Not loaded\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction IsVideo(extension) {\r\n  if (extension === \".webm\" || extension === \".mp4\") {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default withPageManager(withMyAlert(ReaderModal));","import React, { useState, useEffect, useRef } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport ReaderModal from '../_shared/ReaderModal/ReaderModal';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport PullToRefresh from 'react-simple-pull-to-refresh';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction SelfComps(props) {\r\n  console.log(\"selfComps rendering\");\r\n  const type = 1;\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n  const [selectedAlbumCm, setSelectedAlbumCm] = useState(null);\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n\r\n  const handleRefresh = () => {\r\n    return new Promise((resolve, reject) => {\r\n      const { path } = props.queryParts;\r\n      const cleanPath = path ?? \"\";\r\n\r\n      axios.get(_uri.GetAlbumCardModels(type, 0, 0, cleanPath))\r\n        .then((response) => {\r\n          setAlbumCms(response.data);\r\n          console.log('sc albums', response.data);\r\n          resolve(\"param from resolve\");\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n          reject(\"param from reject\");\r\n        });\r\n    });\r\n  }\r\n  useEffect(() => { handleRefresh(); }, [props.queryParts]);\r\n\r\n  const readerHandler = {\r\n    view: (pageCount, albumCm) => {\r\n      if(pageCount === 0){\r\n        props.history.push(\"Sc?path=\" + albumCm.path);\r\n      }\r\n      else{\r\n        setSelectedAlbumCm(albumCm);\r\n        setReaderModalIsOpen(true);\r\n      }\r\n    },\r\n\r\n    close: (path, lastPageIndex) => {\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(_uri.UpdateAlbumOuterValue(type), {\r\n        albumPath: path,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then((response) => {\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n        \r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const crudHandler = {\r\n    pageDeleteSuccess: (path) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (path, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <PullToRefresh onRefresh={handleRefresh}>\r\n        <Row gutter={0} type=\"flex\">\r\n          {albumCms.map((a, index) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.path}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={(albumCm) => readerHandler.view(a.pageCount, albumCm)}\r\n                showContextMenu={true}\r\n                type={1}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      </PullToRefresh>\r\n      <ReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={selectedAlbumCm}\r\n        type={1}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(SelfComps));","import React from 'react';\r\nimport { Input } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputTextbox(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col sm={17}>\r\n          <Input\r\n            placeholder={props.placeholder}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputTextbox;","import React from 'react';\r\nimport { Rate } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputStar(props) {\r\n  function handleChange(value) {\r\n    props.onChange(props.label, value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Rate\r\n            count={3}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputStar;","import React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputRadio(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col sm={17}>\r\n          <Radio.Group onChange={handleChange} value={props.value} style={{ width: \"100%\" }}>\r\n            <Row>\r\n              {props.items.map(item => (\r\n                <Col span={8} key={item}>\r\n                  <Radio key={item} value={item}><span style={{ color: \"white\" }}>{item}</span></Radio>\r\n                </Col>\r\n              ))}\r\n            </Row>\r\n          </Radio.Group>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputRadio;","import React from 'react';\r\nimport { Checkbox } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputCheck(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.checked);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Checkbox onChange={handleChange} checked={props.value} />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputCheck;","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputMulticheck(props) {\r\n\r\n  function handleClick(label) {\r\n    props.onChange(props.label, label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col sm={17}>\r\n          <Row gutter={2}>\r\n            {props.items.map((item) => (\r\n              <Col span={8} key={item}>\r\n                <Button\r\n                  key={item}\r\n                  type={props.value.includes(item) ? \"primary\" : \"link\"}\r\n                  ghost={props.value.includes(item) ? true : false}\r\n                  onClick={() => handleClick(item)}\r\n                  style={{ width: \"100%\", textAlign: \"left\", marginBottom: \"2px\" }}\r\n                >\r\n                  {item}\r\n                </Button>\r\n              </Col>)\r\n            )}\r\n          </Row>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputMulticheck;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Button } from 'antd';\r\nimport useSWR from 'swr';\r\n\r\nimport MyInputTextbox from '../_shared/Editors/MyInputTextbox';\r\nimport MyInputStar from '../_shared/Editors/MyInputStar';\r\nimport MyInputRadio from '../_shared/Editors/MyInputRadio';\r\nimport MyInputCheck from '../_shared/Editors/MyInputCheck';\r\nimport MyInputMulticheck from '../_shared/Editors/MyInputMulticheck';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\n\r\nimport * as _helper from '../_utils/Helper';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst lodash = require('lodash/array');\r\nconst axios = require('axios').default;\r\n\r\nfunction EditModal(props) {\r\n  const { data: albumInfo, error: aiError } = useSWR(_uri.GetAlbumInfo());\r\n\r\n  const [albumVm, setAlbumVm] = useState({\r\n    path: \"\", //not updated\r\n    pageCount: 0, //not updated\r\n    lastPageIndex: 0, //not updated\r\n    album: {\r\n      title: \"\",\r\n      category: \"Manga\",\r\n      orientation: \"Portrait\",\r\n      artists: [],\r\n      tags: [],\r\n      languages: [],\r\n      flags: [],\r\n      tier: 0,\r\n      cover: \"\",\r\n      isWip: false,\r\n      isRead: false,\r\n      entryDate: null\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumPath === undefined) { return; }\r\n\r\n    axios.get(_uri.GetAlbumVm(props.type, props.albumPath))\r\n      .then(function (response) {\r\n        setAlbumVm(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumPath]);\r\n\r\n  const handlers = {\r\n    albumVmChange: function (label, value) {\r\n      let newAlbumVm = { ...albumVm };\r\n      let cleanedValue = value;\r\n      if (label === \"Artists\") {\r\n        cleanedValue = value.split(\",\");\r\n      }\r\n      else if (label === \"Tags\" || label === \"Languages\") {\r\n        cleanedValue = albumVm.album[_helper.firstLetterLowerCase(label)];\r\n        if (cleanedValue.includes(value)) {\r\n          cleanedValue = lodash.pull(cleanedValue, value);\r\n        }\r\n        else {\r\n          cleanedValue.push(value);\r\n        }\r\n      }\r\n      newAlbumVm.album[_helper.firstLetterLowerCase(label)] = cleanedValue;\r\n      setAlbumVm(newAlbumVm);\r\n    },\r\n    ok: function () {\r\n      props.onOk(albumVm);\r\n    },\r\n    cancel: function () {\r\n      props.onCancel();\r\n    },\r\n    editFiles: function () {\r\n      props.onEditFiles(albumVm);\r\n    },\r\n    delete: function () {\r\n      props.onDelete(albumVm);\r\n    },\r\n    refresh: function () {\r\n      props.onRefresh(albumVm);\r\n    }\r\n  }\r\n\r\n  const temp = (\r\n    <div className=\"ant-modal-root\">\r\n      <div className=\"ant-modal-mask\"></div>\r\n      <div tabIndex={-1} className=\"ant-modal-wrap\" role=\"dialog\" aria-labelledby=\"rcDialogTitle0\" onClick={handlers.cancel}>\r\n        <div role=\"document\" className=\"my-ant-modal\" onClick={(e) => e.stopPropagation()}>\r\n          <div className=\"ant-modal-content\">\r\n            <button onClick={handlers.cancel} type=\"button\" aria-label=\"Close\" className=\"ant-modal-close\">\r\n              <span className=\"ant-modal-close-x\">\r\n                <i aria-label=\"icon: close\" className=\"anticon anticon-close ant-modal-close-icon\">\r\n                  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"\" data-icon=\"close\" fill=\"currentColor\" aria-hidden=\"true\" style={{ height: \"1em\", width: \"1em\" }}>\r\n                    <path d=\"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z\">\r\n                    </path>\r\n                  </svg>\r\n                </i>\r\n              </span>\r\n            </button>\r\n            <div className=\"my-ant-modal-header\">\r\n              <div className=\"my-ant-modal-title\" id=\"rcDialogTitle0\">Edit Metadata</div>\r\n            </div>\r\n            <div className=\"my-ant-modal-body\">\r\n              {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n                <>\r\n                  <MyInputTextbox label=\"Title\" value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n                  <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n                  <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n                  <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n                  <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n                  <MyInputTextbox label=\"Note\" value={albumVm.album.note} onChange={handlers.albumVmChange} />\r\n                  <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n                  <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n                  <MyInputCheck label=\"IsRead\" value={albumVm.album.isRead} onChange={handlers.albumVmChange} />\r\n                  <MyInputCheck label=\"IsWip\" value={albumVm.album.isWip} onChange={handlers.albumVmChange} />\r\n                </>\r\n              )}\r\n            </div>\r\n            <div className=\"my-ant-modal-footer\">\r\n              <Row>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.delete} type=\"danger\" style={{ width: \"100%\" }}>\r\n                    Delete\r\n                  </Button>\r\n                </Col>\r\n                <Col span={1}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.refresh} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n                    Refresh\r\n                  </Button>\r\n                </Col>\r\n                <Col span={2}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.editFiles} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n                    Files\r\n                  </Button>\r\n                </Col>\r\n                <Col span={1}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.ok} type=\"primary\" style={{ width: \"100%\" }}>\r\n                    Save\r\n                  </Button>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (<>{props.isOpen ? temp : \"\"}</>);\r\n}\r\n\r\nexport default withMyAlert(EditModal);","import { useMediaQuery } from 'react-responsive'\r\n\r\nconst DesktopOnly = ({ children }) => {\r\n  const isDesktop = useMediaQuery({ minWidth: 801 })\r\n  return isDesktop ? children : null\r\n}\r\nconst MobileOnly = ({ children }) => {\r\n  const isMobile = useMediaQuery({ maxWidth: 800 })\r\n  return isMobile ? children : null\r\n}\r\n\r\nconst IsMobile = () => {\r\n  return useMediaQuery({ maxWidth: 800 })\r\n}\r\n\r\nexport { DesktopOnly, MobileOnly, IsMobile };","import React, { useState, useEffect, useRef } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\n\r\nimport { InView } from 'react-intersection-observer';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport ReaderModal from '../_shared/ReaderModal/ReaderModal';\r\nimport EditModal from './EditModal';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport PullToRefresh from 'react-simple-pull-to-refresh';\r\nimport * as _uri from '../_utils/UriHelper';\r\nimport { MobileOnly } from '../_utils/Display';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction Albums(props) {\r\n  console.log(\"albums rendering\");\r\n  const type = 0;\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  //#region Display Album List\r\n  const pageSize = 100;\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n  const [maxPage, setMaxPage] = useState(0);\r\n\r\n  const handleRefresh = () => {\r\n    return new Promise((resolve, reject) => {\r\n      const { page, row, query } = props.queryParts;\r\n      //const encodedQuery = (query !== undefined) ? encodeURIComponent(query) : \"\";\r\n      axios.get(_uri.GetAlbumCardModels(type, page, row, query))\r\n        .then((response) => {\r\n          setAlbumCms(response.data);\r\n          resolve(\"param from resolve\");\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n          reject(\"param from reject\");\r\n        });\r\n    });\r\n  }\r\n  useEffect(() => { handleRefresh(); }, [props.queryParts]);\r\n\r\n  const [filteredAlbumCms, setFilteredAlbumCms] = useState([]);\r\n  useEffect(() => {\r\n    const acmsFiltered = props.tierFilter === null ? albumCms\r\n      : albumCms.filter(a => { return a.tier === props.tierFilter });\r\n\r\n    const acmsPaged = acmsFiltered.slice(0, maxPage * pageSize);\r\n\r\n    setFilteredAlbumCms(acmsPaged);\r\n  }, [albumCms, maxPage, props.tierFilter]);\r\n\r\n  function inViewChange(inView, entry){\r\n    console.log('inViewChange', entry);\r\n    if(entry.isIntersecting) setMaxPage(maxPage + 1);\r\n  }\r\n  //#endregion\r\n\r\n  //#region Display Album Pages\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n  useEffect(() => {\r\n    var body = document.body;\r\n    if(readerModalIsOpen){\r\n      body.style.overflow = \"hidden\";\r\n    }\r\n    else{\r\n      body.style.overflow = \"visible\";\r\n    }\r\n  },[readerModalIsOpen])\r\n\r\n  const [selectedAlbumCm, setSelectedAlbumCm] = useState(null);\r\n\r\n  const readerHandler = {\r\n    view: (albumCm) => {\r\n      console.log('view', albumCm);\r\n\r\n      setSelectedAlbumCm(albumCm);\r\n      setReaderModalIsOpen(true);\r\n    },\r\n\r\n    close: (path, lastPageIndex) => {\r\n      console.log('readerHandler close triggered');\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(_uri.UpdateAlbumOuterValue(type), {\r\n        albumPath: path,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then((response) => {\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex,\r\n          isRead: lastPageIndex === albumCm.pageCount - 1 ? true : albumCm.isRead\r\n        };\r\n      }));\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Edit Delete\r\n  const [editModalIsOpen, setEditModalIsOpen] = useState(false);\r\n  const [editedAlbumPath, setEditedAlbumId] = useState(undefined);\r\n\r\n  const crudHandler = {\r\n    edit: (path) => {\r\n      setEditModalIsOpen(true);\r\n      setEditedAlbumId(path);\r\n    },\r\n    pageDeleteSuccess: (path) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (path, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const editHandler = {\r\n    ok: (editedAlbumVm) => {\r\n      setEditModalIsOpen(false);\r\n      axios.post(_uri.UpdateAlbum(type), editedAlbumVm)\r\n        .then((response) => {\r\n          console.log(\"edit success. Path: \", response.data);\r\n\r\n          let newAlbumCms = [...albumCms];\r\n          let editedAlbumVmIndex = newAlbumCms.findIndex(a => a.path === editedAlbumVm.path);\r\n          newAlbumCms[editedAlbumVmIndex].fullTitle = `[${editedAlbumVm.album.artists.join(', ')}] ${editedAlbumVm.album.title}`;\r\n          newAlbumCms[editedAlbumVmIndex].languages = editedAlbumVm.album.languages;\r\n\r\n          newAlbumCms[editedAlbumVmIndex].note = editedAlbumVm.album.note;\r\n\r\n          setAlbumCms(newAlbumCms);\r\n        })\r\n        .catch((error) => {\r\n          //console.log\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    cancel: () => {\r\n      setEditModalIsOpen(false);\r\n    },\r\n    delete: (albumVm) => {\r\n      const album = albumVm.album;\r\n      confirm({\r\n        title: `Delete album [${album.artists.join(', ')}] ${album.title}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          axios.delete(_uri.DeleteAlbum(type, albumVm.path))\r\n            .then(function (response) {\r\n              setEditModalIsOpen(false);\r\n\r\n              setAlbumCms(albumCms.filter(albumCm => {\r\n                return albumCm.path !== albumVm.path;\r\n              }));\r\n            })\r\n            .catch(function (error) {\r\n              setEditModalIsOpen(false);\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    },\r\n    refresh: (albumVm) => {\r\n      setEditModalIsOpen(false);\r\n      axios.get(_uri.RefreshAlbum(0, albumVm.path))\r\n        .then((response) => {\r\n          props.popInfo(\"Refresh Album\", response.data, null);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    editFiles: (albumVm) => {\r\n      setEditModalIsOpen(false);\r\n      props.history.push(\"FileManagement?path=\" + albumVm.path);\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <>\r\n      <PullToRefresh onRefresh={handleRefresh}>\r\n        {/* <div style={{width:\"100%\", marginBottom:\"5px\"}}> */}\r\n        <Row gutter={0} type=\"flex\">\r\n          {filteredAlbumCms.map((a, index) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.path}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={crudHandler.edit}\r\n                //onDelete={crudHandler.delete}\r\n                showContextMenu={true}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n        <InView as=\"div\" onChange={inViewChange}>\r\n          <div style={{width:\"100%\", height:\"5px\", backgroundColor:\"transparent\"}}></div>\r\n        </InView>\r\n      </PullToRefresh>\r\n      <div style={{position:\"fixed\", top:0, backgroundColor:'rgba(0,0,0,0)'}}>\r\n        <MobileOnly><div style={{position:\"relative\",height:\"38px\"}}></div></MobileOnly>\r\n        <div style={{position:\"relative\", backgroundColor:'#2d2d2d'}}>\r\n          {`Total: ${albumCms.length} Filtered: ${filteredAlbumCms.length}`}\r\n        </div>\r\n        \r\n      </div>\r\n      <ReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={selectedAlbumCm}\r\n      />\r\n      <EditModal\r\n        isOpen={editModalIsOpen}\r\n        albumPath={editedAlbumPath}\r\n        onOk={editHandler.ok}\r\n        onCancel={editHandler.cancel}\r\n        onDelete={editHandler.delete}\r\n        onRefresh={editHandler.refresh}\r\n        onEditFiles={editHandler.editFiles}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(Albums));","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport useSWR from 'swr';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport * as _uri from \"../_utils/UriHelper\";\r\n\r\nfunction Genres(props) {\r\n  const uri = props.page === \"Genres\" ? _uri.GetGenreCardModels() :\r\n    props.page === \"Artists\" ? _uri.GetFeaturedArtistCardModels() :\r\n      null;\r\n\r\n  const { data: albumCGroups, error } = useSWR(uri);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!albumCGroups) { return <div>loading...</div>; }\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      console.log(\"query click\", albumCm);\r\n      props.history.push('/albums?query=' + albumCm.path)\r\n    },\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {albumCGroups.map((acg, index) => (\r\n        <Row key={\"acgRow\" + acg.name} gutter={0} type=\"flex\" style={{ border: \"1px solid rgb(83, 83, 83)\", borderRadius: \"8px\", paddingTop: \"8px\", marginBottom: \"5px\" }}>\r\n          { props.page === \"This feature is cancelled\" ? (\r\n            <div style={{ position: \"relative\" }}>\r\n              <div style={{ position: \"absolute\", top: \"-18px\", left: \"10px\" }}>{acg.name}</div>\r\n            </div>) : \"\"\r\n          }\r\n          {acg.albumCms.map((a) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.path}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={() => { }}\r\n                onDelete={() => { }}\r\n                showContextMenu={false}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Genres;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { FileBrowser, FileContextMenu, FileList, FileNavbar, FileToolbar, ChonkyActions, defineFileAction, ChonkyIconName } from 'chonky';\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\nimport { TouchBackend } from 'react-dnd-touch-backend';\r\nimport moment from 'moment';\r\n\r\nimport withPageManager from '../_shared/HOCs/withPageManager';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport TextDialog from '../_shared/Modals/TextDialog';\r\nimport { IsMobile } from '../_utils/Display';\r\nimport * as _uri from '../_utils/UriHelper';\r\nimport * as _helper from '../_utils/Helper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction FileManagement(props) {\r\n  const chonkyFileActions = [\r\n    defineFileAction({\r\n      id: \"custom_rename\",\r\n      requiresSelection: true,\r\n      button: {\r\n        name: \"R\",\r\n        toolbar: true,\r\n        contextMenu: true,\r\n        icon: ChonkyIconName.code\r\n      }\r\n    }),\r\n    defineFileAction({\r\n      id: \"custom_delete\",\r\n      requiresSelection: true,\r\n      button: {\r\n        name: \"D\",\r\n        toolbar: true,\r\n        contextMenu: true,\r\n        icon: ChonkyIconName.trash\r\n      }\r\n    }),\r\n    defineFileAction({\r\n      id: \"custom_move\",\r\n      requiresSelection: true,\r\n      button: {\r\n        name: \"M\",\r\n        toolbar: true,\r\n        contextMenu: true,\r\n        icon: ChonkyIconName.folder\r\n      }\r\n    }),\r\n    ChonkyActions.EnableGridView,\r\n    ChonkyActions.EnableListView,\r\n    ChonkyActions.UploadFiles,\r\n    ChonkyActions.CreateFolder\r\n  ];\r\n\r\n  const determineActionToExecute = (data) => {\r\n    if (data.id === \"custom_delete\") action.delete(data);\r\n    else if (data.id === \"custom_rename\") action.rename(data);\r\n    else if (data.id === \"custom_move\") console.log(data.id);\r\n    else if (data.id === ChonkyActions.EndDragNDrop.id) action.dragNDrop(data);\r\n    else if (data.id === ChonkyActions.UploadFiles.id) console.log(data.id);\r\n    else if (data.id === ChonkyActions.OpenFiles.id) action.openFolder(data);\r\n    else if (data.id === ChonkyActions.OpenParentFolder.id) console.log(data.id);\r\n    else if (data.id === ChonkyActions.CreateFolder.id) action.createFolder(data);\r\n  };\r\n\r\n  const action = {\r\n    createFolder: (data) =>{\r\n      setTextDialog({\r\n        visible: true,\r\n        btnText: 'Create Folder',\r\n        initialValue: '',\r\n        onOk: (val, oldVal) => {\r\n          console.log('folder name', val);\r\n          setViewModel((prev) => {\r\n            if (viewModel.subDir !== null) {\r\n              props.popError(\"Invalid Operation\", \"Creating folder inside a folder is not allowed\");\r\n            }\r\n            prev.fsNodes.unshift({\r\n              name: val,\r\n              size: 0,\r\n              nodeType: 0,\r\n              uncPathEncoded: null,\r\n              childs: []\r\n            });\r\n            return ({\r\n              ...prev\r\n            });\r\n          });\r\n        }\r\n      });\r\n    },\r\n    openFolder: (data)=>{\r\n      if (!data.payload.targetFile.isDir) { return; }\r\n\r\n      const targetSubDir = data.payload.targetFile.name !== \"Root\" ?\r\n        data.payload.targetFile.name :\r\n        null;\r\n      const newDirChains = targetSubDir !== null ?\r\n        [...viewModel.dirChains, { id: '1', name: targetSubDir, isDir: true }] :\r\n        rootChain;\r\n\r\n      setViewModel((prevViewModel) => {\r\n        prevViewModel.subDir = targetSubDir;\r\n        prevViewModel.dirChains = newDirChains;\r\n        return ({\r\n          ...prevViewModel\r\n        });\r\n      });\r\n    },\r\n    delete: (data) => {\r\n      const cModel = data.state.selectedFiles[0];\r\n      const subDir = viewModel.dirChains.find(dir => dir.id === \"1\")?.name;\r\n\r\n      const delObj = (() => {\r\n        const alRelPath = cModel.isDir ? cModel.name : _helper.pathJoin([subDir, cModel.name], '\\\\');\r\n\r\n        return {\r\n          albumPath: viewModel.albumPath,\r\n          alRelPath: alRelPath\r\n        };\r\n      })();\r\n\r\n      props.deletePage(delObj,\r\n        (response) => {\r\n          console.log('delete success', response);\r\n          const newFsNodes = (() => {\r\n            if(cModel.isDir || subDir == null){\r\n              return viewModel.fsNodes.filter(n => n.name !== cModel.name);\r\n            }\r\n            else{\r\n              viewModel.fsNodes.forEach(n => {\r\n                if (n.name === subDir) {\r\n                  n.childs = n.childs.filter(c => c.name !== cModel.name);\r\n                }\r\n              });\r\n              return viewModel.fsNodes;\r\n            }\r\n          })();\r\n\r\n          setViewModel((prevState) => ({\r\n            ...prevState,\r\n            fsNodes: newFsNodes\r\n          }));\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    rename: (data) => {\r\n      if (data.state.selectedFiles.length === 0) { return; }\r\n      setTextDialog({\r\n        visible: true,\r\n        btnText: 'Rename',\r\n        initialValue: data.state.selectedFiles[0].name,\r\n        onOk: (val, oldVal) => {\r\n          const srcAlRelPath = _helper.pathJoin([viewModel.subDir, oldVal], '\\\\');\r\n          const dstAlRelPath = _helper.pathJoin([viewModel.subDir, val], '\\\\');\r\n\r\n          const movObj = {\r\n            overwrite: false,\r\n            src: {\r\n              albumPath: viewModel.albumPath,\r\n              alRelPath: srcAlRelPath,\r\n            },\r\n            dst: {\r\n              albumPath: viewModel.albumPath,\r\n              alRelPath: dstAlRelPath\r\n            }\r\n          };\r\n\r\n          props.movePage(movObj, \r\n            (response) => {\r\n              afterAction.move(movObj);\r\n            },(error) => {\r\n              props.popApiError(error);\r\n            });\r\n        }\r\n      });\r\n    },\r\n    dragNDrop: (data) => {\r\n      if (data.payload.draggedFile.isDir) { return; }\r\n      if (!data.payload.destination.isDir) { return; }\r\n\r\n      const fileName = data.payload.draggedFile.name;\r\n      const srcAlRelPath = _helper.pathJoin([viewModel.subDir, fileName], '\\\\');\r\n      const dstDir = data.payload.destination.name !== \"Root\" ? data.payload.destination.name : null;\r\n      const dstAlRelPath = _helper.pathJoin([dstDir, fileName], '\\\\');\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: viewModel.albumPath,\r\n          alRelPath: srcAlRelPath\r\n        },\r\n        dst: {\r\n          albumPath: viewModel.albumPath,\r\n          alRelPath: dstAlRelPath\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          afterAction.move(movObj);\r\n        },(error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n  };\r\n\r\n  const afterAction = {\r\n    move: (movObj) => {\r\n      const albumPath = movObj.src.albumPath;\r\n      const srcObj = splitMoveModel(movObj.src.alRelPath);\r\n      const dstObj = splitMoveModel(movObj.dst.alRelPath);\r\n\r\n      const srcFsNode = (() => {\r\n        if(srcObj.subDir === null){\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === srcObj.fileName);\r\n          return viewModel.fsNodes.splice(lv1Idx, 1)[0];\r\n        }\r\n        else{\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === srcObj.subDir);\r\n          const lv2Idx = viewModel.fsNodes[lv1Idx].childs.findIndex(n => n.name === srcObj.fileName);\r\n          return viewModel.fsNodes[lv1Idx].childs.splice(lv2Idx, 1)[0];\r\n        }\r\n      })();\r\n\r\n      const modifiedSrcFsNode = {\r\n        ...srcFsNode,\r\n        name: dstObj.fileName\r\n      };\r\n\r\n      const removedNode = (() =>{\r\n        //if dst node exist it means overwrite, remove it\r\n        if(dstObj.subDir === null){\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === dstObj.fileName);\r\n          if(lv1Idx !== -1) return viewModel.fsNodes.splice(lv1Idx, 1)[0];\r\n        }\r\n        else{\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === dstObj.subDir);\r\n          const lv2Idx = viewModel.fsNodes[lv1Idx].childs.findIndex(n => n.name === dstObj.fileName);\r\n          if(lv2Idx !== -1) return viewModel.fsNodes[lv1Idx].childs.splice(lv2Idx, 1)[0];\r\n        }\r\n      })();\r\n\r\n      const targetParentIdx = (() => {\r\n        if(dstObj.subDir !== null){\r\n          return viewModel.fsNodes.findIndex(n => n.name === dstObj.subDir);\r\n        }\r\n        return null;\r\n      })();\r\n\r\n      if(targetParentIdx !== null){\r\n        viewModel.fsNodes[targetParentIdx].childs.push(modifiedSrcFsNode);\r\n        viewModel.fsNodes[targetParentIdx].childs.sort(compare);\r\n      }\r\n      else{\r\n        viewModel.fsNodes.push(modifiedSrcFsNode);\r\n        viewModel.fsNodes.sort(compare);\r\n      }\r\n\r\n      setViewModel((prev) => {\r\n        return ({\r\n          ...prev\r\n        });\r\n      });\r\n\r\n      function splitMoveModel(alRelPath){\r\n        const arr = alRelPath.split('\\\\');\r\n        if(arr.length === 2){\r\n          return {\r\n            subDir: arr[0],\r\n            fileName: arr[1]\r\n          };\r\n        }\r\n        else{\r\n          return {\r\n            subDir: null,\r\n            fileName: arr[0]\r\n          };\r\n        }\r\n      }\r\n      function compare(a, b) {\r\n        if (a.nodeType === b.nodeType) { //Make sure folders always come before files\r\n          var nameA = a.name.toLowerCase(), nameB = b.name.toLowerCase();\r\n          if (nameA < nameB) //sort string ascending\r\n            return -1;\r\n          if (nameA > nameB)\r\n            return 1;\r\n          return 0; //default return value (no sorting)\r\n        }\r\n        return a.nodeType > b.nodeType ? 1 : -1;\r\n      }\r\n    }\r\n  }\r\n\r\n  const defaultTextDialog = { visible: false, initialValue: 'ad', btnText: null };\r\n  const [textDialog, setTextDialog] = useState(defaultTextDialog);\r\n\r\n  const rootChain = [{ id: '0', name: 'Root', isDir: true }];\r\n  const [viewModel, setViewModel] = useState({\r\n    albumPath: null,\r\n    title: '',\r\n    subDir: null,\r\n    fsNodes: [],\r\n    dirChains: rootChain\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.path === \"\" || props.path === null || props.path === undefined) { return; }\r\n\r\n    axios.get(_uri.GetAlbumFsNodes(props.type, props.path))\r\n      .then((response) => {\r\n        setViewModel({\r\n          albumPath: props.path,\r\n          title: response.data.title,\r\n          subDir: null,\r\n          fsNodes: response.data.fsNodes,\r\n          dirChains: rootChain\r\n        });\r\n\r\n        console.log(response.data)\r\n      })\r\n      .catch((error) => {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.path]);\r\n\r\n  const [chonkyModels, setChonkyModels] = useState([]);\r\n  useEffect(() => {\r\n    const targetFsNodes = viewModel.subDir !== null ?\r\n      viewModel.fsNodes.find(n => n.name === viewModel.subDir).childs :\r\n      viewModel.fsNodes;\r\n\r\n    const newModels = targetFsNodes.map((n, index) => {\r\n      return {\r\n        id: index + 1,\r\n        name: n.name,\r\n        isDir: n.nodeType === 0,\r\n        thumbnailUrl: n.nodeType === 1 ? _uri.StreamResizedImage(n.uncPathEncoded, 150) : null,\r\n        size: n.size,\r\n        childrenCount: n.childs?.length,\r\n        selectable: true,\r\n        draggable: n.nodeType !== 0\r\n      }\r\n    });\r\n\r\n    setChonkyModels(newModels);\r\n  }, [viewModel]);\r\n\r\n  const dndBackend = IsMobile() ? TouchBackend : HTML5Backend;\r\n\r\n  return (\r\n    <>\r\n      <div style={{\r\n        width: \"100%\",\r\n        padding: \"0px 8px 0px 8px\",\r\n        borderTop: \"1px solid grey\",\r\n        borderBottom: \"1px solid grey\",\r\n        marginBottom: \"2px\"\r\n      }}>\r\n        <h3>{viewModel.title}</h3>\r\n      </div>\r\n      <div style={{ height: \"80vh\" }}>\r\n        <DndProvider backend={dndBackend}>\r\n          <FileBrowser\r\n            darkMode={true}\r\n            //disableSelection={true}\r\n            files={chonkyModels} folderChain={viewModel.dirChains} fileActions={chonkyFileActions}\r\n            disableDragAndDropProvider={true}\r\n            disableDefaultFileActions={true}\r\n            onFileAction={determineActionToExecute}\r\n          >\r\n            <FileNavbar />\r\n            <FileToolbar />\r\n            <FileList />\r\n            <FileContextMenu />\r\n          </FileBrowser>\r\n        </DndProvider>\r\n      </div>\r\n      <TextDialog\r\n        visible={textDialog.visible} onClose={() => setTextDialog(defaultTextDialog)}\r\n        initialValue={textDialog.initialValue}\r\n        onOk={textDialog.onOk}\r\n        btnText={textDialog.btnText}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withPageManager(withMyAlert(FileManagement));","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Button, Divider, Progress, Input, Row, Col, Form, Select, Alert } from 'antd';\r\n\r\nimport { css } from '@emotion/css';\r\nimport ScrollToBottom from 'react-scroll-to-bottom';\r\n\r\nimport { IS_PUBLIC } from \"../_utils/Config\";\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport * as _uri from \"../_utils/UriHelper\";\r\nimport * as _helper from \"../_utils/Helper\";\r\n\r\nconst axios = require('axios').default;\r\n\r\nconst ROOT_CSS = css({\r\n  height: 300,\r\n  width: '100%'\r\n});\r\n\r\nfunction Setting(props){\r\n  function setLoading(btnName, isLoading){\r\n    setButton((prev) => {\r\n      prev[btnName].isLoading = isLoading;\r\n      prev[btnName].progress = isLoading ? 0 : 100;\r\n      return {\r\n        ...prev\r\n      }\r\n    });\r\n  }\r\n\r\n  function setDefaultButton(text,icon,name,uri){\r\n    return {\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: text,\r\n      icon: icon,\r\n      execute: () => {\r\n        setLoading(name, true);\r\n\r\n        const sse = new EventSource(uri, {});\r\n        sse.onmessage = (res) => {\r\n          const resData = JSON.parse(res.data); console.log('res data', resData);\r\n          const isLoading = resData.currentStep !== resData.maxStep;\r\n          if(!isLoading) sse.close();\r\n          if(resData.isError) props.popError(\"API Error\", resData.message);\r\n\r\n          const percent = _helper.getPercent100(resData.currentStep, resData.maxStep);\r\n          setButton(prev => { \r\n            prev[name].percent = percent;\r\n            prev[name].isLoading = isLoading;\r\n            prev[name].eventMsgs.push(resData);\r\n            return {\r\n              ...prev\r\n            };\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  const [button, setButton] = useState({\r\n    reload: setDefaultButton('Reload','reload','reload',_uri.ReloadDatabase()),\r\n    fullScan: setDefaultButton('Full Scan', 'sync', 'fullScan', _uri.RescanDatabase()),\r\n    quickScan: setDefaultButton('Quick Scan', 'history', 'quickScan',_uri.QuickScan()),\r\n    clean: setDefaultButton('Clean Library', 'delete','clean', _uri.CleanLibrary()),\r\n\r\n    checkApiUrl:{\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: 'Check Url',\r\n      icon: 'check-circle',\r\n      execute: null\r\n    },\r\n    checkMediaUrl:{\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: 'Check Url',\r\n      icon: 'check-circle',\r\n      execute: null\r\n    },\r\n    checkResMediaUrl:{\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: 'Check Url',\r\n      icon: 'check-circle',\r\n      execute: null\r\n    },\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <SettingForm {...props} />\r\n\r\n      <Divider orientation=\"left\" style={{color:\"white\"}}>\r\n        Actions\r\n      </Divider>\r\n      <ActionButton {...button.reload} />\r\n      <ActionButton {...button.fullScan} />\r\n      <ActionButton {...button.quickScan} />\r\n      <ActionButton {...button.clean} />\r\n\r\n      <Divider orientation=\"left\" style={{color:\"white\"}}>\r\n        Event Stream\r\n      </Divider>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(Setting);\r\n\r\nfunction SettingForm(props){\r\n\r\n  const [apiBaseUrl, setApiBaseUrl] = useState(null);\r\n  useEffect(() =>{\r\n    setApiBaseUrl(_uri.GetApiBaseUrl());\r\n  },[]);\r\n\r\n  const [mediaBaseUrl, setMediaBaseUrl] = useState(null);\r\n  useEffect(() =>{\r\n    setMediaBaseUrl(_uri.GetMediaBaseUrl());\r\n  },[]);\r\n\r\n  const [resMediaBaseUrl, setResMediaBaseUrl] = useState(null);\r\n  useEffect(() =>{\r\n    setResMediaBaseUrl(_uri.GetResMediaBaseUrl());\r\n  },[]);\r\n\r\n  function checkUrl(url){\r\n    //setLoading('checkApiUrl', true);\r\n    axios.get(url)\r\n      .then((response) => {\r\n        //setLoading('checkApiUrl', false);\r\n        props.popInfo(`${response.status} ${response.statusText}`, '', response.data);\r\n      })\r\n      .catch((error) => {\r\n        //setLoading('checkApiUrl', false);\r\n        props.popApiError(error);\r\n      });\r\n  }\r\n\r\n  return(\r\n    <>\r\n      <RowBase textAlign='right'\r\n        col0={\r\n          <SettingFormLabel text='API'/>\r\n        }\r\n        col1={\r\n          <Input.Search \r\n            value={apiBaseUrl} \r\n            onChange={(e) => { setApiBaseUrl(e.target.value); }} \r\n            onSearch={() => { checkUrl(apiBaseUrl); }}\r\n            disabled={IS_PUBLIC}\r\n            enterButton\r\n          />\r\n        }\r\n      />\r\n      <RowBase textAlign='right'\r\n        col0={\r\n          <SettingFormLabel text='Media'/>\r\n        }\r\n        col1={\r\n          <Input.Search \r\n            value={mediaBaseUrl} \r\n            onChange={(e) => { setMediaBaseUrl(e.target.value); }} \r\n            onSearch={() => { checkUrl(mediaBaseUrl); }}\r\n            disabled={IS_PUBLIC}\r\n            enterButton\r\n          />\r\n        }\r\n      />\r\n      <RowBase textAlign='right'\r\n        col0={\r\n          <SettingFormLabel text='Res Media'/>\r\n        }\r\n        col1={\r\n          <Input.Search \r\n            value={resMediaBaseUrl} \r\n            onChange={(e) => { setResMediaBaseUrl(e.target.value); }} \r\n            onSearch={() => { checkUrl(resMediaBaseUrl); }}\r\n            disabled={IS_PUBLIC}\r\n            enterButton\r\n          />\r\n        }\r\n      />\r\n      <RowBase textAlign='right'\r\n        col1={ \r\n          <Button\r\n            type=\"primary\"\r\n            onClick={() => {\r\n              _uri.SaveApiBaseUrl(apiBaseUrl);\r\n              _uri.SaveMediaBaseUrl(mediaBaseUrl);\r\n              _uri.SaveResMediaBaseUrl(resMediaBaseUrl);\r\n            }}\r\n            style={{ width:\"100%\", maxWidth:\"100px\"}}\r\n            disabled={IS_PUBLIC}\r\n          >\r\n            Save\r\n          </Button>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n\r\n  function SettingFormLabel(props){\r\n    const style={\r\n      paddingTop:'4px',\r\n      fontWeight:'bold'\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <div style={{float:'left', ...style}}>{props.text}</div>\r\n        <div style={{float:'right', ...style}}>:</div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nfunction ActionButton(props){\r\n  const msgStr = props.eventMsgs.map(e => e.message).join('\\n');\r\n  return(\r\n    <>\r\n    <div style={{display:\"flex\", flexDirection:\"row\", marginBottom:\"5px\"}}>\r\n      <div style={{width:\"130px\"}}>\r\n      <Button\r\n        icon={props.icon}\r\n        type=\"primary\"\r\n        loading={props.isLoading}\r\n        onClick={props.execute}\r\n        block={true}\r\n        style={{ width:\"100%\", maxWidth:\"140px\"}}\r\n        disabled={IS_PUBLIC}\r\n      >\r\n        {props.text}\r\n      </Button>\r\n      </div>\r\n      <div style={{\r\n        height:\"32px\", \r\n        flex:\"auto\", \r\n        marginLeft:\"10px\",\r\n        display:\"flex\",\r\n        justifyContent: \"flex-end\",\r\n        flexDirection: \"column\"\r\n      }}>\r\n        <Progress strokeLinecap=\"square\" percent={props.percent} />\r\n      </div>\r\n    </div>\r\n    <div hidden={props.eventMsgs.length === 0}\r\n      style={{display:\"flex\", flexDirection:\"row\", marginBottom:\"5px\"}}>\r\n      <div style={{width:\"130px\"}}></div>\r\n      <div style={{\r\n        //height:\"32px\", \r\n        flex:\"auto\",\r\n        marginLeft:\"10px\",\r\n        paddingRight:\"32px\"\r\n      }}>\r\n        <ScrollToBottom className={ROOT_CSS}>\r\n          {props.eventMsgs.map(e => <p style={{marginBottom:\"0.2em\"}}>{e.message}</p>)}\r\n        </ScrollToBottom>\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction RowBase(props){\r\n  const style = {\r\n    display:\"flex\", \r\n    flexDirection:\"row\", \r\n    marginBottom:\"5px\",\r\n    textAlign: props.textAlign ?? 'left'\r\n  };\r\n\r\n  return(\r\n    <>\r\n    <div style={style}>\r\n      <div style={{width:\"130px\"}}>\r\n        {props.col0}\r\n      </div>\r\n      <div style={{\r\n        height:\"32px\", \r\n        flex:\"auto\", \r\n        marginLeft:\"10px\",\r\n        display:\"flex\",\r\n        justifyContent: \"flex-end\",\r\n        flexDirection: \"column\"\r\n      }}>\r\n        {props.col1}\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\n\r\nimport { Layout, Menu, Drawer, Button, Row, Col, Modal } from 'antd';\r\nimport {\r\n  DesktopOutlined, TeamOutlined, PartitionOutlined, TagsOutlined,\r\n  PlusOutlined, MinusOutlined, ConsoleSqlOutlined, SearchOutlined,  \r\n  LaptopOutlined, SettingOutlined, MenuOutlined\r\n} from '@ant-design/icons';\r\nimport TextArea from 'antd/lib/input/TextArea';\r\nimport queryString from 'query-string';\r\nimport useSWR, { SWRConfig } from 'swr';\r\n\r\nimport SelfComps from './SelfComps/SelfComps';\r\nimport Albums from './Albums/Albums';\r\nimport Genres from './Genres/Genres';\r\nimport FileManagement from './FileManagement/FileManagement';\r\nimport Setting from './Setting/Setting';\r\nimport withMyAlert from \"./_shared/HOCs/withMyAlert\";\r\nimport * as Helper from \"./_utils/Helper\";\r\nimport * as _uri from \"./_utils/UriHelper\";\r\nimport { DesktopOnly, MobileOnly } from './_utils/Display';\r\nimport { IS_PUBLIC, API_URL, STORAGE_URL, SAS_TOKEN } from \"./_utils/Config\";\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\n\r\nfunction AppMasterPage(props) {\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n  const [collapseSider, setCollapseSider] = useState(false);\r\n\r\n  const [tierFilter, setTierFilter] = useState(null);\r\n  const handleSetTierFilter = (tier) => {\r\n    const newTier = tier === tierFilter ? null : tier;\r\n    setTierFilter(newTier);\r\n  }\r\n  const querStr = queryString.parse(props.location.search).query ?? \"\";\r\n  const pageStr = queryString.parse(props.location.search).page ?? 0;\r\n  const rowStr = queryString.parse(props.location.search).row ?? 0;\r\n  const pathStr = queryString.parse(props.location.search).path ?? \"\";\r\n\r\n  console.log(\"master page rendering\");\r\n\r\n  const queryParts = {\r\n    query: querStr,\r\n    page: pageStr,\r\n    row: rowStr,\r\n    path: pathStr\r\n  };\r\n\r\n  const { page, selectedMenu } = (() => {\r\n    function compose(page, selectedMenu) {\r\n      return {\r\n        page: page,\r\n        selectedMenu: selectedMenu\r\n      };\r\n    }\r\n    if(props.page === \"Sc\"){\r\n      return compose(\r\n        <SelfComps queryParts={queryParts} tierFilter={tierFilter} />\r\n        , '1');\r\n    }\r\n    else if (props.page === \"Albums\") {\r\n      return compose(\r\n        <Albums queryParts={queryParts} tierFilter={tierFilter}/>\r\n        , '2');\r\n    }\r\n    else if (props.page === \"Artists\") {\r\n      return compose(\r\n        <Genres page={props.page} history={props.history} />\r\n        , '3');\r\n    }\r\n    else if (props.page === \"Genres\") {\r\n      return compose(\r\n        <Genres page={props.page} history={props.history} />\r\n        , '4');\r\n    }\r\n    else if (props.page === \"FileManagement\") {\r\n      const path = queryString.parse(props.location.search).path ?? \"\";\r\n      return compose(<FileManagement path={path} />, '');\r\n    }\r\n    else if (props.page === \"Setting\") {\r\n      return compose(\r\n        <Setting page={props.page} />\r\n        , '5');\r\n    }\r\n  })();\r\n\r\n  const queryHandler = {\r\n    search: function (query) {\r\n      const correctedQuery = Helper.contains(query.split(\",\")[0], [\":\", \"!\", \">\", \"<\"]) ? query : 'title:' + query;\r\n      queryHandler.goToAlbumList(correctedQuery);\r\n    },\r\n    plus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      const currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryPlus);\r\n      const newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    minus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      const currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryMinus);\r\n      const newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    goToAlbumList: function (query) {\r\n      let currentUrlParams = new URLSearchParams(window.location.search);\r\n      currentUrlParams.set('query', query);\r\n      props.history.push(\"Albums?\" + currentUrlParams.toString());\r\n    }\r\n  }\r\n\r\n  const menuContent = (\r\n    <>\r\n      <div className=\"logo\">\r\n        {/* <span>{props.page === \"Albums\" ? albumCount : ''}</span> */}\r\n      </div>\r\n      <QueryEditor query={querStr} onOk={(query) => queryHandler.goToAlbumList(query)} />\r\n      <Menu theme=\"dark\" defaultSelectedKeys={[selectedMenu]} defaultOpenKeys={[\"sub1\"]} mode=\"inline\">\r\n        {!IS_PUBLIC ? \r\n          <Menu.Item key=\"1\">\r\n            <Link to=\"/sc\">\r\n              <LaptopOutlined />\r\n              <span>Self Comp</span>\r\n            </Link>\r\n          </Menu.Item>\r\n        : ''}\r\n        <Menu.Item key=\"2\">\r\n          <Link to=\"/albums\">\r\n            <DesktopOutlined />\r\n            <span>Albums</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"3\">\r\n          <Link to=\"/artists\">\r\n            <TeamOutlined />\r\n            <span>Artists</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"4\">\r\n          <Link to=\"/genres\">\r\n            <PartitionOutlined />\r\n            <span>Genres</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <SubMenu key=\"sub1\" title={<><TagsOutlined /><span>Tags</span></>} >\r\n          <TagMenuContainer onPlus={queryHandler.plus} onMinus={queryHandler.minus} querStr={querStr} />\r\n        </SubMenu>\r\n        <Menu.Item key=\"5\">\r\n          <Link to=\"/setting\">\r\n            <SettingOutlined />\r\n            <span>Setting</span>\r\n          </Link>\r\n        </Menu.Item>\r\n      </Menu>\r\n    </>\r\n  );\r\n\r\n  const getButtonDisplay = (att, tier) => {\r\n    const isTierMatch = tier === tierFilter;\r\n    if (att === \"type\") {\r\n      return isTierMatch ? \"primary\" : \"link\";\r\n    }\r\n    else {\r\n      return isTierMatch;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <SWRConfig value={{ revalidateOnFocus: false, fetcher: (uri) => fetch(uri).then(res => res.json()) }}>\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <MobileOnly>\r\n          <Layout className=\"mobile-header\">\r\n            <Row>\r\n              <Col span={6} className=\"headerbutton-container\">\r\n                <Button onClick={() => handleSetTierFilter(1)} type={getButtonDisplay(\"type\", 1)} ghost={getButtonDisplay(\"ghost\", 1)} style={{ width: \"100%\" }}>Tier 1</Button>\r\n              </Col>\r\n              <Col span={6} className=\"headerbutton-container\">\r\n                <Button onClick={() => handleSetTierFilter(2)} type={getButtonDisplay(\"type\", 2)} ghost={getButtonDisplay(\"ghost\", 2)} style={{ width: \"100%\" }}>Tier 2</Button>\r\n              </Col>\r\n              <Col span={6} className=\"headerbutton-container\">\r\n                <Button onClick={() => handleSetTierFilter(3)} type={getButtonDisplay(\"type\", 3)} ghost={getButtonDisplay(\"ghost\", 3)} style={{ width: \"100%\" }}>Tier 3</Button>\r\n              </Col>\r\n              <Col span={6} className=\"hamburger-container\" onClick={() => setShowDrawer(true)}>\r\n                <MenuOutlined className=\"hamburger\" />\r\n              </Col>\r\n            </Row>\r\n          </Layout>\r\n          <Drawer\r\n            placement=\"right\"\r\n            closable={false}\r\n            onClose={() => setShowDrawer(false)}\r\n            visible={showDrawer}\r\n          >\r\n            {menuContent}\r\n          </Drawer>\r\n        </MobileOnly>\r\n        <DesktopOnly>\r\n          <Sider collapsible collapsed={collapseSider} onCollapse={(event) => setCollapseSider(event)}>\r\n            {menuContent}\r\n          </Sider>\r\n        </DesktopOnly>\r\n\r\n        <Layout className=\"site-layout\">\r\n          <Content>\r\n            <MobileOnly>\r\n              <div style={{ paddingTop: \"5x\" }}>Padding for mobile</div>\r\n            </MobileOnly>\r\n            <div className=\"site-layout-background\" style={{ paddingTop: 25, paddingLeft: 10, paddingRight: 10, minHeight: 360 }}>\r\n              {page}\r\n            </div>\r\n          </Content>\r\n          <Footer style={{ textAlign: 'center' }}>-----------------</Footer>\r\n        </Layout>\r\n      </Layout>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(AppMasterPage));\r\n\r\nfunction TagMenuContainer(props) {\r\n  const { data: tags, error } = useSWR(_uri.GetTagVMs());\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!tags) { return <div>loading...</div>; }\r\n\r\n  return (\r\n    <>\r\n      {tags.map((tag, index) => (<TagMenuItem key={tag.name} tag={tag} onPlus={props.onPlus} onMinus={props.onMinus} selectStatus={getSelectStatus(tag.name, props.querStr)} />))}\r\n    </>\r\n  );\r\n\r\n  function getSelectStatus(tagName, query) {\r\n    const queryArr = query.split(',');\r\n    const result = queryArr.filter((str) => str.toLowerCase().includes(\"tag:\" + tagName.toLowerCase())).length > 0 ? \"plus\" :\r\n      queryArr.filter((str) => str.toLowerCase().includes(\"tag!\" + tagName.toLowerCase())).length > 0 ? \"minus\" :\r\n        \"none\";\r\n\r\n    return result;\r\n  }\r\n}\r\n\r\nfunction TagMenuItem(props) {\r\n  const encodedQuery = encodeURIComponent(props.tag.query);\r\n  const plusBackground = props.selectStatus === \"plus\" ? \"#1890ff\" : \"\";\r\n  const minusBackground = props.selectStatus === \"minus\" ? \"#1890ff\" : \"\";\r\n\r\n  return (\r\n    <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\", height:\"28px\", marginTop:\"0px\", marginBottom:\"0px\" }}>\r\n      <Row>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onPlus(props.tag.name)}><PlusOutlined style={{ marginRight: \"0px\", backgroundColor: plusBackground }} /></Col>\r\n        <Link to={\"/albums?query=\" + encodedQuery} >\r\n          <Col span={14}>\r\n            <span style={{ fontSize: \"12px\" }}>{props.tag.name}</span>\r\n          </Col>\r\n        </Link>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onMinus(props.tag.name)}><MinusOutlined style={{ marginRight: \"0px\", backgroundColor: minusBackground }} /></Col>\r\n      </Row>\r\n    </li>\r\n  );\r\n}\r\n\r\nfunction QueryEditor(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(props.query);\r\n  }, [props.query]);\r\n\r\n  function handleOk() {\r\n    setVisible(false);\r\n    props.onOk(query);\r\n  }\r\n\r\n  return (\r\n    <div style={{ paddingLeft: \"24px\" }}>\r\n      <Button type=\"link\" onClick={() => setVisible(true)} style={{ width: \"90%\", textAlign: \"left\", padding: \"0px\" }}>\r\n        <ConsoleSqlOutlined />Query Editor\r\n      </Button>\r\n      <Modal\r\n        visible={visible}\r\n        onCancel={() => setVisible(false)}\r\n        closable={false}\r\n        footer={\r\n          <Button type=\"primary\" onClick={handleOk}>\r\n            <SearchOutlined />Search\r\n          </Button>\r\n        }\r\n      >\r\n        <TextArea\r\n          onChange={(event) => setQuery(event.target.value)}\r\n          value={query}\r\n        //autoSize={{ minRows: 2, maxRows: 5 }} //Enabling this will cause react warning\r\n        />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport { HashRouter, Route, Switch, Redirect } from 'react-router-dom';\r\n\r\nimport 'antd/dist/antd.css';\r\n\r\nimport './App.scss';\r\nimport AppMasterPage from './AppMasterPage';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route exact path=\"/\" ><Redirect to=\"/genres\" /></Route>\r\n          <Route exact path=\"/sc\" ><AppMasterPage page=\"Sc\" /></Route>\r\n          <Route exact path=\"/albums\" ><AppMasterPage page=\"Albums\" /></Route>\r\n          {/* <Route exact path=\"/add\" ><AppMasterPage page=\"AlbumAddEdit\" /></Route> */}\r\n          <Route exact path=\"/artists\" ><AppMasterPage page=\"Artists\" /></Route>\r\n          <Route exact path=\"/genres\" ><AppMasterPage page=\"Genres\" /></Route>\r\n          <Route exact path=\"/filemanagement\" ><AppMasterPage page=\"FileManagement\" /></Route>\r\n          <Route exact path=\"/setting\" ><AppMasterPage page=\"Setting\" /></Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { setChonkyDefaults } from 'chonky';\r\nimport { ChonkyIconFA } from 'chonky-icon-fontawesome';\r\n\r\nconst startApp = () => {\r\n  setChonkyDefaults({ iconComponent: ChonkyIconFA });\r\n  ReactDOM.render(<App />, document.getElementById('root'));\r\n  serviceWorker.unregister();\r\n}\r\n\r\nif (window.cordova) {\r\n  document.addEventListener('deviceready', startApp, false);\r\n}\r\nelse {\r\n  startApp();\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA","module.exports = __webpack_public_path__ + \"static/media/loading.d47e58c7.gif\";"],"sourceRoot":""}