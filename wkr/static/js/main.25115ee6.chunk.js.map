{"version":3,"sources":["Albums/EditModalTrigger.js","_shared/HOCs/withMyAlert.js","_utils/Helper.js","_utils/Config.js","_utils/UriHelper.js","_shared/Displays/MyAlbumCard.js","_shared/Modals/TextDialog.js","_shared/Modals/DirNodeDialog.js","_shared/ReaderModal/ReaderModalContextMenu.js","_shared/Editors/MyInputStar.js","_shared/HOCs/withPageManager.js","_shared/ReaderModal/ReaderModalChapterDrawer.js","_shared/ReaderModal/ReaderModal.js","SelfComps/SelfComps.js","_shared/Editors/MyInputTextbox.js","_shared/Editors/MyInputRadio.js","_shared/Editors/MyInputMulticheck.js","Albums/EditModal.js","_utils/Display.js","Albums/Albums.js","Genres/Genres.js","FileManagement/FileManagement.js","Setting/Setting.js","AppMasterPage.js","App.js","serviceWorker.js","index.js","_resources/loading.gif"],"names":["EditModalTrigger","props","useEffect","onVisible","withMyAlert","OriginalComponent","popInfo","title","stringContent","objContent","Modal","info","content","JSON","stringify","onOk","width","popError","error","popApiError","response","undefined","status","statusText","data","warning","toString","firstLetterLowerCase","string","charAt","toLowerCase","slice","getPercent100","value","maxValue","fraction","clamp","number","min","max","Math","pathJoin","parts","sep","validParts","filter","e","separator","replace","RegExp","join","formatDate","date","Date","toLocaleString","publicMediaUrl_","apiBaseUrl","mediaBaseUrl","resMediaBaseUrl","main","sc","media","resMedia","withBase","type","endpoint","GetAlbumCardModels","page","row","query","cleanQuery","encodeURIComponent","GetLibraryDirNodes","UpdateAlbumOuterValue","RefreshAlbum","path","cleanPath","GetAlbumPageInfos","includeDetail","RescanDatabase","StreamPage","libRelPath","cleanType","cleanLibRelPath","toISOString","StreamResizedImage","maxSize","cleanLibrelPath","ColorFromIndex","tier","rgb","r","g","b","alpha","BorderFromIndex","BorderRightFromIndex","FlagIcon","flagStyle","height","marginRight","marginBottom","language","GB","style","JP","CN","ID","handler","view","onView","albumCm","edit","onEdit","useInView","threshold","rootMargin","ref","inView","menu","paddingBottom","position","textAlign","overlay","trigger","disabled","showContextMenu","display","maxWidth","borderLeft","isRead","onClick","objectFit","src","_uri","coverInfo","uncPathEncoded","alt","isWip","left","top","lineHeight","border","borderRadius","borderRight","borderBottom","right","bottom","color","languages","map","item","i","key","backgroundColor","borderTop","lastPageIndex","Helper","pageCount","note","className","fontSize","fullTitle","TextDialog","useState","setValue","initialValue","visible","footer","centered","closable","onCancel","onClose","TextArea","onChange","event","target","rows","btnText","axios","require","default","TreeNode","Tree","DirectoryTree","nodes","setNodes","selected","setSelected","get","then","catch","treeHandlers","loadData","treeNode","Promise","resolve","childs","dataRef","name","prev","select","MyDirTree","onLoadData","onSelect","keys","renderTreeNodes","ReaderModalContextMenu","jumpValue","setJumpValue","changeJumpValue","val","showRenameModal","setShowRenameModal","showDirNodeModal","setShowDirNodeModal","tierDisplay","setTierDisplay","span","count","onTierChange","onRecount","FileSyncOutlined","marginTop","padding","WebkitBoxSizing","onJump","ArrowRightOutlined","onUndoJump","ArrowLeftOutlined","EditOutlined","SwapOutlined","onDelete","DeleteOutlined","pageName","onRename","onMove","MyInputStar","colSpan","label","control","gutter","confirm","deletePage","delObj","onSuccess","onError","alRelPath","icon","ExclamationCircleOutlined","okText","okType","cancelText","delete","cleanAPath","albumPath","movePage","movObj","post","message","FileComparison","file1","srcInfo","file2","dstInfo","overwrite","f1","f2","class","getStyle","size","toFixed","createdDate","moment","format","a","fontWeight","withPageManager","chapters","setChapters","console","log","dst","updateIndex","findIndex","onChapterRenameSuccess","renameModal","setRenameModal","updateChapterTier","param","chapterName","chapterTitle","cleanCName","onChapterDeleteSuccess","c","placement","chapter","index","Item","onJumpToPage","pageIndex","maxHeight","pageUncPath","paddingLeft","getOverlayStyle","isGrey","button","boxSizing","getGuideLabel","text","margin","textShadow","PageDisplay","styleByRotation","isLandscape","transform","styleShow","styleHide","extension","IsVideo","pageInfo","autoPlay","loop","id","queue","loadingImg","lpi","pages","indexes","cPageI","pPageI","triad","zenpenIndex","chuhenIndex","kouhenIndex","restartPageTrigger","apm","setApm","refreshPages","restartPage","orientation","fileInfos","length","targetPage","pageHandler","jumpTo","document","addEventListener","handleKeyDown2","removeEventListener","keyCode","close","renameObj","maxIndex","newPPageI","newCPageI","_helper","compose","newTriad","pageCeil","modifier","pagesLen","modifiedPages","newPageInfo","rename","newVal","oldVal","srcAlRelPath","currentPageInfo","dstAlRelPath","arr","split","pop","push","oldPageIdx","oldPage","splice","renamedPage","sort","localeCompare","move","newDir","removePageFromApm","chapterDeleteSuccess","newPageCount","newIndexes","clampIndexes","chapterRenameSuccess","changeDetailVisibility","createDate","albumHandler","tierChange","put","recount","setShowContextMenu","showDrawer","setShowDrawer","buttonHandler","rightTop","rightMid","rightBot","midTop","midMid","midBot","leftTop","leftMid","leftBot","swipeHandler","useSwipeable","onSwipedUp","eventData","onSwipedDown","onSwipedLeft","onSwipedRight","showGuide","overlayStyle","buttonStyle","side","minHeight","window","innerHeight","mid","zenpenPage","DEBUGPageTriad","chuhenPage","kouhenPage","onOpenEditModal","isOpen","zIndex","bytes","decimals","k","dm","sizes","floor","parseFloat","pow","updateDate","withRouter","scrollTo","albumCms","setAlbumCms","selectedAlbumCm","setSelectedAlbumCm","readerModalIsOpen","setReaderModalIsOpen","handleRefresh","reject","queryParts","readerHandler","history","aIndex","crudHandler","pageDeleteSuccess","onRefresh","lg","md","xs","onPageDeleteSuccess","MyInputTextbox","handleChange","colSize","input","showClearButton","sm","placeholder","autoSize","minRows","maxRows","marginLeft","MyInputRadio","Group","items","MyInputMulticheck","includes","ghost","lodash","useSWR","albumInfo","aiError","album","category","artists","tags","flags","cover","entryDate","albumVm","setAlbumVm","handlers","albumVmChange","newAlbumVm","cleanedValue","pull","ok","cancel","editFiles","onEditFiles","refresh","temp","tabIndex","role","aria-labelledby","stopPropagation","aria-label","viewBox","focusable","data-icon","fill","aria-hidden","d","categories","orientations","checked","DesktopOnly","children","useMediaQuery","minWidth","MobileOnly","IsMobile","innerWidth","documentElement","clientWidth","body","maxPage","setMaxPage","itemPerRow","filteredAlbumCms","setFilteredAlbumCms","acmsPaged","selectedTiers","overflow","editModalIsOpen","setEditModalIsOpen","editedAlbumPath","setEditedAlbumId","editHandler","editedAlbumVm","newAlbumCms","editedAlbumVmIndex","bc","as","entry","isIntersecting","Genres","uri","albumCGroups","acg","chonkyFileActions","defineFileAction","requiresSelection","toolbar","contextMenu","ChonkyIconName","code","trash","folder","ChonkyActions","EnableGridView","EnableListView","UploadFiles","CreateFolder","action","createFolder","setTextDialog","setViewModel","viewModel","subDir","fsNodes","unshift","nodeType","openFolder","payload","targetFile","isDir","targetSubDir","newDirChains","dirChains","rootChain","prevViewModel","cModel","state","selectedFiles","find","dir","newFsNodes","n","forEach","prevState","afterAction","dragNDrop","draggedFile","destination","fileName","srcObj","splitMoveModel","dstObj","srcFsNode","lv1Idx","lv2Idx","modifiedSrcFsNode","targetParentIdx","compare","nameA","nameB","defaultTextDialog","textDialog","chonkyModels","setChonkyModels","newModels","thumbnailUrl","childrenCount","selectable","draggable","dndBackend","TouchBackend","HTML5Backend","DndProvider","backend","darkMode","files","folderChain","fileActions","disableDragAndDropProvider","disableDefaultFileActions","onFileAction","EndDragNDrop","OpenFiles","OpenParentFolder","ROOT_CSS","css","setDefaultButton","isLoading","percent","eventMsgs","execute","btnName","setButton","progress","sse","EventSource","onmessage","res","resData","parse","currentStep","maxStep","isError","reload","fullScan","checkApiUrl","checkMediaUrl","checkResMediaUrl","SettingForm","ActionButton","setApiBaseUrl","setMediaBaseUrl","setResMediaBaseUrl","RowBase","col0","SettingFormLabel","col1","Search","onSearch","enterButton","url","localStorage","setItem","paddingTop","float","flexDirection","loading","block","flex","justifyContent","strokeLinecap","hidden","paddingRight","Layout","Header","Content","Footer","Sider","SubMenu","Menu","collapseSider","setCollapseSider","setSelectedTiers","storedSelectedTiers","getItem","querStr","queryString","location","search","pageStr","rowStr","pathStr","selectedMenu","queryHandler","goToAlbumList","plus","tagName","targetQueryPlus","targetQueryMinus","newQueries","newQueryString","minus","currentUrlParams","URLSearchParams","set","styleMenuItem","menuContent","QueryEditor","theme","defaultSelectedKeys","defaultOpenKeys","mode","to","DesktopOutlined","TeamOutlined","PartitionOutlined","TagsOutlined","TagMenuContainer","onPlus","onMinus","SettingOutlined","revalidateOnFocus","fetcher","fetch","json","MenuOutlined","collapsible","collapsed","onCollapse","tag","TagMenuItem","selectStatus","getSelectStatus","queryArr","str","encodedQuery","plusBackground","minusBackground","PlusOutlined","opacity","MinusOutlined","setVisible","setQuery","ConsoleSqlOutlined","SearchOutlined","App","exact","Boolean","hostname","match","startApp","setChonkyDefaults","iconComponent","ChonkyIconFA","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister","cordova","module","exports"],"mappings":"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","file":"static/js/main.25115ee6.chunk.js","sourcesContent":["import React, {useEffect} from 'react';\r\n\r\nexport default function EditModalTrigger(props) {\r\n  useEffect(() => {\r\n    props.onVisible();\r\n  },[props]);\r\n  return (<></>)\r\n}\r\n","import React from 'react';\r\nimport { Modal } from 'antd';\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  const width = 500;\r\n\r\n  function popInfo(title, stringContent, objContent) {\r\n    Modal.info({\r\n      title: (title),\r\n      content: (\r\n        <>\r\n          <span>{stringContent}</span>\r\n          <pre>{objContent ? JSON.stringify(objContent, null, 2) : \"\"}</pre>\r\n        </>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popError(title, stringContent, objContent) {\r\n    Modal.error({\r\n      title: (title),\r\n      content: (\r\n        <>\r\n          <span>{stringContent}</span>\r\n          <pre>{objContent ? JSON.stringify(objContent, null, 2) : \"\"}</pre>\r\n        </>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popApiError(error) {\r\n    if (error.response === null || error.response === undefined) {\r\n      Modal.error({\r\n        title: ('No response'),\r\n        content: (error.toString()),\r\n        onOk() { },\r\n        width: width\r\n      });\r\n      return;\r\n    }\r\n    const { status, statusText, data } = error.response;\r\n\r\n    const content = {\r\n      title: `${status} - ${statusText}`,\r\n      content: (\r\n        <span>\r\n          {JSON.stringify(data, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    };\r\n\r\n    if (status >= 400 && status < 500) {\r\n      Modal.warning(content);\r\n    }\r\n    else {\r\n      Modal.error(content);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      popInfo={popInfo}\r\n      popError={popError}\r\n      popApiError={popApiError}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;","\r\nexport function firstLetterLowerCase(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nexport function apiErrorHandler(error) {\r\n  if (typeof error.response !== undefined) {\r\n    alert(JSON.stringify(error.response, null, \"\\t\"))\r\n  }\r\n  else {\r\n    alert(JSON.stringify(error, null, \"\\t\"));\r\n  }\r\n}\r\n\r\nexport function getPercent100(value, maxValue) {\r\n  if(maxValue === 0) return 0;\r\n\r\n  let fraction = (value / maxValue) * 100;\r\n  let result = fraction <= 100 ? fraction : 100;\r\n  return result;\r\n}\r\n\r\nexport function contains(target, pattern) {\r\n  var value = 0;\r\n  pattern.forEach(function (word) {\r\n    value = value + target.includes(word);\r\n  });\r\n  return (value === 1);\r\n}\r\n\r\nexport function clamp(number, min, max) {\r\n  return Math.max(min, Math.min(number, max));\r\n}\r\n\r\nexport function clickReport(event) {\r\n  const result = {\r\n    ecy: event.clientY,\r\n    epy: event.pageY,\r\n    ety: event.touches && event.touches[0] ? event.touches[0].clientY : null,\r\n    echy: event.changedTouches && event.changedTouches[0] ? event.changedTouches[0].clientY : null\r\n  };\r\n  return result;\r\n}\r\n\r\nexport function pathJoin(parts, sep){\r\n  var validParts = parts.filter(e => { return e != null && e !== \"\" });\r\n  var separator = sep || '/';\r\n  var replace   = new RegExp(separator+'{1,}', 'g');\r\n  \r\n  return validParts.join(separator).replace(replace, separator);\r\n}\r\n\r\nexport function formatBytes(bytes, decimals = 2){\r\n  if (bytes === 0) return '0 Bytes';\r\n\r\n  const k = 1024;\r\n  const dm = decimals < 0 ? 0 : decimals;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\n\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\r\n}\r\n\r\nexport function formatDate(date){\r\n  return new Date(date).toLocaleString();\r\n}","//const API_URL = \"http://192.168.1.5:5000/\";\r\n//const API_URL = \"http://localhost:51474/\";\r\nconst API_URL = \"https://wkr.azurewebsites.net/\";\r\nconst IS_PUBLIC = true;\r\n\r\nconst STORAGE_URL = \"https://wkrstorage.file.core.windows.net/library/\";\r\n\r\nexport { API_URL, IS_PUBLIC, STORAGE_URL }","import { IS_PUBLIC } from \"./Config\";\r\n\r\nconst publicApiUrl = 'https://wkr.azurewebsites.net/';\r\nconst publicMediaUrl_ = 'https://wkrstorage.file.core.windows.net/library/[libRelPath]?sv=2020-08-04&ss=f&srt=sco&sp=r&se=2023-04-08T01:17:28Z&st=2022-04-07T17:17:28Z&spr=https&sig=%2BdlHr0HKeGENqIjaCXYA%2B1FNdPV7yKVi9ewlvaAhhG0%3D&antiCache=[antiCache]';\r\nconst privateApiUrl = 'http://192.168.1.5:5000/';\r\nconst privateMediaUrl = '[apiBaseUrl]Media/StreamPage?libRelPath=[libRelPath]&type=[type]';\r\nconst privateResMediaUrl = '[apiBaseUrl]Media/StreamResizedImage?libRelPath=[libRelPath]&maxSize=[maxSize]&type=[type]';\r\n\r\nvar apiBaseUrl = (() => {\r\n  if(IS_PUBLIC) return publicApiUrl;\r\n\r\n  const storedUrl = window.localStorage.getItem('apiBaseUrl');\r\n  if(storedUrl != null && storedUrl !== '') return storedUrl;\r\n\r\n  return privateApiUrl;\r\n})();\r\n\r\nvar mediaBaseUrl = (() => {\r\n  if(IS_PUBLIC) return publicMediaUrl_;\r\n\r\n  const storedUrl = window.localStorage.getItem('mediaBaseUrl');\r\n  if(storedUrl != null && storedUrl !== '') return storedUrl;\r\n\r\n  return privateMediaUrl;\r\n})();\r\n\r\nvar resMediaBaseUrl = (() => {\r\n  if(IS_PUBLIC) return publicMediaUrl_;\r\n\r\n  const storedUrl = window.localStorage.getItem('resMediaBaseUrl');\r\n  if(storedUrl != null && storedUrl !== '') return storedUrl;\r\n\r\n  return privateResMediaUrl;\r\n})();\r\n\r\nconst main = `${apiBaseUrl}Main/`;\r\nconst sc = `${apiBaseUrl}Sc/`;\r\nconst media = mediaBaseUrl;\r\nconst resMedia = resMediaBaseUrl;\r\n\r\n\r\nconst GetApiBaseUrl = () => {\r\n  return apiBaseUrl;\r\n}\r\nconst SaveApiBaseUrl = (url) => {\r\n  window.localStorage.setItem('apiBaseUrl', url);\r\n}\r\n\r\nconst GetMediaBaseUrl = () => {\r\n  return mediaBaseUrl;\r\n}\r\nconst SaveMediaBaseUrl = (url) => {\r\n  window.localStorage.setItem('mediaBaseUrl', url);\r\n}\r\n\r\nconst GetResMediaBaseUrl = () => {\r\n  return resMediaBaseUrl;\r\n}\r\nconst SaveResMediaBaseUrl = (url) => {\r\n  window.localStorage.setItem('resMediaBaseUrl', url);\r\n}\r\n\r\nfunction withBase(type, endpoint){\r\n  const base = type === 1 ? sc : main;\r\n  return `${base}${endpoint}`;\r\n}\r\n\r\n//#region Album Query\r\nconst GetAlbumInfo = () => {\r\n  return `${main}GetAlbumInfo`;\r\n}\r\nconst GetTagVMs = () => {\r\n  return `${main}GetTagVMs`;\r\n}\r\nconst GetGenreCardModels = () => {\r\n  return `${main}GetGenreCardModels`;\r\n}\r\nconst GetFeaturedArtistCardModels = () => {\r\n  return `${main}GetFeaturedArtistCardModels`;\r\n}\r\nconst GetAlbumVm = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumVm?path=${cleanPath}`);\r\n}\r\nconst GetAlbumCardModels = (type, page, row, query) => {\r\n  const cleanQuery = query !== undefined ? encodeURIComponent(query) : \"\";\r\n  return withBase(type, `GetAlbumCardModels?page=${page}&row=${row}&query=${cleanQuery}`);\r\n}\r\nconst GetRemovableAlbums = (type) => {\r\n  //Not implemented\r\n  return withBase(type);\r\n}\r\nconst GetLibraryDirNodes = (type) => {\r\n  return withBase(type, \"GetLibraryDirNodes\");\r\n}\r\n//#endregion\r\n\r\n//#region Album Command\r\nconst UpdateAlbum = (type) => {\r\n  return `${main}UpdateAlbum`;\r\n}\r\nconst UpdateAlbumOuterValue = (type) => {\r\n  return withBase(type, 'UpdateAlbumOuterValue');\r\n}\r\nconst UpdateAlbumTier = (type) => {\r\n  return withBase(type, 'UpdateAlbumTier');\r\n}\r\nconst RecountAlbumPages = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `RecountAlbumPages?path=${cleanPath}`);\r\n}\r\nconst RefreshAlbum = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `RefreshAlbum?path=${cleanPath}`);\r\n}\r\nconst DeleteAlbum = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `DeleteAlbum?path=${cleanPath}`);\r\n}\r\n//#endregion\r\n\r\n//#region Page Query\r\nconst GetAlbumChapters = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumChapters?path=${cleanPath}`);\r\n}\r\nconst GetAlbumPageInfos = (type, path, includeDetail) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumPageInfos?path=${cleanPath}&includeDetail=${includeDetail ?? false}`);\r\n}\r\nconst GetAlbumFsNodes = (type, path) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  return withBase(type, `GetAlbumFsNodes?path=${cleanPath}`);\r\n}\r\n//#endregion\r\n\r\n//#region Page Command\r\nconst MoveFile = (type) => {\r\n  return withBase(type, `MoveFile`);\r\n}\r\n\r\nconst DeleteFile = (type, path, alRelPath) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  const cleanAPath = encodeURIComponent(alRelPath);\r\n  return withBase(type, `DeleteFile?path=${cleanPath}&alRelPath=${cleanAPath}`)\r\n}\r\n\r\nconst DeleteAlbumChapter = (type, path, chapterName) => {\r\n  const cleanPath = encodeURIComponent(path);\r\n  const cleanCName = encodeURIComponent(chapterName);\r\n  return withBase(type, `DeleteAlbumChapter?path=${cleanPath}&chapterName=${cleanCName}`);\r\n}\r\n\r\nconst UpdateAlbumChapter = (type) => {\r\n  return withBase(type, `UpdateAlbumChapter`);\r\n}\r\n//#endregion\r\n\r\n//#region Library Command\r\nconst RescanDatabase = (type) => {\r\n  return withBase(type, `RescanDatabase`);\r\n}\r\nconst ReloadDatabase = (type) => {\r\n  return withBase(type, 'ReloadDatabase');\r\n}\r\nconst QuickScan = (type) => {\r\n  return withBase(type, 'QuickScan');\r\n}\r\n// const CleanLibrary = (type) => {\r\n//   return withBase(type, 'CleanLibrary');\r\n// }\r\nconst GetEventStream = (type) => {\r\n  return withBase(type, 'GetEventStream');\r\n}\r\n//#endregion\r\n\r\n//#region Media\r\n\r\nconst StreamPage = (libRelPath, type) => {\r\n  const cleanType = type ?? 0;\r\n  const cleanLibRelPath = encodeURIComponent(libRelPath);\r\n\r\n  return media.replace('[apiBaseUrl]',apiBaseUrl).replace('[libRelPath]',cleanLibRelPath).replace('[type]',cleanType).replace('[antiCache]', (new Date()).toISOString());\r\n}\r\n\r\nconst StreamResizedImage = (libRelPath, maxSize, type) => {\r\n  const cleanType = type ?? 0;\r\n  const cleanLibrelPath = encodeURIComponent(libRelPath);\r\n  \r\n  return resMedia.replace('[apiBaseUrl]',apiBaseUrl).replace('[libRelPath]',cleanLibrelPath).replace('[maxSize]',maxSize).replace('[type]',cleanType).replace('[antiCache]', (new Date()).toISOString());\r\n}\r\n//#endregion\r\n\r\nexport {\r\n  SaveApiBaseUrl,\r\n  SaveMediaBaseUrl,\r\n  SaveResMediaBaseUrl,\r\n  GetApiBaseUrl,\r\n  GetMediaBaseUrl,\r\n  GetResMediaBaseUrl,\r\n\r\n  GetAlbumInfo,\r\n  GetTagVMs,\r\n\r\n  GetAlbumVm,\r\n  GetAlbumCardModels,\r\n  GetGenreCardModels,\r\n  GetFeaturedArtistCardModels,\r\n  GetRemovableAlbums,\r\n  GetLibraryDirNodes,\r\n\r\n  UpdateAlbum,\r\n  UpdateAlbumOuterValue,\r\n  UpdateAlbumTier,\r\n  RecountAlbumPages,\r\n  RefreshAlbum,\r\n  DeleteAlbum,\r\n\r\n  GetAlbumChapters,\r\n  GetAlbumPageInfos,\r\n  GetAlbumFsNodes,\r\n\r\n  MoveFile,\r\n  DeleteFile,\r\n  DeleteAlbumChapter,\r\n  UpdateAlbumChapter,\r\n\r\n  RescanDatabase,\r\n  ReloadDatabase,\r\n  QuickScan,\r\n  //CleanLibrary,\r\n  GetEventStream,\r\n\r\n  StreamPage, \r\n  StreamResizedImage \r\n};","import React, { useState, useEffect, useCallback } from 'react';\r\n\r\nimport { Dropdown, Icon } from 'antd';\r\nimport { useInView } from 'react-intersection-observer';\r\nimport Flags from 'country-flag-icons/react/3x2';\r\nimport EditModalTrigger from '../../Albums/EditModalTrigger';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport * as Helper from '../../_utils/Helper';\r\nimport * as _uri from '../../_utils/UriHelper';\r\n\r\nfunction MyAlbumCard(props) {\r\n  const handler = {\r\n    view: function () {\r\n      props.onView(props.albumCm)\r\n    },\r\n\r\n    edit: function () {\r\n      if(props.onEdit) props.onEdit(props.albumCm.path);\r\n    },\r\n  }\r\n\r\n  const [ref, inView, entry] = useInView({\r\n    threshold: 0,\r\n    rootMargin: \"300px 0px 300px 0px\"\r\n  });\r\n\r\n  const absoluteH = \"150px\";\r\n\r\n  const menu = <EditModalTrigger onVisible={handler.edit}></EditModalTrigger>;\r\n  return (\r\n    <div ref={ref} style={{ paddingBottom: '8px', position: \"relative\", textAlign: \"center\" }}>\r\n      <div style={{ height: absoluteH, width: \"100%\" }} >\r\n        <Dropdown overlay={menu} trigger={['contextMenu']} disabled={!props.showContextMenu}>\r\n        <div style={{\r\n            display: \"inline-block\", position: \"relative\",\r\n            height: absoluteH, width: \"100%\", maxWidth: absoluteH,\r\n            borderLeft: !props.albumCm.isRead ? \"1px solid #ddbe14\" : \"\",\r\n          }}\r\n          onClick={handler.view}\r\n        >\r\n          {inView ? \r\n            <img\r\n              style={{\r\n                objectFit: \"contain\",\r\n                height: \"100%\", width: \"100%\"\r\n              }}\r\n              src={_uri.StreamResizedImage(props.albumCm.coverInfo.uncPathEncoded, 150, props.type)}\r\n              alt=\"img\"\r\n            /> : null\r\n          }\r\n\r\n          {props.albumCm.isWip ?\r\n            <div style={{\r\n              position: \"absolute\",\r\n              height: 0,\r\n              width: 0,\r\n              left: \"0px\",\r\n              top: \"0px\",\r\n              lineHeight: 0\r\n            }}>\r\n              <Icon \r\n                type=\"pause-circle\"\r\n                style={{border:\"1px solid rgba(108, 108, 108, 0.8)\", borderRadius:\"50%\"}}\r\n              />\r\n            </div> : \"\"\r\n          }\r\n\r\n          {!props.albumCm.isRead ?\r\n            <div style={{\r\n              position: \"absolute\",\r\n              height: 0,\r\n              width: 0,\r\n              left: \"0px\",\r\n              top: \"0px\",\r\n              borderLeft: \"15px solid #ddbe14\",\r\n              borderRight: \"15px solid transparent\",\r\n              borderBottom: \"15px solid transparent\"\r\n            }} /> : \"\"\r\n          }\r\n\r\n          <div style={{\r\n            position: \"absolute\",\r\n            right: \"3px\",\r\n            bottom: \"3px\",\r\n            color: \"white\",\r\n            lineHeight: \"0px\"\r\n          }}>\r\n            {props.albumCm.languages.map((item, i) => <FlagIcon language={item} key={i} />)}\r\n          </div>\r\n          <div style={{\r\n            position: \"absolute\",\r\n            right: \"0px\",\r\n            bottom: \"0px\",\r\n            height: \"100%\",\r\n            width: \"3px\"\r\n          }}>\r\n            {[3, 2, 1].map((e, i) =>\r\n              <div key={`tierBar-${i}`}\r\n                style={{\r\n                  width: \"100%\",\r\n                  height: \"33%\",\r\n                  backgroundColor: ColorFromIndex(props.albumCm.tier, e),\r\n                  borderTop: BorderFromIndex(props.albumCm.tier, e),\r\n                  borderRight: BorderRightFromIndex(props.albumCm.tier, e)\r\n                }} />\r\n            )}\r\n          </div>\r\n          <div style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            bottom: \"0px\",\r\n            width: \"100%\",\r\n            height: \"3px\",\r\n            backgroundColor: \"white\",\r\n            display: props.albumCm.lastPageIndex > 0 ? \"block\" : \"none\"\r\n          }}>\r\n            <div style={{\r\n              backgroundColor: \"DodgerBlue\",\r\n              height: \"100%\",\r\n              width: `${Helper.getPercent100(props.albumCm.lastPageIndex + 1, props.albumCm.pageCount)}%`\r\n            }} />\r\n          </div>\r\n          {props.albumCm.note !== null && props.albumCm.note !== \"\" ?\r\n            <div className=\"album-flag\">\r\n              {props.albumCm.note}\r\n            </div> : \"\"\r\n          }\r\n          <div>\r\n          </div>\r\n        </div>\r\n        </Dropdown>\r\n      </div>\r\n      <span style={{ fontSize: '12px', lineHeight: 1.1, color:\"rgba(255,255,255, 0.8)\" }}>\r\n        {props.albumCm.fullTitle}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ColorFromIndex(tier, e) {\r\n  const top = { r: 34, g: 193, b: 195 };\r\n  const mid = { r: 142, g: 190, b: 121 };\r\n  const bot = { r: 253, g: 187, b: 45 };\r\n\r\n  const rgb = e === 3 ? top : e === 2 ? mid : bot;\r\n  const alpha = tier >= e ? 1 : 0;\r\n\r\n  return `rgba(${rgb.r},${rgb.g},${rgb.b},${alpha})`;\r\n}\r\n\r\nfunction BorderFromIndex(tier, e) {\r\n  return tier > e && (e === 1 || e === 2) ? \"2px solid black\" : \"0px\";\r\n}\r\n\r\nfunction BorderRightFromIndex(tier, e){\r\n  return tier >= e ? \"1px solid black\" : \"0px\";\r\n}\r\n\r\nfunction FlagIcon(props) {\r\n  const flagStyle = { width: \"18px\", height: \"12px\", marginRight: \"2px\", marginBottom: \"2px\" };\r\n\r\n  return (\r\n    <>\r\n      {\r\n        props.language === \"English\" ? <Flags.GB style={flagStyle} /> :\r\n          props.language === \"Japanese\" ? <Flags.JP style={flagStyle} /> :\r\n            props.language === \"Chinese\" ? <Flags.CN style={flagStyle} /> :\r\n              <Flags.ID style={flagStyle} />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyAlbumCard);","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Input } from 'antd';\r\n\r\nfunction TextDialog(props) {\r\n  const [value, setValue] = useState(\"\");\r\n  useEffect(() => { setValue(props.initialValue) }, [props.initialValue]);\r\n\r\n  return (\r\n    <Modal\r\n      visible={props.visible}\r\n      footer={null}\r\n      centered={true}\r\n      closable={false}\r\n      onCancel={() => props.onClose()}\r\n      style={{ maxWidth: 300, textAlign: \"center\" }}\r\n      //bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n    >\r\n      <Input.TextArea value={value} onChange={(event) => setValue(event.target.value)} rows={2} />\r\n      <Button\r\n        style={{ width: \"100%\" }} type=\"primary\"\r\n        onClick={() => { props.onOk(value, props.initialValue); props.onClose(); }}\r\n      >\r\n        {props.btnText ?? 'Rename'}\r\n      </Button>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default TextDialog;","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Input, Tree } from 'antd';\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport * as _uri from '../../_utils/UriHelper';\r\nconst axios = require('axios').default;\r\n\r\nconst { TreeNode, DirectoryTree } = Tree;\r\n\r\nfunction DirNodeDialog(props) {\r\n  const [nodes, setNodes] = useState([]);\r\n  const [selected, setSelected] = useState(null);\r\n\r\n  useEffect(() => {\r\n    axios.get(_uri.GetLibraryDirNodes(1))\r\n        .then((response) => {\r\n          setNodes(response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n  },[]);\r\n\r\n  const treeHandlers = {\r\n    loadData: (treeNode) =>{\r\n      const result = new Promise(resolve => {\r\n        if (treeNode.props.childs) {\r\n          resolve();\r\n          return;\r\n        }\r\n        axios.get(`${_uri.GetLibraryDirNodes(1)}?path=${treeNode.props.dataRef.name}`)\r\n          .then((response) => {\r\n            treeNode.props.dataRef.childs = response.data;\r\n  \r\n            setNodes((prev) => {\r\n              return ([\r\n                ...prev\r\n              ]);\r\n            });\r\n            resolve();\r\n          })\r\n          .catch((error) => {\r\n            props.popApiError(error);\r\n          });\r\n      });\r\n  \r\n      return result;\r\n    },\r\n    select: (key) => {\r\n      setSelected(key);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      visible={props.visible}\r\n      footer={null}\r\n      centered={true}\r\n      closable={false}\r\n      onCancel={() => props.onClose()}\r\n      style={{ width: 400, maxWidth: \"95vh\" }}\r\n      //bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n    >\r\n      <MyDirTree \r\n        nodes={nodes} \r\n        onLoadData={treeHandlers.loadData}\r\n        onSelect={treeHandlers.select}\r\n      />\r\n      <Button\r\n        style={{ width: \"100%\" }} type=\"primary\"\r\n        onClick={() => { props.onOk(selected); props.onClose(); }}\r\n      >\r\n        Move Here\r\n      </Button>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(DirNodeDialog);\r\n\r\nfunction MyDirTree(props){\r\n  const renderTreeNodes = (data) => {\r\n    var result = data.map(item => {\r\n      if (item.childs) {\r\n        return (\r\n          <TreeNode title={item.name} key={item.name} dataRef={item}>\r\n            {renderTreeNodes(item.childs)}\r\n          </TreeNode>\r\n        );\r\n      }\r\n      return <TreeNode title={item.name} key={item.name} dataRef={item} />;\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\n  return (\r\n    <DirectoryTree \r\n      loadData={props.onLoadData} \r\n      onSelect={(keys) => props.onSelect(keys[0])}\r\n    >\r\n      {renderTreeNodes(props.nodes)}\r\n    </DirectoryTree>\r\n  );\r\n}","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Modal, Button, Rate } from 'antd';\r\nimport { ArrowLeftOutlined, ArrowRightOutlined, DeleteOutlined, EditOutlined, FileSyncOutlined, SwapOutlined } from '@ant-design/icons';\r\n\r\nimport TextDialog from '../Modals/TextDialog';\r\nimport DirNodeDialog from '../Modals/DirNodeDialog';\r\n\r\nfunction ReaderModalContextMenu(props) {\r\n  const [jumpValue, setJumpValue] = useState(0);\r\n  useEffect(() => {\r\n    setJumpValue(props.initialValue + 1);\r\n  }, [props.initialValue]);\r\n\r\n  const changeJumpValue = (val) => {\r\n    setJumpValue(Math.min(Math.max(val, 1), props.albumCm.pageCount));\r\n  };\r\n\r\n  const [showRenameModal, setShowRenameModal] = useState(false);\r\n  const [showDirNodeModal, setShowDirNodeModal] = useState(false);\r\n  //const [showConfirmDelete, setShowConfirmDelete] = useState(false);\r\n\r\n  const [tierDisplay, setTierDisplay] = useState(0);\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    setTierDisplay(props.albumCm.tier);\r\n  }, [props.albumCm]);\r\n\r\n  if (props.albumCm === undefined) { return (<></>); }\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={props.visible}\r\n        onCancel={props.onCancel}\r\n        footer={null}\r\n        closable={false}\r\n        centered={true}\r\n        style={{ maxWidth: 300 }}\r\n      //bodyStyle={{ border: \"1px solid black\" }}\r\n      >\r\n        <Row>\r\n          {props.type !== 1 ? \r\n            <Col span={24} style={{ marginBottom: 15, textAlign: \"center\" }}>\r\n              <Rate\r\n                count={3}\r\n                value={tierDisplay}\r\n                onChange={(value) => { setTierDisplay(value); props.onTierChange(value); }}\r\n                style={{ fontSize: \"40px\" }}\r\n              />\r\n            </Col>\r\n          : \"\" }\r\n          <Col span={24}>\r\n            <Button type=\"primary\" onClick={() => props.onRecount()} style={{ width: \"100%\" }}>\r\n              <FileSyncOutlined />Recount Pages\r\n            </Button>\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <input type=\"number\" value={jumpValue} onChange={(e) => changeJumpValue(e.target.value)} style={{ width: \"97%\", padding: \"4px\", WebkitBoxSizing: \"border-box\", borderRadius: \"5px\", color: \"black\" }} />\r\n          </Col>\r\n          <Col span={6} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <Button type=\"ghost\" style={{ width: \"97%\", color: \"white\" }}\r\n              onClick={() => changeJumpValue(jumpValue - 1)}\r\n            >-</Button>\r\n          </Col>\r\n          <Col span={6} style={{ textAlign: \"right\", marginTop: 5 }}>\r\n            <Button type=\"ghost\" style={{ width: \"97%\", color: \"white\" }}\r\n              onClick={() => changeJumpValue(jumpValue + 1)}\r\n            >+</Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onJump(jumpValue - 1)} style={{ width: \"100%\" }}>\r\n              <ArrowRightOutlined />Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onUndoJump()} style={{ width: \"100%\" }}>\r\n              <ArrowLeftOutlined />Undo Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => { props.onCancel(); setShowRenameModal(true); }} style={{ width: \"100%\" }}>\r\n              <EditOutlined />Rename Page\r\n            </Button>\r\n          </Col>\r\n          {props.type === 1 ? \r\n            <Col span={24} style={{ marginTop: 5 }}>\r\n              <Button type=\"primary\" onClick={() => { props.onCancel(); setShowDirNodeModal(true); }} style={{ width: \"100%\" }}>\r\n                <SwapOutlined />Move Page\r\n              </Button>\r\n            </Col>\r\n          : \"\"}\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"danger\" onClick={() => { props.onCancel(); props.onDelete(); }} style={{ width: \"100%\" }}>\r\n              <DeleteOutlined />Delete Page\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Modal>\r\n      <TextDialog\r\n        visible={showRenameModal} onClose={() => setShowRenameModal(false)}\r\n        initialValue={props.pageName}\r\n        onOk={props.onRename}\r\n      />\r\n      {props.type === 1 ? \r\n        <DirNodeDialog \r\n          visible={showDirNodeModal} \r\n          onClose={() => setShowDirNodeModal(false)}\r\n          onOk={props.onMove}\r\n        />\r\n      :\"\"}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ReaderModalContextMenu;","import React from 'react';\r\nimport { Rate } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputStar(props) {\r\n  const colSpan = props.colSpan ?? { label: 6, control: 18 };\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={colSpan.label}>\r\n          <label className='my-editor-label'>{props.label}</label>\r\n        </Col>\r\n        <Col span={colSpan.control}>\r\n          <Rate\r\n            count={3}\r\n            value={props.value}\r\n            onChange={(value) => { props.onChange(props.label, value); } }\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputStar;","import React from 'react';\r\nimport { Modal } from 'antd';\r\nimport * as _uri from '../../_utils/UriHelper';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport moment from 'moment';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  function deletePage(delObj, onSuccess, onError){\r\n    confirm({\r\n      title: `Delete ${delObj.alRelPath}?`,\r\n      icon: <ExclamationCircleOutlined />,\r\n      okText: '   YES   ',\r\n      okType: 'danger',\r\n      cancelText: '   NO   ',\r\n      onOk() {\r\n        axios.delete(_uri.DeleteFile(props.type, delObj.albumPath, delObj.alRelPath))\r\n          .then(function (response) {\r\n            onSuccess(response);\r\n          })\r\n          .catch(function (error) {\r\n            onError(error);\r\n          });\r\n      },\r\n      onCancel() {\r\n      },\r\n    });\r\n  }\r\n\r\n  function movePage(movObj, onSuccess, onError){\r\n    axios.post(_uri.MoveFile(props.type), movObj)\r\n      .then((response) =>{\r\n        if (response.data.message === \"Destination file already exist\") {\r\n          confirm({\r\n            title: `Overwrite?`,\r\n            icon: <ExclamationCircleOutlined />,\r\n            content: <FileComparison file1={response.data.srcInfo} file2={response.data.dstInfo} />,\r\n            okText: '   YES   ',\r\n            okType: 'danger',\r\n            cancelText: '   NO   ',\r\n            onOk() {\r\n              const newMovObj = {\r\n                ...movObj,\r\n                overwrite: true\r\n              }\r\n\r\n              movePage(newMovObj, onSuccess);\r\n            },\r\n            onCancel() {\r\n            },\r\n          });\r\n        }\r\n        else{\r\n          onSuccess(response);\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        onError(error);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      deletePage={deletePage}\r\n      movePage={movePage}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;\r\n\r\nfunction FileComparison(props) {\r\n  const f1 = props.file1;\r\n  const f2 = props.file2;\r\n\r\n  return (\r\n    <table class=\"comparison-table\" style={{ width: \"100%\" }}>\r\n      <tr>\r\n        <th>Source</th>\r\n        <th>Destination</th>\r\n      </tr>\r\n      <tr>\r\n        <td>{f1.name}</td>\r\n        <td>{f2.name}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style={getStyle(f1.size, f2.size)}>{(f1.size / 1024).toFixed(2)} KB</td>\r\n        <td style={getStyle(f2.size, f1.size)}>{(f2.size / 1024).toFixed(2)} KB</td>\r\n      </tr>\r\n      <tr>\r\n        <td style={getStyle(f1.createdDate, f2.createdDate)}>{moment(f1.createdDate).format('YYYY-MM-DD hh:mm')}</td>\r\n        <td style={getStyle(f2.createdDate, f1.createdDate)}>{moment(f2.createdDate).format('YYYY-MM-DD hh:mm')}</td>\r\n      </tr>\r\n    </table>\r\n  );\r\n\r\n  function getStyle(a, b) {\r\n    const fontWeight = a > b ? \"bold\" : \"normal\";\r\n    return {\r\n      fontWeight: fontWeight\r\n    };\r\n  }\r\n}","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Drawer, Modal, Menu, Dropdown } from 'antd';\r\nimport {\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport MyInputStar from '../Editors/MyInputStar';\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport withPageManager from '../HOCs/withPageManager';\r\nimport TextDialog from '../Modals/TextDialog';\r\nimport * as _uri from '../../_utils/UriHelper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction ReaderModalChapterDrawer(props) {\r\n  const [chapters, setChapters] = useState([]);\r\n  const [renameModal, setRenameModal] = useState({\r\n    visible: false,\r\n    initialValue: '',\r\n    onOk: (value, initialValue) => {\r\n      console.log('rename ok', value, initialValue);\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: props.albumPath,\r\n          alRelPath: initialValue\r\n        },\r\n        dst: {\r\n          albumPath: props.albumPath,\r\n          alRelPath: value\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          setChapters((prev) => {\r\n            const updateIndex = prev.findIndex(a => a.title === movObj.src.alRelPath);\r\n            prev[updateIndex].title = movObj.dst.alRelPath;\r\n\r\n            return ([\r\n              ...prev\r\n            ]);\r\n          });\r\n\r\n          props.onChapterRenameSuccess();\r\n        },(error) => {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  });\r\n\r\n  const updateChapterTier = (param) => {\r\n    axios.post(_uri.UpdateAlbumChapter(props.type), param)\r\n        .then(function (response) {\r\n          setChapters((prev) => {\r\n            const updateIndex = prev.findIndex(a => a.title === param.chapterName);\r\n            \r\n            prev[updateIndex].tier = param.tier;\r\n\r\n            return ([\r\n              ...prev\r\n            ]);\r\n          });\r\n\r\n          props.onChapterRenameSuccess();\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (props.albumPath === undefined) { return; }\r\n    axios.get(_uri.GetAlbumChapters(props.type, props.albumPath))\r\n      .then(function (response) {\r\n        setChapters(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n  }, [props.albumPath]);\r\n\r\n  const handler = {\r\n    rename: (chapterTitle) => {\r\n      setRenameModal(prev => {\r\n        prev.visible = true;\r\n        prev.initialValue = chapterTitle;\r\n        return{ ...prev };\r\n      });\r\n    },\r\n    delete: (chapterTitle) => {\r\n      confirm({\r\n        title: `Delete chapter ${chapterTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   Yes   ',\r\n        okType: 'danger',\r\n        cancelText: '   No   ',\r\n        onOk() {\r\n          axios.delete(_uri.DeleteAlbumChapter(props.type, props.albumPath, chapterTitle))\r\n            .then(function (response) {\r\n              console.log(\"newPageCount\", response.data);\r\n              props.onChapterDeleteSuccess(response.data);\r\n              setChapters(\r\n                chapters.filter(c => c.title !== chapterTitle)\r\n              );\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    },\r\n    tierChange:(chapterTitle, value) => {\r\n      updateChapterTier({ \r\n        albumPath:props.albumPath, \r\n        chapterName:chapterTitle, \r\n        tier:value \r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      placement=\"left\"\r\n      closable={false}\r\n      onClose={props.onClose}\r\n      visible={props.visible}\r\n    >\r\n      <div style={{ padding: \"10px\" }}>\r\n        {chapters.map((chapter, index) => (\r\n          <Row style={{ marginBottom: \"5px\" }} key={chapter.title}>\r\n            <Dropdown overlay={\r\n              <Menu>\r\n                <Menu.Item key=\"1\" onClick={() => handler.rename(chapter.title)}><EditOutlined />Rename</Menu.Item>\r\n                <Menu.Item key=\"2\" onClick={() => handler.delete(chapter.title)}><DeleteOutlined />Delete</Menu.Item>\r\n              </Menu>}\r\n              trigger={['contextMenu']}\r\n            >\r\n              <Col span={10} onClick={() => props.onJumpToPage(chapter.pageIndex)}>\r\n                <img\r\n                  style={{ objectFit: \"contain\", width: \"100%\", maxHeight: \"128px\", border: \"1px solid white\" }}\r\n                  src={_uri.StreamResizedImage(chapter.pageUncPath, 150, props.type)}\r\n                  alt=\"img\"\r\n                >\r\n                </img>\r\n              </Col>\r\n            </Dropdown>\r\n            <Col span={14}>\r\n              <Row>\r\n                <Col span={24}>\r\n                  <span style={{ color: \"white\" }}>{chapter.title}</span>\r\n                </Col>\r\n                <Col span={24} style={{ paddingLeft:'10px' }}>\r\n                  <MyInputStar  value={chapter.tier} colSpan={{ label:0, control:24 }} onChange={(label, value) => { handler.tierChange(chapter.title, value); }}  />\r\n                </Col>\r\n              </Row>\r\n            </Col>\r\n          </Row>\r\n        ))};\r\n      </div>\r\n      <TextDialog\r\n        visible={renameModal.visible} \r\n        onClose={() => setRenameModal(prev => { prev.visible = false; return {...prev}; })}\r\n        initialValue={renameModal.initialValue}\r\n        onOk={renameModal.onOk}\r\n      />\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default withPageManager(withMyAlert(ReaderModalChapterDrawer));","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Dropdown } from 'antd';\r\nimport { useSwipeable } from 'react-swipeable';\r\n\r\nimport EditModalTrigger from '../../Albums/EditModalTrigger';\r\nimport ReaderModalContextMenu from './ReaderModalContextMenu';\r\nimport ReaderModalChapterDrawer from './ReaderModalChapterDrawer';\r\nimport { IS_PUBLIC } from '../../_utils/Config';\r\nimport loadingImg from '../../_resources/loading.gif';\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport withPageManager from '../HOCs/withPageManager';\r\nimport * as _helper from '../../_utils/Helper';\r\nimport * as _uri from \"../../_utils/UriHelper\";\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction ReaderModal(props) {\r\n  const [apm, setApm] = useState({ //apm = album pagination model\r\n    path: null,\r\n    lpi: 0,\r\n    pages: [],\r\n    indexes: {\r\n      cPageI: 0,\r\n      pPageI: 0,\r\n      triad: \"zenpen\",\r\n      zenpenIndex: 0,\r\n      chuhenIndex: 0,\r\n      kouhenIndex: 0,\r\n    },\r\n    isLandscape: false,\r\n    includeDetail: false,\r\n\r\n    restartPageTrigger: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined || props.albumCm === null) { return; }\r\n    if (props.albumCm.path === apm.path) { return; }\r\n    refreshPages(false);\r\n    \r\n  }, [props.albumCm]);\r\n\r\n  const refreshPages = (restartPage) => {\r\n    axios.get(_uri.GetAlbumPageInfos(props.type, props.albumCm.path, apm.includeDetail))\r\n      .then(function (response) {\r\n        setApm({\r\n          path: props.albumCm.path,\r\n          lpi: restartPage ? 0 : props.albumCm.lastPageIndex,\r\n          isLandscape: response.data.orientation === \"Landscape\",\r\n          pages: response.data.fileInfos,\r\n          indexes: null,\r\n          includeDetail: apm.includeDetail,\r\n          restartPageTrigger: restartPage ? !apm.restartPageTrigger : apm.restartPageTrigger\r\n        });\r\n\r\n        if (props.albumCm.pageCount !== response.data.fileInfos.length & props.type !== 1) {\r\n          console.log(`PageCount (${props.albumCm.pageCount}) does not match fileInfos length (${response.data.fileInfos.length})`);\r\n          axios.get(_uri.RefreshAlbum(props.type, props.albumCm.path))\r\n            .then(function (response) {\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n  }\r\n\r\n  useEffect(() => {\r\n    const targetPage = apm.lpi < apm.pages.length ? apm.lpi : apm.pages.length - 1;\r\n\r\n    pageHandler.jumpTo(targetPage);\r\n  }, [apm.path, apm.restartPageTrigger]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"keydown\", handleKeyDown2, false);\r\n\r\n    return () => { //component will unmount\r\n      document.removeEventListener(\"keydown\", handleKeyDown2, false);\r\n    };\r\n  }, []);\r\n\r\n  const handleKeyDown2 = (event) => {\r\n    if (event.keyCode === 27) {\r\n      pageHandler.close();\r\n    }\r\n  };\r\n\r\n  //#region Event handlers\r\n  const pageHandler = {\r\n    jumpTo: function (page, renameObj) {\r\n      const maxIndex = apm.pages.length - 1;\r\n      const newPPageI = apm.indexes?.cPageI ?? 0;\r\n      const newCPageI = _helper.clamp(page, 0, maxIndex);\r\n\r\n      const { newTriad, zenpenIndex, chuhenIndex, kouhenIndex } = (() => {\r\n        function compose(newTriad, zenpenIndex, chuhenIndex, kouhenIndex) {\r\n          return {\r\n            newTriad,\r\n            zenpenIndex,\r\n            chuhenIndex,\r\n            kouhenIndex\r\n          };\r\n        }\r\n\r\n        function pageCeil(modifier) {\r\n          const pagesLen = apm.pages.length;\r\n          return (((newCPageI + modifier) % pagesLen) + pagesLen) % pagesLen;\r\n        }\r\n\r\n        if (newCPageI % 3 === 0) {\r\n          return compose(\"zenpen\", newCPageI, pageCeil(1), pageCeil(-1));\r\n        }\r\n        if (newCPageI % 3 === 1) {\r\n          return compose(\"chuhen\", pageCeil(-1), newCPageI, pageCeil(1));\r\n        }\r\n        if (newCPageI % 3 === 2) {\r\n          return compose(\"kouhen\", pageCeil(1), pageCeil(-1), newCPageI);\r\n        }\r\n      })();\r\n\r\n      let modifiedPages = apm.pages;\r\n      if (renameObj !== null && renameObj !== undefined) {\r\n        modifiedPages[renameObj.index] = renameObj.newPageInfo;\r\n      }\r\n\r\n      setApm({\r\n        indexes: {\r\n          cPageI: newCPageI,\r\n          pPageI: newPPageI,\r\n          triad: newTriad,\r\n          zenpenIndex: zenpenIndex,\r\n          chuhenIndex: chuhenIndex,\r\n          kouhenIndex: kouhenIndex\r\n        },\r\n        path: apm.path,\r\n        lpi: apm.lpi,\r\n        isLandscape: apm.isLandscape,\r\n        includeDetail: apm.includeDetail,\r\n        pages: modifiedPages,\r\n      });\r\n\r\n      if (apm.path != null && page === apm.pages.length - 1 && props.type !== 1) {\r\n        axios.post(_uri.UpdateAlbumOuterValue(props.type), {\r\n          albumPath: apm.path,\r\n          lastPageIndex: page\r\n        })\r\n          .then((response) => {\r\n          })\r\n          .catch((error) => {\r\n            props.popApiError(error);\r\n          });\r\n      }\r\n    },\r\n    rename: (newVal, oldVal) => {\r\n      const srcAlRelPath = currentPageInfo.uncPathEncoded;\r\n      const dstAlRelPath = (() => {\r\n        var arr = currentPageInfo.uncPathEncoded.split('\\\\');\r\n        arr.pop();\r\n        arr.push(newVal);\r\n\r\n        return _helper.pathJoin(arr, '\\\\');\r\n      })();\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: apm.path,\r\n          alRelPath: srcAlRelPath,\r\n        },\r\n        dst: {\r\n          albumPath: apm.path,\r\n          alRelPath: dstAlRelPath\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          const oldPageIdx = apm.pages.findIndex(e => e.uncPathEncoded === srcAlRelPath);\r\n          const oldPage = apm.pages.splice(oldPageIdx, 1)[0];\r\n          const renamedPage = {\r\n            ...oldPage,\r\n            name: newVal,\r\n            uncPathEncoded: dstAlRelPath\r\n          };\r\n          \r\n          apm.pages = apm.pages.filter(e => e.uncPathEncoded !== dstAlRelPath);//this line is for overwrite\r\n          apm.pages.push(renamedPage);\r\n          apm.pages.sort((a, b) => a.uncPathEncoded.localeCompare(b.uncPathEncoded));\r\n\r\n          setApm((prev) => {\r\n            return ({\r\n              ...prev\r\n            });\r\n          });\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        }\r\n      )\r\n    },\r\n    move: (newDir) => {\r\n      console.log('reader model move', newDir);\r\n\r\n      const srcAlRelPath = currentPageInfo.uncPathEncoded;\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: apm.path,\r\n          alRelPath: srcAlRelPath,\r\n        },\r\n        dst: {\r\n          albumPath: newDir,\r\n          alRelPath: currentPageInfo.name\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          removePageFromApm(currentPageInfo.uncPathEncoded);\r\n          setApm((prev) => {\r\n            return ({\r\n              ...prev\r\n            });\r\n          });\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        }\r\n      )\r\n    },\r\n    delete: (pageInfo) => {\r\n      const delObj = {\r\n        albumPath: apm.path,\r\n        alRelPath: pageInfo.uncPathEncoded\r\n      };\r\n\r\n      props.deletePage(delObj,\r\n        (response) => {\r\n          removePageFromApm(pageInfo.uncPathEncoded);\r\n          setApm(prev => {\r\n            return{\r\n              ...prev\r\n            }\r\n          });\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    close: () => {\r\n      props.onClose(apm.path, apm.indexes.cPageI);\r\n    },\r\n    chapterDeleteSuccess: (newPageCount) => {\r\n      props.onChapterDeleteSuccess(apm.path, newPageCount);\r\n      axios.get(_uri.GetAlbumPageInfos(props.type, props.albumCm.path))\r\n      .then(function (response) {\r\n        const newIndexes = clampIndexes(apm.indexes, response.data.fileInfos.length - 1);\r\n\r\n        setApm({\r\n          path: props.albumCm.path,\r\n          lpi: props.albumCm.lastPageIndex,\r\n          isLandscape: response.data.orientation === \"Landscape\",\r\n          pages: response.data.fileInfos,\r\n          indexes: {...apm.indexes, ...newIndexes},\r\n          includeDetail: apm.includeDetail\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n    },\r\n    chapterRenameSuccess: () => {\r\n      refreshPages(true);\r\n    }\r\n  }\r\n\r\n  function removePageFromApm(uncPathEncoded){\r\n    const max = apm.pages.length - 2;\r\n    const newIndexes = clampIndexes(apm.indexes, max);\r\n    apm.indexes = { ...apm.indexes,...newIndexes};\r\n    \r\n    apm.pages = apm.pages.filter(page => page.uncPathEncoded !== uncPathEncoded);\r\n  }\r\n\r\n  function clampIndexes(indexes, max){\r\n    return{\r\n      cPageI:_helper.clamp(indexes.cPageI, 0, max),\r\n      pPageI:_helper.clamp(indexes.pPageI, 0, max),\r\n      zenpenIndex:_helper.clamp(indexes.zenpenIndex, 0, max),\r\n      chuhenIndex:_helper.clamp(indexes.chuhenIndex, 0, max),\r\n      kouhenIndex:_helper.clamp(indexes.kouhenIndex, 0, max)\r\n    }\r\n  }\r\n\r\n  function changeDetailVisibility(){\r\n    const includeDetail = !apm.includeDetail;\r\n\r\n    if(includeDetail && apm.pages[0].createDate === null){\r\n      axios.get(_uri.GetAlbumPageInfos(props.type, props.albumCm.path, includeDetail))\r\n      .then(function (response) {\r\n        setApm(prev => {\r\n          prev.includeDetail = includeDetail;\r\n          prev.pages = response.data.fileInfos\r\n          return { ...prev };\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n    }\r\n    else{\r\n      setApm(prev => {\r\n        prev.includeDetail = includeDetail;\r\n        return { ...prev };\r\n      });\r\n    }\r\n  }\r\n\r\n  const albumHandler = {\r\n    tierChange: (value) => {\r\n      axios.put(_uri.UpdateAlbumTier(props.type), {\r\n        albumPath: apm.path,\r\n        tier: value\r\n      })\r\n        .then(function (response) {\r\n          console.log(response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    recount: () => {\r\n      axios.get(_uri.RecountAlbumPages(props.type, apm.path))\r\n        .then(function (response) {\r\n          console.log(\"new page count\", response.data);\r\n          props.onChapterDeleteSuccess(apm.path, response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const [showContextMenu, setShowContextMenu] = useState(false);\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n\r\n  const buttonHandler = {\r\n    rightTop: () => {\r\n      if (apm.isLandscape) { setShowDrawer(true); }\r\n      else { pageHandler.close(); }\r\n    },\r\n    rightMid: () => {\r\n      if (apm.isLandscape) { changeDetailVisibility(); }\r\n      else { pageHandler.jumpTo(apm.indexes.cPageI + 1); }\r\n    },\r\n    rightBot: () => {\r\n      if (apm.isLandscape) { pageHandler.close(); }\r\n      else { pageHandler.jumpTo(apm.pages.length - 1); }\r\n    },\r\n    midTop: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n      else { changeDetailVisibility(); }\r\n    },\r\n    midMid: () => {\r\n      setShowContextMenu(true);\r\n    },\r\n    midBot: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.indexes.cPageI + 1); }\r\n      else { }\r\n    },\r\n    leftTop: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(0); }\r\n      else { setShowDrawer(true); }\r\n    },\r\n    leftMid: () => {\r\n      if (apm.isLandscape) { }\r\n      else { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n    },\r\n    leftBot: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.pages.length - 1); }\r\n      else { pageHandler.jumpTo(0); }\r\n    }\r\n  }\r\n\r\n  const swipeHandler = useSwipeable({\r\n    onSwipedUp: (eventData) => { \r\n      if(!apm.isLandscape) return;\r\n      pageHandler.jumpTo(apm.indexes.cPageI + 1);\r\n    },\r\n    onSwipedDown: (eventData) => { \r\n      if(!apm.isLandscape) return;\r\n      pageHandler.jumpTo(apm.indexes.cPageI - 1);\r\n    },\r\n    onSwipedLeft: (eventData) => { \r\n      if(apm.isLandscape) return; \r\n      pageHandler.jumpTo(apm.indexes.cPageI + 1); \r\n    },\r\n    onSwipedRight: (eventData) => { \r\n      if(apm.isLandscape) return; \r\n      pageHandler.jumpTo(apm.indexes.cPageI - 1); \r\n    }\r\n  });\r\n\r\n  //#endregion\r\n  const showGuide = IS_PUBLIC && apm.indexes !== null && apm.indexes.cPageI === 0;\r\n  const overlayStyle = getOverlayStyle(showGuide);\r\n  const buttonStyle = {\r\n    side: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.25 * window.innerHeight\r\n    },\r\n    mid: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.5 * window.innerHeight\r\n    }\r\n  }\r\n\r\n  if (apm.indexes === null || apm.pages.length === 0) { return (<></>); }\r\n\r\n  console.log('currentApm', apm);\r\n\r\n  const currentPageInfo = apm.indexes.triad === \"zenpen\" ? apm.pages[apm.indexes.zenpenIndex]\r\n    : apm.indexes.triad === \"chuhen\" ? apm.pages[apm.indexes.chuhenIndex]\r\n      : apm.indexes.triad === \"kouhen\" ? apm.pages[apm.indexes.kouhenIndex]\r\n        : null;\r\n\r\n  const zenpenPage = <PageDisplay\r\n    id=\"zenpen-page\"\r\n    albumPath={apm.path}\r\n    pageInfo={apm.pages[apm.indexes.zenpenIndex]}\r\n    queue={apm.indexes.triad === \"zenpen\" ? \"q0\" : apm.indexes.triad === \"kouhen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n    type={props.type}\r\n    DEBUGPageTriad=\"zenpen\"\r\n  />;\r\n\r\n  const chuhenPage = <PageDisplay\r\n    id=\"chuhen-page\"\r\n    albumPath={apm.path}\r\n    pageInfo={apm.pages[apm.indexes.chuhenIndex]}\r\n    queue={apm.indexes.triad === \"chuhen\" ? \"q0\" : apm.indexes.triad === \"zenpen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n    type={props.type}\r\n    DEBUGPageTriad=\"chuhen\"\r\n  />;\r\n\r\n  const kouhenPage = <PageDisplay\r\n    id=\"kouhen-page\"\r\n    albumPath={apm.path}\r\n    pageInfo={apm.pages[apm.indexes.kouhenIndex]}\r\n    queue={apm.indexes.triad === \"kouhen\" ? \"q0\" : apm.indexes.triad === \"chuhen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n    type={props.type}\r\n    DEBUGPageTriad=\"kouhen\"\r\n  />;\r\n\r\n  const menu = <EditModalTrigger onVisible={props.onOpenEditModal}></EditModalTrigger>;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"overlay overlay-reader\" style={{ display: props.isOpen ? \"block\" : \"none\", zIndex: 1 }}>\r\n        {/* <div className=\"overlay-content\"> */}\r\n        {/* <div style={{ position: \"relative\", top: \"0%\", textAlign: \"center\", height: window.innerHeight, width: window.innerWidth }}> */}\r\n        <div style={{ height: \"100vh\", position: \"absolute\", left: 0, top: 0 }}>\r\n          {zenpenPage}\r\n          {chuhenPage}\r\n          {kouhenPage}\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 2 }}>\r\n          <div className=\"overlay-content\">\r\n            <span className=\"with-shadow\">{currentPageInfo.name}</span>\r\n            <div style={{ position: \"fixed\", bottom: \"0px\", width: \"100%\", textAlign: \"center\" }}>\r\n              <span className=\"with-shadow\">{apm.indexes.cPageI + 1}/{apm.pages.length}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {!apm.includeDetail ? <></> : \r\n          <div className=\"overlay\" style={{ zIndex: 3 }}>\r\n            <div className=\"overlay-content\">\r\n              <Row>\r\n                <Col span={6}><div style={buttonStyle.side}></div></Col>\r\n                <Col span={12}><div style={buttonStyle.side}></div></Col>\r\n                <Col span={6}>\r\n                  <div className=\"with-shadow\" style={{ textAlign:\"left\",...buttonStyle.side}}>\r\n                    <div>{_helper.formatBytes(currentPageInfo.size, 0)}</div>\r\n                    <div>{_helper.formatDate(currentPageInfo.createDate)}</div>\r\n                    <div>{_helper.formatDate(currentPageInfo.updateDate)}</div>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        }\r\n        <div className=\"overlay\" style={{ zIndex: 4 }}>\r\n          <div style={overlayStyle.content} {...swipeHandler}>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftTop} style={buttonStyle.side}>\r\n                  {\r\n                    getGuideLabel(showGuide, \"Browse Chapters\")\r\n                    //WARNING, getGuideLabel mechanism has not been updated to conform with rotation mechanic (isLandscape)\r\n                  }\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Show File Info\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Close Album\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Previous Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <Dropdown overlay={menu} trigger={['contextMenu']} disabled={false}>\r\n                <div onClick={buttonHandler.midMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Context Menu\")}\r\n                </div>\r\n                </Dropdown>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Next Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"First Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midBot} style={buttonStyle.side} />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Last Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ReaderModalContextMenu\r\n        visible={showContextMenu}\r\n        albumCm={props.albumCm}\r\n        initialValue={apm.indexes.cPageI}\r\n        pageName={currentPageInfo.name}\r\n        type={props.type}\r\n\r\n        onTierChange={albumHandler.tierChange}\r\n        onRecount={() => { albumHandler.recount(); setShowContextMenu(false); }}\r\n        onJump={(page) => { pageHandler.jumpTo(page); setShowContextMenu(false); }}\r\n        onUndoJump={() => { pageHandler.jumpTo(apm.indexes.pPageI); setShowContextMenu(false); }}\r\n        onRename={(newVal, oldVal) => { pageHandler.rename(newVal, oldVal); setShowContextMenu(false); }}\r\n        onMove={(newDir) => { pageHandler.move(newDir); setShowContextMenu(false); }}\r\n        onDelete={() => { pageHandler.delete(currentPageInfo); setShowContextMenu(false); }}\r\n        onCancel={() => setShowContextMenu(false)}\r\n      />\r\n      <ReaderModalChapterDrawer\r\n        visible={showDrawer}\r\n        albumPath={apm.path}\r\n        type={props.type}\r\n\r\n        onClose={() => setShowDrawer(false)}\r\n        onJumpToPage={pageHandler.jumpTo}\r\n        onChapterDeleteSuccess={pageHandler.chapterDeleteSuccess}\r\n        onChapterRenameSuccess={pageHandler.chapterRenameSuccess}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst getOverlayStyle = (isGrey) => {\r\n  const result = {\r\n    content: {\r\n      position: 'relative',\r\n      top: '0%',\r\n      width: '100%',\r\n      textAlign: 'center',\r\n      backgroundColor: isGrey ? 'rgba(200, 200, 200, 0.3)' : 'rgba(0, 0, 0, 0)'\r\n    },\r\n    button: {\r\n      position: 'relative',\r\n      boxSizing: 'border-box',\r\n      border: isGrey ? '1px solid black' : '0px'\r\n    }\r\n  };\r\n\r\n  return result;\r\n}\r\n\r\nconst getGuideLabel = (isGrey, text) => {\r\n  return isGrey ?\r\n    <span style={{ textAlign: \"center\", margin: \"auto\", textShadow: \"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black\" }}>\r\n      {text}\r\n    </span> :\r\n    \"\";\r\n}\r\n\r\nfunction PageDisplay(props) {\r\n  const styleByRotation = props.isLandscape ?\r\n    {\r\n      transform: \"translatex(calc(50vw - 50%)) translatey(calc(50vh - 50%)) rotate(90deg)\",\r\n      width: \"100vh\",\r\n      height: \"100vw\",\r\n    } :\r\n    {\r\n      transform: \"translatex(calc(50vw - 50%)) translatey(calc(50vh - 50%))\",\r\n      width: \"100vw\",\r\n      height: \"100vh\"\r\n    };\r\n\r\n  const styleShow = {\r\n    objectFit: \"contain\",\r\n    ...styleByRotation\r\n  };\r\n  const styleHide = { objectFit: \"contain\", height: 0, width: 0, position: \"absolute\" };\r\n  //const styleShow = { height: 300, width: 300 };\r\n  //const styleHide = { height: 150, width: 150 };\r\n\r\n  console.log('pageDisplay', props);\r\n\r\n  if (IsVideo(props.pageInfo.extension)) {\r\n    return (\r\n      <video\r\n        autoPlay loop\r\n        id={props.id}\r\n        style={props.queue === \"q0\" ? styleShow : styleHide}\r\n        src={props.queue === \"q0\" ? _uri.StreamPage(`${props.albumPath}\\\\${props.pageInfo.uncPathEncoded}`, props.type) : \"\"}\r\n      >\r\n        video not showing\r\n      </video>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <img\r\n      id={props.id}\r\n      style={props.queue === \"q0\" ? styleShow : styleHide}\r\n      src={props.queue === \"q0\" || props.queue === \"q1\" ? _uri.StreamPage(`${props.albumPath}\\\\${props.pageInfo.uncPathEncoded}`, props.type) : loadingImg}\r\n      alt=\"Not loaded\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction IsVideo(extension) {\r\n  if (extension === \".webm\" || extension === \".mp4\") {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction EditMenuInbetweener(props) {\r\n  useEffect(() => {\r\n    props.onVisible();\r\n  },[props]);\r\n  return (<></>)\r\n}\r\n\r\nexport default withPageManager(withMyAlert(ReaderModal));","import React, { useState, useEffect, useRef } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport { Row, Col } from 'antd';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport ReaderModal from '../_shared/ReaderModal/ReaderModal';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport PullToRefresh from 'react-simple-pull-to-refresh';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction SelfComps(props) {\r\n  console.log(\"selfComps rendering\");\r\n  const type = 1;\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n  const [selectedAlbumCm, setSelectedAlbumCm] = useState(null);\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n\r\n  const handleRefresh = () => {\r\n    return new Promise((resolve, reject) => {\r\n      const { path } = props.queryParts;\r\n      const cleanPath = path ?? \"\";\r\n\r\n      axios.get(_uri.GetAlbumCardModels(type, 0, 0, cleanPath))\r\n        .then((response) => {\r\n          setAlbumCms(response.data);\r\n          console.log('sc albums', response.data);\r\n          resolve(\"param from resolve\");\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n          reject(\"param from reject\");\r\n        });\r\n    });\r\n  }\r\n  useEffect(() => { handleRefresh(); }, [props.queryParts]);\r\n\r\n  const readerHandler = {\r\n    view: (pageCount, albumCm) => {\r\n      if(pageCount === 0){\r\n        props.history.push(\"Sc?path=\" + albumCm.path);\r\n      }\r\n      else{\r\n        setSelectedAlbumCm(albumCm);\r\n        setReaderModalIsOpen(true);\r\n      }\r\n    },\r\n\r\n    close: (path, lastPageIndex) => {\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(_uri.UpdateAlbumOuterValue(type), {\r\n        albumPath: path,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then((response) => {\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n        \r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const crudHandler = {\r\n    pageDeleteSuccess: (path) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (path, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <PullToRefresh onRefresh={handleRefresh}>\r\n        <Row gutter={0} type=\"flex\">\r\n          {albumCms.map((a, index) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.path}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={(albumCm) => readerHandler.view(a.pageCount, albumCm)}\r\n                showContextMenu={true}\r\n                type={1}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      </PullToRefresh>\r\n      <ReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={selectedAlbumCm}\r\n        type={1}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(SelfComps));","import React from 'react';\r\nimport { Button, Input } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputTextbox(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n\r\n  const colSize = {\r\n    input: props.showClearButton ? 14 : 18,\r\n    button: props.showClearButton ? 4 : 0\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={6}>\r\n          <label className='my-editor-label'>{props.label}</label>\r\n        </Col>\r\n        <Col sm={colSize.input}>\r\n          {\r\n            props.row == null ?\r\n            <Input\r\n              placeholder={props.placeholder}\r\n              value={props.value}\r\n              onChange={handleChange}\r\n            /> :\r\n            <Input.TextArea \r\n              placeholder={props.placeholder}\r\n              value={props.value}\r\n              onChange={handleChange}\r\n              autoSize={{minRows: props.row, maxRows:props.row}}\r\n            />\r\n          }\r\n        </Col>\r\n        {\r\n          props.showClearButton ?\r\n          <Col sm={colSize.button}>\r\n            <Button \r\n              style={{ width: \"100%\", marginLeft:\"5px\" }}\r\n              onClick={() => props.onChange(props.label, '')}\r\n            >\r\n              <span className='my-editor-button-label'>Clear</span>\r\n            </Button>\r\n          </Col>:\r\n          <></>\r\n        }\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputTextbox;","import React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputRadio(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={6}>\r\n          <label className='my-editor-label'>{props.label}</label>\r\n        </Col>\r\n        <Col sm={18}>\r\n          <Radio.Group onChange={handleChange} value={props.value} style={{ width: \"100%\" }}>\r\n            <Row>\r\n              {props.items.map(item => (\r\n                <Col span={6} key={item}>\r\n                  <Radio key={item} value={item}><span style={{ color: \"white\" }}>{item}</span></Radio>\r\n                </Col>\r\n              ))}\r\n            </Row>\r\n          </Radio.Group>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputRadio;","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputMulticheck(props) {\r\n\r\n  function handleClick(label) {\r\n    props.onChange(props.label, label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={6}>\r\n          <label className='my-editor-label'>{props.label}</label>\r\n        </Col>\r\n        <Col sm={18}>\r\n          <Row gutter={2}>\r\n            {props.items.map((item) => (\r\n              <Col span={6} key={item}>\r\n                <Button\r\n                  key={item}\r\n                  type={props.value.includes(item) ? \"primary\" : \"link\"}\r\n                  ghost={props.value.includes(item) ? true : false}\r\n                  onClick={() => handleClick(item)}\r\n                  style={{ width: \"100%\", textAlign: \"left\", marginBottom: \"2px\" }}\r\n                >\r\n                  {item}\r\n                </Button>\r\n              </Col>)\r\n            )}\r\n          </Row>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputMulticheck;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Button, Checkbox } from 'antd';\r\nimport useSWR from 'swr';\r\n\r\nimport MyInputTextbox from '../_shared/Editors/MyInputTextbox';\r\nimport MyInputStar from '../_shared/Editors/MyInputStar';\r\nimport MyInputRadio from '../_shared/Editors/MyInputRadio';\r\nimport MyInputCheck from '../_shared/Editors/MyInputCheck';\r\nimport MyInputMulticheck from '../_shared/Editors/MyInputMulticheck';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\n\r\nimport * as _helper from '../_utils/Helper';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst lodash = require('lodash/array');\r\nconst axios = require('axios').default;\r\n\r\nfunction EditModal(props) {\r\n  const { data: albumInfo, error: aiError } = useSWR(_uri.GetAlbumInfo());\r\n\r\n  const [albumVm, setAlbumVm] = useState({\r\n    path: \"\", //not updated\r\n    pageCount: 0, //not updated\r\n    lastPageIndex: 0, //not updated\r\n    album: {\r\n      title: \"\",\r\n      category: \"Manga\",\r\n      orientation: \"Portrait\",\r\n      artists: [],\r\n      tags: [],\r\n      languages: [],\r\n      flags: [],\r\n      tier: 0,\r\n      cover: \"\",\r\n      isWip: false,\r\n      isRead: false,\r\n      entryDate: null\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumPath === undefined) { return; }\r\n\r\n    axios.get(_uri.GetAlbumVm(props.type, props.albumPath))\r\n      .then(function (response) {\r\n        setAlbumVm(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumPath]);\r\n\r\n  const handlers = {\r\n    albumVmChange: function (label, value) {\r\n      let newAlbumVm = { ...albumVm };\r\n      let cleanedValue = value;\r\n      if (label === \"Artists\") {\r\n        cleanedValue = value.split(\",\");\r\n      }\r\n      else if (label === \"Tags\" || label === \"Languages\") {\r\n        cleanedValue = albumVm.album[_helper.firstLetterLowerCase(label)];\r\n        if (cleanedValue.includes(value)) {\r\n          cleanedValue = lodash.pull(cleanedValue, value);\r\n        }\r\n        else {\r\n          cleanedValue.push(value);\r\n        }\r\n      }\r\n      newAlbumVm.album[_helper.firstLetterLowerCase(label)] = cleanedValue;\r\n      setAlbumVm(newAlbumVm);\r\n    },\r\n    ok: function () {\r\n      props.onOk(albumVm);\r\n    },\r\n    cancel: function () {\r\n      props.onCancel();\r\n    },\r\n    editFiles: function () {\r\n      props.onEditFiles(albumVm);\r\n    },\r\n    delete: function () {\r\n      props.onDelete(albumVm);\r\n    },\r\n    refresh: function () {\r\n      props.onRefresh(albumVm);\r\n    }\r\n  }\r\n\r\n  const temp = (\r\n    <div className=\"ant-modal-root\">\r\n      <div className=\"ant-modal-mask\"></div>\r\n      <div tabIndex={-1} className=\"ant-modal-wrap\" role=\"dialog\" aria-labelledby=\"rcDialogTitle0\" onClick={handlers.cancel}>\r\n        <div role=\"document\" className=\"my-ant-modal\" onClick={(e) => e.stopPropagation()}>\r\n          <div className=\"ant-modal-content\">\r\n            <button onClick={handlers.cancel} type=\"button\" aria-label=\"Close\" className=\"ant-modal-close\">\r\n              <span className=\"ant-modal-close-x\">\r\n                <i aria-label=\"icon: close\" className=\"anticon anticon-close ant-modal-close-icon\">\r\n                  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"\" data-icon=\"close\" fill=\"currentColor\" aria-hidden=\"true\" style={{ height: \"1em\", width: \"1em\" }}>\r\n                    <path d=\"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z\">\r\n                    </path>\r\n                  </svg>\r\n                </i>\r\n              </span>\r\n            </button>\r\n            <div className=\"my-ant-modal-header\">\r\n              <div className=\"my-ant-modal-title\" id=\"rcDialogTitle0\">Edit Metadata</div>\r\n            </div>\r\n            <div className=\"my-ant-modal-body\">\r\n              {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n                <>\r\n                  <MyInputTextbox label=\"Title\" row={3} value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n                  <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n                  <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n                  <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n                  <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n                  <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n                  <MyInputTextbox label=\"Note\" value={albumVm.album.note} onChange={handlers.albumVmChange} showClearButton={true} />\r\n                  <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n                  <Row gutter={[0, 8]}>\r\n                    <Col span={6}>\r\n                      <label className='my-editor-label'>Flags</label>\r\n                    </Col>\r\n                    <Col sm={18}>\r\n                      <Row gutter={2}>\r\n                        <Col span={6}>\r\n                          <Checkbox onChange={(event) => handlers.albumVmChange('IsWip', event.target.checked)} checked={albumVm.album.isWip}>\r\n                            <span style={{ color: \"white\" }}>WIP</span>\r\n                          </Checkbox>\r\n                        </Col>\r\n                        <Col span={6}>\r\n                          <Checkbox onChange={(event) => handlers.albumVmChange('IsRead', event.target.checked)} checked={albumVm.album.isRead}>\r\n                            <span style={{ color: \"white\" }}>Read</span>\r\n                          </Checkbox>\r\n                        </Col>\r\n                      </Row>\r\n                    </Col>\r\n                  </Row>\r\n                </>\r\n              )}\r\n            </div>\r\n            <div className=\"my-ant-modal-footer\">\r\n              <Row>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.delete} type=\"danger\" style={{ width: \"100%\" }}>\r\n                    <span className='my-editor-button-label'>Delete</span>\r\n                  </Button>\r\n                </Col>\r\n                <Col span={1}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.refresh} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n                    <span className='my-editor-button-label'>Refresh</span>\r\n                  </Button>\r\n                </Col>\r\n                <Col span={2}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.editFiles} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n                    <span className='my-editor-button-label'>Files</span>\r\n                  </Button>\r\n                </Col>\r\n                <Col span={1}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.ok} type=\"primary\" style={{ width: \"100%\" }}>\r\n                    <span className='my-editor-button-label'>Save</span>\r\n                  </Button>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (<>{props.isOpen ? temp : \"\"}</>);\r\n}\r\n\r\nexport default withMyAlert(EditModal);","import { useMediaQuery } from 'react-responsive'\r\n\r\nconst DesktopOnly = ({ children }) => {\r\n  const isDesktop = useMediaQuery({ minWidth: 801 })\r\n  return isDesktop ? children : null\r\n}\r\nconst MobileOnly = ({ children }) => {\r\n  const isMobile = useMediaQuery({ maxWidth: 800 })\r\n  return isMobile ? children : null\r\n}\r\n\r\nconst IsMobile = () => {\r\n  var width = window.innerWidth\r\n  || document.documentElement.clientWidth\r\n  || document.body.clientWidth;\r\n\r\n  return width <= 800;\r\n}\r\n\r\nconst IsPhone = () => {\r\n  var width = window.innerWidth\r\n  || document.documentElement.clientWidth\r\n  || document.body.clientWidth;\r\n\r\n  return width <= 576;\r\n}\r\n\r\nexport { DesktopOnly, MobileOnly, IsMobile, IsPhone };","import React, { useState, useEffect, useRef } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\n\r\nimport { InView } from 'react-intersection-observer';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport ReaderModal from '../_shared/ReaderModal/ReaderModal';\r\nimport EditModal from './EditModal';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport PullToRefresh from 'react-simple-pull-to-refresh';\r\nimport * as _uri from '../_utils/UriHelper';\r\nimport { MobileOnly, IsMobile, IsPhone } from '../_utils/Display';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction Albums(props) {\r\n  console.log(\"albums rendering\");\r\n  const type = 0;\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  //#region Display Album List\r\n  const pageSize = 100;\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n  const [maxPage, setMaxPage] = useState(0);\r\n  const itemPerRow = IsPhone() ? 2 : IsMobile() ? 4 : 8;\r\n\r\n  const handleRefresh = () => {\r\n    return new Promise((resolve, reject) => {\r\n      const { page, row, query } = props.queryParts;\r\n      //const encodedQuery = (query !== undefined) ? encodeURIComponent(query) : \"\";\r\n      axios.get(_uri.GetAlbumCardModels(type, page, row, query))\r\n        .then((response) => {\r\n          setAlbumCms(response.data);\r\n          resolve(\"param from resolve\");\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n          reject(\"param from reject\");\r\n        });\r\n    });\r\n  }\r\n  useEffect(() => { handleRefresh(); }, [props.queryParts]);\r\n\r\n  const [filteredAlbumCms, setFilteredAlbumCms] = useState([]);\r\n  useEffect(() => {\r\n    const acmsFiltered = albumCms.filter(a => { \r\n      return props.selectedTiers.includes(`${a.tier}`)\r\n        || (props.selectedTiers.includes('N') && !a.isRead);\r\n    });\r\n\r\n    const acmsPaged = acmsFiltered.slice(0, maxPage * pageSize);\r\n\r\n    setFilteredAlbumCms(acmsPaged);\r\n  }, [albumCms, maxPage, props.selectedTiers]);\r\n\r\n  function inViewChange(inView, entry){\r\n    console.log('inViewChange', entry);\r\n    if(entry.isIntersecting) setMaxPage(maxPage + 1);\r\n  }\r\n  //#endregion\r\n\r\n  //#region Display Album Pages\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n  useEffect(() => {\r\n    var body = document.body;\r\n    if(readerModalIsOpen){\r\n      body.style.overflow = \"hidden\";\r\n    }\r\n    else{\r\n      body.style.overflow = \"visible\";\r\n    }\r\n  },[readerModalIsOpen])\r\n\r\n  const [selectedAlbumCm, setSelectedAlbumCm] = useState(null);\r\n\r\n  const readerHandler = {\r\n    view: (albumCm) => {\r\n      console.log('view', albumCm);\r\n\r\n      setSelectedAlbumCm(albumCm);\r\n      setReaderModalIsOpen(true);\r\n    },\r\n\r\n    close: (path, lastPageIndex) => {\r\n      console.log('readerHandler close triggered');\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(_uri.UpdateAlbumOuterValue(type), {\r\n        albumPath: path,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then((response) => {\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex,\r\n          isRead: lastPageIndex === albumCm.pageCount - 1 ? true : albumCm.isRead\r\n        };\r\n      }));\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Edit Delete\r\n  const [editModalIsOpen, setEditModalIsOpen] = useState(false);\r\n  const [editedAlbumPath, setEditedAlbumId] = useState(undefined);\r\n\r\n  const crudHandler = {\r\n    edit: (path) => {\r\n      setEditModalIsOpen(true);\r\n      setEditedAlbumId(path);\r\n    },\r\n    pageDeleteSuccess: (path) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (path, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.path !== path) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const editHandler = {\r\n    ok: (editedAlbumVm) => {\r\n      setEditModalIsOpen(false);\r\n      axios.post(_uri.UpdateAlbum(type), editedAlbumVm)\r\n        .then((response) => {\r\n          console.log(\"edit success. Path: \", response.data);\r\n\r\n          let newAlbumCms = [...albumCms];\r\n          let editedAlbumVmIndex = newAlbumCms.findIndex(a => a.path === editedAlbumVm.path);\r\n          newAlbumCms[editedAlbumVmIndex].fullTitle = `[${editedAlbumVm.album.artists.join(', ')}] ${editedAlbumVm.album.title}`;\r\n          newAlbumCms[editedAlbumVmIndex].languages = editedAlbumVm.album.languages;\r\n\r\n          newAlbumCms[editedAlbumVmIndex].note = editedAlbumVm.album.note;\r\n\r\n          setAlbumCms(newAlbumCms);\r\n        })\r\n        .catch((error) => {\r\n          //console.log\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    cancel: () => {\r\n      setEditModalIsOpen(false);\r\n    },\r\n    delete: (albumVm) => {\r\n      const album = albumVm.album;\r\n      confirm({\r\n        title: `Delete album [${album.artists.join(', ')}] ${album.title}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          axios.delete(_uri.DeleteAlbum(type, albumVm.path))\r\n            .then(function (response) {\r\n              setEditModalIsOpen(false);\r\n\r\n              setAlbumCms(albumCms.filter(albumCm => {\r\n                return albumCm.path !== albumVm.path;\r\n              }));\r\n            })\r\n            .catch(function (error) {\r\n              setEditModalIsOpen(false);\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    },\r\n    refresh: (albumVm) => {\r\n      setEditModalIsOpen(false);\r\n      axios.get(_uri.RefreshAlbum(0, albumVm.path))\r\n        .then((response) => {\r\n          props.popInfo(\"Refresh Album\", response.data, null);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    editFiles: (albumVm) => {\r\n      setEditModalIsOpen(false);\r\n      props.history.push(\"FileManagement?path=\" + albumVm.path);\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <>\r\n      <PullToRefresh onRefresh={handleRefresh}>\r\n        {/* <div style={{width:\"100%\", marginBottom:\"5px\"}}> */}\r\n        <Row gutter={0} type=\"flex\">\r\n          {filteredAlbumCms.map((a, index) => {\r\n            const rowIndex = Math.floor(index / itemPerRow);\r\n            const bc = (index + rowIndex) % 2 === 0 ? '#333' : 'inherit';\r\n            return (\r\n              <Col style={{ textAlign: 'center', backgroundColor:bc }} lg={3} md={6} xs={12} key={\"albumCol\" + a.path}>\r\n                <MyAlbumCard\r\n                  index={index}\r\n                  albumCm={a}\r\n                  onView={readerHandler.view}\r\n                  onEdit={crudHandler.edit}\r\n                  //onDelete={crudHandler.delete}\r\n                  showContextMenu={true}\r\n                />\r\n              </Col>\r\n            );\r\n          })}\r\n        </Row>\r\n        <InView as=\"div\" onChange={inViewChange}>\r\n          <div style={{width:\"100%\", height:\"5px\", backgroundColor:\"transparent\"}}></div>\r\n        </InView>\r\n      </PullToRefresh>\r\n      <div style={{position:\"fixed\", top:0, backgroundColor:'rgba(0,0,0,0)'}}>\r\n        <MobileOnly><div style={{position:\"relative\",height:\"38px\"}}></div></MobileOnly>\r\n        <div style={{position:\"relative\", backgroundColor:'#2d2d2d'}}>\r\n          {`Total: ${albumCms.length} Filtered: ${filteredAlbumCms.length}`}\r\n        </div>\r\n      </div>\r\n      <ReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        onOpenEditModal={()=>{\r\n          setEditModalIsOpen(true);\r\n          setEditedAlbumId(selectedAlbumCm?.path)\r\n        }}\r\n        albumCm={selectedAlbumCm}\r\n      />\r\n      <EditModal\r\n        isOpen={editModalIsOpen}\r\n        albumPath={editedAlbumPath}\r\n        onOk={editHandler.ok}\r\n        onCancel={editHandler.cancel}\r\n        onDelete={editHandler.delete}\r\n        onRefresh={editHandler.refresh}\r\n        onEditFiles={editHandler.editFiles}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(Albums));","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport useSWR from 'swr';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport * as _uri from \"../_utils/UriHelper\";\r\n\r\nfunction Genres(props) {\r\n  const uri = props.page === \"Genres\" ? _uri.GetGenreCardModels() :\r\n    props.page === \"Artists\" ? _uri.GetFeaturedArtistCardModels() :\r\n      null;\r\n\r\n  const { data: albumCGroups, error } = useSWR(uri);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!albumCGroups) { return <div>loading...</div>; }\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      console.log(\"query click\", albumCm);\r\n      props.history.push('/albums?query=' + albumCm.path)\r\n    },\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {albumCGroups.map((acg, index) => (\r\n        <Row key={\"acgRow\" + acg.name} gutter={0} type=\"flex\" style={{ borderBottom: \"1px solid rgb(83, 83, 83)\", marginBottom: \"5px\" }}>\r\n          { props.page === \"This feature is cancelled\" ? (\r\n            <div style={{ position: \"relative\" }}>\r\n              <div style={{ position: \"absolute\", top: \"-18px\", left: \"10px\" }}>{acg.name}</div>\r\n            </div>) : \"\"\r\n          }\r\n          {acg.albumCms.map((a) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.path}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={() => { }}\r\n                onDelete={() => { }}\r\n                showContextMenu={false}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Genres;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { FileBrowser, FileContextMenu, FileList, FileNavbar, FileToolbar, ChonkyActions, defineFileAction, ChonkyIconName } from 'chonky';\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\nimport { TouchBackend } from 'react-dnd-touch-backend';\r\nimport moment from 'moment';\r\n\r\nimport withPageManager from '../_shared/HOCs/withPageManager';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport TextDialog from '../_shared/Modals/TextDialog';\r\nimport { IsMobile } from '../_utils/Display';\r\nimport * as _uri from '../_utils/UriHelper';\r\nimport * as _helper from '../_utils/Helper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction FileManagement(props) {\r\n  const chonkyFileActions = [\r\n    defineFileAction({\r\n      id: \"custom_rename\",\r\n      requiresSelection: true,\r\n      button: {\r\n        name: \"R\",\r\n        toolbar: true,\r\n        contextMenu: true,\r\n        icon: ChonkyIconName.code\r\n      }\r\n    }),\r\n    defineFileAction({\r\n      id: \"custom_delete\",\r\n      requiresSelection: true,\r\n      button: {\r\n        name: \"D\",\r\n        toolbar: true,\r\n        contextMenu: true,\r\n        icon: ChonkyIconName.trash\r\n      }\r\n    }),\r\n    defineFileAction({\r\n      id: \"custom_move\",\r\n      requiresSelection: true,\r\n      button: {\r\n        name: \"M\",\r\n        toolbar: true,\r\n        contextMenu: true,\r\n        icon: ChonkyIconName.folder\r\n      }\r\n    }),\r\n    ChonkyActions.EnableGridView,\r\n    ChonkyActions.EnableListView,\r\n    ChonkyActions.UploadFiles,\r\n    ChonkyActions.CreateFolder\r\n  ];\r\n\r\n  const determineActionToExecute = (data) => {\r\n    if (data.id === \"custom_delete\") action.delete(data);\r\n    else if (data.id === \"custom_rename\") action.rename(data);\r\n    else if (data.id === \"custom_move\") console.log(data.id);\r\n    else if (data.id === ChonkyActions.EndDragNDrop.id) action.dragNDrop(data);\r\n    else if (data.id === ChonkyActions.UploadFiles.id) console.log(data.id);\r\n    else if (data.id === ChonkyActions.OpenFiles.id) action.openFolder(data);\r\n    else if (data.id === ChonkyActions.OpenParentFolder.id) console.log(data.id);\r\n    else if (data.id === ChonkyActions.CreateFolder.id) action.createFolder(data);\r\n  };\r\n\r\n  const action = {\r\n    createFolder: (data) =>{\r\n      setTextDialog({\r\n        visible: true,\r\n        btnText: 'Create Folder',\r\n        initialValue: '',\r\n        onOk: (val, oldVal) => {\r\n          console.log('folder name', val);\r\n          setViewModel((prev) => {\r\n            if (viewModel.subDir !== null) {\r\n              props.popError(\"Invalid Operation\", \"Creating folder inside a folder is not allowed\");\r\n            }\r\n            prev.fsNodes.unshift({\r\n              name: val,\r\n              size: 0,\r\n              nodeType: 0,\r\n              uncPathEncoded: null,\r\n              childs: []\r\n            });\r\n            return ({\r\n              ...prev\r\n            });\r\n          });\r\n        }\r\n      });\r\n    },\r\n    openFolder: (data)=>{\r\n      if (!data.payload.targetFile.isDir) { return; }\r\n\r\n      const targetSubDir = data.payload.targetFile.name !== \"Root\" ?\r\n        data.payload.targetFile.name :\r\n        null;\r\n      const newDirChains = targetSubDir !== null ?\r\n        [...viewModel.dirChains, { id: '1', name: targetSubDir, isDir: true }] :\r\n        rootChain;\r\n\r\n      setViewModel((prevViewModel) => {\r\n        prevViewModel.subDir = targetSubDir;\r\n        prevViewModel.dirChains = newDirChains;\r\n        return ({\r\n          ...prevViewModel\r\n        });\r\n      });\r\n    },\r\n    delete: (data) => {\r\n      const cModel = data.state.selectedFiles[0];\r\n      const subDir = viewModel.dirChains.find(dir => dir.id === \"1\")?.name;\r\n\r\n      const delObj = (() => {\r\n        const alRelPath = cModel.isDir ? cModel.name : _helper.pathJoin([subDir, cModel.name], '\\\\');\r\n\r\n        return {\r\n          albumPath: viewModel.albumPath,\r\n          alRelPath: alRelPath\r\n        };\r\n      })();\r\n\r\n      props.deletePage(delObj,\r\n        (response) => {\r\n          console.log('delete success', response);\r\n          const newFsNodes = (() => {\r\n            if(cModel.isDir || subDir == null){\r\n              return viewModel.fsNodes.filter(n => n.name !== cModel.name);\r\n            }\r\n            else{\r\n              viewModel.fsNodes.forEach(n => {\r\n                if (n.name === subDir) {\r\n                  n.childs = n.childs.filter(c => c.name !== cModel.name);\r\n                }\r\n              });\r\n              return viewModel.fsNodes;\r\n            }\r\n          })();\r\n\r\n          setViewModel((prevState) => ({\r\n            ...prevState,\r\n            fsNodes: newFsNodes\r\n          }));\r\n        },\r\n        (error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    rename: (data) => {\r\n      if (data.state.selectedFiles.length === 0) { return; }\r\n      setTextDialog({\r\n        visible: true,\r\n        btnText: 'Rename',\r\n        initialValue: data.state.selectedFiles[0].name,\r\n        onOk: (val, oldVal) => {\r\n          const srcAlRelPath = _helper.pathJoin([viewModel.subDir, oldVal], '\\\\');\r\n          const dstAlRelPath = _helper.pathJoin([viewModel.subDir, val], '\\\\');\r\n\r\n          const movObj = {\r\n            overwrite: false,\r\n            src: {\r\n              albumPath: viewModel.albumPath,\r\n              alRelPath: srcAlRelPath,\r\n            },\r\n            dst: {\r\n              albumPath: viewModel.albumPath,\r\n              alRelPath: dstAlRelPath\r\n            }\r\n          };\r\n\r\n          props.movePage(movObj, \r\n            (response) => {\r\n              afterAction.move(movObj);\r\n            },(error) => {\r\n              props.popApiError(error);\r\n            });\r\n        }\r\n      });\r\n    },\r\n    dragNDrop: (data) => {\r\n      if (data.payload.draggedFile.isDir) { return; }\r\n      if (!data.payload.destination.isDir) { return; }\r\n\r\n      const fileName = data.payload.draggedFile.name;\r\n      const srcAlRelPath = _helper.pathJoin([viewModel.subDir, fileName], '\\\\');\r\n      const dstDir = data.payload.destination.name !== \"Root\" ? data.payload.destination.name : null;\r\n      const dstAlRelPath = _helper.pathJoin([dstDir, fileName], '\\\\');\r\n\r\n      const movObj = {\r\n        overwrite: false,\r\n        src: {\r\n          albumPath: viewModel.albumPath,\r\n          alRelPath: srcAlRelPath\r\n        },\r\n        dst: {\r\n          albumPath: viewModel.albumPath,\r\n          alRelPath: dstAlRelPath\r\n        }\r\n      };\r\n\r\n      props.movePage(movObj, \r\n        (response) => {\r\n          afterAction.move(movObj);\r\n        },(error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n  };\r\n\r\n  const afterAction = {\r\n    move: (movObj) => {\r\n      const albumPath = movObj.src.albumPath;\r\n      const srcObj = splitMoveModel(movObj.src.alRelPath);\r\n      const dstObj = splitMoveModel(movObj.dst.alRelPath);\r\n\r\n      const srcFsNode = (() => {\r\n        if(srcObj.subDir === null){\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === srcObj.fileName);\r\n          return viewModel.fsNodes.splice(lv1Idx, 1)[0];\r\n        }\r\n        else{\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === srcObj.subDir);\r\n          const lv2Idx = viewModel.fsNodes[lv1Idx].childs.findIndex(n => n.name === srcObj.fileName);\r\n          return viewModel.fsNodes[lv1Idx].childs.splice(lv2Idx, 1)[0];\r\n        }\r\n      })();\r\n\r\n      const modifiedSrcFsNode = {\r\n        ...srcFsNode,\r\n        name: dstObj.fileName\r\n      };\r\n\r\n      const removedNode = (() =>{\r\n        //if dst node exist it means overwrite, remove it\r\n        if(dstObj.subDir === null){\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === dstObj.fileName);\r\n          if(lv1Idx !== -1) return viewModel.fsNodes.splice(lv1Idx, 1)[0];\r\n        }\r\n        else{\r\n          const lv1Idx = viewModel.fsNodes.findIndex(n => n.name === dstObj.subDir);\r\n          const lv2Idx = viewModel.fsNodes[lv1Idx].childs.findIndex(n => n.name === dstObj.fileName);\r\n          if(lv2Idx !== -1) return viewModel.fsNodes[lv1Idx].childs.splice(lv2Idx, 1)[0];\r\n        }\r\n      })();\r\n\r\n      const targetParentIdx = (() => {\r\n        if(dstObj.subDir !== null){\r\n          return viewModel.fsNodes.findIndex(n => n.name === dstObj.subDir);\r\n        }\r\n        return null;\r\n      })();\r\n\r\n      if(targetParentIdx !== null){\r\n        viewModel.fsNodes[targetParentIdx].childs.push(modifiedSrcFsNode);\r\n        viewModel.fsNodes[targetParentIdx].childs.sort(compare);\r\n      }\r\n      else{\r\n        viewModel.fsNodes.push(modifiedSrcFsNode);\r\n        viewModel.fsNodes.sort(compare);\r\n      }\r\n\r\n      setViewModel((prev) => {\r\n        return ({\r\n          ...prev\r\n        });\r\n      });\r\n\r\n      function splitMoveModel(alRelPath){\r\n        const arr = alRelPath.split('\\\\');\r\n        if(arr.length === 2){\r\n          return {\r\n            subDir: arr[0],\r\n            fileName: arr[1]\r\n          };\r\n        }\r\n        else{\r\n          return {\r\n            subDir: null,\r\n            fileName: arr[0]\r\n          };\r\n        }\r\n      }\r\n      function compare(a, b) {\r\n        if (a.nodeType === b.nodeType) { //Make sure folders always come before files\r\n          var nameA = a.name.toLowerCase(), nameB = b.name.toLowerCase();\r\n          if (nameA < nameB) //sort string ascending\r\n            return -1;\r\n          if (nameA > nameB)\r\n            return 1;\r\n          return 0; //default return value (no sorting)\r\n        }\r\n        return a.nodeType > b.nodeType ? 1 : -1;\r\n      }\r\n    }\r\n  }\r\n\r\n  const defaultTextDialog = { visible: false, initialValue: 'ad', btnText: null };\r\n  const [textDialog, setTextDialog] = useState(defaultTextDialog);\r\n\r\n  const rootChain = [{ id: '0', name: 'Root', isDir: true }];\r\n  const [viewModel, setViewModel] = useState({\r\n    albumPath: null,\r\n    title: '',\r\n    subDir: null,\r\n    fsNodes: [],\r\n    dirChains: rootChain\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.path === \"\" || props.path === null || props.path === undefined) { return; }\r\n\r\n    axios.get(_uri.GetAlbumFsNodes(props.type, props.path))\r\n      .then((response) => {\r\n        setViewModel({\r\n          albumPath: props.path,\r\n          title: response.data.title,\r\n          subDir: null,\r\n          fsNodes: response.data.fsNodes,\r\n          dirChains: rootChain\r\n        });\r\n\r\n        console.log(response.data)\r\n      })\r\n      .catch((error) => {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.path]);\r\n\r\n  const [chonkyModels, setChonkyModels] = useState([]);\r\n  useEffect(() => {\r\n    const targetFsNodes = viewModel.subDir !== null ?\r\n      viewModel.fsNodes.find(n => n.name === viewModel.subDir).childs :\r\n      viewModel.fsNodes;\r\n\r\n    const newModels = targetFsNodes.map((n, index) => {\r\n      return {\r\n        id: index + 1,\r\n        name: n.name,\r\n        isDir: n.nodeType === 0,\r\n        thumbnailUrl: n.nodeType === 1 ? _uri.StreamResizedImage(n.uncPathEncoded, 150) : null,\r\n        size: n.size,\r\n        childrenCount: n.childs?.length,\r\n        selectable: true,\r\n        draggable: n.nodeType !== 0\r\n      }\r\n    });\r\n\r\n    setChonkyModels(newModels);\r\n  }, [viewModel]);\r\n\r\n  const dndBackend = IsMobile() ? TouchBackend : HTML5Backend;\r\n\r\n  return (\r\n    <>\r\n      <div style={{\r\n        width: \"100%\",\r\n        padding: \"0px 8px 0px 8px\",\r\n        borderTop: \"1px solid grey\",\r\n        borderBottom: \"1px solid grey\",\r\n        marginBottom: \"2px\"\r\n      }}>\r\n        <h3>{viewModel.title}</h3>\r\n      </div>\r\n      <div style={{ height: \"80vh\" }}>\r\n        <DndProvider backend={dndBackend}>\r\n          <FileBrowser\r\n            darkMode={true}\r\n            //disableSelection={true}\r\n            files={chonkyModels} folderChain={viewModel.dirChains} fileActions={chonkyFileActions}\r\n            disableDragAndDropProvider={true}\r\n            disableDefaultFileActions={true}\r\n            onFileAction={determineActionToExecute}\r\n          >\r\n            <FileNavbar />\r\n            <FileToolbar />\r\n            <FileList />\r\n            <FileContextMenu />\r\n          </FileBrowser>\r\n        </DndProvider>\r\n      </div>\r\n      <TextDialog\r\n        visible={textDialog.visible} onClose={() => setTextDialog(defaultTextDialog)}\r\n        initialValue={textDialog.initialValue}\r\n        onOk={textDialog.onOk}\r\n        btnText={textDialog.btnText}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withPageManager(withMyAlert(FileManagement));","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Button, Divider, Progress, Input, Row, Col, Form, Select, Alert } from 'antd';\r\n\r\nimport { css } from '@emotion/css';\r\nimport ScrollToBottom from 'react-scroll-to-bottom';\r\n\r\nimport { IS_PUBLIC } from \"../_utils/Config\";\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport * as _uri from \"../_utils/UriHelper\";\r\nimport * as _helper from \"../_utils/Helper\";\r\n\r\nconst axios = require('axios').default;\r\n\r\nconst ROOT_CSS = css({\r\n  height: 300,\r\n  width: '100%'\r\n});\r\n\r\nfunction Setting(props){\r\n  function setLoading(btnName, isLoading){\r\n    setButton((prev) => {\r\n      prev[btnName].isLoading = isLoading;\r\n      prev[btnName].progress = isLoading ? 0 : 100;\r\n      return {\r\n        ...prev\r\n      }\r\n    });\r\n  }\r\n\r\n  function setDefaultButton(text,icon,name,uri){\r\n    return {\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: text,\r\n      icon: icon,\r\n      execute: () => {\r\n        setLoading(name, true);\r\n\r\n        const sse = new EventSource(uri, {});\r\n        sse.onmessage = (res) => {\r\n          const resData = JSON.parse(res.data); console.log('res data', resData);\r\n          const isLoading = resData.currentStep !== resData.maxStep;\r\n          if(!isLoading) sse.close();\r\n          if(resData.isError) props.popError(\"API Error\", resData.message);\r\n\r\n          const percent = _helper.getPercent100(resData.currentStep, resData.maxStep);\r\n          setButton(prev => { \r\n            prev[name].percent = percent;\r\n            prev[name].isLoading = isLoading;\r\n            prev[name].eventMsgs.push(resData);\r\n            return {\r\n              ...prev\r\n            };\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  const [button, setButton] = useState({\r\n    reload: setDefaultButton('Reload','reload','reload',_uri.ReloadDatabase()),\r\n    fullScan: setDefaultButton('Full Scan', 'sync', 'fullScan', _uri.RescanDatabase()),\r\n    //clean: setDefaultButton('Clean Library', 'delete','clean', _uri.CleanLibrary()),\r\n\r\n    checkApiUrl:{\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: 'Check Url',\r\n      icon: 'check-circle',\r\n      execute: null\r\n    },\r\n    checkMediaUrl:{\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: 'Check Url',\r\n      icon: 'check-circle',\r\n      execute: null\r\n    },\r\n    checkResMediaUrl:{\r\n      isLoading: false,\r\n      percent: 0,\r\n      eventMsgs: [],\r\n      text: 'Check Url',\r\n      icon: 'check-circle',\r\n      execute: null\r\n    },\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <SettingForm {...props} />\r\n\r\n      <Divider orientation=\"left\" style={{color:\"white\"}}>\r\n        Actions\r\n      </Divider>\r\n      <ActionButton {...button.reload} />\r\n      <ActionButton {...button.fullScan} />\r\n      {/* <ActionButton {...button.clean} /> */}\r\n\r\n      <Divider orientation=\"left\" style={{color:\"white\"}}>\r\n        Event Stream\r\n      </Divider>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(Setting);\r\n\r\nfunction SettingForm(props){\r\n\r\n  const [apiBaseUrl, setApiBaseUrl] = useState(null);\r\n  useEffect(() =>{\r\n    setApiBaseUrl(_uri.GetApiBaseUrl());\r\n  },[]);\r\n\r\n  const [mediaBaseUrl, setMediaBaseUrl] = useState(null);\r\n  useEffect(() =>{\r\n    setMediaBaseUrl(_uri.GetMediaBaseUrl());\r\n  },[]);\r\n\r\n  const [resMediaBaseUrl, setResMediaBaseUrl] = useState(null);\r\n  useEffect(() =>{\r\n    setResMediaBaseUrl(_uri.GetResMediaBaseUrl());\r\n  },[]);\r\n\r\n  function checkUrl(url){\r\n    //setLoading('checkApiUrl', true);\r\n    axios.get(url)\r\n      .then((response) => {\r\n        //setLoading('checkApiUrl', false);\r\n        props.popInfo(`${response.status} ${response.statusText}`, '', response.data);\r\n      })\r\n      .catch((error) => {\r\n        //setLoading('checkApiUrl', false);\r\n        props.popApiError(error);\r\n      });\r\n  }\r\n\r\n  return(\r\n    <>\r\n      <RowBase textAlign='right'\r\n        col0={\r\n          <SettingFormLabel text='API'/>\r\n        }\r\n        col1={\r\n          <Input.Search \r\n            value={apiBaseUrl} \r\n            onChange={(e) => { if(!IS_PUBLIC) setApiBaseUrl(e.target.value); }} \r\n            onSearch={() => { if(!IS_PUBLIC) checkUrl(apiBaseUrl); }}\r\n            enterButton\r\n          />\r\n        }\r\n      />\r\n      <RowBase textAlign='right'\r\n        col0={\r\n          <SettingFormLabel text='Media'/>\r\n        }\r\n        col1={\r\n          <Input.Search \r\n            value={mediaBaseUrl} \r\n            onChange={(e) => { if(!IS_PUBLIC) setMediaBaseUrl(e.target.value); }} \r\n            onSearch={() => { if(!IS_PUBLIC) checkUrl(mediaBaseUrl); }}\r\n            enterButton\r\n          />\r\n        }\r\n      />\r\n      <RowBase textAlign='right'\r\n        col0={\r\n          <SettingFormLabel text='Res Media'/>\r\n        }\r\n        col1={\r\n          <Input.Search \r\n            value={resMediaBaseUrl} \r\n            onChange={(e) => { if(!IS_PUBLIC) setResMediaBaseUrl(e.target.value); }} \r\n            onSearch={() => { if(!IS_PUBLIC) checkUrl(resMediaBaseUrl); }}\r\n            enterButton\r\n          />\r\n        }\r\n      />\r\n      <RowBase textAlign='right'\r\n        col1={ \r\n          <Button\r\n            type=\"primary\"\r\n            onClick={() => {\r\n              _uri.SaveApiBaseUrl(apiBaseUrl);\r\n              _uri.SaveMediaBaseUrl(mediaBaseUrl);\r\n              _uri.SaveResMediaBaseUrl(resMediaBaseUrl);\r\n            }}\r\n            style={{ width:\"100%\", maxWidth:\"100px\"}}\r\n            disabled={IS_PUBLIC}\r\n          >\r\n            Save\r\n          </Button>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n\r\n  function SettingFormLabel(props){\r\n    const style={\r\n      paddingTop:'4px',\r\n      fontWeight:'bold'\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <div style={{float:'left', ...style}}>{props.text}</div>\r\n        <div style={{float:'right', ...style}}>:</div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nfunction ActionButton(props){\r\n  const msgStr = props.eventMsgs.map(e => e.message).join('\\n');\r\n  return(\r\n    <>\r\n    <div style={{display:\"flex\", flexDirection:\"row\", marginBottom:\"5px\"}}>\r\n      <div style={{width:\"130px\"}}>\r\n      <Button\r\n        icon={props.icon}\r\n        type=\"primary\"\r\n        loading={props.isLoading}\r\n        onClick={props.execute}\r\n        block={true}\r\n        style={{ width:\"100%\", maxWidth:\"140px\"}}\r\n        disabled={IS_PUBLIC}\r\n      >\r\n        {props.text}\r\n      </Button>\r\n      </div>\r\n      <div style={{\r\n        height:\"32px\", \r\n        flex:\"auto\", \r\n        marginLeft:\"10px\",\r\n        display:\"flex\",\r\n        justifyContent: \"flex-end\",\r\n        flexDirection: \"column\"\r\n      }}>\r\n        <Progress strokeLinecap=\"square\" percent={props.percent} />\r\n      </div>\r\n    </div>\r\n    <div hidden={props.eventMsgs.length === 0}\r\n      style={{display:\"flex\", flexDirection:\"row\", marginBottom:\"5px\"}}>\r\n      <div style={{width:\"130px\"}}></div>\r\n      <div style={{\r\n        //height:\"32px\", \r\n        flex:\"auto\",\r\n        marginLeft:\"10px\",\r\n        paddingRight:\"32px\"\r\n      }}>\r\n        <ScrollToBottom className={ROOT_CSS}>\r\n          {props.eventMsgs.map(e => <p style={{marginBottom:\"0.2em\"}}>{e.message}</p>)}\r\n        </ScrollToBottom>\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction RowBase(props){\r\n  const style = {\r\n    display:\"flex\", \r\n    flexDirection:\"row\", \r\n    marginBottom:\"5px\",\r\n    textAlign: props.textAlign ?? 'left'\r\n  };\r\n\r\n  return(\r\n    <>\r\n    <div style={style}>\r\n      <div style={{width:\"130px\"}}>\r\n        {props.col0}\r\n      </div>\r\n      <div style={{\r\n        height:\"32px\", \r\n        flex:\"auto\", \r\n        marginLeft:\"10px\",\r\n        display:\"flex\",\r\n        justifyContent: \"flex-end\",\r\n        flexDirection: \"column\"\r\n      }}>\r\n        {props.col1}\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\n\r\nimport { Layout, Menu, Drawer, Button, Row, Col, Modal } from 'antd';\r\nimport {\r\n  DesktopOutlined, TeamOutlined, PartitionOutlined, TagsOutlined,\r\n  PlusOutlined, MinusOutlined, ConsoleSqlOutlined, SearchOutlined,  \r\n  LaptopOutlined, SettingOutlined, MenuOutlined\r\n} from '@ant-design/icons';\r\nimport TextArea from 'antd/lib/input/TextArea';\r\nimport queryString from 'query-string';\r\nimport useSWR, { SWRConfig } from 'swr';\r\n\r\nimport SelfComps from './SelfComps/SelfComps';\r\nimport Albums from './Albums/Albums';\r\nimport Genres from './Genres/Genres';\r\nimport FileManagement from './FileManagement/FileManagement';\r\nimport Setting from './Setting/Setting';\r\nimport withMyAlert from \"./_shared/HOCs/withMyAlert\";\r\nimport * as Helper from \"./_utils/Helper\";\r\nimport * as _uri from \"./_utils/UriHelper\";\r\nimport { DesktopOnly, MobileOnly } from './_utils/Display';\r\nimport { IS_PUBLIC, API_URL, STORAGE_URL, SAS_TOKEN } from \"./_utils/Config\";\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\n\r\nfunction AppMasterPage(props) {\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n  const [collapseSider, setCollapseSider] = useState(false);\r\n\r\n  const [selectedTiers, setSelectedTiers] = useState([]);\r\n  useEffect(() =>{\r\n    const storedSelectedTiers = window.localStorage.getItem('selectedTiers');\r\n    if(storedSelectedTiers != null)\r\n      setSelectedTiers(JSON.parse(storedSelectedTiers));\r\n    else\r\n      setSelectedTiers(['N','0','1','2','3']);\r\n  },[]);\r\n\r\n  const handleTierChange = (tier) => {\r\n    const newTier = selectedTiers.includes(tier)\r\n      ? selectedTiers.filter(e => e !== tier)\r\n      : [...selectedTiers, tier];\r\n\r\n    setSelectedTiers(newTier);\r\n\r\n    window.localStorage.setItem('selectedTiers', JSON.stringify(newTier));\r\n  }\r\n\r\n  const querStr = queryString.parse(props.location.search).query ?? \"\";\r\n  const pageStr = queryString.parse(props.location.search).page ?? 0;\r\n  const rowStr = queryString.parse(props.location.search).row ?? 0;\r\n  const pathStr = queryString.parse(props.location.search).path ?? \"\";\r\n\r\n  const queryParts = {\r\n    query: querStr,\r\n    page: pageStr,\r\n    row: rowStr,\r\n    path: pathStr\r\n  };\r\n\r\n  const { page, selectedMenu } = (() => {\r\n    function compose(page, selectedMenu) {\r\n      return {\r\n        page: page,\r\n        selectedMenu: selectedMenu\r\n      };\r\n    }\r\n    if(props.page === \"Sc\"){\r\n      return compose(\r\n        <SelfComps queryParts={queryParts} />\r\n        , '1');\r\n    }\r\n    else if (props.page === \"Albums\") {\r\n      return compose(\r\n        <Albums queryParts={queryParts} selectedTiers={selectedTiers} />\r\n        , '2');\r\n    }\r\n    else if (props.page === \"Artists\") {\r\n      return compose(\r\n        <Genres page={props.page} history={props.history} />\r\n        , '3');\r\n    }\r\n    else if (props.page === \"Genres\") {\r\n      return compose(\r\n        <Genres page={props.page} history={props.history} />\r\n        , '4');\r\n    }\r\n    else if (props.page === \"FileManagement\") {\r\n      const path = queryString.parse(props.location.search).path ?? \"\";\r\n      return compose(<FileManagement path={path} />, '');\r\n    }\r\n    else if (props.page === \"Setting\") {\r\n      return compose(\r\n        <Setting page={props.page} />\r\n        , '5');\r\n    }\r\n  })();\r\n\r\n  const queryHandler = {\r\n    search: function (query) {\r\n      queryHandler.goToAlbumList(query);\r\n    },\r\n    plus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      const currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryPlus);\r\n      const newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    minus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      const currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryMinus);\r\n      const newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    goToAlbumList: function (query) {\r\n      let currentUrlParams = new URLSearchParams(window.location.search);\r\n      currentUrlParams.set('query', query);\r\n      props.history.push(\"Albums?\" + currentUrlParams.toString());\r\n    }\r\n  }\r\n\r\n  const styleMenuItem = { fontWeight:600 };\r\n\r\n  const menuContent = (\r\n    <>\r\n      <div className=\"logo\">\r\n        {/* <span>{props.page === \"Albums\" ? albumCount : ''}</span> */}\r\n      </div>\r\n      <QueryEditor query={querStr} onOk={(query) => queryHandler.goToAlbumList(query)} />\r\n      <Menu theme=\"dark\" defaultSelectedKeys={[selectedMenu]} defaultOpenKeys={[\"sub1\"]} mode=\"inline\">\r\n        {!IS_PUBLIC ? \r\n          <Menu.Item key=\"1\">\r\n            <Link to=\"/sc\">\r\n              <LaptopOutlined />\r\n              <span style={styleMenuItem}>Self Comp</span>\r\n            </Link>\r\n          </Menu.Item>\r\n        : ''}\r\n        <Menu.Item key=\"2\">\r\n          <Link to=\"/albums\">\r\n            <DesktopOutlined />\r\n            <span style={styleMenuItem}>Albums</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"3\">\r\n          <Link to=\"/artists\">\r\n            <TeamOutlined />\r\n            <span style={styleMenuItem}>Artists</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"4\">\r\n          <Link to=\"/genres\">\r\n            <PartitionOutlined />\r\n            <span style={styleMenuItem}>Genres</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <SubMenu key=\"sub1\" title={\r\n            <>\r\n              <TagsOutlined />\r\n              <span style={styleMenuItem}>Tags</span>\r\n            </>\r\n          }\r\n        >\r\n          <TagMenuContainer onPlus={queryHandler.plus} onMinus={queryHandler.minus} querStr={querStr} />\r\n        </SubMenu>\r\n        <Menu.Item key=\"5\">\r\n          <Link to=\"/setting\">\r\n            <SettingOutlined />\r\n            <span style={styleMenuItem}>Setting</span>\r\n          </Link>\r\n        </Menu.Item>\r\n      </Menu>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <SWRConfig value={{ revalidateOnFocus: false, fetcher: (uri) => fetch(uri).then(res => res.json()) }}>\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <MobileOnly>\r\n          <Layout className=\"mobile-header\">\r\n            <Row>\r\n              <Col span={12}></Col>\r\n              <Col span={10}>\r\n                {!IS_PUBLIC ? <TierChecklist onTierChange={handleTierChange} selectedTiers={selectedTiers} /> : <></> }\r\n              </Col>\r\n              <Col span={2} className=\"hamburger-container\" onClick={() => setShowDrawer(true)}>\r\n                <MenuOutlined className=\"hamburger\" />\r\n              </Col>\r\n            </Row>\r\n          </Layout>\r\n          <Drawer\r\n            placement=\"right\"\r\n            closable={false}\r\n            onClose={() => setShowDrawer(false)}\r\n            visible={showDrawer}\r\n          >\r\n            {menuContent}\r\n          </Drawer>\r\n        </MobileOnly>\r\n        <DesktopOnly>\r\n          <Sider collapsible collapsed={collapseSider} onCollapse={(event) => setCollapseSider(event)}>\r\n            {menuContent}\r\n          </Sider>\r\n        </DesktopOnly>\r\n\r\n        <Layout className=\"site-layout\">\r\n          <Content>\r\n            <MobileOnly>\r\n              <div style={{ paddingTop: \"5x\" }}>Padding for mobile</div>\r\n            </MobileOnly>\r\n            <div className=\"site-layout-background\" style={{ paddingTop: 25, paddingLeft: 10, paddingRight: 10, minHeight: 360 }}>\r\n              {page}\r\n            </div>\r\n          </Content>\r\n          <Footer style={{ textAlign: 'center' }}>-----------------</Footer>\r\n        </Layout>\r\n      </Layout>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(AppMasterPage));\r\n\r\nfunction TagMenuContainer(props) {\r\n  const { data: tags, error } = useSWR(_uri.GetTagVMs());\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!tags) { return <div>loading...</div>; }\r\n\r\n  return (\r\n    <>\r\n      {tags.map((tag, index) => (<TagMenuItem key={tag.name} tag={tag} onPlus={props.onPlus} onMinus={props.onMinus} selectStatus={getSelectStatus(tag.name, props.querStr)} />))}\r\n    </>\r\n  );\r\n\r\n  function getSelectStatus(tagName, query) {\r\n    const queryArr = query.split(',');\r\n    const result = queryArr.filter((str) => str.toLowerCase().includes(\"tag:\" + tagName.toLowerCase())).length > 0 ? \"plus\" :\r\n      queryArr.filter((str) => str.toLowerCase().includes(\"tag!\" + tagName.toLowerCase())).length > 0 ? \"minus\" :\r\n        \"none\";\r\n\r\n    return result;\r\n  }\r\n}\r\n\r\nfunction TagMenuItem(props) {\r\n  const encodedQuery = encodeURIComponent(props.tag.query);\r\n  const plusBackground = props.selectStatus === \"plus\" ? \"#1890ff\" : \"\";\r\n  const minusBackground = props.selectStatus === \"minus\" ? \"#1890ff\" : \"\";\r\n\r\n  return (\r\n    <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\", height:\"28px\", marginTop:\"0px\", marginBottom:\"0px\" }}>\r\n      <Row>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onPlus(props.tag.name)}><PlusOutlined style={{ marginRight: \"0px\", backgroundColor: plusBackground }} /></Col>\r\n        <Link to={\"/albums?query=\" + encodedQuery} >\r\n          <Col span={14}>\r\n            <span style={{ fontSize: \"12px\", opacity:0.8 }}>{props.tag.name}</span>\r\n          </Col>\r\n        </Link>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onMinus(props.tag.name)}><MinusOutlined style={{ marginRight: \"0px\", backgroundColor: minusBackground }} /></Col>\r\n      </Row>\r\n    </li>\r\n  );\r\n}\r\n\r\nfunction QueryEditor(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(props.query);\r\n  }, [props.query]);\r\n\r\n  function handleOk() {\r\n    setVisible(false);\r\n    props.onOk(query);\r\n  }\r\n\r\n  return (\r\n    <div style={{ paddingLeft: \"24px\" }}>\r\n      <Button type=\"link\" onClick={() => setVisible(true)} style={{ width: \"90%\", textAlign: \"left\", padding: \"0px\" }}>\r\n        <ConsoleSqlOutlined /> \r\n        <span style={{ fontWeight:600 }}> Query Editor </span>\r\n      </Button>\r\n      <Modal\r\n        visible={visible}\r\n        onCancel={() => setVisible(false)}\r\n        closable={false}\r\n        footer={\r\n          <Button type=\"primary\" onClick={handleOk}>\r\n            <SearchOutlined />Search\r\n          </Button>\r\n        }\r\n      >\r\n        <TextArea\r\n          onChange={(event) => setQuery(event.target.value)}\r\n          value={query}\r\n        //autoSize={{ minRows: 2, maxRows: 5 }} //Enabling this will cause react warning\r\n        />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction TierChecklist(props){\r\n  const getButtonDisplay = (att, tier) => {\r\n    const isTierMatch = props.selectedTiers.includes(tier);\r\n    if (att === \"type\") {\r\n      return isTierMatch ? \"primary\" : \"link\";\r\n    }\r\n    else {\r\n      return isTierMatch;\r\n    }\r\n  };\r\n\r\n  return(\r\n    <Row>\r\n      <Col span={2} ></Col>\r\n      <Col span={4} className=\"headerbutton-container\">\r\n        <Button onClick={() => props.onTierChange('0')} type={getButtonDisplay(\"type\", '0')} ghost={getButtonDisplay(\"ghost\", '0')} style={{ width: \"100%\" }}>0</Button>\r\n      </Col>\r\n      <Col span={4} className=\"headerbutton-container\">\r\n        <Button onClick={() => props.onTierChange('1')} type={getButtonDisplay(\"type\", '1')} ghost={getButtonDisplay(\"ghost\", '1')} style={{ width: \"100%\" }}>1</Button>\r\n      </Col>\r\n      <Col span={4} className=\"headerbutton-container\">\r\n        <Button onClick={() => props.onTierChange('2')} type={getButtonDisplay(\"type\", '2')} ghost={getButtonDisplay(\"ghost\", '2')} style={{ width: \"100%\" }}>2</Button>\r\n      </Col>\r\n      <Col span={4} className=\"headerbutton-container\">\r\n        <Button onClick={() => props.onTierChange('3')} type={getButtonDisplay(\"type\", '3')} ghost={getButtonDisplay(\"ghost\", '3')} style={{ width: \"100%\" }}>3</Button>\r\n      </Col>\r\n      <Col span={4} className=\"headerbutton-container\">\r\n        <Button onClick={() => props.onTierChange('N')} type={getButtonDisplay(\"type\", 'N')} ghost={getButtonDisplay(\"ghost\", 'N')} style={{ width: \"100%\" }}>N</Button>\r\n      </Col>\r\n    </Row>\r\n  );\r\n}","import React from 'react';\r\nimport { HashRouter, Route, Switch, Redirect } from 'react-router-dom';\r\n\r\nimport 'antd/dist/antd.css';\r\n\r\nimport './App.scss';\r\nimport AppMasterPage from './AppMasterPage';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route exact path=\"/\" ><Redirect to=\"/genres\" /></Route>\r\n          <Route exact path=\"/sc\" ><AppMasterPage page=\"Sc\" /></Route>\r\n          <Route exact path=\"/albums\" ><AppMasterPage page=\"Albums\" /></Route>\r\n          {/* <Route exact path=\"/add\" ><AppMasterPage page=\"AlbumAddEdit\" /></Route> */}\r\n          <Route exact path=\"/artists\" ><AppMasterPage page=\"Artists\" /></Route>\r\n          <Route exact path=\"/genres\" ><AppMasterPage page=\"Genres\" /></Route>\r\n          <Route exact path=\"/filemanagement\" ><AppMasterPage page=\"FileManagement\" /></Route>\r\n          <Route exact path=\"/setting\" ><AppMasterPage page=\"Setting\" /></Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { setChonkyDefaults } from 'chonky';\r\nimport { ChonkyIconFA } from 'chonky-icon-fontawesome';\r\n\r\nconst startApp = () => {\r\n  setChonkyDefaults({ iconComponent: ChonkyIconFA });\r\n  ReactDOM.render(<App />, document.getElementById('root'));\r\n  serviceWorker.unregister();\r\n}\r\n\r\nif (window.cordova) {\r\n  document.addEventListener('deviceready', startApp, false);\r\n}\r\nelse {\r\n  startApp();\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA","module.exports = __webpack_public_path__ + \"static/media/loading.d47e58c7.gif\";"],"sourceRoot":""}