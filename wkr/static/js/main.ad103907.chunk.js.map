{"version":3,"sources":["_resources/loading.gif","_shared/HOCs/withMyAlert.js","_utils/Helper.js","_utils/Config.js","_utils/UriHelper.js","_shared/Displays/MyAlbumCard.js","_shared/Modals/TextDialog.js","Albums/ReaderModalContextMenu.js","Albums/ReaderModalChapterDrawer.js","Albums/ReaderModal.js","_shared/Editors/MyInputTextbox.js","_shared/Editors/MyInputStar.js","_shared/Editors/MyInputRadio.js","_shared/Editors/MyInputCheck.js","_shared/Editors/MyInputMulticheck.js","Albums/EditModal.js","Albums/Albums.js","_utils/DataSource.js","_shared/Editors/MyInputButton.js","AddEdit/AddEdit.js","Genres/Genres.js","_utils/Display.js","FileManagement/FileManagement.js","AppMasterPage.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","withMyAlert","OriginalComponent","props","popInfo","title","stringContent","objContent","Modal","info","content","JSON","stringify","onOk","width","popError","error","popApiError","response","status","statusText","data","warning","firstLetterLowerCase","string","charAt","toLowerCase","slice","getPercent100","value","maxValue","fraction","API_URL","STORAGE_URL","SAS_TOKEN","crud","file","fullPage","albumId","alRelPathBase64","cachePrevention","endsWith","Number","Date","resizedPage","librelPathBase64","maxSize","EditMenuInbetweener","onVisible","ColorFromIndex","tier","e","rgb","r","g","b","alpha","BorderFromIndex","FlagIcon","flagStyle","height","marginRight","marginBottom","language","GB","style","JP","CN","ID","handler","view","onView","albumCm","edit","onEdit","useInView","threshold","rootMargin","ref","inView","menu","paddingBottom","position","textAlign","display","maxWidth","borderLeft","isRead","overlay","trigger","disabled","showContextMenu","onClick","objectFit","src","_uri","coverInfo","uncPathEncoded","alt","left","top","borderRight","borderBottom","right","bottom","color","lineHeight","languages","map","item","i","key","backgroundColor","borderTop","lastPageIndex","Helper","pageCount","note","className","fontSize","fullTitle","TextDialog","useState","setValue","useEffect","initialValue","visible","footer","centered","closable","onCancel","onClose","bodyStyle","border","TextArea","onChange","event","target","rows","type","btnText","ReaderModalContextMenu","jumpValue","setJumpValue","changeJumpValue","val","Math","min","max","showRenameModal","setShowRenameModal","showConfirmDelete","setShowConfirmDelete","tierDisplay","setTierDisplay","undefined","span","count","onTierChange","onRecount","FileSyncOutlined","marginTop","padding","WebkitBoxSizing","borderRadius","onJump","ArrowRightOutlined","onUndoJump","ArrowLeftOutlined","EditOutlined","DeleteOutlined","pageName","newName","onRename","onDelete","confirm","axios","require","default","chapters","setChapters","get","then","catch","chapterTitle","console","log","icon","ExclamationCircleOutlined","okText","okType","cancelText","encodedChapterTitle","encodeURIComponent","delete","onChapterDeleteSuccess","filter","c","placement","chapter","index","Item","onJumpToPage","pageIndex","maxHeight","pageUncPath","getOverlayStyle","isGrey","button","boxSizing","getGuideLabel","text","margin","textShadow","PageDisplay","styleByRotation","isLandscape","transform","styleShow","styleHide","extension","IsVideo","pageInfo","autoPlay","loop","id","queue","loadingImg","lpi","pages","indexes","cPageI","pPageI","triad","zenpenIndex","chuhenIndex","kouhenIndex","apm","setApm","orientation","fileInfos","length","targetPage","pageHandler","jumpTo","document","addEventListener","handleKeyDown2","removeEventListener","keyCode","close","page","renameObj","number","maxIndex","newPPageI","newCPageI","compose","newTriad","pageCeil","modifier","pagesLen","modifiedPages","newPageInfo","post","rename","onPageDeleteSuccess","albumHandler","tierChange","put","recount","setShowContextMenu","showDrawer","setShowDrawer","buttonHandler","rightTop","rightMid","rightBot","midTop","midMid","midBot","leftTop","leftMid","leftBot","swipeHandler","useSwipeable","onSwipedLeft","eventData","onSwipedRight","showGuide","overlayStyle","buttonStyle","side","minHeight","window","innerHeight","mid","currentPageInfo","zenpenPage","chuhenPage","kouhenPage","isOpen","zIndex","name","newPageCount","MyInputTextbox","gutter","sm","label","placeholder","MyInputStar","MyInputRadio","Group","items","MyInputCheck","checked","MyInputMulticheck","includes","ghost","lodash","useSWR","albumInfo","aiError","path","album","category","artists","tags","flags","cover","isWip","entryDate","albumVm","setAlbumVm","handlers","albumVmChange","newAlbumVm","cleanedValue","split","_helper","pull","push","ok","cancel","editFiles","onEditFiles","refresh","onRefresh","temp","tabIndex","role","aria-labelledby","stopPropagation","aria-label","viewBox","focusable","data-icon","fill","aria-hidden","d","join","categories","orientations","withRouter","scrollTo","albumCms","setAlbumCms","handleRefresh","Promise","resolve","reject","queryParts","row","query","encodedQuery","filteredAlbumCms","setFilteredAlbumCms","newFiltered","tierFilter","a","readerModalIsOpen","setReaderModalIsOpen","selectedAlbumId","setSelectedAlbumId","readerHandler","aIndex","editModalIsOpen","setEditModalIsOpen","editedAlbumId","setEditedAlbumId","crudHandler","pageDeleteSuccess","chapterDeleteSuccess","editHandler","editedAlbumVm","newAlbumCms","editedAlbumVmIndex","findIndex","history","lg","md","xs","find","aCm","GetTags","FetchAlbumInfo","GetCategories","GetOrientations","GetLanguages","fetch","method","res","json","MyInputButton","AddEdit","webkit","Files","setFiles","AlbumVm","Tags","setTags","Categories","setCategories","Orientations","setOrientations","Languages","setLanguages","handleAlbumVmChange","DataSource","_tag","_categories","_orientations","_languages","getElementById","onchange","files","justify","align","webkitdirectory","directory","multiple","Genres","endpoint","albumCGroups","acg","paddingTop","DesktopOnly","children","useMediaQuery","minWidth","MobileOnly","renameAction","defineFileAction","requiresSelection","toolbar","contextMenu","ChonkyIconName","code","fileActions","trash","folder","ChonkyActions","EnableGridView","EnableListView","UploadFiles","CreateFolder","postMoveFile","param","onSuccess","message","FileComparison","file1","srcInfo","file2","dstInfo","newParam","overwrite","defaultTextDialog","textDialog","setTextDialog","handleRename","oldVal","moveParam","viewModel","subDir","dst","setViewModel","prev","dirIdx","fsNodes","n","owIdx","childs","f","splice","fileIdx","handleCreateFolder","unshift","size","nodeType","rootChain","isDir","dirChains","chonkyModels","setChonkyModels","newModels","thumbnailUrl","childrenCount","selectable","draggable","dndBackend","TouchBackend","HTML5Backend","DndProvider","backend","darkMode","folderChain","disableDragAndDropProvider","disableDefaultFileActions","onFileAction","cModel","state","selectedFiles","typeText","dir","delObj","vAlbumId","vSubDir","vFileName","fileName","newFsNodes","forEach","prevState","EndDragNDrop","payload","draggedFile","destination","srcName","srcFsNode","srcDir","dstDir","sort","compare","nameA","nameB","prevViewModel","OpenFiles","targetFile","targetSubDir","newDirChains","OpenParentFolder","f1","f2","class","getStyle","toFixed","createdDate","moment","format","fontWeight","Content","Layout","Header","Footer","Sider","SubMenu","Menu","collapseSider","setCollapseSider","setAlbumCount","setTierFilter","handleSetTierFilter","querStr","queryString","parse","location","search","pageStr","rowStr","selectedMenu","onAlbumCountChange","queryHandler","correctedQuery","pattern","word","goToAlbumList","plus","tagName","targetQueryPlus","targetQueryMinus","newQueries","newQueryString","minus","currentUrlParams","URLSearchParams","set","toString","actionHandler","reload","rescan","menuContent","QueryEditor","theme","defaultSelectedKeys","defaultOpenKeys","mode","to","DesktopOutlined","TeamOutlined","PartitionOutlined","TagsOutlined","TagMenuContainer","onPlus","onMinus","DatabaseOutlined","paddingLeft","paddingRight","ReloadOutlined","SyncOutlined","getButtonDisplay","att","isTierMatch","revalidateOnFocus","fetcher","uri","collapsible","collapsed","onCollapse","tag","TagMenuItem","selectStatus","getSelectStatus","queryArr","str","plusBackground","minusBackground","PlusOutlined","MinusOutlined","setVisible","setQuery","ConsoleSqlOutlined","SearchOutlined","App","exact","Boolean","hostname","match","startApp","setChonkyDefaults","iconComponent","ChonkyIconFA","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister","cordova"],"mappings":"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","file":"static/js/main.ad103907.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/loading.d47e58c7.gif\";","import React from 'react';\r\nimport { Modal } from 'antd';\r\n\r\nconst withMyAlert = OriginalComponent => ({ ...props }) => {\r\n  const width = 500;\r\n\r\n  function popInfo(title, stringContent, objContent) {\r\n    Modal.info({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {objContent ? JSON.stringify(objContent, null, 2) : \"\"}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popError(title, stringContent, objContent) {\r\n    Modal.error({\r\n      title: (title),\r\n      content: (\r\n        <span>\r\n          {stringContent}\r\n          {objContent ? JSON.stringify(objContent, null, 2) : \"\"}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    });\r\n  }\r\n\r\n  function popApiError(error) {\r\n    if (error.response == null) {\r\n      Modal.error(JSON.stringify(error));\r\n      return;\r\n    }\r\n    const { status, statusText, data } = error.response;\r\n\r\n    const content = {\r\n      title: `${status} - ${statusText}`,\r\n      content: (\r\n        <span>\r\n          {JSON.stringify(data, null, 2)}\r\n        </span>\r\n      ),\r\n      onOk() { },\r\n      width: width\r\n    };\r\n\r\n    if (status >= 400 && status < 500) {\r\n      Modal.warning(content);\r\n    }\r\n    else {\r\n      Modal.error(content);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OriginalComponent\r\n      {...props}\r\n      popInfo={popInfo}\r\n      popError={popError}\r\n      popApiError={popApiError}\r\n    />\r\n  )\r\n}\r\n\r\nexport default withMyAlert;","\r\nexport function firstLetterLowerCase(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nexport function apiErrorHandler(error) {\r\n  if (typeof error.response !== undefined) {\r\n    alert(JSON.stringify(error.response, null, \"\\t\"))\r\n  }\r\n  else {\r\n    alert(JSON.stringify(error, null, \"\\t\"));\r\n  }\r\n}\r\n\r\nexport function getPercent100(value, maxValue) {\r\n  let fraction = (value / maxValue) * 100;\r\n  let result = fraction <= 100 ? fraction : 100;\r\n  return result;\r\n}\r\n\r\nexport function contains(target, pattern) {\r\n  var value = 0;\r\n  pattern.forEach(function (word) {\r\n    value = value + target.includes(word);\r\n  });\r\n  return (value === 1);\r\n}\r\n\r\nexport function clamp(number, min, max) {\r\n  return Math.max(min, Math.min(number, max));\r\n}\r\n\r\nexport function clickReport(event) {\r\n  const result = {\r\n    ecy: event.clientY,\r\n    epy: event.pageY,\r\n    ety: event.touches && event.touches[0] ? event.touches[0].clientY : null,\r\n    echy: event.changedTouches && event.changedTouches[0] ? event.changedTouches[0].clientY : null\r\n  };\r\n  return result;\r\n}\r\n\r\nexport var global = {\r\n\r\n};","//WARNING can't figure out how to read .env file in production\r\n//require('dotenv').config();\r\n//const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n//const API_URL = \"http://192.168.1.4:5000/\";\r\n//const API_URL = \"http://localhost:57389/\";\r\nconst API_URL = \"https://wkrapi.azurewebsites.net/\";\r\nconst IS_PUBLIC = true;\r\n\r\nconst STORAGE_URL = \"https://wkrstorage.file.core.windows.net/library/\";\r\nconst SAS_TOKEN = \"?sv=2020-02-10&ss=f&srt=o&sp=r&se=2022-03-08T01:36:14Z&st=2021-05-09T17:36:14Z&spr=https&sig=zNFZiJ0sRJw%2B0wbG5ndCoJF%2FitA03CzK4CNZYiXLvoI%3D\";\r\n\r\nexport { API_URL, IS_PUBLIC, STORAGE_URL, SAS_TOKEN }","import { IS_PUBLIC, API_URL, STORAGE_URL, SAS_TOKEN } from \"./Config\";\r\n\r\nconst crudController = IS_PUBLIC ? \"PublicCrud\" : \"Crud\";\r\nconst fileController = IS_PUBLIC ? \"PublicFile\" : \"File\";\r\nconst crud = `${API_URL}${crudController}/`;\r\nconst file = `${API_URL}${fileController}/`;\r\nconst media = `${API_URL}Media/`;\r\n\r\n//const placeholder = '[Sam] UFC Posters/71wnOWqFfTL._AC_SY679_.jpg';\r\n\r\nconst fullPage = (albumId, alRelPathBase64) => {\r\n  if (IS_PUBLIC) {\r\n\r\n    const isVideo = alRelPathBase64.endsWith(\".mp4\");\r\n    const cachePrevention = isVideo ? `&xyz=${Number(new Date())}` : \"\";\r\n\r\n    return `${STORAGE_URL}${albumId}/${alRelPathBase64}${SAS_TOKEN}${cachePrevention}`;\r\n  }\r\n  return `${media}StreamPage?albumId=${albumId}&alRelPathBase64=${alRelPathBase64}`;\r\n}\r\n\r\nconst resizedPage = (librelPathBase64, maxSize) => {\r\n  if (IS_PUBLIC) {\r\n    return `${STORAGE_URL}${librelPathBase64}${SAS_TOKEN}`;\r\n  }\r\n  return `${media}StreamResizedImage?librelPathBase64=${librelPathBase64}&maxSize=${maxSize}`;\r\n}\r\n\r\nexport { crud, file, fullPage, resizedPage };","import React, { useState, useEffect, useCallback } from 'react';\r\n\r\nimport { Dropdown } from 'antd';\r\nimport { useInView } from 'react-intersection-observer';\r\nimport Flags from 'country-flag-icons/react/3x2';\r\n\r\nimport withMyAlert from '../HOCs/withMyAlert';\r\nimport * as Helper from '../../_utils/Helper';\r\nimport * as _uri from '../../_utils/UriHelper';\r\n\r\nfunction MyAlbumCard(props) {\r\n  const handler = {\r\n    view: function () {\r\n      props.onView(props.albumCm)\r\n    },\r\n\r\n    edit: function () {\r\n      props.onEdit(props.albumCm.albumId);\r\n      //#region LEGACY\r\n      //Added delay so onMouseUp event won't be triggered on the popup element\r\n      //Otherwise it will open default browser context menu\r\n      //setTimeout(() => { props.onEdit(props.albumCm.albumId); }, 20);\r\n      //#endregion\r\n    },\r\n  }\r\n\r\n  //#region LEGACY menu\r\n  // const menu = (() => {\r\n  //   const style = { fontSize: 16 };\r\n  //   return (\r\n  //     <Menu>\r\n  //       <Menu.Item key=\"1\" onClick={handler.edit} style={style}>\r\n  //         <EditOutlined style={style} />Edit\r\n  //       </Menu.Item>\r\n  //       <Menu.Item key=\"2\" onClick={handler.delete} style={style}>\r\n  //         <DeleteOutlined style={style} />Delete\r\n  //       </Menu.Item>\r\n  //     </Menu>\r\n  //   )\r\n  // })();\r\n\r\n\r\n  //#endregion\r\n\r\n  //#region LEGACY Click Event\r\n  // const myClickEvent = useMyClickHandler(handler.edit, handler.view, {\r\n  //   shouldPreventDefault: true,\r\n  //   delay: 300,\r\n  // });\r\n\r\n  // const longPressCallback = useCallback(event => {\r\n  //   if (event.changedTouches && event.changedTouches[0]) {\r\n  //     console.log(\"callback\", event.changedTouches[0]);\r\n  //     if (Helper.global.ect0.screenY !== event.changedTouches[0].screenY) {\r\n  //       console.log(\"not same\", Helper.global.ect0.screenY, event.changedTouches);\r\n  //     }\r\n  //     else {\r\n  //       console.log(\"same\");\r\n  //     }\r\n  //     return;\r\n  //   }\r\n  //   handler.edit();\r\n  // }, []);\r\n\r\n  // const bind = useLongPress(longPressCallback, {\r\n  //   onStart: event => {\r\n  //     if (event.changedTouches && event.changedTouches[0]) {\r\n  //       console.log(\"onStart\", event.changedTouches[0]);\r\n  //       Helper.global.ect0 = {\r\n  //         pageX: event.changedTouches[0].pageX,\r\n  //         screenY: event.changedTouches[0].screenY,\r\n  //       };\r\n  //       return;\r\n  //     }\r\n  //   },\r\n  //   onFinish: event => { },\r\n  //   onCancel: event => {\r\n  //     //console.log(\"Press canceled\", Helper.clickReport(event));\r\n  //     if (event.changedTouches && event.changedTouches[0]) { return; }\r\n  //     if (event.button === 2) { handler.edit(); return; }\r\n  //     handler.view();\r\n  //   },\r\n  //   threshold: 500,\r\n  //   captureEvent: true,\r\n  //   detect: 'both',\r\n  // });\r\n  //#endregion\r\n\r\n  const [ref, inView, entry] = useInView({\r\n    threshold: 0,\r\n    rootMargin: \"300px 0px 300px 0px\"\r\n  });\r\n\r\n  const absoluteH = \"150px\";\r\n\r\n  const menu = <EditMenuInbetweener onVisible={handler.edit}></EditMenuInbetweener>;\r\n  return (\r\n    <div ref={ref} style={{ paddingBottom: '8px', position: \"relative\", textAlign: \"center\" }}>\r\n      <div style={{ height: absoluteH, width: \"100%\" }} >\r\n        <div style={{\r\n          display: \"inline-block\", position: \"relative\",\r\n          height: absoluteH, width: \"100%\", maxWidth: absoluteH,\r\n          borderLeft: !props.albumCm.isRead ? \"1px solid #ddbe14\" : \"\",\r\n        }}>\r\n          <Dropdown overlay={menu} trigger={['contextMenu']} disabled={!props.showContextMenu}>\r\n            <img\r\n              //onContextMenu={(e) => { e.preventDefault(); }}\r\n              onClick={handler.view}\r\n              style={{\r\n                objectFit: \"contain\",\r\n                height: \"100%\", width: \"100%\"\r\n              }}\r\n              src={inView ? _uri.resizedPage(props.albumCm.coverInfo.uncPathEncoded, 150) : \"\"}\r\n              alt=\"img\"\r\n            />\r\n          </Dropdown>\r\n\r\n          {!props.albumCm.isRead ?\r\n            <div style={{\r\n              position: \"absolute\",\r\n              height: 0,\r\n              width: 0,\r\n              left: \"0px\",\r\n              top: \"0px\",\r\n              borderLeft: \"15px solid #ddbe14\",\r\n              borderRight: \"15px solid transparent\",\r\n              borderBottom: \"15px solid transparent\"\r\n            }} /> : \"\"\r\n          }\r\n          <div style={{\r\n            position: \"absolute\",\r\n            right: \"3px\",\r\n            bottom: \"3px\",\r\n            color: \"white\",\r\n            lineHeight: \"0px\"\r\n          }}>\r\n            {props.albumCm.languages.map((item, i) => <FlagIcon language={item} key={i} />)}\r\n          </div>\r\n          <div style={{\r\n            position: \"absolute\",\r\n            right: \"0px\",\r\n            bottom: \"0px\",\r\n            height: \"100%\",\r\n            width: \"2px\"\r\n          }}>\r\n            {[3, 2, 1].map((e, i) =>\r\n              <div key={`tierBar-${i}`}\r\n                style={{\r\n                  width: \"100%\",\r\n                  height: \"33%\",\r\n                  backgroundColor: ColorFromIndex(props.albumCm.tier, e),\r\n                  borderTop: BorderFromIndex(props.albumCm.tier, e)\r\n                }} />\r\n            )}\r\n          </div>\r\n          <div style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            bottom: \"0px\",\r\n            width: \"100%\",\r\n            height: \"3px\",\r\n            backgroundColor: \"white\",\r\n            display: props.albumCm.lastPageIndex > 0 ? \"block\" : \"none\"\r\n          }}>\r\n            <div style={{\r\n              backgroundColor: \"DodgerBlue\",\r\n              height: \"100%\",\r\n              width: `${Helper.getPercent100(props.albumCm.lastPageIndex + 1, props.albumCm.pageCount)}%`\r\n            }} />\r\n          </div>\r\n          {props.albumCm.note !== null && props.albumCm.note !== \"\" ?\r\n            <div className=\"album-flag\">\r\n              {props.albumCm.note}\r\n            </div> : \"\"\r\n          }\r\n          <div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <span style={{ fontSize: '12px', lineHeight: 1.1 }}>\r\n        {props.albumCm.fullTitle}\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction EditMenuInbetweener(props) {\r\n  props.onVisible();\r\n  return (<></>)\r\n}\r\n\r\nfunction ColorFromIndex(tier, e) {\r\n  const top = { r: 34, g: 193, b: 195 };\r\n  const mid = { r: 142, g: 190, b: 121 };\r\n  const bot = { r: 253, g: 187, b: 45 };\r\n\r\n  const rgb = e === 3 ? top : e === 2 ? mid : bot;\r\n  const alpha = tier < e ? 0 : 1;\r\n\r\n  return `rgba(${rgb.r},${rgb.g},${rgb.b},${alpha})`;\r\n}\r\n\r\nfunction BorderFromIndex(tier, e) {\r\n  return tier > e && (e === 1 || e === 2) ? \"2px solid black\" : \"0px\";\r\n}\r\n\r\nfunction FlagIcon(props) {\r\n  const flagStyle = { width: \"18px\", height: \"12px\", marginRight: \"2px\", marginBottom: \"2px\" };\r\n\r\n  return (\r\n    <>\r\n      {\r\n        props.language === \"English\" ? <Flags.GB style={flagStyle} /> :\r\n          props.language === \"Japanese\" ? <Flags.JP style={flagStyle} /> :\r\n            props.language === \"Chinese\" ? <Flags.CN style={flagStyle} /> :\r\n              <Flags.ID style={flagStyle} />\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(MyAlbumCard);","import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Input } from 'antd';\r\n\r\nfunction TextDialog(props) {\r\n  const [value, setValue] = useState(\"\");\r\n  useEffect(() => { setValue(props.initialValue) }, [props.initialValue]);\r\n\r\n  return (\r\n    <Modal\r\n      visible={props.visible}\r\n      footer={null}\r\n      centered={true}\r\n      closable={false}\r\n      onCancel={() => props.onClose()}\r\n      style={{ maxWidth: 300, textAlign: \"center\" }}\r\n      bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n    >\r\n      <Input.TextArea value={value} onChange={(event) => setValue(event.target.value)} rows={2} />\r\n      <Button\r\n        style={{ width: \"100%\" }} type=\"primary\"\r\n        onClick={() => { props.onOk(value, props.initialValue); props.onClose(); }}\r\n      >\r\n        {props.btnText ?? 'Rename'}\r\n      </Button>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default TextDialog;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Modal, Button, Rate } from 'antd';\r\nimport { ArrowLeftOutlined, ArrowRightOutlined, DeleteOutlined, EditOutlined, FileSyncOutlined } from '@ant-design/icons';\r\n\r\nimport RenameDialog from '../_shared/Modals/TextDialog';\r\n\r\nfunction ReaderModalContextMenu(props) {\r\n  const [jumpValue, setJumpValue] = useState(0);\r\n  useEffect(() => {\r\n    setJumpValue(props.initialValue + 1);\r\n  }, [props.initialValue]);\r\n\r\n  const changeJumpValue = (val) => {\r\n    setJumpValue(Math.min(Math.max(val, 1), props.albumCm.pageCount));\r\n  };\r\n\r\n  const [showRenameModal, setShowRenameModal] = useState(false);\r\n  const [showConfirmDelete, setShowConfirmDelete] = useState(false);\r\n\r\n  const [tierDisplay, setTierDisplay] = useState(0);\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    setTierDisplay(props.albumCm.tier);\r\n  }, [props.albumCm]);\r\n\r\n  if (props.albumCm === undefined) { return (<></>); }\r\n\r\n  return (\r\n    <>\r\n      <Modal\r\n        visible={props.visible}\r\n        onCancel={props.onCancel}\r\n        footer={null}\r\n        closable={false}\r\n        centered={true}\r\n        style={{ maxWidth: 300 }}\r\n      //bodyStyle={{ border: \"1px solid black\" }}\r\n      >\r\n        <Row>\r\n          <Col span={24} style={{ marginBottom: 15, textAlign: \"center\" }}>\r\n            <Rate\r\n              count={3}\r\n              value={tierDisplay}\r\n              onChange={(value) => { setTierDisplay(value); props.onTierChange(value); }}\r\n              style={{ fontSize: \"40px\" }}\r\n            />\r\n          </Col>\r\n          <Col span={24}>\r\n            <Button type=\"primary\" onClick={() => props.onRecount()} style={{ width: \"100%\" }}>\r\n              <FileSyncOutlined />Recount Pages\r\n            </Button>\r\n          </Col>\r\n          <Col span={12} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <input type=\"number\" value={jumpValue} onChange={(e) => changeJumpValue(e.target.value)} style={{ width: \"97%\", padding: \"4px\", WebkitBoxSizing: \"border-box\", borderRadius: \"5px\", color: \"black\" }} />\r\n          </Col>\r\n          <Col span={6} style={{ textAlign: \"left\", marginTop: 5 }}>\r\n            <Button type=\"ghost\" style={{ width: \"97%\", color: \"white\" }}\r\n              onClick={() => changeJumpValue(jumpValue - 1)}\r\n            >-</Button>\r\n          </Col>\r\n          <Col span={6} style={{ textAlign: \"right\", marginTop: 5 }}>\r\n            <Button type=\"ghost\" style={{ width: \"97%\", color: \"white\" }}\r\n              onClick={() => changeJumpValue(jumpValue + 1)}\r\n            >+</Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onJump(jumpValue - 1)} style={{ width: \"100%\" }}>\r\n              <ArrowRightOutlined />Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => props.onUndoJump()} style={{ width: \"100%\" }}>\r\n              <ArrowLeftOutlined />Undo Jump\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"primary\" onClick={() => { props.onCancel(); setShowRenameModal(true); }} style={{ width: \"100%\" }}>\r\n              <EditOutlined />Rename Page\r\n            </Button>\r\n          </Col>\r\n          <Col span={24} style={{ marginTop: 5 }}>\r\n            <Button type=\"danger\" onClick={() => { props.onCancel(); setShowConfirmDelete(true); }} style={{ width: \"100%\" }}>\r\n              <DeleteOutlined />Delete Page\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </Modal>\r\n      <RenameDialog\r\n        visible={showRenameModal} onClose={() => setShowRenameModal(false)}\r\n        initialValue={props.pageName}\r\n        onOk={(newName) => props.onRename(newName)}\r\n      />\r\n      <Modal\r\n        visible={showConfirmDelete}\r\n        footer={null}\r\n        centered={true}\r\n        closable={false}\r\n        onCancel={() => setShowConfirmDelete(false)}\r\n        style={{ maxWidth: 300, textAlign: \"center\" }}\r\n        bodyStyle={{ backgroundColor: \"grey\", border: \"1px solid black\" }}\r\n      >\r\n        <span style={{ color: \"white\" }}>Are you sure to delete this page?</span>\r\n        <Button type=\"danger\" onClick={() => { setShowConfirmDelete(false); props.onDelete(); }} style={{ width: \"100%\" }}>\r\n          Delete\r\n        </Button>\r\n      </Modal>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ReaderModalContextMenu;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Drawer, Modal, Menu, Dropdown } from 'antd';\r\nimport {\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  ExclamationCircleOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction ReaderModalChapterDrawer(props) {\r\n  const [chapters, setChapters] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(`${_uri.crud}GetAlbumChapters?id=${props.albumId}`)\r\n      .then(function (response) {\r\n        setChapters(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n  }, [props.albumId]);\r\n\r\n  const handler = {\r\n    rename: (chapterTitle) => {\r\n      console.log(\"rename \", chapterTitle);\r\n    },\r\n    delete: (chapterTitle) => {\r\n      console.log(\"delete \", chapterTitle);\r\n      confirm({\r\n        title: `Delete chapter ${chapterTitle}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   Yes   ',\r\n        okType: 'danger',\r\n        cancelText: '   No   ',\r\n        onOk() {\r\n          let encodedChapterTitle = encodeURIComponent(chapterTitle);\r\n          axios.delete(`${_uri.crud}DeleteAlbumChapter/${props.albumId}/${encodedChapterTitle}`)\r\n            .then(function (response) {\r\n              console.log(\"newPageCount\", response.data);\r\n              props.onChapterDeleteSuccess(response.data);\r\n              setChapters(\r\n                chapters.filter(c => c.title !== chapterTitle)\r\n              );\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      placement=\"left\"\r\n      closable={false}\r\n      onClose={props.onClose}\r\n      visible={props.visible}\r\n    >\r\n      <div style={{ padding: \"10px\" }}>\r\n        {chapters.map((chapter, index) => (\r\n          <Row style={{ marginBottom: \"5px\" }} key={chapter.title}>\r\n            <Dropdown overlay={\r\n              <Menu>\r\n                <Menu.Item key=\"1\" onClick={() => handler.rename(chapter.title)}><EditOutlined />Rename</Menu.Item>\r\n                <Menu.Item key=\"2\" onClick={() => handler.delete(chapter.title)}><DeleteOutlined />Delete</Menu.Item>\r\n              </Menu>}\r\n              trigger={['contextMenu']}\r\n            >\r\n              <Col span={10} onClick={() => props.onJumpToPage(chapter.pageIndex)}>\r\n                <img\r\n                  style={{ objectFit: \"contain\", width: \"100%\", maxHeight: \"128px\", border: \"1px solid white\" }}\r\n                  src={_uri.resizedPage(chapter.pageUncPath, 150)}\r\n                  alt=\"img\"\r\n                >\r\n                </img>\r\n              </Col>\r\n            </Dropdown>\r\n            <Col span={14}>\r\n              <span style={{ color: \"white\" }}>{chapter.title}</span>\r\n            </Col>\r\n          </Row>\r\n        ))};\r\n      </div>\r\n    </Drawer>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(ReaderModalChapterDrawer);","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport { useSwipeable } from 'react-swipeable';\r\n\r\nimport ReaderModalContextMenu from './ReaderModalContextMenu';\r\nimport ReaderModalChapterDrawer from './ReaderModalChapterDrawer';\r\nimport { IS_PUBLIC } from '../_utils/Config';\r\nimport loadingImg from '../_resources/loading.gif';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport * as Helper from '../_utils/Helper';\r\nimport * as _uri from \"../_utils/UriHelper\";\r\n\r\nconst axios = require('axios').default;\r\n\r\nfunction ReaderModal(props) {\r\n  const [apm, setApm] = useState({ //apm = album pagination model\r\n    id: null,\r\n    lpi: 0,\r\n    pages: [],\r\n    indexes: {\r\n      cPageI: 0,\r\n      pPageI: 0,\r\n      triad: \"zenpen\",\r\n      zenpenIndex: 0,\r\n      chuhenIndex: 0,\r\n      kouhenIndex: 0,\r\n    },\r\n    isLandscape: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumCm === undefined) { return; }\r\n    if (props.albumCm.albumId === apm.id) { return; }\r\n\r\n    axios.get(`${_uri.file}GetAlbumPageInfos?id=${props.albumCm.albumId}`)\r\n      .then(function (response) {\r\n        setApm({\r\n          id: props.albumCm.albumId,\r\n          lpi: props.albumCm.lastPageIndex,\r\n          isLandscape: response.data.orientation === \"Landscape\",\r\n          pages: response.data.fileInfos,\r\n          indexes: null,\r\n        });\r\n\r\n        if (props.albumCm.pageCount !== response.data.fileInfos.length) {\r\n          console.log(`PageCount (${props.albumCm.pageCount}) does not match fileInfos length (${response.data.fileInfos.length})`);\r\n\r\n          axios.get(`${_uri.crud}RefreshAlbum/${props.albumCm.albumId}`)\r\n            .then(function (response) {\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n  }, [props.albumCm]);\r\n\r\n  useEffect(() => {\r\n    const targetPage = apm.lpi < apm.pages.length ? apm.lpi : apm.pages.length - 1;\r\n\r\n    pageHandler.jumpTo(targetPage);\r\n  }, [apm.id]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"keydown\", handleKeyDown2, false);\r\n\r\n    return () => { //component will unmount\r\n      document.removeEventListener(\"keydown\", handleKeyDown2, false);\r\n    };\r\n  }, []);\r\n\r\n  const handleKeyDown2 = (event) => {\r\n    if (event.keyCode === 27) {\r\n      pageHandler.close();\r\n    }\r\n  };\r\n\r\n  //#region Event handlers\r\n  const pageHandler = {\r\n    jumpTo: function (page, renameObj) {\r\n      const maxIndex = apm.pages.length - 1;\r\n      const newPPageI = apm.indexes?.cPageI ?? 0;\r\n      const newCPageI = Helper.clamp(page, 0, maxIndex);\r\n\r\n      const { newTriad, zenpenIndex, chuhenIndex, kouhenIndex } = (() => {\r\n        function compose(newTriad, zenpenIndex, chuhenIndex, kouhenIndex) {\r\n          return {\r\n            newTriad,\r\n            zenpenIndex,\r\n            chuhenIndex,\r\n            kouhenIndex\r\n          };\r\n        }\r\n\r\n        function pageCeil(modifier) {\r\n          const pagesLen = apm.pages.length;\r\n          return (((newCPageI + modifier) % pagesLen) + pagesLen) % pagesLen;\r\n        }\r\n\r\n        if (newCPageI % 3 === 0) {\r\n          return compose(\"zenpen\", newCPageI, pageCeil(1), pageCeil(-1));\r\n        }\r\n        if (newCPageI % 3 === 1) {\r\n          return compose(\"chuhen\", pageCeil(-1), newCPageI, pageCeil(1));\r\n        }\r\n        if (newCPageI % 3 === 2) {\r\n          return compose(\"kouhen\", pageCeil(1), pageCeil(-1), newCPageI);\r\n        }\r\n      })();\r\n\r\n      let modifiedPages = apm.pages;\r\n      if (renameObj !== null && renameObj !== undefined) {\r\n        modifiedPages[renameObj.index] = renameObj.newPageInfo;\r\n      }\r\n\r\n      setApm({\r\n        indexes: {\r\n          cPageI: newCPageI,\r\n          pPageI: newPPageI,\r\n          triad: newTriad,\r\n          zenpenIndex: zenpenIndex,\r\n          chuhenIndex: chuhenIndex,\r\n          kouhenIndex: kouhenIndex\r\n        },\r\n        id: apm.id,\r\n        lpi: apm.lpi,\r\n        isLandscape: apm.isLandscape,\r\n        pages: modifiedPages,\r\n      });\r\n\r\n      if (apm.id != null && page === apm.pages.length - 1) {\r\n        axios.post(`${_uri.crud}UpdateAlbumOuterValue`, {\r\n          albumId: apm.id,\r\n          lastPageIndex: page\r\n        })\r\n          .then((response) => {\r\n          })\r\n          .catch((error) => {\r\n            props.popApiError(error);\r\n          });\r\n      }\r\n    },\r\n    rename: (page, newName) => {\r\n      console.log(`rename page ${page} with name ${newName}`);\r\n      axios.post(`${_uri.file}RenameFile`, {\r\n        albumId: apm.id,\r\n        pageIndex: page,\r\n        newName: newName\r\n      })\r\n        .then(function (response) {\r\n          const renameObj = {\r\n            index: page,\r\n            newPageInfo: response.data\r\n          };\r\n          console.log(renameObj);\r\n          pageHandler.jumpTo(apm.indexes.cPageI - 1, renameObj);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    delete: (page) => {\r\n      axios.delete(`${_uri.file}DeleteFile/${apm.id}/${page}`)\r\n        .then(function (response) {\r\n          props.onPageDeleteSuccess(apm.id, page);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    close: () => {\r\n      props.onClose(apm.id, apm.indexes.cPageI);\r\n    }\r\n  }\r\n\r\n  const albumHandler = {\r\n    tierChange: (value) => {\r\n      axios.put(`${_uri.crud}UpdateAlbumTier`, {\r\n        albumId: apm.id,\r\n        tier: value\r\n      })\r\n        .then(function (response) {\r\n          console.log(response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    recount: () => {\r\n      axios.post(`${_uri.crud}RecountAlbumPages\"`, {\r\n        albumId: apm.id\r\n      })\r\n        .then(function (response) {\r\n          console.log(\"new page count\", response.data);\r\n          props.onChapterDeleteSuccess(apm.id, response.data);\r\n        })\r\n        .catch(function (error) {\r\n          props.popApiError(error);\r\n        });\r\n    }\r\n  }\r\n\r\n  const [showContextMenu, setShowContextMenu] = useState(false);\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n\r\n  const buttonHandler = {\r\n    rightTop: () => {\r\n      if (apm.isLandscape) { setShowDrawer(true); }\r\n      else { pageHandler.close(); }\r\n    },\r\n    rightMid: () => {\r\n      if (apm.isLandscape) { }\r\n      else { pageHandler.jumpTo(apm.indexes.cPageI + 1); }\r\n    },\r\n    rightBot: () => {\r\n      if (apm.isLandscape) { pageHandler.close(); }\r\n      else { pageHandler.jumpTo(apm.pages.length - 1); }\r\n    },\r\n    midTop: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n      else { }\r\n    },\r\n    midMid: () => {\r\n      setShowContextMenu(true);\r\n    },\r\n    midBot: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.indexes.cPageI + 1); }\r\n      else { }\r\n    },\r\n    leftTop: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(0); }\r\n      else { setShowDrawer(true); }\r\n    },\r\n    leftMid: () => {\r\n      if (apm.isLandscape) { }\r\n      else { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n    },\r\n    leftBot: () => {\r\n      if (apm.isLandscape) { pageHandler.jumpTo(apm.pages.length - 1); }\r\n      else { pageHandler.jumpTo(0); }\r\n    }\r\n  }\r\n\r\n  const swipeHandler = useSwipeable({\r\n    onSwipedLeft: (eventData) => { pageHandler.jumpTo(apm.indexes.cPageI + 1); },\r\n    onSwipedRight: (eventData) => { pageHandler.jumpTo(apm.indexes.cPageI - 1); }\r\n  });\r\n\r\n  //#endregion\r\n  const showGuide = IS_PUBLIC && apm.indexes !== null && apm.indexes.cPageI === 0;\r\n  const overlayStyle = getOverlayStyle(showGuide);\r\n  const buttonStyle = {\r\n    side: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.25 * window.innerHeight\r\n    },\r\n    mid: {\r\n      ...overlayStyle.button,\r\n      minHeight: 0.5 * window.innerHeight\r\n    }\r\n  }\r\n\r\n  if (apm.indexes === null || apm.pages.length === 0) { return (<></>); }\r\n\r\n  const currentPageInfo = apm.indexes.triad === \"zenpen\" ? apm.pages[apm.indexes.zenpenIndex]\r\n    : apm.indexes.triad === \"chuhen\" ? apm.pages[apm.indexes.chuhenIndex]\r\n      : apm.indexes.triad === \"kouhen\" ? apm.pages[apm.indexes.kouhenIndex]\r\n        : null;\r\n\r\n  const zenpenPage = <PageDisplay\r\n    id=\"zenpen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.zenpenIndex]}\r\n    queue={apm.indexes.triad === \"zenpen\" ? \"q0\" : apm.indexes.triad === \"kouhen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n  />;\r\n\r\n  const chuhenPage = <PageDisplay\r\n    id=\"chuhen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.chuhenIndex]}\r\n    queue={apm.indexes.triad === \"chuhen\" ? \"q0\" : apm.indexes.triad === \"zenpen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n  />;\r\n\r\n  const kouhenPage = <PageDisplay\r\n    id=\"kouhen-page\"\r\n    albumId={apm.id}\r\n    pageInfo={apm.pages[apm.indexes.kouhenIndex]}\r\n    queue={apm.indexes.triad === \"kouhen\" ? \"q0\" : apm.indexes.triad === \"chuhen\" ? \"q1\" : \"q2\"}\r\n    isLandscape={apm.isLandscape}\r\n  />;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"overlay overlay-reader\" style={{ display: props.isOpen ? \"block\" : \"none\", zIndex: 1 }}>\r\n        {/* <div className=\"overlay-content\"> */}\r\n        {/* <div style={{ position: \"relative\", top: \"0%\", textAlign: \"center\", height: window.innerHeight, width: window.innerWidth }}> */}\r\n        <div style={{ height: \"100vh\", position: \"absolute\", left: 0, top: 0 }}>\r\n          {zenpenPage}\r\n          {chuhenPage}\r\n          {kouhenPage}\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 2 }}>\r\n          <div className=\"overlay-content\">\r\n            <span className=\"with-shadow\">{currentPageInfo.name}</span>\r\n            <div style={{ position: \"fixed\", bottom: \"0px\", width: \"100%\", textAlign: \"center\" }}>\r\n              <span className=\"with-shadow\">{apm.indexes.cPageI + 1}/{apm.pages.length}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"overlay\" style={{ zIndex: 3 }}>\r\n          <div style={overlayStyle.content} {...swipeHandler}>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftTop} style={buttonStyle.side}>\r\n                  {\r\n                    getGuideLabel(showGuide, \"Browse Chapters\")\r\n                    //WARNING, getGuideLabel mechanism has not been updated to conform with rotation mechanic (isLandscape)\r\n                  }\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midTop} style={buttonStyle.side}>\r\n                </div>\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightTop} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Close Album\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Previous Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Context Menu\")}\r\n                </div>\r\n                <ReaderModalContextMenu\r\n                  albumCm={props.albumCm}\r\n                  initialValue={apm.indexes.cPageI}\r\n                  pageName={currentPageInfo.name}\r\n                  onTierChange={albumHandler.tierChange}\r\n                  onRecount={() => { albumHandler.recount(); setShowContextMenu(false); }}\r\n                  onJump={(page) => { pageHandler.jumpTo(page); setShowContextMenu(false); }}\r\n                  onUndoJump={() => { pageHandler.jumpTo(apm.indexes.pPageI); setShowContextMenu(false); }}\r\n                  visible={showContextMenu}\r\n                  onRename={(value) => { pageHandler.rename(apm.indexes.cPageI, value); setShowContextMenu(false); }}\r\n                  onDelete={() => { pageHandler.delete(apm.indexes.cPageI); setShowContextMenu(false); }}\r\n                  onCancel={() => setShowContextMenu(false)}\r\n                />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightMid} style={buttonStyle.mid}>\r\n                  {getGuideLabel(showGuide, \"Next Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.leftBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"First Page\")}\r\n                </div>\r\n              </Col>\r\n              <Col span={12}>\r\n                <div onClick={buttonHandler.midBot} style={buttonStyle.side} />\r\n              </Col>\r\n              <Col span={6}>\r\n                <div onClick={buttonHandler.rightBot} style={buttonStyle.side}>\r\n                  {getGuideLabel(showGuide, \"Last Page\")}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ReaderModalChapterDrawer\r\n        visible={showDrawer}\r\n        onClose={() => setShowDrawer(false)}\r\n        albumId={apm.id}\r\n        onJumpToPage={pageHandler.jumpTo}\r\n        onChapterDeleteSuccess={(newPageCount) => props.onChapterDeleteSuccess(apm.id, newPageCount)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst getOverlayStyle = (isGrey) => {\r\n  const result = {\r\n    content: {\r\n      position: 'relative',\r\n      top: '0%',\r\n      width: '100%',\r\n      textAlign: 'center',\r\n      backgroundColor: isGrey ? 'rgba(200, 200, 200, 0.3)' : 'rgba(0, 0, 0, 0)'\r\n    },\r\n    button: {\r\n      position: 'relative',\r\n      boxSizing: 'border-box',\r\n      border: isGrey ? '1px solid black' : '0px'\r\n    }\r\n  };\r\n\r\n  return result;\r\n}\r\n\r\nconst getGuideLabel = (isGrey, text) => {\r\n  return isGrey ?\r\n    <span style={{ textAlign: \"center\", margin: \"auto\", textShadow: \"-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black\" }}>\r\n      {text}\r\n    </span> :\r\n    \"\";\r\n}\r\n\r\nfunction PageDisplay(props) {\r\n  const styleByRotation = props.isLandscape ?\r\n    {\r\n      transform: \"translatex(calc(50vw - 50%)) translatey(calc(50vh - 50%)) rotate(90deg)\",\r\n      width: \"100vh\",\r\n      height: \"100vw\",\r\n    } :\r\n    {\r\n      transform: \"translatex(calc(50vw - 50%)) translatey(calc(50vh - 50%))\",\r\n      width: \"100vw\",\r\n      height: \"100vh\"\r\n    };\r\n\r\n  const styleShow = {\r\n    objectFit: \"contain\",\r\n    ...styleByRotation\r\n  };\r\n  const styleHide = { objectFit: \"contain\", height: 0, width: 0, position: \"absolute\" };\r\n  //const styleShow = { height: 300, width: 300 };\r\n  //const styleHide = { height: 150, width: 150 };\r\n\r\n  if (IsVideo(props.pageInfo.extension)) {\r\n    return (\r\n      <video\r\n        autoPlay loop\r\n        id={props.id}\r\n        style={props.queue === \"q0\" ? styleShow : styleHide}\r\n        src={props.queue === \"q0\" ? _uri.fullPage(props.albumId, props.pageInfo.uncPathEncoded) : \"\"}\r\n      >\r\n        video not showing\r\n      </video>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <img\r\n      id={props.id}\r\n      style={props.queue === \"q0\" ? styleShow : styleHide}\r\n      src={props.queue === \"q0\" || props.queue === \"q1\" ? _uri.fullPage(props.albumId, props.pageInfo.uncPathEncoded) : loadingImg}\r\n      alt=\"Not loaded\"\r\n    />\r\n  );\r\n}\r\n\r\nfunction IsVideo(extension) {\r\n  if (extension === \".webm\" || extension === \".mp4\") {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default withMyAlert(ReaderModal);","import React from 'react';\r\nimport { Input } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputTextbox(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col sm={17}>\r\n          <Input\r\n            placeholder={props.placeholder}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputTextbox;","import React from 'react';\r\nimport { Rate } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputStar(props) {\r\n  function handleChange(value) {\r\n    props.onChange(props.label, value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Rate\r\n            count={3}\r\n            value={props.value}\r\n            onChange={handleChange}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputStar;","import React from 'react';\r\nimport { Radio } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputRadio(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.value);\r\n  }\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col sm={17}>\r\n          <Radio.Group onChange={handleChange} value={props.value} style={{ width: \"100%\" }}>\r\n            <Row>\r\n              {props.items.map(item => (\r\n                <Col span={8} key={item}>\r\n                  <Radio key={item} value={item}><span style={{ color: \"white\" }}>{item}</span></Radio>\r\n                </Col>\r\n              ))}\r\n            </Row>\r\n          </Radio.Group>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputRadio;","import React from 'react';\r\nimport { Checkbox } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputCheck(props) {\r\n  function handleChange(event) {\r\n    props.onChange(props.label, event.target.checked);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Checkbox onChange={handleChange} checked={props.value} />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputCheck;","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { Row, Col } from 'antd';\r\n\r\nfunction MyInputMulticheck(props) {\r\n\r\n  function handleClick(label) {\r\n    props.onChange(props.label, label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col sm={7}>\r\n          <label>{props.label}</label>\r\n        </Col>\r\n        <Col sm={17}>\r\n          <Row gutter={2}>\r\n            {props.items.map((item) => (\r\n              <Col span={8} key={item}>\r\n                <Button\r\n                  key={item}\r\n                  type={props.value.includes(item) ? \"primary\" : \"link\"}\r\n                  ghost={props.value.includes(item) ? true : false}\r\n                  onClick={() => handleClick(item)}\r\n                  style={{ width: \"100%\", textAlign: \"left\", marginBottom: \"2px\" }}\r\n                >\r\n                  {item}\r\n                </Button>\r\n              </Col>)\r\n            )}\r\n          </Row>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputMulticheck;","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Row, Col, Button } from 'antd';\r\nimport useSWR from 'swr';\r\n\r\nimport MyInputTextbox from '../_shared/Editors/MyInputTextbox';\r\nimport MyInputStar from '../_shared/Editors/MyInputStar';\r\nimport MyInputRadio from '../_shared/Editors/MyInputRadio';\r\nimport MyInputCheck from '../_shared/Editors/MyInputCheck';\r\nimport MyInputMulticheck from '../_shared/Editors/MyInputMulticheck';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\n\r\nimport * as _helper from '../_utils/Helper';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst lodash = require('lodash/array');\r\nconst axios = require('axios').default;\r\n\r\nfunction EditModal(props) {\r\n  const { data: albumInfo, error: aiError } = useSWR(`${_uri.crud}GetAlbumInfo`);\r\n\r\n  const [albumVm, setAlbumVm] = useState({\r\n    albumId: \"\",\r\n    path: \"\", //not updated\r\n    pageCount: 0, //not updated\r\n    lastPageIndex: 0, //not updated\r\n    album: {\r\n      title: \"\",\r\n      category: \"Manga\",\r\n      orientation: \"Portrait\",\r\n      artists: [],\r\n      tags: [],\r\n      languages: [],\r\n      flags: [],\r\n      tier: 0,\r\n      cover: \"\",\r\n      isWip: false,\r\n      isRead: false,\r\n      entryDate: null\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.albumId === undefined) { return; }\r\n\r\n    axios.get(`${_uri.crud}GetAlbumVm?id=${props.albumId}`)\r\n      .then(function (response) {\r\n        //console.log(\"GetAlbumVm response.data\", response.data);\r\n        setAlbumVm(response.data);\r\n      })\r\n      .catch(function (error) {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.albumId]);\r\n\r\n  const handlers = {\r\n    albumVmChange: function (label, value) {\r\n      let newAlbumVm = { ...albumVm };\r\n      let cleanedValue = value;\r\n      if (label === \"Artists\") {\r\n        cleanedValue = value.split(\",\");\r\n      }\r\n      else if (label === \"Tags\" || label === \"Languages\") {\r\n        cleanedValue = albumVm.album[_helper.firstLetterLowerCase(label)];\r\n        if (cleanedValue.includes(value)) {\r\n          cleanedValue = lodash.pull(cleanedValue, value);\r\n        }\r\n        else {\r\n          cleanedValue.push(value);\r\n        }\r\n      }\r\n      newAlbumVm.album[_helper.firstLetterLowerCase(label)] = cleanedValue;\r\n      setAlbumVm(newAlbumVm);\r\n    },\r\n    ok: function () {\r\n      props.onOk(albumVm);\r\n    },\r\n    cancel: function () {\r\n      props.onCancel();\r\n    },\r\n    editFiles: function () {\r\n      props.onEditFiles(albumVm);\r\n    },\r\n    delete: function () {\r\n      props.onDelete(albumVm);\r\n    },\r\n    refresh: function () {\r\n      props.onRefresh(albumVm);\r\n    }\r\n  }\r\n\r\n  const temp = (\r\n    <div className=\"ant-modal-root\">\r\n      <div className=\"ant-modal-mask\"></div>\r\n      <div tabIndex={-1} className=\"ant-modal-wrap\" role=\"dialog\" aria-labelledby=\"rcDialogTitle0\" onClick={handlers.cancel}>\r\n        <div role=\"document\" className=\"my-ant-modal\" onClick={(e) => e.stopPropagation()}>\r\n          <div className=\"ant-modal-content\">\r\n            <button onClick={handlers.cancel} type=\"button\" aria-label=\"Close\" className=\"ant-modal-close\">\r\n              <span className=\"ant-modal-close-x\">\r\n                <i aria-label=\"icon: close\" className=\"anticon anticon-close ant-modal-close-icon\">\r\n                  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"\" data-icon=\"close\" fill=\"currentColor\" aria-hidden=\"true\" style={{ height: \"1em\", width: \"1em\" }}>\r\n                    <path d=\"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z\">\r\n                    </path>\r\n                  </svg>\r\n                </i>\r\n              </span>\r\n            </button>\r\n            <div className=\"my-ant-modal-header\">\r\n              <div className=\"my-ant-modal-title\" id=\"rcDialogTitle0\">Edit Metadata</div>\r\n            </div>\r\n            <div className=\"my-ant-modal-body\">\r\n              {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n                <>\r\n                  <MyInputTextbox label=\"Title\" value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n                  <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n                  <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n                  <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n                  <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n                  <MyInputTextbox label=\"Note\" value={albumVm.album.note} onChange={handlers.albumVmChange} />\r\n                  <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n                  <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n                  <MyInputCheck label=\"IsRead\" value={albumVm.album.isRead} onChange={handlers.albumVmChange} />\r\n                  <MyInputCheck label=\"IsWip\" value={albumVm.album.isWip} onChange={handlers.albumVmChange} />\r\n                </>\r\n              )}\r\n            </div>\r\n            <div className=\"my-ant-modal-footer\">\r\n              <Row>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.delete} type=\"danger\" style={{ width: \"100%\" }}>\r\n                    Delete\r\n                  </Button>\r\n                </Col>\r\n                <Col span={1}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.refresh} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n                    Refresh\r\n                  </Button>\r\n                </Col>\r\n                <Col span={2}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.editFiles} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n                    Files\r\n                  </Button>\r\n                </Col>\r\n                <Col span={1}></Col>\r\n                <Col span={5}>\r\n                  <Button onClick={handlers.ok} type=\"primary\" style={{ width: \"100%\" }}>\r\n                    Save\r\n                  </Button>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (<>{props.isOpen ? temp : \"\"}</>);\r\n\r\n  //#region legacy\r\n  // return (\r\n  //   <Modal\r\n  //     title=\"Edit Metadata\"\r\n  //     visible={props.isOpen}\r\n  //     onOk={handlers.ok}\r\n  //     onCancel={handlers.cancel}\r\n  //     footer={\r\n  //       <Row>\r\n  //         <Col span={4}>\r\n  //           <Button onClick={handlers.delete} type=\"danger\" style={{ width: \"100%\" }}>\r\n  //             Delete\r\n  //           </Button>\r\n  //         </Col>\r\n  //         <Col span={11}></Col>\r\n  //         <Col span={4}>\r\n  //           <Button onClick={handlers.editFiles} type=\"ghost\" style={{ width: \"100%\", color: \"white\" }}>\r\n  //             Files\r\n  //           </Button>\r\n  //         </Col>\r\n  //         <Col span={1}></Col>\r\n  //         <Col span={4}>\r\n  //           <Button onClick={handlers.ok} type=\"primary\" style={{ width: \"100%\" }}>\r\n  //             Save\r\n  //           </Button>\r\n  //         </Col>\r\n  //       </Row>\r\n  //     }\r\n  //   >\r\n  //     {aiError ? \"album Info Fetching error\" : !albumInfo ? \"loading...\" : (\r\n  //       <>\r\n  //         <MyInputTextbox label=\"Title\" value={albumVm.album.title} onChange={handlers.albumVmChange} />\r\n  //         <MyInputTextbox label=\"Artists\" value={albumVm.album.artists.join()} onChange={handlers.albumVmChange} />\r\n  //         <MyInputRadio label=\"Category\" value={albumVm.album.category} items={albumInfo.categories} onChange={handlers.albumVmChange} />\r\n  //         <MyInputRadio label=\"Orientation\" value={albumVm.album.orientation} items={albumInfo.orientations} onChange={handlers.albumVmChange} />\r\n  //         <MyInputStar label=\"Tier\" value={albumVm.album.tier} onChange={handlers.albumVmChange} />\r\n  //         <MyInputTextbox label=\"Flags\" value={albumVm.album.flags.join()} onChange={handlers.albumVmChange} />\r\n  //         <MyInputMulticheck label=\"Tags\" value={albumVm.album.tags} items={albumInfo.tags} onChange={handlers.albumVmChange} />\r\n  //         <MyInputMulticheck label=\"Languages\" value={albumVm.album.languages} items={albumInfo.languages} onChange={handlers.albumVmChange} />\r\n  //         <MyInputCheck label=\"IsRead\" value={albumVm.album.isRead} onChange={handlers.albumVmChange} />\r\n  //         <MyInputCheck label=\"IsWip\" value={albumVm.album.isWip} onChange={handlers.albumVmChange} />\r\n  //       </>\r\n  //     )}\r\n  //   </Modal>\r\n  // );\r\n  //#endregion\r\n}\r\n\r\nexport default withMyAlert(EditModal);","import React, { useState, useEffect, useRef } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport ReaderModal from './ReaderModal';\r\nimport EditModal from './EditModal';\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport PullToRefresh from 'react-simple-pull-to-refresh';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction Albums(props) {\r\n  console.log(\"albums rendering\");\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  //#region Display Album List\r\n  const [albumCms, setAlbumCms] = useState([]);\r\n\r\n  const handleRefresh = () => {\r\n    return new Promise((resolve, reject) => {\r\n      const { page, row, query } = props.queryParts;\r\n      const encodedQuery = (query !== undefined) ? encodeURIComponent(query) : \"\";\r\n      axios.get(`${_uri.crud}GetAlbumCardModels?page=${page}&row=${row}&query=${encodedQuery}`)\r\n        .then((response) => {\r\n          setAlbumCms(response.data);\r\n          resolve(\"param from resolve\");\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n          reject(\"param from reject\");\r\n        });\r\n    });\r\n  }\r\n  useEffect(() => { handleRefresh(); }, [props.queryParts]);\r\n\r\n  const [filteredAlbumCms, setFilteredAlbumCms] = useState([]);\r\n  useEffect(() => {\r\n    const newFiltered = props.tierFilter === null ? albumCms\r\n      : albumCms.filter(a => { return a.tier === props.tierFilter });\r\n\r\n    setFilteredAlbumCms(newFiltered);\r\n    //props.onAlbumCountChange(newFiltered.length);\r\n  }, [albumCms, props.tierFilter]);\r\n  //#endregion\r\n\r\n  //#region Display Album Pages\r\n  const [readerModalIsOpen, setReaderModalIsOpen] = useState(false);\r\n  const [selectedAlbumId, setSelectedAlbumId] = useState({});\r\n\r\n  const readerHandler = {\r\n    view: (albumCm) => {\r\n      setSelectedAlbumId(albumCm.albumId);\r\n      setReaderModalIsOpen(true);\r\n    },\r\n\r\n    close: (albumId, lastPageIndex) => {\r\n      setReaderModalIsOpen(false);\r\n\r\n      axios.post(`${_uri.crud}UpdateAlbumOuterValue`, {\r\n        albumId: albumId,\r\n        lastPageIndex: lastPageIndex\r\n      })\r\n        .then((response) => {\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          lastPageIndex: lastPageIndex,\r\n          isRead: lastPageIndex === albumCm.pageCount - 1 ? true : albumCm.isRead\r\n        };\r\n      }));\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Edit Delete\r\n  const [editModalIsOpen, setEditModalIsOpen] = useState(false);\r\n  const [editedAlbumId, setEditedAlbumId] = useState(undefined);\r\n\r\n  const crudHandler = {\r\n    edit: (albumId) => {\r\n      setEditModalIsOpen(true);\r\n      setEditedAlbumId(albumId);\r\n    },\r\n    pageDeleteSuccess: (albumId, page) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: albumCm.pageCount - 1,\r\n          lastPageIndex: page\r\n        };\r\n      }));\r\n    },\r\n    chapterDeleteSuccess: (albumId, newPageCount) => {\r\n      setAlbumCms(albumCms.map((albumCm, aIndex) => {\r\n        if (albumCm.albumId !== albumId) {\r\n          return albumCm;\r\n        }\r\n        return {\r\n          ...albumCm,\r\n          pageCount: newPageCount,\r\n          lastPageIndex: 0\r\n        };\r\n      }));\r\n    }\r\n  }\r\n\r\n  const editHandler = {\r\n    ok: (editedAlbumVm) => {\r\n      setEditModalIsOpen(false);\r\n\r\n      axios.post(`${_uri.crud}UpdateAlbum`, editedAlbumVm)\r\n        .then((response) => {\r\n          console.log(\"edit success. Id: \", response.data);\r\n\r\n          let newAlbumCms = [...albumCms];\r\n          let editedAlbumVmIndex = newAlbumCms.findIndex(a => a.albumId === editedAlbumVm.albumId);\r\n          newAlbumCms[editedAlbumVmIndex].fullTitle = `[${editedAlbumVm.album.artists.join(', ')}] ${editedAlbumVm.album.title}`;\r\n          newAlbumCms[editedAlbumVmIndex].languages = editedAlbumVm.album.languages;\r\n\r\n          newAlbumCms[editedAlbumVmIndex].note = editedAlbumVm.album.note;\r\n\r\n          setAlbumCms(newAlbumCms);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    cancel: () => {\r\n      setEditModalIsOpen(false);\r\n    },\r\n    delete: (albumVm) => {\r\n      const album = albumVm.album;\r\n      confirm({\r\n        title: `Delete album [${album.artists.join(', ')}] ${album.title}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          axios.delete(`${_uri.crud}DeleteAlbum/${albumVm.albumId}`)\r\n            .then(function (response) {\r\n              setEditModalIsOpen(false);\r\n\r\n              setAlbumCms(albumCms.filter(albumCm => {\r\n                return albumCm.albumId !== albumVm.albumId;\r\n              }));\r\n            })\r\n            .catch(function (error) {\r\n              setEditModalIsOpen(false);\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    },\r\n    refresh: (albumVm) => {\r\n      setEditModalIsOpen(false);\r\n\r\n      axios.get(`${_uri.crud}RefreshAlbum/${albumVm.albumId}`)\r\n        .then((response) => {\r\n          props.popInfo(\"Refresh Album\", response.data, null);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        });\r\n    },\r\n    editFiles: (albumVm) => {\r\n      setEditModalIsOpen(false);\r\n      props.history.push(\"FileManagement?id=\" + albumVm.albumId);\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  return (\r\n    <>\r\n      <PullToRefresh onRefresh={handleRefresh}>\r\n        <Row gutter={0} type=\"flex\">\r\n          {filteredAlbumCms.map((a, index) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={crudHandler.edit}\r\n                //onDelete={crudHandler.delete}\r\n                showContextMenu={true}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      </PullToRefresh>\r\n      <ReaderModal\r\n        isOpen={readerModalIsOpen}\r\n        onClose={readerHandler.close}\r\n        onPageDeleteSuccess={crudHandler.pageDeleteSuccess}\r\n        onChapterDeleteSuccess={crudHandler.chapterDeleteSuccess}\r\n        albumCm={albumCms.find(aCm => aCm.albumId === selectedAlbumId)}\r\n      />\r\n      <EditModal\r\n        isOpen={editModalIsOpen}\r\n        albumId={editedAlbumId}\r\n        onOk={editHandler.ok}\r\n        onCancel={editHandler.cancel}\r\n        onDelete={editHandler.delete}\r\n        onRefresh={editHandler.refresh}\r\n        onEditFiles={editHandler.editFiles}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(Albums));","//THIS ENTIRE CLASS IS LEGACY\r\n\r\nimport { API_URL } from './Config';\r\nimport * as Helper from './Helper';\r\n\r\nconst axios = require('axios').default;\r\n\r\nvar albumInfo = null;\r\n\r\n//#region AlbumInfo\r\nexport const GetAlbumInfo = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo;\r\n}\r\n\r\nexport const GetTags = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.tags;\r\n}\r\nexport const GetCategories = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.categories;\r\n}\r\nexport const GetOrientations = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.orientations;\r\n}\r\nexport const GetLanguages = async () => {\r\n  if (albumInfo === null) {\r\n    albumInfo = await FetchAlbumInfo();\r\n  }\r\n  return albumInfo.languages;\r\n}\r\n\r\nasync function FetchAlbumInfo() {\r\n  console.log(\"FetchAlbumInfo called\");\r\n  const res = await fetch(API_URL + \"Crud/GetAlbumInfo\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region Queries\r\nvar tagVMs = null;\r\nexport const GetTagVMs = async () => {\r\n  if (tagVMs === null) {\r\n    tagVMs = await FetchTagVMs();\r\n  }\r\n  return tagVMs;\r\n}\r\n\r\nasync function FetchTagVMs() {\r\n  const res = await fetch(API_URL + \"Crud/GetTagVMs\", {\r\n    method: 'GET'\r\n  });\r\n\r\n  return res.json();\r\n}\r\n//#endregion\r\n\r\n//#region AlbumViewer\r\nexport const GetAlbumVMs = (page, row, query) => {\r\n  let encodedQuery = (typeof query !== 'undefined') ? encodeURIComponent(query) : \"\";\r\n  let queryString = \"?page=\" + page + \"&row=\" + row + \"&query=\" + encodedQuery;\r\n\r\n  axios.get(API_URL + \"Crud/GetAlbums\" + queryString)\r\n    .then(function (response) {\r\n      return response.data;\r\n    })\r\n    .catch(function (error) {\r\n      Helper.apiErrorHandler(error);\r\n    });\r\n\r\n  // async function FetchAlbums() {\r\n  //   const res = await fetch(API_URL + \"Crud/GetAlbums\" + queryString, {\r\n  //     method: 'GET',\r\n  //     //headers: '',\r\n  //     mode: 'cors',\r\n  //     cache: 'default'\r\n  //   });\r\n  //   return res.json();\r\n  // };\r\n\r\n  // let result = await FetchAlbums();\r\n  // return result;\r\n}\r\n//#endregion\r\n\r\nexport const InsertAlbum = async (albumVm) => {\r\n  const res = await fetch(API_URL + \"Crud/InsertAlbum\", {\r\n    method: 'POST',\r\n    body: JSON.stringify(albumVm),\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    }\r\n  });\r\n  return await res.json();\r\n}","import React from 'react';\r\nimport { Button, Row, Col } from 'antd';\r\n\r\nfunction MyInputButton(props) {\r\n  function handleClick(event) {\r\n    props.onClick(props.label);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Row gutter={[0, 8]}>\r\n        <Col span={7}>\r\n        </Col>\r\n        <Col span={17}>\r\n          <Button onClick={handleClick}>{props.label}</Button>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyInputButton;","import React, { useState, useEffect } from 'react';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport MyInputTextbox from '../_shared/Editors/MyInputTextbox';\r\nimport { Button, Row, Col, Upload } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport MyInputRadio from '../_shared/Editors/MyInputRadio';\r\nimport MyInputMulticheck from '../_shared/Editors/MyInputMulticheck';\r\nimport MyInputCheck from '../_shared/Editors/MyInputCheck';\r\nimport MyInputStar from '../_shared/Editors/MyInputStar';\r\n\r\nimport * as DataSource from \"../_utils/DataSource\";\r\nimport * as Helper from \"../_utils/Helper\";\r\nimport MyInputButton from '../_shared/Editors/MyInputButton';\r\n\r\nvar lodash = require('lodash/array');\r\n\r\n\r\nfunction AddEdit(props) {\r\n  const [FolderName, setFolderName] = useState(\"\");\r\n  const [Files, setFiles] = useState([]);\r\n  const [AlbumVm, setAlbumVm] = useState({\r\n    title: \"\",\r\n    category: \"Manga\",\r\n    orientation: \"Portrait\",\r\n    artists: [],\r\n    tags: [],\r\n    languages: [],\r\n    flags: [],\r\n    tier: 0,\r\n    cover: \"\",\r\n    isWip: false,\r\n    isRead: false,\r\n    entryDate: null\r\n  });\r\n\r\n  const [Tags, setTags] = useState([]);\r\n  const [Categories, setCategories] = useState([]);\r\n  const [Orientations, setOrientations] = useState([]);\r\n  const [Languages, setLanguages] = useState([]);\r\n\r\n  var webkit;\r\n\r\n  useEffect(() => {\r\n    async function FetchAlbumInfo() {\r\n      let _tag = await DataSource.GetTags();\r\n      let _categories = await DataSource.GetCategories();\r\n      let _orientations = await DataSource.GetOrientations();\r\n      let _languages = await DataSource.GetLanguages();\r\n      setTags(_tag);\r\n      setCategories(_categories);\r\n      setOrientations(_orientations);\r\n      setLanguages(_languages);\r\n    }\r\n    FetchAlbumInfo();\r\n\r\n    webkit = document.getElementById(\"myInput\");\r\n    webkit.onchange = function () {\r\n      console.log(webkit);\r\n      setFiles(webkit.files);\r\n      // var files = webkit.files,\r\n      //   len = files.length,\r\n      //   i;\r\n      // for (i = 0; i < len; i += 1) {\r\n      //   //console.log(files[i]);\r\n      // }\r\n    };\r\n  }, []);\r\n\r\n  function handleAlbumVmChange(label, value) {\r\n    let newAlbumVm = { ...AlbumVm };\r\n    let cleanedValue = value;\r\n    if (label === \"Artists\" || label === \"Flags\") {\r\n      cleanedValue = value.split(\",\");\r\n    }\r\n    else if (label === \"Tags\" || label === \"Languages\") {\r\n      cleanedValue = AlbumVm[Helper.firstLetterLowerCase(label)];\r\n      if (cleanedValue.includes(value)) {\r\n        cleanedValue = lodash.pull(cleanedValue, value);\r\n      }\r\n      else {\r\n        cleanedValue.push(value);\r\n      }\r\n    }\r\n    newAlbumVm[Helper.firstLetterLowerCase(label)] = cleanedValue;\r\n    setAlbumVm(newAlbumVm);\r\n  }\r\n\r\n  function handleLogAlbum(event) {\r\n    console.log(AlbumVm);\r\n  }\r\n  function handleSubmit(event) {\r\n    console.log(event);\r\n  }\r\n\r\n  function logWebkitFiles() {\r\n    // for (let i = 0; i < Files.length; i++) {\r\n    //   var reader = new FileReader();\r\n    //   reader.onload = function (e) {\r\n    //     var object = new Object();\r\n    //     object.content = e.target.content;\r\n    //     var json_upload = \"jsonObject=\" + JSON.stringify(object);\r\n\r\n    //     console.log(\"what is e\", e);\r\n    //     console.log(\"what is json_u\", json_upload);\r\n    //   }\r\n    //   reader.readAsBinaryString(Files);\r\n    // }\r\n    console.log(Files[0]);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Add edit page</h3>\r\n      <br />\r\n      <Row justify=\"start\" align=\"middle\" gutter={[16, 24]}>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <MyInputTextbox label=\"Title\" value={AlbumVm.title} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Artists\" value={AlbumVm.artists.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Category\" value={AlbumVm.category} items={Categories} onChange={handleAlbumVmChange} />\r\n          <MyInputStar label=\"Tier\" value={AlbumVm.tier} onChange={handleAlbumVmChange} />\r\n          <MyInputTextbox label=\"Flags\" value={AlbumVm.flags.join()} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Tags\" value={AlbumVm.tags} items={Tags} onChange={handleAlbumVmChange} />\r\n          <MyInputRadio label=\"Orientation\" value={AlbumVm.orientation} items={Orientations} onChange={handleAlbumVmChange} />\r\n          <MyInputMulticheck label=\"Languages\" value={AlbumVm.languages} items={Languages} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsRead\" value={AlbumVm.isRead} onChange={handleAlbumVmChange} />\r\n          <MyInputCheck label=\"IsWip\" value={AlbumVm.isWip} onChange={handleAlbumVmChange} />\r\n          <Button onClick={() => logWebkitFiles()}>Log Webkit Files</Button>\r\n          <MyInputButton label=\"Insert Album\" onClick={handleSubmit} />\r\n          {/* <Upload directory>\r\n            <Button>\r\n              <UploadOutlined /> Select Folder\r\n            </Button>\r\n          </Upload> */}\r\n          <input id=\"myInput\" type=\"file\" webkitdirectory=\"true\" directory multiple />\r\n        </Col>\r\n        <Col span={12} className=\"gutter-row\">\r\n          <p>placeholder for image</p>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddEdit;","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport { Row, Col } from 'antd';\r\nimport useSWR from 'swr';\r\n\r\nimport MyAlbumCard from '../_shared/Displays/MyAlbumCard';\r\nimport * as _uri from \"../_utils/UriHelper\";\r\n\r\nfunction Genres(props) {\r\n  const endpoint = props.page === \"Genres\" ? \"GetGenreCardModels\" :\r\n    props.page === \"Artists\" ? \"GetFeaturedArtistCardModel\" :\r\n      \"NotFound\";\r\n\r\n  const { data: albumCGroups, error } = useSWR(`${_uri.crud}${endpoint}`);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!albumCGroups) { return <div>loading...</div>; }\r\n\r\n  const readerHandler = {\r\n    view: function (albumCm) {\r\n      console.log(\"query click\", albumCm);\r\n      props.history.push('/albums?query=' + albumCm.albumId)\r\n    },\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {albumCGroups.map((acg, index) => (\r\n        <Row key={\"acgRow\" + acg.name} gutter={0} type=\"flex\" style={{ border: \"1px solid rgb(83, 83, 83)\", borderRadius: \"8px\", paddingTop: \"8px\", marginBottom: \"5px\" }}>\r\n          { props.page === \"This feature is cancelled\" ? (\r\n            <div style={{ position: \"relative\" }}>\r\n              <div style={{ position: \"absolute\", top: \"-18px\", left: \"10px\" }}>{acg.name}</div>\r\n            </div>) : \"\"\r\n          }\r\n          {acg.albumCms.map((a) => (\r\n            <Col style={{ textAlign: 'center' }} lg={3} md={6} xs={12} key={\"albumCol\" + a.albumId}>\r\n              <MyAlbumCard\r\n                index={index}\r\n                albumCm={a}\r\n                onView={readerHandler.view}\r\n                onEdit={() => { }}\r\n                onDelete={() => { }}\r\n                showContextMenu={false}\r\n              />\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Genres;","import { useMediaQuery } from 'react-responsive'\r\n\r\nconst DesktopOnly = ({ children }) => {\r\n  const isDesktop = useMediaQuery({ minWidth: 801 })\r\n  return isDesktop ? children : null\r\n}\r\nconst MobileOnly = ({ children }) => {\r\n  const isMobile = useMediaQuery({ maxWidth: 800 })\r\n  return isMobile ? children : null\r\n}\r\n\r\nconst IsMobile = () => {\r\n  return useMediaQuery({ maxWidth: 800 })\r\n}\r\n\r\nexport { DesktopOnly, MobileOnly, IsMobile };","import React, { useState, useEffect } from 'react';\r\n\r\nimport { Modal } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { FileBrowser, FileContextMenu, FileList, FileNavbar, FileToolbar, ChonkyActions, defineFileAction, ChonkyIconName } from 'chonky';\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\nimport { TouchBackend } from 'react-dnd-touch-backend';\r\nimport moment from 'moment';\r\n\r\nimport withMyAlert from '../_shared/HOCs/withMyAlert';\r\nimport TextDialog from '../_shared/Modals/TextDialog';\r\nimport { IsMobile } from '../_utils/Display';\r\nimport * as _uri from '../_utils/UriHelper';\r\n\r\nconst { confirm } = Modal;\r\nconst axios = require('axios').default;\r\n\r\nfunction FileManagement(props) {\r\n  const renameAction = defineFileAction({\r\n    id: \"custom_rename\",\r\n    requiresSelection: true,\r\n    button: {\r\n      name: \"R\",\r\n      toolbar: true,\r\n      contextMenu: true,\r\n      icon: ChonkyIconName.code\r\n    }\r\n  });\r\n  const deleteAction = defineFileAction({\r\n    id: \"custom_delete\",\r\n    requiresSelection: true,\r\n    button: {\r\n      name: \"D\",\r\n      toolbar: true,\r\n      contextMenu: true,\r\n      icon: ChonkyIconName.trash\r\n    }\r\n  });\r\n  const moveAction = defineFileAction({\r\n    id: \"custom_move\",\r\n    requiresSelection: true,\r\n    button: {\r\n      name: \"M\",\r\n      toolbar: true,\r\n      contextMenu: true,\r\n      icon: ChonkyIconName.folder\r\n    }\r\n  });\r\n  const fileActions = [\r\n    deleteAction,\r\n    renameAction,\r\n    moveAction,\r\n    ChonkyActions.EnableGridView,\r\n    ChonkyActions.EnableListView,\r\n    ChonkyActions.UploadFiles,\r\n    ChonkyActions.CreateFolder\r\n  ];\r\n\r\n  const handleAction = (data) => {\r\n    if (data.id === \"custom_delete\") {\r\n      console.log(\"delete\", data);\r\n\r\n      const cModel = data.state.selectedFiles[0];\r\n      const typeText = cModel.isDir ? `directory` : 'file';\r\n\r\n      confirm({\r\n        title: `Delete ${typeText} ${cModel.name}?`,\r\n        icon: <ExclamationCircleOutlined />,\r\n        okText: '   YES   ',\r\n        okType: 'danger',\r\n        cancelText: '   NO   ',\r\n        onOk() {\r\n          const subDir = viewModel.dirChains.find(dir => dir.id === \"1\")?.name;\r\n          console.log(`confirm delete ${cModel.name}, subDir ${subDir}, albumId ${props.id}`);\r\n\r\n          const delObj = (() => {\r\n            function compose(vAlbumId, vSubDir, vFileName) {\r\n              return ({\r\n                albumId: vAlbumId,\r\n                subDir: vSubDir,\r\n                fileName: vFileName\r\n              });\r\n            }\r\n            if (cModel.isDir) {\r\n              return compose(viewModel.albumId, cModel.name, \"\");\r\n            }\r\n            else {\r\n              return compose(viewModel.albumId, subDir ?? \"\", cModel.name);\r\n            }\r\n          })();\r\n\r\n          console.log(\"delete \", delObj);\r\n          axios.delete(`${_uri.file}Delete?id=${delObj.albumId}&subDir=${delObj.subDir}&fileName=${delObj.fileName}`)\r\n            .then(function (response) {\r\n              const newFsNodes = (() => {\r\n                if (delObj.subDir !== \"\" && delObj.fileName === \"\") {\r\n                  return viewModel.fsNodes.filter(n => n.name !== delObj.subDir);\r\n                }\r\n                else if (delObj.subDir === \"\" && delObj.fileName !== \"\") {\r\n                  return viewModel.fsNodes.filter(n => n.name !== delObj.fileName);\r\n                }\r\n                else if (delObj.subDir !== \"\" && delObj.fileName !== \"\") {\r\n                  viewModel.fsNodes.forEach(n => {\r\n                    if (n.name === delObj.subDir) {\r\n                      n.childs = n.childs.filter(c => c.name !== delObj.fileName);\r\n                    }\r\n                  });\r\n                  return viewModel.fsNodes;\r\n                }\r\n              })();\r\n\r\n              setViewModel((prevState) => ({\r\n                ...prevState,\r\n                fsNodes: newFsNodes\r\n              }));\r\n            })\r\n            .catch(function (error) {\r\n              props.popApiError(error);\r\n            });\r\n        },\r\n        onCancel() {\r\n        },\r\n      });\r\n    }\r\n    else if (data.id === \"custom_rename\") {\r\n      console.log(\"rename\", data);\r\n      if (data.state.selectedFiles.length === 0) { return; }\r\n      setTextDialog({\r\n        visible: true,\r\n        btnText: 'Rename',\r\n        initialValue: data.state.selectedFiles[0].name,\r\n        onOk: handleRename\r\n      });\r\n    }\r\n    else if (data.id === \"custom_move\") {\r\n      console.log(\"move\", data);\r\n    }\r\n    else if (data.id === ChonkyActions.EndDragNDrop.id) {\r\n      console.log(\"EndDragNDrop\", data);\r\n\r\n      if (data.payload.draggedFile.isDir) { return; }\r\n      if (!data.payload.destination.isDir) { return; }\r\n\r\n      const dir = data.payload.destination.name; //root or subDir\r\n      const fileName = data.payload.draggedFile.name;\r\n\r\n      const moveParam = {\r\n        overwrite: false,\r\n        src: {\r\n          albumId: viewModel.albumId,\r\n          subDir: viewModel.subDir,\r\n          name: fileName\r\n        },\r\n        dst: {\r\n          albumId: viewModel.albumId,\r\n          subDir: dir === 'Root' ? null : dir,\r\n          name: fileName\r\n        }\r\n      };\r\n      postMoveFile(moveParam, adjustFsNodes);\r\n\r\n      function adjustFsNodes(param) {\r\n        const srcName = param.src.name;\r\n        const srcFsNode = (() => {\r\n          const srcDir = param.src.subDir;\r\n          if (srcDir !== null) {\r\n            const dirIdx = viewModel.fsNodes.findIndex(n => n.name === srcDir);\r\n            const fileIdx = viewModel.fsNodes[dirIdx].childs.findIndex(f => f.name === srcName);\r\n            const result = viewModel.fsNodes[dirIdx].childs.splice(fileIdx, 1)[0];\r\n            return result;\r\n          }\r\n          else {\r\n            const fileIdx = viewModel.fsNodes.findIndex(n => n.name === srcName);\r\n            const result = viewModel.fsNodes.splice(fileIdx, 1)[0];\r\n            return result;\r\n          }\r\n        })();\r\n\r\n        const dstDir = param.dst.subDir;\r\n        if (dstDir !== null) {\r\n          const dirIdx = viewModel.fsNodes.findIndex(n => n.name === dstDir);\r\n          if (param.overwrite) {\r\n            const owIdx = viewModel.fsNodes[dirIdx].childs.findIndex(f => f.name === srcName);\r\n            viewModel.fsNodes[dirIdx].childs.splice(owIdx, 1);\r\n          }\r\n\r\n          viewModel.fsNodes[dirIdx].childs.push(srcFsNode);\r\n          viewModel.fsNodes[dirIdx].childs.sort(compare);\r\n        }\r\n        else {\r\n          if (param.overwrite) {\r\n            const owIdx = viewModel.fsNodes.findIndex(n => n.name === srcName);\r\n            viewModel.fsNodes.splice(owIdx, 1);\r\n          }\r\n          viewModel.fsNodes.push(srcFsNode);\r\n          viewModel.fsNodes.sort(compare);\r\n        }\r\n\r\n        setViewModel((prevViewModel) => {\r\n          return ({\r\n            ...prevViewModel\r\n          });\r\n        });\r\n\r\n        function compare(a, b) {\r\n          if (a.nodeType === b.nodeType) { //Make sure folders always come before files\r\n            var nameA = a.name.toLowerCase(), nameB = b.name.toLowerCase();\r\n            if (nameA < nameB) //sort string ascending\r\n              return -1;\r\n            if (nameA > nameB)\r\n              return 1;\r\n            return 0; //default return value (no sorting)\r\n          }\r\n          return a.nodeType > b.nodeType ? 1 : -1;\r\n        }\r\n      }\r\n    }\r\n    else if (data.id === ChonkyActions.UploadFiles.id) {\r\n      console.log(\"Upload\", data)\r\n    }\r\n    else if (data.id === ChonkyActions.OpenFiles.id) {\r\n      if (!data.payload.targetFile.isDir) { return; }\r\n\r\n      const targetSubDir = data.payload.targetFile.name !== \"Root\" ?\r\n        data.payload.targetFile.name :\r\n        null;\r\n      const newDirChains = targetSubDir !== null ?\r\n        [...viewModel.dirChains, { id: '1', name: targetSubDir, isDir: true }] :\r\n        rootChain;\r\n\r\n      setViewModel((prevViewModel) => {\r\n        prevViewModel.subDir = targetSubDir;\r\n        prevViewModel.dirChains = newDirChains;\r\n        return ({\r\n          ...prevViewModel\r\n        });\r\n      });\r\n    }\r\n    else if (data.id === ChonkyActions.OpenParentFolder.id) {\r\n      console.log(\"OpenParentFolder\", data)\r\n    }\r\n    else if (data.id === ChonkyActions.CreateFolder.id) {\r\n      setTextDialog({\r\n        visible: true,\r\n        btnText: 'Create Folder',\r\n        initialValue: '',\r\n        onOk: handleCreateFolder\r\n      });\r\n    }\r\n  };\r\n\r\n  const postMoveFile = (param, onSuccess) => {\r\n    axios.post(`${_uri.file}NewMoveFile`, param)\r\n      .then(function (response) {\r\n        console.log(response);\r\n        if (response.data.message === \"Destination file already exist\") {\r\n          confirm({\r\n            title: `Overwrite?`,\r\n            icon: <ExclamationCircleOutlined />,\r\n            content: <FileComparison file1={response.data.srcInfo} file2={response.data.dstInfo} />,\r\n            okText: '   YES   ',\r\n            okType: 'danger',\r\n            cancelText: '   NO   ',\r\n            onOk() {\r\n              const newParam = {\r\n                ...param,\r\n                overwrite: true\r\n              }\r\n\r\n              postMoveFile(newParam, onSuccess);\r\n            },\r\n            onCancel() {\r\n            },\r\n          });\r\n        }\r\n        else {\r\n          console.log(\"Move success\", response.data);\r\n          onSuccess(param);\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        //debugger;\r\n        props.popApiError(error);\r\n      });\r\n  };\r\n\r\n  const defaultTextDialog = { visible: false, initialValue: 'ad', btnText: null };\r\n  const [textDialog, setTextDialog] = useState(defaultTextDialog);\r\n  const handleRename = (val, oldVal) => {\r\n    //console.log(\"rename ok\", val, oldVal);\r\n    //console.log(\"textDialog\", textDialog);\r\n\r\n    const moveParam = {\r\n      overwrite: false,\r\n      src: {\r\n        albumId: viewModel.albumId,\r\n        subDir: viewModel.subDir,\r\n        name: oldVal\r\n      },\r\n      dst: {\r\n        albumId: viewModel.albumId,\r\n        subDir: viewModel.subDir,\r\n        name: val\r\n      }\r\n    };\r\n    postMoveFile(moveParam, adjustFsNodes);\r\n    function adjustFsNodes(param) {\r\n      setViewModel((prev) => {\r\n        if (param.src.subDir !== null) {\r\n          const dirIdx = prev.fsNodes.findIndex(n => n.name === param.src.subDir);\r\n          if (param.overwrite) {\r\n            const owIdx = prev.fsNodes[dirIdx].childs.findIndex(f => f.name === param.dst.name);\r\n            prev.fsNodes[dirIdx].childs.splice(owIdx, 1);\r\n          }\r\n\r\n          const fileIdx = prev.fsNodes[dirIdx].childs.findIndex(f => f.name === param.src.name);\r\n          prev.fsNodes[dirIdx].childs[fileIdx].name = param.dst.name;\r\n        }\r\n        else {\r\n          if (param.overwrite) {\r\n            const owIdx = prev.fsNodes.findIndex(n => n.name === param.dst.name);\r\n            prev.fsNodes.splice(owIdx, 1);\r\n          }\r\n\r\n          const fileIdx = prev.fsNodes.findIndex(n => n.name === param.src.name);\r\n          prev.fsNodes[fileIdx].name = param.dst.name;\r\n        }\r\n\r\n        return ({\r\n          ...prev\r\n        });\r\n      });\r\n    }\r\n  };\r\n  const handleCreateFolder = (val, oldVal) => {\r\n    console.log('folder name', val);\r\n    setViewModel((prev) => {\r\n      if (viewModel.subDir !== null) {\r\n        props.popError(\"Invalid Operation\", \"Creating folder inside a folder is not allowed\");\r\n      }\r\n      prev.fsNodes.unshift({\r\n        name: val,\r\n        size: 0,\r\n        nodeType: 0,\r\n        uncPathEncoded: null,\r\n        childs: []\r\n      });\r\n      return ({\r\n        ...prev\r\n      });\r\n    });\r\n  };\r\n\r\n  const rootChain = [{ id: '0', name: 'Root', isDir: true }];\r\n  const [viewModel, setViewModel] = useState({\r\n    albumId: null,\r\n    title: '',\r\n    subDir: null,\r\n    fsNodes: [],\r\n    dirChains: rootChain\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (props.id === \"\" || props.id === null || props.id === undefined) { return; }\r\n\r\n    axios.get(`${_uri.file}GetAlbumFsNodes?id=${props.id}`)\r\n      .then((response) => {\r\n        setViewModel({\r\n          albumId: props.id,\r\n          title: response.data.title,\r\n          subDir: null,\r\n          fsNodes: response.data.fsNodes,\r\n          dirChains: rootChain\r\n        });\r\n\r\n        console.log(response.data)\r\n      })\r\n      .catch((error) => {\r\n        props.popApiError(error);\r\n      });\r\n\r\n  }, [props.id]);\r\n\r\n  const [chonkyModels, setChonkyModels] = useState([]);\r\n  useEffect(() => {\r\n    const targetFsNodes = viewModel.subDir !== null ?\r\n      viewModel.fsNodes.find(n => n.name === viewModel.subDir).childs :\r\n      viewModel.fsNodes;\r\n\r\n    const newModels = targetFsNodes.map((n, index) => {\r\n      return {\r\n        id: index + 1,\r\n        name: n.name,\r\n        isDir: n.nodeType === 0,\r\n        thumbnailUrl: n.nodeType === 1 ? _uri.resizedPage(n.uncPathEncoded, 150) : null,\r\n        size: n.size,\r\n        childrenCount: n.childs?.length,\r\n        selectable: true,\r\n        draggable: n.nodeType !== 0\r\n      }\r\n    });\r\n\r\n    setChonkyModels(newModels);\r\n  }, [viewModel]);\r\n\r\n  const dndBackend = IsMobile() ? TouchBackend : HTML5Backend;\r\n\r\n  return (\r\n    <>\r\n      <div style={{\r\n        width: \"100%\",\r\n        padding: \"0px 8px 0px 8px\",\r\n        borderTop: \"1px solid grey\",\r\n        borderBottom: \"1px solid grey\",\r\n        marginBottom: \"2px\"\r\n      }}>\r\n        <h3>{viewModel.title}</h3>\r\n      </div>\r\n      <div style={{ height: \"80vh\" }}>\r\n        <DndProvider backend={dndBackend}>\r\n          <FileBrowser\r\n            darkMode={true}\r\n            //disableSelection={true}\r\n            files={chonkyModels} folderChain={viewModel.dirChains} fileActions={fileActions}\r\n            disableDragAndDropProvider={true}\r\n            disableDefaultFileActions={true}\r\n            onFileAction={handleAction}\r\n          >\r\n            <FileNavbar />\r\n            <FileToolbar />\r\n            {/* <div style={{ width: \"100%\", }}>wololo</div> */}\r\n            <FileList />\r\n            <FileContextMenu />\r\n          </FileBrowser>\r\n        </DndProvider>\r\n      </div>\r\n      <TextDialog\r\n        visible={textDialog.visible} onClose={() => setTextDialog(defaultTextDialog)}\r\n        initialValue={textDialog.initialValue}\r\n        onOk={textDialog.onOk}\r\n        btnText={textDialog.btnText}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default withMyAlert(FileManagement);\r\n\r\n\r\nfunction FileComparison(props) {\r\n  const f1 = props.file1;\r\n  const f2 = props.file2;\r\n\r\n  return (\r\n    <table class=\"comparison-table\" style={{ width: \"100%\" }}>\r\n      <tr>\r\n        <th>Source</th>\r\n        <th>Destination</th>\r\n      </tr>\r\n      <tr>\r\n        <td>{f1.name}</td>\r\n        <td>{f2.name}</td>\r\n      </tr>\r\n      <tr>\r\n        <td style={getStyle(f1.size, f2.size)}>{(f1.size / 1024).toFixed(2)} KB</td>\r\n        <td style={getStyle(f2.size, f1.size)}>{(f2.size / 1024).toFixed(2)} KB</td>\r\n      </tr>\r\n      <tr>\r\n        <td style={getStyle(f1.createdDate, f2.createdDate)}>{moment(f1.createdDate).format('YYYY-MM-DD hh:mm')}</td>\r\n        <td style={getStyle(f2.createdDate, f1.createdDate)}>{moment(f2.createdDate).format('YYYY-MM-DD hh:mm')}</td>\r\n      </tr>\r\n    </table>\r\n  );\r\n\r\n  function getStyle(a, b) {\r\n    const fontWeight = a > b ? \"bold\" : \"normal\";\r\n    return {\r\n      fontWeight: fontWeight\r\n    };\r\n  }\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\n\r\nimport { Layout, Menu, Drawer, Button, Row, Col, Modal } from 'antd';\r\nimport {\r\n  DesktopOutlined, TeamOutlined, PartitionOutlined, TagsOutlined,\r\n  ReloadOutlined, SyncOutlined, DatabaseOutlined, PlusOutlined,\r\n  MinusOutlined, ConsoleSqlOutlined, SearchOutlined\r\n} from '@ant-design/icons';\r\nimport TextArea from 'antd/lib/input/TextArea';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport queryString from 'query-string';\r\nimport useSWR, { SWRConfig } from 'swr';\r\n\r\nimport Albums from './Albums/Albums';\r\nimport AlbumAddEdit from './AddEdit/AddEdit';\r\nimport Genres from './Genres/Genres';\r\nimport FileManagement from './FileManagement/FileManagement';\r\nimport withMyAlert from \"./_shared/HOCs/withMyAlert\";\r\nimport * as Helper from \"./_utils/Helper\";\r\nimport * as _uri from \"./_utils/UriHelper\";\r\nimport { DesktopOnly, MobileOnly } from './_utils/Display';\r\n\r\nconst axios = require('axios').default;\r\n\r\nconst { Header, Content, Footer, Sider } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\n\r\nfunction AppMasterPage(props) {\r\n  const [showDrawer, setShowDrawer] = useState(false);\r\n  const [collapseSider, setCollapseSider] = useState(false);\r\n  const [albumCount, setAlbumCount] = useState(0);\r\n\r\n  const [tierFilter, setTierFilter] = useState(null);\r\n  const handleSetTierFilter = (tier) => {\r\n    const newTier = tier === tierFilter ? null : tier;\r\n    setTierFilter(newTier);\r\n  }\r\n  const querStr = queryString.parse(props.location.search).query ?? \"\";\r\n  const pageStr = queryString.parse(props.location.search).page ?? 0;\r\n  const rowStr = queryString.parse(props.location.search).row ?? 0;\r\n\r\n  console.log(\"master page rendering\");\r\n\r\n  const queryParts = {\r\n    query: querStr,\r\n    page: pageStr,\r\n    row: rowStr\r\n  };\r\n\r\n  const { page, selectedMenu } = (() => {\r\n    function compose(page, selectedMenu) {\r\n      return {\r\n        page: page,\r\n        selectedMenu: selectedMenu\r\n      };\r\n    }\r\n\r\n    if (props.page === \"Albums\") {\r\n      return compose(<Albums queryParts={queryParts} tierFilter={tierFilter} onAlbumCountChange={setAlbumCount} />, '2');\r\n    }\r\n    else if (props.page === \"AlbumAddEdit\") {\r\n      return compose(<AlbumAddEdit />, '1');\r\n    }\r\n    else if (props.page === \"Artists\") {\r\n      return compose(<Genres page={props.page} history={props.history} />, '3');\r\n    }\r\n    else if (props.page === \"Genres\") {\r\n      return compose(<Genres page={props.page} history={props.history} />, '4');\r\n    }\r\n    else if (props.page === \"FileManagement\") {\r\n      const id = queryString.parse(props.location.search).id ?? \"\";\r\n      return compose(<FileManagement id={id} />, '');\r\n    }\r\n  })();\r\n\r\n  const queryHandler = {\r\n    search: function (query) {\r\n      const correctedQuery = Helper.contains(query.split(\",\")[0], [\":\", \"!\", \">\", \"<\"]) ? query : 'title:' + query;\r\n      queryHandler.goToAlbumList(correctedQuery);\r\n    },\r\n    plus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      const currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryPlus);\r\n      const newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    minus: function (tagName) {\r\n      const targetQueryPlus = \"tag:\" + tagName;\r\n      const targetQueryMinus = \"tag!\" + tagName;\r\n\r\n      const currentQueries = querStr !== \"\" ? querStr.split(',') : [];\r\n      let newQueries = currentQueries.filter((item, index) => !(item === targetQueryPlus || item === targetQueryMinus));\r\n      newQueries.push(targetQueryMinus);\r\n      const newQueryString = newQueries.join(',');\r\n\r\n      queryHandler.goToAlbumList(newQueryString);\r\n    },\r\n    goToAlbumList: function (query) {\r\n      let currentUrlParams = new URLSearchParams(window.location.search);\r\n      currentUrlParams.set('query', query);\r\n      props.history.push(\"Albums?\" + currentUrlParams.toString());\r\n    }\r\n  }\r\n\r\n  const actionHandler = {\r\n    reload: () => {\r\n      axios.get(`${_uri.crud}ReloadDatabase`)\r\n        .then((response) => {\r\n          props.popInfo(\"ReloadDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    },\r\n    rescan: () => {\r\n      axios.get(`${_uri.crud}RescanDatabase`)\r\n        .then((response) => {\r\n          props.popInfo(\"RescanDatabase\", response.data);\r\n        })\r\n        .catch((error) => {\r\n          props.popApiError(error);\r\n        })\r\n    }\r\n  }\r\n\r\n  const menuContent = (\r\n    <>\r\n      <div className=\"logo\">\r\n        {/* <span>{props.page === \"Albums\" ? albumCount : ''}</span> */}\r\n      </div>\r\n      <QueryEditor query={querStr} onOk={(query) => queryHandler.goToAlbumList(query)} />\r\n      <Menu theme=\"dark\" defaultSelectedKeys={[selectedMenu]} defaultOpenKeys={[\"sub1\"]} mode=\"inline\">\r\n        <Menu.Item key=\"2\">\r\n          <Link to=\"/albums?page=1&row=100\">\r\n            <DesktopOutlined />\r\n            <span>Albums</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"3\">\r\n          <Link to=\"/artists\">\r\n            <TeamOutlined />\r\n            <span>Artists</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"4\">\r\n          <Link to=\"/genres\">\r\n            <PartitionOutlined />\r\n            <span>Genres</span>\r\n          </Link>\r\n        </Menu.Item>\r\n        <SubMenu key=\"sub1\" title={<><TagsOutlined /><span>Tags</span></>} >\r\n          <TagMenuContainer onPlus={queryHandler.plus} onMinus={queryHandler.minus} querStr={querStr} />\r\n        </SubMenu>\r\n        <SubMenu key=\"sub2\" title={<><DatabaseOutlined /><span>Actions</span></>} >\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.reload}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><ReloadOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Reload Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n          <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n            <Row onClick={actionHandler.rescan}>\r\n              <Col span={5} style={{ textAlign: \"center\" }}><SyncOutlined style={{ marginRight: \"0px\" }} /></Col>\r\n              <Col span={14}>\r\n                <span style={{ fontSize: \"12px\" }}>Rescan Db</span>\r\n              </Col>\r\n              <Col span={5} style={{ textAlign: \"center\" }}></Col>\r\n            </Row>\r\n          </li>\r\n        </SubMenu>\r\n      </Menu>\r\n    </>\r\n  );\r\n\r\n  const getButtonDisplay = (att, tier) => {\r\n    const isTierMatch = tier === tierFilter;\r\n    if (att === \"type\") {\r\n      return isTierMatch ? \"primary\" : \"link\";\r\n    }\r\n    else {\r\n      return isTierMatch;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <SWRConfig value={{ revalidateOnFocus: false, fetcher: (uri) => fetch(uri).then(res => res.json()) }}>\r\n      <Layout style={{ minHeight: '100vh' }}>\r\n        <MobileOnly>\r\n          <Layout className=\"mobile-header\">\r\n            <Row>\r\n              <Col span={6} className=\"headerbutton-container\">\r\n                <Button onClick={() => handleSetTierFilter(1)} type={getButtonDisplay(\"type\", 1)} ghost={getButtonDisplay(\"ghost\", 1)} style={{ width: \"100%\" }}>Tier 1</Button>\r\n              </Col>\r\n              <Col span={6} className=\"headerbutton-container\">\r\n                <Button onClick={() => handleSetTierFilter(2)} type={getButtonDisplay(\"type\", 2)} ghost={getButtonDisplay(\"ghost\", 2)} style={{ width: \"100%\" }}>Tier 2</Button>\r\n              </Col>\r\n              <Col span={6} className=\"headerbutton-container\">\r\n                <Button onClick={() => handleSetTierFilter(3)} type={getButtonDisplay(\"type\", 3)} ghost={getButtonDisplay(\"ghost\", 3)} style={{ width: \"100%\" }}>Tier 3</Button>\r\n              </Col>\r\n              <Col span={6} className=\"hamburger-container\" onClick={() => setShowDrawer(true)}>\r\n                <MenuIcon style={{ fontSize: \"36px\" }} className=\"hamburger\" />\r\n              </Col>\r\n            </Row>\r\n          </Layout>\r\n          <Drawer\r\n            placement=\"right\"\r\n            closable={false}\r\n            onClose={() => setShowDrawer(false)}\r\n            visible={showDrawer}\r\n          >\r\n            {menuContent}\r\n          </Drawer>\r\n        </MobileOnly>\r\n        <DesktopOnly>\r\n          <Sider collapsible collapsed={collapseSider} onCollapse={(event) => setCollapseSider(event)}>\r\n            {menuContent}\r\n          </Sider>\r\n        </DesktopOnly>\r\n\r\n        <Layout className=\"site-layout\">\r\n          <Content>\r\n            <MobileOnly>\r\n              <div style={{ paddingTop: \"5x\" }}>Padding for mobile</div>\r\n            </MobileOnly>\r\n            <div className=\"site-layout-background\" style={{ paddingTop: 25, paddingLeft: 10, paddingRight: 10, minHeight: 360 }}>\r\n              {page}\r\n            </div>\r\n          </Content>\r\n          <Footer style={{ textAlign: 'center' }}>-----------------</Footer>\r\n        </Layout>\r\n      </Layout>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default withRouter(withMyAlert(AppMasterPage));\r\n\r\nfunction TagMenuContainer(props) {\r\n  const { data: tags, error } = useSWR(`${_uri.crud}GetTagVMs`);\r\n\r\n  if (error) { return <div>error!</div>; }\r\n  if (!tags) { return <div>loading...</div>; }\r\n\r\n  return (\r\n    <>\r\n      {tags.map((tag, index) => (<TagMenuItem key={tag.name} tag={tag} onPlus={props.onPlus} onMinus={props.onMinus} selectStatus={getSelectStatus(tag.name, props.querStr)} />))}\r\n    </>\r\n  );\r\n\r\n  function getSelectStatus(tagName, query) {\r\n    const queryArr = query.split(',');\r\n    const result = queryArr.filter((str) => str.toLowerCase().includes(\"tag:\" + tagName.toLowerCase())).length > 0 ? \"plus\" :\r\n      queryArr.filter((str) => str.toLowerCase().includes(\"tag!\" + tagName.toLowerCase())).length > 0 ? \"minus\" :\r\n        \"none\";\r\n\r\n    return result;\r\n  }\r\n}\r\n\r\nfunction TagMenuItem(props) {\r\n  const encodedQuery = encodeURIComponent(props.tag.query);\r\n  const plusBackground = props.selectStatus === \"plus\" ? \"#1890ff\" : \"\";\r\n  const minusBackground = props.selectStatus === \"minus\" ? \"#1890ff\" : \"\";\r\n\r\n  return (\r\n    <li className=\"ant-menu-item\" role=\"menuitem\" style={{ paddingLeft: \"24px\", paddingRight: \"0px\" }}>\r\n      <Row>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onPlus(props.tag.name)}><PlusOutlined style={{ marginRight: \"0px\", backgroundColor: plusBackground }} /></Col>\r\n        <Link to={\"/albums?query=\" + encodedQuery} >\r\n          <Col span={14}>\r\n            <span style={{ fontSize: \"12px\" }}>{props.tag.name}</span>\r\n          </Col>\r\n        </Link>\r\n        <Col span={5} style={{ textAlign: \"center\" }} onClick={() => props.onMinus(props.tag.name)}><MinusOutlined style={{ marginRight: \"0px\", backgroundColor: minusBackground }} /></Col>\r\n      </Row>\r\n    </li>\r\n  );\r\n}\r\n\r\nfunction QueryEditor(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setQuery(props.query);\r\n  }, [props.query]);\r\n\r\n  function handleOk() {\r\n    setVisible(false);\r\n    props.onOk(query);\r\n  }\r\n\r\n  return (\r\n    <div style={{ paddingLeft: \"24px\" }}>\r\n      <Button type=\"link\" onClick={() => setVisible(true)} style={{ width: \"90%\", textAlign: \"left\", padding: \"0px\" }}>\r\n        <ConsoleSqlOutlined />Query Editor\r\n      </Button>\r\n      <Modal\r\n        visible={visible}\r\n        onCancel={() => setVisible(false)}\r\n        closable={false}\r\n        footer={\r\n          <Button type=\"primary\" onClick={handleOk}>\r\n            <SearchOutlined />Search\r\n          </Button>\r\n        }\r\n      >\r\n        <TextArea\r\n          onChange={(event) => setQuery(event.target.value)}\r\n          value={query}\r\n        //autoSize={{ minRows: 2, maxRows: 5 }} //Enabling this will cause react warning\r\n        />\r\n      </Modal>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport { HashRouter, Route, Switch, Redirect } from 'react-router-dom';\r\n\r\nimport 'antd/dist/antd.css';\r\n\r\nimport './App.scss';\r\nimport AppMasterPage from './AppMasterPage';\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route exact path=\"/\" ><Redirect to=\"/genres\" /></Route>\r\n          <Route exact path=\"/albums\" ><AppMasterPage page=\"Albums\" /></Route>\r\n          <Route exact path=\"/add\" ><AppMasterPage page=\"AlbumAddEdit\" /></Route>\r\n          <Route exact path=\"/artists\" ><AppMasterPage page=\"Artists\" /></Route>\r\n          <Route exact path=\"/genres\" ><AppMasterPage page=\"Genres\" /></Route>\r\n          <Route exact path=\"/filemanagement\" ><AppMasterPage page=\"FileManagement\" /></Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { setChonkyDefaults } from 'chonky';\r\nimport { ChonkyIconFA } from 'chonky-icon-fontawesome';\r\n\r\nconst startApp = () => {\r\n  setChonkyDefaults({ iconComponent: ChonkyIconFA });\r\n  ReactDOM.render(<App />, document.getElementById('root'));\r\n  serviceWorker.unregister();\r\n}\r\n\r\nif (window.cordova) {\r\n  document.addEventListener('deviceready', startApp, false);\r\n}\r\nelse {\r\n  startApp();\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA"],"sourceRoot":""}